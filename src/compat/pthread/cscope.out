cscope 15 $HOME/Projects/2020summer/nautiluses/nautilus-wwy/nautilus/src/compat/pthread               0000362002
	@cleanup.c

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

55 
±e_ş—nup_t
 *

56 
	$±e_pİ_ş—nup
 (
execu‹
)

83 
	`NK_PROFILE_ENTRY
();

84 
±e_ş—nup_t
 *
ş—nup
;

86 
ş—nup
 = (
±e_ş—nup_t
 *è
	`±h»ad_g‘¥ecific
 (
±e_ş—nupKey
);

88 ià(
ş—nup
 !ğ
NULL
)

90 ià(
execu‹
 && (
ş—nup
->
routše
 !ğ
NULL
))

93 (*
ş—nup
->
routše
è(ş—nup->
¬g
);

97 
	`±h»ad_£t¥ecific
 (
±e_ş—nupKey
, (*è
ş—nup
->
´ev
);

101 
	`NK_PROFILE_EXIT
();

102  (
ş—nup
);

104 
	}
}

108 
	$±e_push_ş—nup
 (
±e_ş—nup_t
 * 
ş—nup
,

109 
±e_ş—nup_ÿÎback_t
 
routše
, *
¬g
)

150 
	`NK_PROFILE_ENTRY
();

151 
ş—nup
->
routše
 =„outine;

152 
ş—nup
->
¬g
 =‡rg;

154 
ş—nup
->
´ev
 = (
±e_ş—nup_t
 *è
	`±h»ad_g‘¥ecific
 (
±e_ş—nupKey
);

156 
	`±h»ad_£t¥ecific
 (
±e_ş—nupKey
, (*è
ş—nup
);

158 
	`NK_PROFILE_EXIT
();

159 
	}
}

	@create.c

5 
	~"nk/±e_o§l.h
"

6 
	~"±h»ad.h
"

7 
	~"im¶em’t.h
"

8 
	~<Çutus/Çutus.h
>

10 
	gCOUNT
=0;

12 
	$±h»ad_ü—‹
 (
±h»ad_t
 * 
±id
,

13 cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

14 *(*
¡¬t
è(*), *
¬g
)

25 
	`DEBUG
("thread create‡nd start\n");

26 
	`NK_PROFILE_ENTRY
();

28 
±h»ad_©Œ_t
 
a
;

30 
»suÉ
 = 
EAGAIN
, 
d‘ach_¡©e
=0, 
´iÜ™y
=0;

31 
¡ack_size
;

32 
th»ad_·rms
 *
·rms
 = 
NULL
;

34 
±e_osResuÉ
 
osResuÉ
;

36 ià(
©Œ
 !ğ
NULL
)

38 
a
 = *
©Œ
;

42 
a
 = 
NULL
;

44 ià((
·rms
 = (
th»ad_·rms
 *è
	`m®loc
 ( (*·rms))è=ğ
NULL
)

46 
FAIL0
;

49 
·rms
->
tid
 = 
±id
;

50 
·rms
->
¡¬t
 = start;

51 
·rms
->
¬g
 =‡rg;

54 ià(
a
 !ğ
NULL
)

56 
¡ack_size
 = 
a
->
¡acksize
;

57 
d‘ach_¡©e
 = 
a
->
d‘ach¡©e
;

58 
´iÜ™y
 = 
a
->
·¿m
.
sched_´iÜ™y
;

59 ià(
PTHREAD_INHERIT_SCHED
 =ğ
a
->
šh”™sched
){

69 
¡ack_size
 = 
PTHREAD_STACK_MIN
;

73 
sys_šfo
 *
sys
 = 
	`³r_ıu_g‘
(
sy¡em
);

74 
ıu_num
 = (++
COUNT
)% 
sys
->
num_ıus
;

76 
»t
 = 
	`nk_th»ad_¡¬t
((*)(&
±e_th»ad_¡¬t
), 
·rms
, 
NULL
, 0, (
nk_¡ack_size_t
)
¡ack_size
, 
±id
, 
ıu_num
);

77 ià(
»t
 != 0){

78 
	`ERROR
("createƒrrorƒxit\n");

79 
osResuÉ
 = 
PTE_OS_NO_RESOURCES
;

80 
»suÉ
 = 
EAGAIN
;

81 
FAIL0
;

84 
osResuÉ
 = 
PTE_OS_OK
;

97 
	`NK_PROFILE_EXIT
();

99  
osResuÉ
;

100 
FAIL0
:

101 
	`NK_PROFILE_EXIT
();

103  (
»suÉ
);

105 
	}
}

	@debug.h

1 #iâdeà
_PTHREAD_DEBUG


2 
	#_PTHREAD_DEBUG


	)

4 
	#BOGUS_FUN_ERR
(è
	`ERROR_PRINT
("FunùiÚ (%sèi BOGUS\n", 
__func__
)

	)

5 
	#BOGUS
(è
	`BOGUS_FUN_ERR
()

	)

7 
	#ERROR
(
fmt
, 
¬gs
...è
	`ERROR_PRINT
("±h»ad: " fmt, ##¬gs)

	)

8 
	#INFO
(
fmt
, 
¬gs
...è
	`INFO_PRINT
("±h»ad: " fmt, ##¬gs)

	)

10 #ifdeà
NAUT_CONFIG_DEBUG_BASE_PTHREAD_COMPAT


11 
	#DEBUG
(
fmt
, 
¬gs
...è
	`DEBUG_PRINT
("±h»ad: " fmt, ##¬gs)

	)

13 
	#DEBUG
(
fmt
, 
¬gs
...)

	)

	@global.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

48 
	g±e_´oûssIn™Ÿlized
 = 
PTE_FALSE
;

49 
±e_th»ad_t
 * 
	g±e_th»adReu£Tİ
 = 
PTE_THREAD_REUSE_EMPTY
;

50 
±e_th»ad_t
 * 
	g±e_th»adReu£BÙtom
 = 
PTE_THREAD_REUSE_EMPTY
;

51 
±h»ad_key_t
 
	g±e_£lfTh»adKey
;

52 
±h»ad_key_t
 
	g±e_ş—nupKey
;

54 
	g±e_cÚcu¼’cy
 = 0;

57 
	g±e_ã©u»s
 = 0;

59 
	g±e_smp_sy¡em
 = 
PTE_TRUE
;

64 
±e_osMu‹xHªdË
 
	g±e_th»ad_»u£_lock
;

69 
±e_osMu‹xHªdË
 
	g±e_mu‹x_‹¡_š™_lock
;

75 
±e_osMu‹xHªdË
 
	g±e_cÚd_‹¡_š™_lock
;

81 
±e_osMu‹xHªdË
 
	g±e_rwlock_‹¡_š™_lock
;

87 
±e_osMu‹xHªdË
 
	g±e_¥šlock_‹¡_š™_lock
;

94 
±e_osMu‹xHªdË
 
	g±e_cÚd_li¡_lock
;

	@implement.h

51 #iâdeà
_IMPLEMENT_H


52 
	#_IMPLEMENT_H


	)

54 
	~"nk/±e_o§l.h
"

55 
	~"sim¶e_£m/s£m.h
"

57 
	~"£m­hÜe.h
"

58 
	~"sched.h
"

59 
	~<Çutus/¥šlock.h
>

60 
	~<Çutus/wa™queue.h
>

69 
	mPTh»adS‹In™Ÿl
 = 0,

70 
	mPTh»adS‹RuÂšg
,

71 
	mPTh»adS‹Su¥’ded
,

72 
	mPTh»adS‹CªûlP’dšg
,

74 
	mPTh»adS‹Cªûlšg
,

77 
	mPTh»adS‹Exû±iÚ
,

79 
	mPTh»adS‹La¡


81 
	tPTh»adS‹
;

84 
±e_th»ad_t_
 
	t±e_th»ad_t
;

86 
	s±e_th»ad_t_


88 
nk_th»ad_id_t
 
	mtid
;

90 
±h»ad_t
 
	m±HªdË
;

92 vŞ©
PTh»adS‹
 
	m¡©e
;

93 *
	mex™Stus
;

98 
	msched_´iÜ™y
;

100 
	mÿnûlS‹
;

101 
	mÿnûlTy³
;

102 
	mÿnûlEv’t
;

103 #ifdeà
PTE_CLEANUP_C


104 
jmp_buf
 
	m¡¬t_m¬k
;

106 
	mim¶ic™
:

116 
	#PTE_ATTR_VALID
 ((è0xC4C0FFEE)

	)

118 
	s±h»ad_©Œ_t_


120 
	mv®id
;

121 *
	m¡ackaddr
;

122 
size_t
 
	m¡acksize
;

123 
	md‘ach¡©e
;

124 
sched_·¿m
 
	m·¿m
;

125 
	mšh”™sched
;

126 
	mcÚ‹ÁiÚscİe
;

138 
	s£m_t_


140 
	mv®ue
;

141 
±h»ad_mu‹x_t
 
	mlock
;

142 
±e_osSem­hÜeHªdË
 
	m£m
;

145 
	#PTE_OBJECT_AUTO_INIT
 ((*è-1)

	)

146 
	#PTE_OBJECT_INVALID
 0

	)

148 
	s±h»ad_mu‹x_t_


152 
sim¶e_£m_t
 *
	m£m
;

153 
	mlock_idx
;

160 
	m»cursive_couÁ
;

163 
	mkšd
;

164 
±h»ad_t
 
	mowÃrTh»ad
;

167 
	s±h»ad_mu‹x©Œ_t_


169 
	mpsh¬ed
;

170 
	mkšd
;

190 
	#PTE_SPIN_UNLOCKED
 (1)

	)

191 
	#PTE_SPIN_LOCKED
 (2)

	)

192 
	#PTE_SPIN_USE_MUTEX
 (3)

	)

194 
	s±h»ad_¥šlock_t_


196 
	mš‹¾ock
;

199 
	mıus
;

200 
±h»ad_mu‹x_t
 
	mmu‹x
;

201 } 
	mu
;

205 
	snk_±h»ad_b¬r›r_t_


207 
¥šlock_t
 
	mlock
;

209 
	m»maššg
;

210 
	mš™_couÁ
;

211 
ušt8_t
 
	maùive
;

213 
	mpsh¬ed
;

214 
ušt8_t
 
	m·d
[48];

216 vŞ©
	mnÙify
;

218 } 
__©Œibu‹__
((
·cked
)è__©Œibu‹__((
®igÃd
(64)));

221 
	s±h»ad_b¬r›r_t_


223 
	mnCu¼’tB¬r›rHeight
;

224 
	mnIn™ŸlB¬r›rHeight
;

225 
	miS‹p
;

226 
	mpsh¬ed
;

227 
£m_t
 
	m£mB¬r›rB»eched
[2];

230 
	s±h»ad_b¬r›¿‰r_t_


232 
	mpsh¬ed
;

235 
	s±h»ad_key_t_


237 
	mkey
;

238 (*
	mde¡ruùÜ
) (*);

239 
±h»ad_mu‹x_t
 
	mkeyLock
;

240 *
	mth»ads
;

244 
Th»adP¬ms
 
	tTh»adP¬ms
;

245 
Th»adKeyAssoc
 
	tTh»adKeyAssoc
;

247 
	sth»ad_·rms
{

248 
±h»ad_t
 
	mtid
;

249 * (*
	m¡¬t
) (*);

250 *
	m¬g
;

252 } 
	tth»ad_·rms
;

254 
	sTh»adP¬ms


256 
±h»ad_t
 
	mtid
;

257 *(*
	m¡¬t
) (*);

258 *
	m¬g
;

261 
	snk_±h»ad_cÚd_t_


263 
NK_LOCK_T
 
	mlock
;

264 
sim¶e_£m_t
* 
	m£m
;

266 
	mnwa™”s
;

267 
	mwakeup_£q
;

268 
	mwok’_£q
;

269 
	mmaš_£q
;

270 
	mbÿ¡_£q
;

275 
	s±h»ad_cÚd_t_


277 
	mnWa™”sBlocked
;

278 
	mnWa™”sGÚe
;

279 
	mnWa™”sToUnblock
;

280 
£m_t
 
	m£mBlockQueue
;

282 
£m_t
 
	m£mBlockLock
;

285 
±h»ad_mu‹x_t
 
	mmtxUnblockLock
;

288 
±h»ad_cÚd_t
 
	mÃxt
;

289 
±h»ad_cÚd_t
 
	m´ev
;

293 
	s±h»ad_cÚd©Œ_t_


295 
	mpsh¬ed
;

298 
	#PTE_RWLOCK_MAGIC
 0xçÿde2

	)

300 
	s±h»ad_rwlock_t_


302 
±h»ad_mu‹x_t
 
	mmtxExşusiveAcûss
;

303 
±h»ad_mu‹x_t
 
	mmtxSh¬edAcûssCom¶‘ed
;

304 
±h»ad_cÚd_t
 
	múdSh¬edAcûssCom¶‘ed
;

305 
	mnSh¬edAcûssCouÁ
;

306 
	mnExşusiveAcûssCouÁ
;

307 
	mnCom¶‘edSh¬edAcûssCouÁ
;

308 
	mnMagic
;

311 
	s±h»ad_rwlock©Œ_t_


313 
	mpsh¬ed
;

319 
	s±e_mcs_node_t_


321 
±e_mcs_node_t_
 **
	mlock
;

322 
±e_mcs_node_t_
 *
	mÃxt
;

323 
	m»adyFÏg
;

325 
	mÃxtFÏg
;

329 
±e_mcs_node_t_
 
	t±e_mcs_loÿl_node_t
;

330 
±e_mcs_node_t_
 *
	t±e_mcs_lock_t
;

333 
	sTh»adKeyAssoc


433 
±e_th»ad_t
 * 
	mth»ad
;

434 
±h»ad_key_t
 
	mkey
;

435 
Th»adKeyAssoc
 *
	mÃxtKey
;

436 
Th»adKeyAssoc
 *
	mÃxtTh»ad
;

437 
Th»adKeyAssoc
 *
	m´evKey
;

438 
Th»adKeyAssoc
 *
	m´evTh»ad
;

447 
	#PTE_EPS_EXIT
 (1)

	)

448 
	#PTE_EPS_CANCEL
 (2)

	)

452 
	#PTE_MAX
(
a
,
b
è(×)<(b)?(b):×))

	)

453 
	#PTE_MIN
(
a
,
b
è(×)>(b)?(b):×))

	)

457 
	#PTE_THREAD_REUSE_EMPTY
 ((
±e_th»ad_t
 *è1)

	)

459 
±e_´oûssIn™Ÿlized
;

460 
±e_th»ad_t
 * 
±e_th»adReu£Tİ
;

461 
±e_th»ad_t
 * 
±e_th»adReu£BÙtom
;

462 
±h»ad_key_t
 
±e_£lfTh»adKey
;

463 
±h»ad_key_t
 
±e_ş—nupKey
;

465 
±e_mu‹x_deçuÉ_kšd
;

467 
±e_cÚcu¼’cy
;

469 
±e_ã©u»s
;

471 
±e_osMu‹xHªdË
 
±e_th»ad_»u£_lock
;

472 
±e_osMu‹xHªdË
 
±e_mu‹x_‹¡_š™_lock
;

473 
±e_osMu‹xHªdË
 
±e_cÚd_li¡_lock
;

474 
±e_osMu‹xHªdË
 
±e_cÚd_‹¡_š™_lock
;

475 
±e_osMu‹xHªdË
 
±e_rwlock_‹¡_š™_lock
;

476 
±e_osMu‹xHªdË
 
±e_¥šlock_‹¡_š™_lock
;

479 #ifdeà
__ılu¥lus


492 
±e_is_©Œ
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
);

494 
±e_cÚd_check_Ãed_š™
 (
±h»ad_cÚd_t
 * 
cÚd
);

495 
±e_mu‹x_check_Ãed_š™
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

496 
±e_rwlock_check_Ãed_š™
 (
±h»ad_rwlock_t
 * 
rwlock
);

497 
±e_¥šlock_check_Ãed_š™
 (
±h»ad_¥šlock_t
 * 
lock
);

499 
±e_´oûssIn™Ÿlize
 ();

501 
±e_´oûssT”mš©e
 ();

503 
±e_th»adDe¡roy
 (
±h»ad_t
 
tid
);

504 
±e_th»adEx™AndDe¡roy
 (
±h»ad_t
 
tid
);

506 
±e_pİ_ş—nup_®l
 (
execu‹
);

508 
±h»ad_t
 
±e_Ãw
 ();

510 
±h»ad_t
 
±e_th»adReu£Pİ
 ();

512 
±e_th»adReu£Push
 (
±h»ad_t
 
th»ad
);

514 
±e_g‘´oûssÜs
 (*
couÁ
);

516 
±e_£‰h»ad´iÜ™y
 (
±h»ad_t
 
th»ad
, 
pŞicy
, 
´iÜ™y
);

518 
±e_rwlock_ÿnûlwrwa™
 (*
¬g
);

521 
±e_th»adS¹
 (*
vth»adP¬ms
, ** 
out
);

523 
±e_th»ad_¡¬t
(*
·rms
, ** 
out
);

525 
±e_ÿÎU£rDe¡royRoutšes
 (
±h»ad_t
 
th»ad
);

527 
±e_tkAssocC»©e
 (
±e_th»ad_t
 * 
th»ad
, 
±h»ad_key_t
 
key
);

529 
±e_tkAssocDe¡roy
 (
Th»adKeyAssoc
 * 
assoc
);

531 
£m_wa™_noÿnûl
 (
£m_t
 * 
£m
);

533 
±e_»lmli£cs
 (cÚ¡ 
time¥ec
 * 
ab¡ime
);

535 
±e_mcs_lock_acquœe
 (
±e_mcs_lock_t
 * 
lock
, 
±e_mcs_loÿl_node_t
 * 
node
);

537 
±e_mcs_lock_»Ëa£
 (
±e_mcs_loÿl_node_t
 * 
node
);

540 
±e_throw
 (
exû±iÚ
);

542 
±e_ÿnûÎabË_wa™
 (
±e_osSem­hÜeHªdË
 
£mHªdË
, * 
timeout
);

544 
	#PTE_ATOMIC_EXCHANGE
 
±e_osAtomicExchªge


	)

545 
	#PTE_ATOMIC_EXCHANGE_ADD
 
±e_osAtomicExchªgeAdd


	)

546 
	#PTE_ATOMIC_COMPARE_EXCHANGE
 
±e_osAtomicCom·»Exchªge


	)

547 
	#PTE_ATOMIC_DECREMENT
 
±e_osAtomicDeüem’t


	)

548 
	#PTE_ATOMIC_INCREMENT
 
±e_osAtomicInüem’t


	)

550 
±e_th»ad_d‘ach_Å
();

551 
±e_th»ad_d‘ach_ªd_ex™_Å
();

554 #ifdeà
__ılu¥lus


	@nautilus_osal.c

1 #šşud
	~<¡dio.h
> #šşud<¡dlib.h> #šşud<¡ršg.h> #šşud<p¥k”rÜ.h> #šşud"±e_o§l.h" #šşud"±h»ad.h" #šşud"s-h–³r.h" #šşud<sys/time.h> #šşud<sys/ty³s.h> #šşud<sys/timeb.h> #defšMAX_PSP_UID 2048

	@nautilus_osal.h

29 
	~<Çutus/th»ad.h
>

30 
	~<Çutus/£m­hÜe.h
>

31 
	~<Çutus/¥šlock.h
>

32 
	~<Çutus/th»ad.h
>

34 
nk_th»ad_id_t
 
	t±e_osTh»adHªdË
;

36 
nk_£m­hÜe
 *
	t±e_osSem­hÜeHªdË
;

38 
¥šlock_t
 *
	t±e_osMu‹xHªdË
;

41 
	#OS_IS_HANDLE_VALID
(
x
è((xè> 0)

	)

46 
	#OS_MAX_SIMUL_THREADS
 256

	)

48 
	#OS_DEFAULT_PRIO
 11

	)

50 
	#OS_MIN_PRIO
 17

	)

51 
	#OS_MAX_PRIO
 32

	)

55 
	#POLLING_DELAY_IN_us
 100

	)

59 
	#OS_MAX_SEM_VALUE
 254

	)

	@need_errno.h

16 #iâdeà
_INC_ERRNO


17 
	#_INC_ERRNO


	)

19 #ifdeà 
__ılu¥lus


28 
”ºo
;

32 
	#EPERM
 1

	)

33 
	#ENOENT
 2

	)

34 
	#ESRCH
 3

	)

35 
	#EINTR
 4

	)

36 
	#EIO
 5

	)

37 
	#ENXIO
 6

	)

38 
	#E2BIG
 7

	)

39 
	#ENOEXEC
 8

	)

40 
	#EBADF
 9

	)

41 
	#ECHILD
 10

	)

42 
	#EAGAIN
 11

	)

43 
	#ENOMEM
 12

	)

44 
	#EACCES
 13

	)

45 
	#EFAULT
 14

	)

46 
	#EBUSY
 16

	)

47 
	#EEXIST
 17

	)

48 
	#EXDEV
 18

	)

49 
	#ENODEV
 19

	)

50 
	#ENOTDIR
 20

	)

51 
	#EISDIR
 21

	)

52 
	#EINVAL
 22

	)

53 
	#ENFILE
 23

	)

54 
	#EMFILE
 24

	)

55 
	#ENOTTY
 25

	)

56 
	#EFBIG
 27

	)

57 
	#ENOSPC
 28

	)

58 
	#ESPIPE
 29

	)

59 
	#EROFS
 30

	)

60 
	#EMLINK
 31

	)

61 
	#EPIPE
 32

	)

62 
	#EDOM
 33

	)

63 
	#ERANGE
 34

	)

64 
	#EDEADLK
 36

	)

67 #iâdeà
ENAMETOOLONG


68 
	#ENAMETOOLONG
 38

	)

71 
	#ENOLCK
 39

	)

72 
	#ENOSYS
 40

	)

75 #iâdeà
ENOTEMPTY


76 
	#ENOTEMPTY
 41

	)

79 
	#EILSEQ
 42

	)

84 
	#EDEADLOCK
 
EDEADLK


	)

86 #ifdeà 
__ılu¥lus


	@nk/nk_compatibility.h

2 #iâdeà
NK_COMPAT_PTE_H


3 
	#NK_COMPAT_PTE_H


	)

5 
	~<Çutus/scheduËr.h
>

10 ’um { 
	mARRIVED
=0,

11 
	mADMITTED
,

12 
	mCHANGING
,

13 
	mYIELDING
,

14 
	mSLEEPING
,

16 
	mEXITING
,

18 
	mDENIED
,

19 
	mREAPABLE
,

20 } 
	t¹_¡©us
;

22 ’um { 
	mRUNNABLE_QUEUE
 = 0,

23 
	mPENDING_QUEUE
 = 1,

24 
	mAPERIODIC_QUEUE
 = 2} 
	tqueue_ty³
;

26 
	snk_sched_th»ad_¡©e
 {

28 
nk_sched_cÚ¡¿šts
 
	mcÚ¡¿šts
;

30 
¹_¡©us
 
	m¡©us
;

32 
queue_ty³
 
	mq_ty³
;

34 
	mis_šŒ
;

35 
	mis_sk
;

37 
ušt64_t
 
	m¡¬t_time
;

38 
ušt64_t
 
	mcur_run_time
;

39 
ušt64_t
 
	mrun_time
;

42 
ušt64_t
 
	md—dlše
;

44 
ušt64_t
 
	mex™_time
;

47 
ušt64_t
 
	m¬riv®_couÁ
;

48 
ušt64_t
 
	m»sched_couÁ
;

49 
ušt64_t
 
	m»sched_lÚg_couÁ
;

50 
ušt64_t
 
	msw™ch_š_couÁ
;

51 
ušt64_t
 
	mmiss_couÁ
;

52 
ušt64_t
 
	mmiss_time_sum
;

53 
ušt64_t
 
	mmiss_time_sum2
;

56 
nk_th»ad
 *
	mth»ad
;

59 
¹_node
 *
	mli¡
;

61 } 
	t¹_th»ad
 ;

63 
nk_sched_th»ad_¡©e
 
	t¹_th»ad
;

64 
	s¹_node
 {

65 
¹_th»ad
 *
	mth»ad
;

66 
¹_node
 *
	mÃxt
;

67 
¹_node
 *
	m´ev
;

68 } 
	t¹_node
;

	@nk/nk_osal.c

2 
	~"../debug.h
"

3 
	~"±e_ty³s.h
"

4 
	~"±e_o§l.h
"

5 
	~<Çutus/libccom·t.h
>

6 
	~<Çutus/scheduËr.h
>

7 
	~<Çutus/£m­hÜe.h
>

8 
	~<Çutus/wa™queue.h
>

10 
	#BOGUS_FUN_ERR
(è
	`ERROR_PRINT
("FunùiÚ (%sèi BOGUS\n", 
__func__
)

	)

11 
	#BOGUS
(è
	`BOGUS_FUN_ERR
()

	)

13 
	#STATE_UNLOCK
(
a
,
b
è
	`¥š_uÆock_œq_»¡Üe
×,b)

	)

14 
	#STATE_TRY_LOCK
(
a
,
b
è
	`¥š_Œy_lock_œq_§ve
×,b)

	)

15 
	#STATE_LOCK
(
a
è
	`¥š_lock_œq_§ve
×)

	)

16 
	#RESTORE_UNIRQ
(
a
,
b
è
	`œq_’abË_»¡Üe
(b)

	)

18 
	#SIMPLE_SPIN
 1

	)

19 
	#ZOMBIE
 500

20 
	#ZOMBIE_mode
 
Œue


21 

	)

23 
	#poff£tof
(
TYPE
, 
MEMBER
è((
size_t
è&((TYPE *)0)->MEMBER)

	)

24 
	#pcÚš”_of
(
±r
, 
ty³
, 
memb”
) ({ \

25 cÚ¡ 
	`ty³of
Ğ((
ty³
 *)0)->
memb”
 ) *
__m±r
 = (ty³of((Ñy³ *)0)->memb”)*è(
±r
); \

26 (
ty³
 *)Ğ(*)
__m±r
 - 
	`off£tof
Ñy³,
memb”
è);})

	)

28 
	#TIME
(è()
	`nk_sched_g‘_»®time
();

	)

31 
	#NS
 1000000ULL

	)

35 
	$ex™_check
(*
¡©e
)

37 vŞ©
nk_th»ad_t
 *
th‘h»ad
 = (nk_th»ad_ˆ*)
¡©e
;

39 
	`DEBUG
("ex™_check:h»ad (%lu %sè¡©u i %u\n",
th‘h»ad
->
tid
,th‘h»ad->
Çme
,th‘h»ad->
¡©us
);

40  
th‘h»ad
->
¡©us
==
NK_THR_EXITED
;

41 
	}
}

44 
±e_osResuÉ
 
	$±e_osIn™
(){

45  
PTE_OS_OK
;

46 
	}
}

56 
±e_osResuÉ
 
	$±e_osMu‹xC»©e
(
±e_osMu‹xHªdË
 *
pHªdË
){

58 *
pHªdË
 = 
	`m®loc
((
pmu‹x
));

59 
	`¥šlock_š™
(&((*
pHªdË
)->
lock
));

60 
	`DEBUG
("osMutexCreate\n");

61  
PTE_OS_OK
;

62 
	}
}

64 
±e_osResuÉ
 
	$±e_osMu‹xD–‘e
(
±e_osMu‹xHªdË
 
hªdË
){

65 
	`¥šlock_deš™
(&(
hªdË
->
lock
));

66 
	`DEBUG
("osMutexDelete\n");

67  
PTE_OS_OK
;

68 
	}
}

77 
±e_osResuÉ
 
	$±e_osMu‹xLock
(
±e_osMu‹xHªdË
 
hªdË
){

79 #ià
SIMPLE_SPIN


80 
	`¥š_lock
(&(
hªdË
->
lock
));

82 
hªdË
->
æags
 = 
	`STATE_LOCK
(&(hªdË->
lock
));

85 
	`DEBUG
("osMutexLock\n");

86  
PTE_OS_OK
;

88 
	}
}

91 
±e_osResuÉ
 
	$±e_osMu‹xTimedLock
(
±e_osMu‹xHªdË
 
hªdË
, 
timeout
){

92 
¡¬t
 = 
	`TIME
();

93 
’d
 = 
¡¬t
;

94 
»s
 = -1;

95  (
’d
-
¡¬t
è<
timeout
*
NS
 ){

97 #ià
SIMPLE_SPIN


98 
»s
 = 
	`¥š_Œy_lock
(&(
hªdË
->
lock
));

100 
»s
=
	`STATE_TRY_LOCK
(&(
hªdË
->
lock
), &(hªdË->
æags
) );

103 
	`DEBUG
("osMutexTimedLock\n");

104 
’d
 = 
	`TIME
();

105 if(
»s
 == 0){

106  
PTE_OS_OK
;

109  
PTE_OS_TIMEOUT
;

110 
	}
}

113 
±e_osResuÉ
 
	$±e_osMu‹xUÆock
(
±e_osMu‹xHªdË
 
hªdË
){

115 #ià
SIMPLE_SPIN


116 
	`¥š_uÆock
(&(
hªdË
->
lock
));

118 
	`STATE_UNLOCK
(&(
hªdË
->
lock
), hªdË->
æags
);

121 
	`DEBUG
("osMutexUnlock\n");

122  
PTE_OS_OK
;

123 
	}
}

139 
	gCOUNT
 = 0;

140 
±e_osResuÉ
 
	$±e_osTh»adC»©e
(
±e_osTh»adEÁryPošt
 
’ŒyPošt
,

141 
¡ackSize
,

142 
š™ŸlPriÜ™y
,

143 *
¬gv
,

144 
±e_osTh»adHªdË
* 
hªdË
)

155 
sys_šfo
 *
sys
 = 
	`³r_ıu_g‘
(
sy¡em
);

156 
COUNT
 = (++COUNTè% 
sys
->
num_ıus
;

157 
»t
 = 
	`nk_th»ad_ü—‹
(
’ŒyPošt
, 
¬gv
, 
NULL
, 
çl£
,(
nk_¡ack_size_t
è
¡ackSize
, 
hªdË
,
COUNT
);

158 ià(
»t
 != 0){

159 
	`ERROR
("createƒrrorƒxit\n");

160  
PTE_OS_NO_RESOURCES
;

164 
nk_th»ad
* 
th»ad
 = (nk_th»ad*è(*
hªdË
);

166 
	`DEBUG
("osTh»adC»©%p, %lu„eà%lu\n", 
th»ad
,h»ad->
tid
,h»ad->
»fcouÁ
);

168  
PTE_OS_OK
;

169 
	}
}

172 
±e_osResuÉ
 
	$±e_osTh»adS¹
(
±e_osTh»adHªdË
 
hªdË
){

174 
	`nk_th»ad_run
(
hªdË
);

175 
	`DEBUG
("osTh»adS¹ %08x\n", 
hªdË
);

177  
PTE_OS_OK
;

178 
	}
}

180 
	$±e_osTh»adEx™
(){

181 
	`DEBUG
("osthread EXIT\n");

182 
	`nk_th»ad_ex™
(
NULL
);

183 
	}
}

193 
±e_osResuÉ
 
	$±e_osTh»adWa™FÜEnd
(
±e_osTh»adHªdË
 
th»adHªdË
){

194 
	`DEBUG
("pte osThread Wait For End\n");

195 
nk_th»ad_t
 *
th‘h»ad
 = (nk_th»ad_t*è(
th»adHªdË
);

200  
	`nk_još
(
th‘h»ad
, 
NULL
);

201 
	}
}

207 
±e_osTh»adHªdË
 
	$±e_osTh»adG‘HªdË
(){

209 
nk_th»ad_t
* 
th‘h»ad
 = 
	`g‘_cur_th»ad
();

210 
	`DEBUG
("osThreadGetHandle\n");

211  
th‘h»ad
;

213 
	}
}

215 
	$±e_osTh»adG‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
){

218 
	}
}

220 
±e_osResuÉ
 
	$±e_osTh»adS‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
, 
ÃwPriÜ™y
){

222  
PTE_OS_OK
;

224 
	}
}

226 
±e_osResuÉ
 
	$±e_osTh»adD–‘e
(
±e_osTh»adHªdË
 
hªdË
){

227 
	`DEBUG
("osThreadDelete\n");

228 
	`nk_th»ad_ex™
(
NULL
);

229  
PTE_OS_OK
;

230 
	}
}

237 
±e_osResuÉ
 
	$±e_osTh»adEx™AndD–‘e
(
±e_osTh»adHªdË
 
hªdË
){

239 
	`DEBUG
("osThreadExitDelete\n");

240 
	`nk_th»ad_ex™
(
NULL
);

242 
	}
}

252 
±e_osResuÉ
 
	$±e_osTh»adCªûl
(
±e_osTh»adHªdË
 
hªdË
){

254 
	`BOGUS
();

255 
	`DEBUG
("osThreadCancel\n");

256  
PTE_OS_GENERAL_FAILURE
;

263  
PTE_OS_OK
;

264 
	}
}

267 
±e_osResuÉ
 
	$±e_osTh»adCheckCªûl
(
±e_osTh»adHªdË
 
hªdË
){

269 
	`BOGUS
();

270 
	`DEBUG
("osThreadCheckCancel\n");

271  
PTE_OS_OK
;

280 
	}
}

286 
	$±e_osTh»adSË•
(
m£cs
){

288 
ušt64_t
 
¡¬t
 = 
	`nk_sched_g‘_»®time
(), 
now
, 
wa™ns
 = 
m£cs
*1000000;

289 
now
 = 
¡¬t
;

290 (
now
 - 
¡¬t
è< 
wa™ns
){

291 
	`nk_sched_y›ld
(0);

292 
now
 = 
	`nk_sched_g‘_»®time
();

294 
	}
}

299 
	$±e_osTh»adG‘MaxPriÜ™y
(){

302 
	}
}

307 
	$±e_osTh»adG‘MšPriÜ™y
(){

309 
	}
}

315 
	$±e_osTh»adG‘DeçuÉPriÜ™y
(){

317 
	}
}

328 
±e_osResuÉ
 
	$±e_osSem­hÜeC»©e
(
š™ŸlV®ue
, 
±e_osSem­hÜeHªdË
 *
pHªdË
){

331 
	`DEBUG
("osSemaphoreCreate\n");

333 *
pHªdË
 = 
	`nk_£m­hÜe_ü—‹
(
NULL
, 
š™ŸlV®ue
, 0, NULL);

334  
PTE_OS_OK
;

335 
	}
}

344 
±e_osResuÉ
 
	$±e_osSem­hÜeD–‘e
(
±e_osSem­hÜeHªdË
 
hªdË
){

346 
	`ä“
(
hªdË
);

347 
	`DEBUG
("osSemaphoreDelete\n");

348  
PTE_OS_OK
;

349 
	}
}

359 
±e_osResuÉ
 
	$±e_osSem­hÜePo¡
(
±e_osSem­hÜeHªdË
 
hªdË
, 
couÁ
){

361 
	`DEBUG
("releaseosSemaphorePost\n");

362 
couÁ
--){

363 
	`nk_£m­hÜe_up
(
hªdË
);

366 
	}
}

379 
±e_osResuÉ
 
	$±e_osSem­hÜeP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
){

380 if(
pTimeout
==
NULL
){

381 
	`nk_£m­hÜe_down
(
hªdË
);

383 
	`nk_£m­hÜe_down_timeout
(
hªdË
, (
ušt64_t
)*
pTimeout
);

385 
	}
}

400 
±e_osResuÉ
 
	$±e_osSem­hÜeCªûÎabËP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
){

403 
	`BOGUS
();

404  
	`±e_osSem­hÜeP’d
(
hªdË
, 
pTimeout
);

405 
	}
}

415 
±e_osResuÉ
 
	$±e_osTlsS‘V®ue
(
key
, * 
v®ue
){

416 
	`DEBUG
("pte_osTlsSetvalue\n");

417 
	`nk_s_£t
(
key
, 
v®ue
);

418  
PTE_OS_OK
;

419 
	}
}

431 * 
	$±e_osTlsG‘V®ue
(
key
){

432 
	`DEBUG
("osTlsGetValue\n");

433  
	`nk_s_g‘
(
key
);

434 
	}
}

440 
	$±e_osTlsIn™
(){

442 
	}
}

453 
±e_osResuÉ
 
	$±e_osTlsAÎoc
(*
pKey
){

454 
	`DEBUG
("osTlsAlloc\n");

455 
	`nk_s_key_ü—‹
(
pKey
, 
NULL
);

456  
PTE_OS_OK
;

457 
	}
}

464 
±e_osResuÉ
 
	$±e_osTlsF»e
(
key
){

465 
	`DEBUG
("osTlsFree\n");

466 
	`nk_s_key_d–‘e
(
key
);

467  
PTE_OS_OK
;

468 
	}
}

476 
	$±e_osAtomicExchªge
(*
pT¬g
, 
v®
){

478  
	`__©omic_exchªge_n
(
pT¬g
,
v®
,
__ATOMIC_SEQ_CST
);

479 
	}
}

489 
	$±e_osAtomicCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
){

490 
	`DEBUG
("AtomicCompareEXCHANGE");

491  
	`__sync_v®_com·»_ªd_sw­
(
pde¡
,
comp
,
exchªge
);

493 
	}
}

501 
	$±e_osAtomicExchªgeAdd
(vŞ©e* 
pde¡
, 
v®ue
){

503 
	`DEBUG
("AtomicEXCHANGEAdd\n");

504  
	`__sync_ãtch_ªd_add
(
pde¡
, 
v®ue
);

505 
	}
}

511 
	$±e_osAtomicDeüem’t
(*
pde¡
){

513 
	`DEBUG
("AtomicDecrement\n" );

514  
	`__sync_ãtch_ªd_sub
(
pde¡
,1);

515 
	}
}

517 
	$±e_osAtomicInüem’t
(*
pde¡
){

518 
	`DEBUG
("AtomicIncrement\n");

519  
	`__sync_ãtch_ªd_add
(
pde¡
,1);

521 
	}
}

524 
	$áime
(
timeb
 *
tb
){

525 
tb
->
time
 = 0;

526 
tb
->
ml™m
 = 0;

527 
tb
->
timezÚe
 = 0;

528 
tb
->
d¡æag
=0;

530 
	}
}

614 
	$±h»ad_©fÜk
((*
´•¬e
)(), (*
·»Á
)(), (*
chd
)())

616 
	`DEBUG
("no support for…thrad_atfork()\n");

621 
	}
}

	@nk/pte_generic_osal.h

29 #iâdeà
_GENERIC_OS_SUPPORT_H_


30 
	#_GENERIC_OS_SUPPORT_H_


	)

31 #ifdeà
__ılu¥lus


37 
	e±e_osResuÉ


41 
PTE_OS_OK
 = 0,

44 
PTE_OS_NO_RESOURCES
,

47 
PTE_OS_GENERAL_FAILURE
,

50 
PTE_OS_TIMEOUT
,

53 
PTE_OS_INTERRUPTED
,

56 
PTE_OS_INVALID_PARAM


59 } 
	t±e_osResuÉ
;

65 
±e_osResuÉ
 
±e_osIn™
();

79 
±e_osResuÉ
 
±e_osMu‹xC»©e
(
±e_osMu‹xHªdË
 *
pHªdË
);

88 
±e_osResuÉ
 
±e_osMu‹xD–‘e
(
±e_osMu‹xHªdË
 
hªdË
);

97 
±e_osResuÉ
 
±e_osMu‹xLock
(
±e_osMu‹xHªdË
 
hªdË
);

109 
±e_osResuÉ
 
±e_osMu‹xTimedLock
(
±e_osMu‹xHªdË
 
hªdË
, 
timeoutM£cs
);

118 
±e_osResuÉ
 
±e_osMu‹xUÆock
(
±e_osMu‹xHªdË
 
hªdË
);

141 
±e_osResuÉ
 
±e_osTh»adC»©e
(
±e_osTh»adEÁryPošt
 
’ŒyPošt
,

142 
¡ackSize
,

143 
š™ŸlPriÜ™y
,

144 *
¬gv
,

145 
±e_osTh»adHªdË
* 
µ‹_osTh»adHªdË
);

154 
±e_osResuÉ
 
±e_osTh»adS¹
(
±e_osTh»adHªdË
 
osTh»adHªdË
);

161 
±e_osTh»adEx™
();

171 
±e_osResuÉ
 
±e_osTh»adWa™FÜEnd
(
±e_osTh»adHªdË
 
th»adHªdË
);

176 
±e_osTh»adHªdË
 
±e_osTh»adG‘HªdË
();

181 
±e_osTh»adG‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
);

188 
±e_osResuÉ
 
±e_osTh»adS‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
, 
ÃwPriÜ™y
);

195 
±e_osResuÉ
 
±e_osTh»adD–‘e
(
±e_osTh»adHªdË
 
hªdË
);

202 
±e_osResuÉ
 
±e_osTh»adEx™AndD–‘e
(
±e_osTh»adHªdË
 
hªdË
);

212 
±e_osResuÉ
 
±e_osTh»adCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
);

222 
±e_osResuÉ
 
±e_osTh»adCheckCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
);

227 
±e_osTh»adSË•
(
m£cs
);

232 
±e_osTh»adG‘MaxPriÜ™y
();

237 
±e_osTh»adG‘MšPriÜ™y
();

243 
±e_osTh»adG‘DeçuÉPriÜ™y
();

260 
±e_osResuÉ
 
±e_osSem­hÜeC»©e
(
š™ŸlV®ue
, 
±e_osSem­hÜeHªdË
 *
pHªdË
);

269 
±e_osResuÉ
 
±e_osSem­hÜeD–‘e
(
±e_osSem­hÜeHªdË
 
hªdË
);

279 
±e_osResuÉ
 
±e_osSem­hÜePo¡
(
±e_osSem­hÜeHªdË
 
hªdË
, 
couÁ
);

292 
±e_osResuÉ
 
±e_osSem­hÜeP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
);

307 
±e_osResuÉ
 
±e_osSem­hÜeCªûÎabËP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
);

320 
±e_osResuÉ
 
±e_osTlsS‘V®ue
(
key
, * 
v®ue
);

332 * 
±e_osTlsG‘V®ue
(
key
);

338 
±e_osTlsIn™
();

349 
±e_osResuÉ
 
±e_osTlsAÎoc
(*
pKey
);

358 
±e_osResuÉ
 
±e_osTlsF»e
(
key
);

378 
±e_osAtomicExchªge
(*
pT¬g
, 
v®
);

397 
±e_osAtomicCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
);

413 
±e_osAtomicExchªgeAdd
(vŞ©e* 
pde¡
, 
v®ue
);

428 
±e_osAtomicDeüem’t
(*
pde¡
);

438 
±e_osAtomicInüem’t
(*
pde¡
);

441 
timeb
;

443 
áime
(
timeb
 *
tb
);

445 #ifdeà
__ılu¥lus


	@nk/pte_osal.h

1 #iâdeà
_PTE_OSAL_H_


2 
	#_PTE_OSAL_H_


	)

3 
	~"±e_ty³s.h
"

4 
	~"±e_g’”ic_o§l.h
"

5 
	~<Çutus/Çutus.h
>

7 
	#ÿÎoc
(
a
,
b
è
	`m®loc
×*b)

	)

9 
	#OS_MAX_SIMUL_THREADS
 256

	)

11 
	#OS_DEFAULT_PRIO
 11

	)

13 
	#OS_MIN_PRIO
 17

	)

14 
	#OS_MAX_PRIO
 32

	)

18 
	#POLLING_DELAY_IN_us
 100

	)

20 
	#OS_MAX_SEM_VALUE
 254

	)

23 #iâdeà
EPERM


24 
	#EPERM
 1

	)

27 #iâdeà
ESRCH


28 
	#ESRCH
 3

	)

31 #iâdeà
EINTR


32 
	#EINTR
 4

	)

35 #iâdeà
EIO


36 
	#EIO
 5

	)

39 #iâdeà
EAGAIN


40 
	#EAGAIN
 11

	)

43 #iâdeà
ENOMEM


44 
	#ENOMEM
 12

	)

47 #iâdeà
EBUSY


48 
	#EBUSY
 16

	)

51 #iâdeà
EINVAL


52 
	#EINVAL
 22

	)

55 #iâdeà
ENOSPC


56 
	#ENOSPC
 28

	)

59 #iâdeà
EDEADLK


60 
	#EDEADLK
 35

	)

63 #iâdeà
ENOSYS


64 
	#ENOSYS
 38

	)

67 #iâdeà
ENOTSUP


68 
	#ENOTSUP
 95

	)

71 #iâdeà
ETIMEDOUT


72 
	#ETIMEDOUT
 116

	)

75 #iâdeà
ENOENT


76 
	#ENOENT
 7

	)

79 #iâdeà
ERANGE


80 
	#ERANGE
 9

	)

	@nk/pte_types.h

2 #iâdeà
PTE_TYPES_H


3 
	#PTE_TYPES_H


	)

4 
	~<Çutus/li¡.h
>

5 
	~<Çutus/£m­hÜe.h
>

6 
	~<Çutus/¥šlock.h
>

7 
	~<Çutus/libccom·t.h
>

8 
	~<Çutus/wa™queue.h
>

9 
	~<Çutus/tick‘lock.h
>

11 
	#TICKET_LOCK
 0

	)

13 
	stick‘mu‹x
{

14 
nk_tick‘_lock
 
	mlock
;

17 
	spmu‹x
{

18 
¥šlock_t
 
	mlock
;

19 
ušt8_t
 
	mæags
;

22 
	stick‘_£m­hÜe
{

23 
	m¦“pcouÁ
;

24 
nk_tick‘_lock
 
	mlock
;

25 
	mcouÁ
;

26 
nk_wa™_queue_t
 *
	mwa™_queue
;

27 
ušt8_t
 
	mæags
;

30 
	sp£m­hÜe
{

31 
	m¦“pcouÁ
;

32 
¥šlock_t
 
	mlock
;

33 
	mcouÁ
;

34 
nk_wa™_queue_t
 *
	mwa™_queue
;

35 
ušt8_t
 
	mæags
;

38 
	sth»ad_w™h_sigÇl
{

39 
nk_th»ad_id_t
 
	mtid
;

40 
ušt8_t
 
	m´iÜ™y
;

41 
ušt8_t
 
	msigÇl
;

46 #ià
TICKET_LOCK


47 
nk_tick‘_lock
* 
	t±e_osMu‹xHªdË
;

49 
pmu‹x
* 
	t±e_osMu‹xHªdË
;

52 
nk_th»ad_fun_t
 
	t±e_osTh»adEÁryPošt
;

54 
nk_th»ad_id_t
 
	t±e_osTh»adHªdË
;

56 
nk_£m­hÜe
* 
	t±e_osSem­hÜeHªdË
;

64 
	e_±h»ad_sigÇl
{

65 
	mNK_THREAD_NORM
,

66 
	mNK_THREAD_CANCEL


67 }
	t±h»ad_sigÇl
;

70 
nk_th»ad_fun_t
 
	t±e_osTh»adEÁryPošt
;

71 
	tpid_t
;

72 
	tmode_t
;

74 
	stimeb


76 
time_t
 
	mtime
;

77 
	mml™m
;

78 
	mtimezÚe
;

79 
	md¡æag
;

	@nk_get_pte_thread_t.c

1 
	~<Çutus/Çutus.h
>

2 
	~"±h»ad.h
"

3 
	~"im¶em’t.h
"

5 
±e_th»ad_t
 * 
	$nk_g‘_±e_th»ad_t
(){

7 
nk_th»ad_t
 *
cur
 = 
	`g‘_cur_th»ad
();

8  *((
±e_th»ad_t
 **è
cur
->
hws
+8);

10 
	}
}

	@platform/dspbios/dspbios-config.h

3 #iâdeà
PTE_CONFIG_H


4 
	#PTE_CONFIG_H


	)

6 
	#PTE_STATIC_LIB


	)

13 
	#PTE_BUILD


	)

16 #undeà
NEED_ERRNO


17 
	#NEED_ERRNO


	)

20 #undeà
HAVE_MODE_T


23 #undeà
HAVE_STRUCT_TIMESPEC


	@platform/dspbios/dspbios-osal.c

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

32 
	~<¡d.h
>

33 
	~<şk.h
>

34 
	~<lck.h
>

35 
	~<mbx.h
>

37 
	~<±h»ad.h
>

39 
	~"s-h–³r.h
"

40 
	~"±e_o§l.h
"

42 
	#POLLING_DELAY_IN_ticks
 10

	)

44 
	#DSPBIOS_MAX_TLS
 32

	)

46 
	#DEFAULT_STACK_SIZE_BYTES
 4096

	)

52 
	sd¥biosTh»adD©a


55 
SEM_HªdË
 
	mjošSem
;

58 
SEM_HªdË
 
	mÿnûlSem
;

61 
	m´iÜ™y
;

63 } 
	td¥biosTh»adD©a
;

67 
TSK_HªdË
 
	ggcTaskHªdË
;

68 
MBX_HªdË
 
	ggcMabox
;

71 
	gth»adD©aKey
;

81 
d¥biosTh»adD©a
 * 
	$g‘Th»adD©a
(
TSK_HªdË
 
th»adHªdË
)

84 
d¥biosTh»adD©a
 *
pTh»adD©a
;

85 * 
pTls
;

87 
pTls
 = (*è
	`TSK_g‘’v
(
th»adHªdË
);

89 
pTh»adD©a
 = (
d¥biosTh»adD©a
 *è
	`±eTlsG‘V®ue
(
pTls
, 
th»adD©aKey
);

91  
pTh»adD©a
;

92 
	}
}

95 
	$m£csToSysTicks
(
m£cs
)

97 
ticks
 = 
	`CLK_couÁ¥ms
(è/ 
	`CLK_g‘´d
(è* 
m£cs
;

99 
ticks
 =icks / 100;

101  
ticks
;

102 
	}
}

105 
	$d¥biosG¬bageCŞËùÜMaš
()

108 
gcMabox
 = 
	`MBX_ü—‹
((*), 10, 
NULL
);

112 
BoŞ
 
¡©us
;

113 * 
pTask
;

116 
¡©us
 = 
	`MBX_³nd
(
gcMabox
, &
pTask
, 
SYS_FOREVER
);

118 ià(
¡©us
)

120 
	`TSK_d–‘e
((
TSK_HªdË
è
pTask
);

125 
	}
}

140 
±e_osResuÉ
 
	$±e_osIn™
()

142 
±e_osResuÉ
 
»suÉ
;

143 
TSK_A‰rs
 
©Œs
;

146 
»suÉ
 = 
	`±eTlsGlob®In™
(
DSPBIOS_MAX_TLS
);

148 ià(
»suÉ
 =ğ
PTE_OS_OK
)

151 
»suÉ
 = 
	`±eTlsAÎoc
(&
th»adD©aKey
);

153 ià(
»suÉ
 =ğ
PTE_OS_OK
)

156 
©Œs
 = 
TSK_ATTRS
;

157 
©Œs
.
´iÜ™y
 = 1;

158 
©Œs
.
Çme
 = "pthread-gc";

160 
gcTaskHªdË
 = 
	`TSK_ü—‹
((
Fxn
è
d¥biosG¬bageCŞËùÜMaš
, &
©Œs
);

163 
	`TSK_¦“p
(1);

165 ià(
gcTaskHªdË
 =ğ
NULL
)

167 
»suÉ
 = 
PTE_OS_NO_RESOURCES
;

172  
»suÉ
;

173 
	}
}

183 
	$d¥biosStubTh»adEÁry
 (*
¬gv
, 
±e_osTh»adEÁryPošt
 
’ŒyPošt
)

185 (*(
’ŒyPošt
))(
¬gv
);

187 
	}
}

201 
±e_osResuÉ
 
	$±e_osTh»adC»©e
(
±e_osTh»adEÁryPošt
 
’ŒyPošt
,

202 
¡ackSize
,

203 
š™ŸlPriÜ™y
,

204 *
¬gv
,

205 
±e_osTh»adHªdË
* 
µ‹_osTh»adHªdË
)

207 
TSK_HªdË
 
hªdË
;

208 
TSK_A‰rs
 
©Œs
;

209 *
pTls
;

210 
±e_osResuÉ
 
»suÉ
;

211 
d¥biosTh»adD©a
 *
pTh»adD©a
;

214 ià(
¡ackSize
 < 
DEFAULT_STACK_SIZE_BYTES
)

216 
¡ackSize
 = 
DEFAULT_STACK_SIZE_BYTES
;

220 
pTls
 = 
	`±eTlsTh»adIn™
();

221 ià(
pTls
 =ğ
NULL
)

223 
»suÉ
 = 
PTE_OS_NO_RESOURCES
;

224 
FAIL0
;

233 
pTh»adD©a
 = (
d¥biosTh»adD©a
*è
	`m®loc
((dspbiosThreadData));

235 ià(
pTh»adD©a
 =ğ
NULL
)

237 
	`±eTlsTh»adDe¡roy
(
pTls
);

239 
»suÉ
 = 
PTE_OS_NO_RESOURCES
;

240 
FAIL0
;

244 
	`±eTlsS‘V®ue
(
pTls
, 
th»adD©aKey
, 
pTh»adD©a
);

247 
pTh»adD©a
->
jošSem
 = 
	`SEM_ü—‹
(0, 
NULL
);

248 
pTh»adD©a
->
ÿnûlSem
 = 
	`SEM_ü—‹
(0, 
NULL
);

252 
pTh»adD©a
->
´iÜ™y
 = 
š™ŸlPriÜ™y
;

257 
©Œs
 = 
TSK_ATTRS
;

260 
©Œs
.
¡acksize
 = 
¡ackSize
;

262 
©Œs
.
´iÜ™y
 = -1;

265 
©Œs
.
’vœÚ
 = 
pTls
;

267 
hªdË
 = 
	`TSK_ü—‹
((
Fxn
è
d¥biosStubTh»adEÁry
, &
©Œs
, 
¬gv
, 
’ŒyPošt
);

269 ià(
hªdË
 !ğ
NULL
)

272 *
µ‹_osTh»adHªdË
 = 
hªdË
;

273 
»suÉ
 = 
PTE_OS_OK
;

278 
	`ä“
(
pTh»adD©a
);

279 
	`±eTlsTh»adDe¡roy
(
pTls
);

281 
»suÉ
 = 
PTE_OS_NO_RESOURCES
;

284 
FAIL0
:

285  
»suÉ
;

286 
	}
}

294 
±e_osResuÉ
 
	$±e_osTh»adS¹
(
±e_osTh»adHªdË
 
osTh»adHªdË
)

297 
d¥biosTh»adD©a
 *
pTh»adD©a
;

299 
pTh»adD©a
 = 
	`g‘Th»adD©a
(
osTh»adHªdË
);

301 
	`TSK_£ri
(
osTh»adHªdË
, 
pTh»adD©a
->
´iÜ™y
);

303  
PTE_OS_OK
;

305 
	}
}

314 
	$±e_osTh»adEx™
()

316 
TSK_HªdË
 
thisTask
;

317 
d¥biosTh»adD©a
 *
pTh»adD©a
;

319 
thisTask
 = 
	`TSK_£lf
();

321 
pTh»adD©a
 = 
	`g‘Th»adD©a
(
thisTask
);

323 ià(
pTh»adD©a
 !ğ
NULL
)

325 
	`SEM_po¡
(
pTh»adD©a
->
jošSem
);

328 
	`TSK_ex™
();

330 
	}
}

332 
±e_osResuÉ
 
	$±e_osTh»adEx™AndD–‘e
(
±e_osTh»adHªdË
 
hªdË
)

334 
d¥biosTh»adD©a
 *
pTh»adD©a
;

335 * 
pTls
;

337 
pTh»adD©a
 = 
	`g‘Th»adD©a
(
hªdË
);

339 
pTls
 = (*è
	`TSK_g‘’v
(
hªdË
);

342 
	`SEM_d–‘e
(
pTh»adD©a
->
jošSem
);

343 
	`SEM_d–‘e
(
pTh»adD©a
->
ÿnûlSem
);

345 
	`ä“
(
pTh»adD©a
);

348 
	`±eTlsTh»adDe¡roy
(
pTls
);

352 
	`MBX_po¡
(
gcMabox
, &
hªdË
, 
SYS_FOREVER
);

354 
	`TSK_ex™
();

356  
PTE_OS_OK
;

357 
	}
}

367 
±e_osResuÉ
 
	$±e_osTh»adD–‘e
(
±e_osTh»adHªdË
 
hªdË
)

370 
d¥biosTh»adD©a
 *
pTh»adD©a
;

371 * 
pTls
;

373 
pTh»adD©a
 = 
	`g‘Th»adD©a
(
hªdË
);

375 
pTls
 = (*è
	`TSK_g‘’v
(
hªdË
);

378 
	`SEM_d–‘e
(
pTh»adD©a
->
jošSem
);

379 
	`SEM_d–‘e
(
pTh»adD©a
->
ÿnûlSem
);

381 
	`ä“
(
pTh»adD©a
);

384 
	`±eTlsTh»adDe¡roy
(
pTls
);

386 
	`TSK_d–‘e
(
hªdË
);

388  
PTE_OS_OK
;

389 
	}
}

397 
±e_osResuÉ
 
	$±e_osTh»adWa™FÜEnd
(
±e_osTh»adHªdË
 
th»adHªdË
)

399 
TSK_St
 
skSts
;

400 
±e_osResuÉ
 
»suÉ
;

404 
	`TSK_di§bË
();

407 
	`TSK_¡©
(
th»adHªdË
, &
skSts
);

409 ià(
skSts
.
mode
 !ğ
TSK_TERMINATED
)

411 
d¥biosTh»adD©a
 *
pTh»adD©a
;

412 
d¥biosTh»adD©a
 *
pS–fTh»adD©a
;

414 
pTh»adD©a
 = 
	`g‘Th»adD©a
(
th»adHªdË
);

415 
pS–fTh»adD©a
 = 
	`g‘Th»adD©a
(
	`TSK_£lf
());

417 
	`TSK_’abË
();

423 ià(
	`SEM_couÁ
(
pTh»adD©a
->
jošSem
) > 0)

426 
»suÉ
 = 
PTE_OS_OK
;

429 ià((
pS–fTh»adD©a
 !ğ
NULL
è&& 
	`SEM_couÁ
ÕS–fTh»adD©a->
ÿnûlSem
) > 0)

432 
»suÉ
 = 
PTE_OS_INTERRUPTED
;

439 
	`TSK_¦“p
(
POLLING_DELAY_IN_ticks
);

447 
	`TSK_’abË
();

448 
»suÉ
 = 
PTE_OS_OK
;

451  
»suÉ
;

452 
	}
}

459 
±e_osResuÉ
 
	$±e_osTh»adCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
)

461 
d¥biosTh»adD©a
 *
pTh»adD©a
;

463 
pTh»adD©a
 = 
	`g‘Th»adD©a
(
th»adHªdË
);

465 ià(
pTh»adD©a
 !ğ
NULL
)

467 
	`SEM_po¡
(
pTh»adD©a
->
ÿnûlSem
);

470  
PTE_OS_OK
;

471 
	}
}

478 
±e_osResuÉ
 
	$±e_osTh»adCheckCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
)

481 
d¥biosTh»adD©a
 *
pTh»adD©a
;

483 
pTh»adD©a
 = 
	`g‘Th»adD©a
(
th»adHªdË
);

485 ià(
pTh»adD©a
 !ğ
NULL
)

487 ià(
	`SEM_couÁ
(
pTh»adD©a
->
ÿnûlSem
) > 0)

489  
PTE_OS_INTERRUPTED
;

493  
PTE_OS_OK
;

499  
PTE_OS_OK
;

503 
	}
}

505 
	$±e_osTh»adSË•
(
m£cs
)

507 
ticks
 = 
	`m£csToSysTicks
(
m£cs
);

509 
	`TSK_¦“p
(
ticks
);

510 
	}
}

512 
±e_osTh»adHªdË
 
	$±e_osTh»adG‘HªdË
()

514  
	`TSK_£lf
();

515 
	}
}

517 
	$±e_osTh»adG‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
)

519  
	`TSK_g‘´i
(
th»adHªdË
);

520 
	}
}

522 
±e_osResuÉ
 
	$±e_osTh»adS‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
, 
ÃwPriÜ™y
)

524 
	`TSK_£ri
(
th»adHªdË
, 
ÃwPriÜ™y
);

526  
PTE_OS_OK
;

527 
	}
}

529 
	$±e_osTh»adG‘MšPriÜ™y
()

531  
TSK_MINPRI
;

532 
	}
}

534 
	$±e_osTh»adG‘MaxPriÜ™y
()

536  
TSK_MAXPRI
;

537 
	}
}

539 
	$±e_osTh»adG‘DeçuÉPriÜ™y
()

542  ((
TSK_MINPRI
 + 
TSK_MAXPRI
) / 2);

543 
	}
}

551 
±e_osResuÉ
 
	$±e_osMu‹xC»©e
(
±e_osMu‹xHªdË
 *
pHªdË
)

554 *
pHªdË
 = 
	`LCK_ü—‹
(
NULL
);

556 ià(*
pHªdË
 =ğ
NULL
)

558  
PTE_OS_NO_RESOURCES
;

562  
PTE_OS_OK
;

564 
	}
}

566 
±e_osResuÉ
 
	$±e_osMu‹xD–‘e
(
±e_osMu‹xHªdË
 
hªdË
)

568 
	`LCK_d–‘e
(
hªdË
);

570  
PTE_OS_OK
;

571 
	}
}

573 
±e_osResuÉ
 
	$±e_osMu‹xLock
(
±e_osMu‹xHªdË
 
hªdË
)

575 
	`LCK_³nd
(
hªdË
, 
SYS_FOREVER
);

577  
PTE_OS_OK
;

578 
	}
}

580 
±e_osResuÉ
 
	$±e_osMu‹xUÆock
(
±e_osMu‹xHªdË
 
hªdË
)

583 
	`LCK_po¡
(
hªdË
);

585  
PTE_OS_OK
;

586 
	}
}

594 
±e_osResuÉ
 
	$±e_osSem­hÜeC»©e
(
š™ŸlV®ue
, 
±e_osSem­hÜeHªdË
 *
pHªdË
)

597 *
pHªdË
 = 
	`SEM_ü—‹
(
š™ŸlV®ue
, 
NULL
);

599 ià(*
pHªdË
 =ğ
NULL
)

601  
PTE_OS_NO_RESOURCES
;

605  
PTE_OS_OK
;

608 
	}
}

610 
±e_osResuÉ
 
	$±e_osSem­hÜeD–‘e
(
±e_osSem­hÜeHªdË
 
hªdË
)

612 
	`SEM_d–‘e
(
hªdË
);

614  
PTE_OS_OK
;

615 
	}
}

618 
±e_osResuÉ
 
	$±e_osSem­hÜePo¡
(
±e_osSem­hÜeHªdË
 
hªdË
, 
couÁ
)

620 
i
;

622 
i
=0;i<
couÁ
;i++)

624 
	`SEM_po¡
(
hªdË
);

627  
PTE_OS_OK
;

628 
	}
}

630 
±e_osResuÉ
 
	$±e_osSem­hÜeP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeoutM£cs
)

632 
BoŞ
 
¡©us
;

633 
timeoutTicks
;

635 ià(
pTimeoutM£cs
 =ğ
NULL
)

637 
timeoutTicks
 = 
SYS_FOREVER
;

641 
timeoutTicks
 = 
	`m£csToSysTicks
(*
pTimeoutM£cs
);

645 
¡©us
 = 
	`SEM_³nd
(
hªdË
, 
timeoutTicks
);

647 ià(
¡©us
)

649  
PTE_OS_OK
;

653  
PTE_OS_TIMEOUT
;

656 
	}
}

666 
±e_osResuÉ
 
	$±e_osSem­hÜeCªûÎabËP’d
(
±e_osSem­hÜeHªdË
 
£mHªdË
, *
pTimeout
)

670 
şock_t
 
¡¬t_time
;

671 
şock_t
 
cu¼’t_time
;

672 
±e_osResuÉ
 
»suÉ
 = 
PTE_OS_OK
;

673 
timeout
;

675 
d¥biosTh»adD©a
 *
pTh»adD©a
;

677 
pTh»adD©a
 = 
	`g‘Th»adD©a
(
	`TSK_£lf
());

680 
¡¬t_time
 = 
	`CLK_g‘Éime
();

682 ià(
pTimeout
 =ğ
NULL
)

684 
timeout
 = -1;

688 
timeout
 = 
	`m£csToSysTicks
(*
pTimeout
);

693 
BoŞ
 
£mTimeout
;

694 
¡©us
;

697 
£mTimeout
 = 0;

699 
cu¼’t_time
 = 
	`CLK_g‘Éime
();

701 
¡©us
 = 
	`SEM_³nd
(
£mHªdË
, 
£mTimeout
);

703 ià(
¡©us
 =ğ
TRUE
)

706 
»suÉ
 = 
PTE_OS_OK
;

709 ià((
timeout
 !ğ-1è&& ((
cu¼’t_time
 - 
¡¬t_time
) >imeout))

712 
»suÉ
 = 
PTE_OS_TIMEOUT
;

717 ià((
pTh»adD©a
 !ğ
NULL
è&& 
	`SEM_couÁ
ÕTh»adD©a->
ÿnûlSem
) > 0)

720 
»suÉ
 = 
PTE_OS_INTERRUPTED
;

727 
	`TSK_¦“p
(
POLLING_DELAY_IN_ticks
);

733  
»suÉ
;

735 
	}
}

743 
	$±e_osAtomicExchªge
(*
±¬g
, 
v®
)

746 
ÜigV®
;

747 
Uns
 
ŞdCSR
;

749 
ŞdCSR
 = 
	`HWI_di§bË
();

751 
ÜigV®
 = *
±¬g
;

753 *
±¬g
 = 
v®
;

755 
	`HWI_»¡Üe
(
ŞdCSR
);

757  
ÜigV®
;

759 
	}
}

761 
	$±e_osAtomicCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
)

764 
ÜigV®
;

765 
Uns
 
ŞdCSR
;

767 
ŞdCSR
 = 
	`HWI_di§bË
();

770 
ÜigV®
 = *
pde¡
;

772 ià(*
pde¡
 =ğ
comp
)

774 *
pde¡
 = 
exchªge
;

777 
	`HWI_»¡Üe
(
ŞdCSR
);

780  
ÜigV®
;

782 
	}
}

784 
	$±e_osAtomicExchªgeAddIÁ
(vŞ©e* 
pAdd’d
, 
v®ue
)

787 
ÜigV®
;

788 
Uns
 
ŞdCSR
;

790 
ŞdCSR
 = 
	`HWI_di§bË
();

793 
ÜigV®
 = *
pAdd’d
;

795 *
pAdd’d
 +ğ
v®ue
;

797 
	`HWI_»¡Üe
(
ŞdCSR
);

800  
ÜigV®
;

802 
	}
}

804 
	$±e_osAtomicExchªgeAdd
(vŞ©e* 
pAdd’d
, 
v®ue
)

807 
ÜigV®
;

808 
Uns
 
ŞdCSR
;

810 
ŞdCSR
 = 
	`HWI_di§bË
();

813 
ÜigV®
 = *
pAdd’d
;

815 *
pAdd’d
 +ğ
v®ue
;

817 
	`HWI_»¡Üe
(
ŞdCSR
);

820  
ÜigV®
;

821 
	}
}

823 
	$±e_osAtomicDeüem’t
(*
pde¡
)

825 
v®
;

826 
Uns
 
ŞdCSR
;

828 
ŞdCSR
 = 
	`HWI_di§bË
();

831 (*
pde¡
)--;

832 
v®
 = *
pde¡
;

834 
	`HWI_»¡Üe
(
ŞdCSR
);

836  
v®
;

838 
	}
}

840 
	$±e_osAtomicInüem’t
(*
pde¡
)

842 
v®
;

843 
Uns
 
ŞdCSR
;

845 
ŞdCSR
 = 
	`HWI_di§bË
();

847 (*
pde¡
)++;

849 
v®
 = *
pde¡
;

851 
	`HWI_»¡Üe
(
ŞdCSR
);

854  
v®
;

855 
	}
}

863 
±e_osResuÉ
 
	$±e_osTlsS‘V®ue
(
šdex
, * 
v®ue
)

865 *
pTls
;

867 
pTls
 = (*è
	`TSK_g‘’v
(
	`TSK_£lf
());

869 ià(
pTls
 =ğ
NULL
)

873 
pTls
 = 
	`±eTlsTh»adIn™
();

876 
	`TSK_£‹nv
(
	`TSK_£lf
(), 
pTls
);

879  
	`±eTlsS‘V®ue
(
pTls
, 
šdex
, 
v®ue
);

880 
	}
}

884 * 
	$±e_osTlsG‘V®ue
(
šdex
)

886 *
pTls
;

888 
pTls
 = (*è
	`TSK_g‘’v
(
	`TSK_£lf
());

890  (*è
	`±eTlsG‘V®ue
(
pTls
, 
šdex
);

892 
	}
}

896 
±e_osResuÉ
 
	$±e_osTlsAÎoc
(*
pKey
)

898  
	`±eTlsAÎoc
(
pKey
);

899 
	}
}

902 
±e_osResuÉ
 
	$±e_osTlsF»e
(
šdex
)

904  
	`±eTlsF»e
(
šdex
);

906 
	}
}

909 
	$áime
(
timeb
 *

)

911 
Éime
 = (
	`CLK_g‘Éime
(è* 
	`CLK_ıuCyşesP”Ltime
()) / CLK_cpuCyclesPerLtime();

912 
£cs
 = 
Éime
 / 1000;

913 
m£cs
 = 
Éime
 % 1000;

915 

->
d¡æag
 = 0;

916 

->
timezÚe
 = 0;

917 

->
time
 = 
£cs
;

918 

->
ml™m
 = 
m£cs
;

921 
	}
}

	@platform/dspbios/dspbios-osal.h

29 
	~<¡d.h
>

30 
	~<tsk.h
>

31 
	~<£m.h
>

32 
	~<lck.h
>

33 
	~<”ºo.h
>

35 
TSK_HªdË
 
	t±e_osTh»adHªdË
;

37 
SEM_HªdË
 
	t±e_osSem­hÜeHªdË
;

39 
LCK_HªdË
 
	t±e_osMu‹xHªdË
;

41 
	#OS_DEFAULT_PRIO
 11

	)

43 
	#OS_MAX_SIMUL_THREADS
 10

	)

48 #iâdeà
EPERM


49 
	#EPERM
 1

	)

52 #iâdeà
ESRCH


53 
	#ESRCH
 3

	)

56 #iâdeà
EINTR


57 
	#EINTR
 4

	)

60 #iâdeà
EIO


61 
	#EIO
 5

	)

64 #iâdeà
EAGAIN


65 
	#EAGAIN
 11

	)

68 #iâdeà
ENOMEM


69 
	#ENOMEM
 12

	)

72 #iâdeà
EBUSY


73 
	#EBUSY
 16

	)

76 #iâdeà
EINVAL


77 
	#EINVAL
 22

	)

80 #iâdeà
ENOSPC


81 
	#ENOSPC
 28

	)

84 #iâdeà
EDEADLK


85 
	#EDEADLK
 35

	)

88 #iâdeà
ENOSYS


89 
	#ENOSYS
 38

	)

92 #iâdeà
ENOTSUP


93 
	#ENOTSUP
 95

	)

96 #iâdeà
ETIMEDOUT


97 
	#ETIMEDOUT
 116

	)

	@platform/dspbios/main.c

29 
	~<¡d.h
>

30 
	~<tsk.h
>

32 
±e_‹¡_maš
();

34 
	$maš
()

39 
TSK_A‰rs
 
©Œs
;

41 
©Œs
 = 
TSK_ATTRS
;

43 
©Œs
.
¡acksize
 = 4*1024;

45 
	`TSK_ü—‹
((
Fxn
)
±e_‹¡_maš
,&
©Œs
);

46 
	}
}

	@platform/dspbios/pte_osal.h

2 #iâdeà
_OS_SUPPORT_H_


3 
	#_OS_SUPPORT_H_


	)

6 
	~"d¥bios-o§l.h
"

8 
	~"±e_g’”ic_o§l.h
"

	@platform/dspbios/pte_types.h

3 #iâdeà
PTE_TYPES_H


4 
	#PTE_TYPES_H


	)

6 
	~<time.h
>

8 
	tpid_t
;

10 
	stime¥ec


12 
time_t
 
	mtv_£c
;

13 
	mtv_n£c
;

16 
	tmode_t
;

19 
	stimeb


21 
time_t
 
	mtime
;

22 
	mml™m
;

23 
	mtimezÚe
;

24 
	md¡æag
;

	@platform/helper/tls-helper.c

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

32 
	~"s-h–³r.h
"

34 *
	gkeysU£d
;

37 
	gmaxTlsV®ues
;

39 
±e_osMu‹xHªdË
 
	gglob®TlsLock
;

41 
±e_osResuÉ
 
	$±eTlsGlob®In™
(
maxEÁr›s
)

43 
i
;

44 
±e_osResuÉ
 
»suÉ
;

46 
	`±e_osMu‹xC»©e
(&
glob®TlsLock
);

48 
keysU£d
 = (*è
	`m®loc
(
maxEÁr›s
 * ());

50 ià(
keysU£d
 !ğ
NULL
)

52 
i
=0;i<
maxEÁr›s
;i++)

54 
keysU£d
[
i
] = 0;

57 
maxTlsV®ues
 = 
maxEÁr›s
;

59 
»suÉ
 = 
PTE_OS_OK
;

63 
»suÉ
 = 
PTE_OS_NO_RESOURCES
;

66  
»suÉ
;

67 
	}
}

70 * 
	$±eTlsTh»adIn™
()

72 ** 
pTlsSŒuù
;

73 
i
;

75 
pTlsSŒuù
 = (**è
	`m®loc
(
maxTlsV®ues
 * (*));

78 
i
=0; i<
maxTlsV®ues
;i++)

80 
pTlsSŒuù
[
i
] = 0;

83  (*è
pTlsSŒuù
;

84 
	}
}

87 
±e_osResuÉ
 
	$±eTlsAÎoc
(*
pKey
)

89 
i
;

90 
±e_osResuÉ
 
»suÉ
 = 
PTE_OS_NO_RESOURCES
;

93 
	`±e_osMu‹xLock
(
glob®TlsLock
);

95 
i
=0;i<
maxTlsV®ues
;i++)

97 ià(
keysU£d
[
i
] == 0)

99 
keysU£d
[
i
] = 1;

101 *
pKey
 = 
i
+1;

102 
»suÉ
 = 
PTE_OS_OK
;

107 
	`±e_osMu‹xUÆock
(
glob®TlsLock
);

109  
»suÉ
;

110 
	}
}

113 * 
	$±eTlsG‘V®ue
(*
pTlsTh»adSŒuù
, 
šdex
)

115 **
pTls
 = (**è
pTlsTh»adSŒuù
;

117 ià(
keysU£d
[
šdex
-1])

119 ià(
pTls
 !ğ
NULL
)

121  
pTls
[
šdex
-1];

125  
NULL
;

130  
NULL
;

132 
	}
}

135 
±e_osResuÉ
 
	$±eTlsS‘V®ue
(*
pTlsTh»adSŒuù
, 
šdex
, * 
v®ue
)

137 
±e_osResuÉ
 
»suÉ
;

138 ** 
pTls
 = (**è
pTlsTh»adSŒuù
;

140 ià(
pTls
 !ğ
NULL
)

142 
pTls
[
šdex
-1] = 
v®ue
;

143 
»suÉ
 = 
PTE_OS_OK
;

147 
»suÉ
 = 
PTE_OS_INVALID_PARAM
;

150  
»suÉ
;

152 
	}
}

154 
±e_osResuÉ
 
	$±eTlsF»e
(
šdex
)

156 
±e_osResuÉ
 
»suÉ
;

158 ià(
keysU£d
 !ğ
NULL
)

160 
	`±e_osMu‹xLock
(
glob®TlsLock
);

162 
keysU£d
[
šdex
-1] = 0;

164 
	`±e_osMu‹xUÆock
(
glob®TlsLock
);

166 
»suÉ
 = 
PTE_OS_OK
;

170 
»suÉ
 = 
PTE_OS_GENERAL_FAILURE
;

173  
»suÉ
;

174 
	}
}

176 
	$±eTlsTh»adDe¡roy
(* 
pTlsTh»adSŒuù
)

178 
	`ä“
(
pTlsTh»adSŒuù
);

179 
	}
}

181 
	$±eTlsGlob®De¡roy
()

183 
	`±e_osMu‹xD–‘e
(
glob®TlsLock
);

184 
	`ä“
(
keysU£d
);

185 
	}
}

	@platform/helper/tls-helper.h

29 #iâdeà
_TLS_HELPER_H_


30 
	#_TLS_HELPER_H_


	)

32 
	~"±e_o§l.h
"

36 
±e_osResuÉ
 
±eTlsGlob®In™
(
maxEÁr›s
);

37 * 
±eTlsTh»adIn™
();

39 
±e_osResuÉ
 
±eTlsAÎoc
(*
pKey
);

40 * 
±eTlsG‘V®ue
(*
pTlsTh»adSŒuù
, 
šdex
);

41 
±e_osResuÉ
 
±eTlsS‘V®ue
(*
pTlsTh»adSŒuù
, 
šdex
, * 
v®ue
);

42 
±e_osResuÉ
 
±eTlsF»e
(
šdex
);

44 
±eTlsTh»adDe¡roy
(* 
pTlsTh»adSŒuù
);

45 
±eTlsGlob®De¡roy
();

	@platform/nautilus/main.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<p¥k”Ãl.h
>

4 
	~<p¥debug.h
>

5 
	~<p¥sdk.h
>

6 
	~<p¥ù¾.h
>

9 
PSP_MODULE_INFO
("Pthread Test", 0, 1, 1);

11 
±e_‹¡_maš
();

13 #ifdeà
JNS


14 
	#´štf
 
p¥DebugSü“nPrštf


	)

18 
	$ex™_ÿÎback
(
¬g1
, 
¬g2
, *
commÚ
)

20 
	`sûK”ÃlEx™Game
();

22 
	}
}

25 
	$C®lbackTh»ad
(
SûSize
 
¬gs
, *
¬gp
)

28 
cbid
;

30 
cbid
 = 
	`sûK”ÃlC»©eC®lback
("Ex™ C®lback", 
ex™_ÿÎback
, 
NULL
);

31 
	`sûK”ÃlRegi¡”Ex™C®lback
(
cbid
);

33 
	`sûK”ÃlSË•Th»adCB
();

36 
	}
}

39 
	$S‘upC®lbacks
()

41 
thid
 = 0;

43 
thid
 = 
	`sûK”ÃlC»©eTh»ad
("upd©e_th»ad", 
C®lbackTh»ad
, 0x11, 0xFA0, 0, 0);

44 ià(
thid
 >= 0)

46 
	`sûK”ÃlS¹Th»ad
(
thid
, 0, 0);

49  
thid
;

50 
	}
}

54 
	$maš
()

56 
SûCŒlD©a
 
·d
;

58 
	`p¥DebugSü“nIn™
();

59 
	`S‘upC®lbacks
();

61 
	`±e_‹¡_maš
();

65 
	`sûCŒlR—dBufãrPos™ive
(&
·d
, 1);

66 ià(
·d
.
Bu‰Ús
 & 
PSP_CTRL_UP
)

68 
	`´štf
("Exiting...\n");

74 
	}
}

	@platform/nautilus/nautilus_osal.c

1 #šşud
	~<¡dio.h
> #šşud<¡dlib.h> #šşud<¡ršg.h> #šşud<p¥k”rÜ.h> #šşud"±e_o§l.h" #šşud"±h»ad.h" #šşud"s-h–³r.h" #šşud<sys/time.h> #šşud<sys/ty³s.h> #šşud<sys/timeb.h> #defšMAX_PSP_UID 2048

	@platform/nautilus/nautilus_osal.h

29 
	~<Çutus/th»ad.h
>

30 
	~<Çutus/£m­hÜe.h
>

31 
	~<Çutus/¥šlock.h
>

32 
	~<Çutus/th»ad.h
>

34 
nk_th»ad_id_t
 
	t±e_osTh»adHªdË
;

36 
nk_£m­hÜe
 *
	t±e_osSem­hÜeHªdË
;

38 
¥šlock_t
 *
	t±e_osMu‹xHªdË
;

41 
	#OS_IS_HANDLE_VALID
(
x
è((xè> 0)

	)

46 
	#OS_MAX_SIMUL_THREADS
 1000

	)

48 
	#OS_DEFAULT_PRIO
 11

	)

50 
	#OS_MIN_PRIO
 17

	)

51 
	#OS_MAX_PRIO
 32

	)

55 
	#POLLING_DELAY_IN_us
 100

	)

59 
	#OS_MAX_SEM_VALUE
 254

	)

	@platform/nautilus/psp_osal.c

1 #šşud
	~<¡dio.h
> #šşud<¡dlib.h> #šşud<¡ršg.h> #šşud<p¥k”rÜ.h> #šşud"±e_o§l.h" #šşud"±h»ad.h" #šşud"s-h–³r.h" #šşud<sys/time.h> #šşud<sys/ty³s.h> #šşud<sys/timeb.h> #defšMAX_PSP_UID 2048

	@platform/nautilus/psp_osal.h

29 
	~<p¥sdk.h
>

31 
SûUID
 
	t±e_osTh»adHªdË
;

33 
SûUID
 
	t±e_osSem­hÜeHªdË
;

35 
SûUID
 
	t±e_osMu‹xHªdË
;

38 
	#OS_IS_HANDLE_VALID
(
x
è((xè> 0)

	)

43 
	#OS_MAX_SIMUL_THREADS
 10

	)

45 
	#OS_DEFAULT_PRIO
 11

	)

47 
	#OS_MIN_PRIO
 17

	)

48 
	#OS_MAX_PRIO
 32

	)

52 
	#POLLING_DELAY_IN_us
 100

	)

56 
	#OS_MAX_SEM_VALUE
 254

	)

58 
P¥IÁ”lockedExchªge
(*
±¬g
, 
v®
);

59 
P¥IÁ”lockedCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
);

60 
P¥IÁ”lockedExchªgeAdd
(vŞ©e* 
pAdd’d
, 
v®ue
);

61 
P¥IÁ”lockedDeüem’t
(*
pde¡
);

62 
P¥IÁ”lockedInüem’t
(*
pde¡
);

	@platform/nautilus/pte_osal.h

2 #iâdeà
_OS_SUPPORT_H_


3 
	#_OS_SUPPORT_H_


	)

8 
	~<autocÚf.h
>

9 
	~<Çutus/Çutus.h
>

11 
	~"±e_g’”ic_o§l.h
"

	@platform/nautilus/pte_types.h

3 #iâdeà
PTE_TYPES_H


4 
	#PTE_TYPES_H


	)

6 
	~<”ºo.h
>

7 
	~<sys/ty³s.h
>

8 
	~<sys/timeb.h
>

10 
	tpid_t
;

	@platform/psp/main.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<p¥k”Ãl.h
>

4 
	~<p¥debug.h
>

5 
	~<p¥sdk.h
>

6 
	~<p¥ù¾.h
>

9 
PSP_MODULE_INFO
("Pthread Test", 0, 1, 1);

11 
±e_‹¡_maš
();

13 #ifdeà
JNS


14 
	#´štf
 
p¥DebugSü“nPrštf


	)

18 
	$ex™_ÿÎback
(
¬g1
, 
¬g2
, *
commÚ
)

20 
	`sûK”ÃlEx™Game
();

22 
	}
}

25 
	$C®lbackTh»ad
(
SûSize
 
¬gs
, *
¬gp
)

28 
cbid
;

30 
cbid
 = 
	`sûK”ÃlC»©eC®lback
("Ex™ C®lback", 
ex™_ÿÎback
, 
NULL
);

31 
	`sûK”ÃlRegi¡”Ex™C®lback
(
cbid
);

33 
	`sûK”ÃlSË•Th»adCB
();

36 
	}
}

39 
	$S‘upC®lbacks
()

41 
thid
 = 0;

43 
thid
 = 
	`sûK”ÃlC»©eTh»ad
("upd©e_th»ad", 
C®lbackTh»ad
, 0x11, 0xFA0, 0, 0);

44 ià(
thid
 >= 0)

46 
	`sûK”ÃlS¹Th»ad
(
thid
, 0, 0);

49  
thid
;

50 
	}
}

54 
	$maš
()

56 
SûCŒlD©a
 
·d
;

58 
	`p¥DebugSü“nIn™
();

59 
	`S‘upC®lbacks
();

61 
	`±e_‹¡_maš
();

65 
	`sûCŒlR—dBufãrPos™ive
(&
·d
, 1);

66 ià(
·d
.
Bu‰Ús
 & 
PSP_CTRL_UP
)

68 
	`´štf
("Exiting...\n");

74 
	}
}

	@platform/psp/psp_osal.c

1 #šşud
	~<¡dio.h
> #šşud<¡dlib.h> #šşud<¡ršg.h> #šşud<p¥k”rÜ.h> #šşud"±e_o§l.h" #šşud"±h»ad.h" #šşud"s-h–³r.h" #šşud<sys/time.h> #šşud<sys/ty³s.h> #šşud<sys/timeb.h> #defšMAX_PSP_UID 2048

	@platform/psp/psp_osal.h

29 
	~<p¥sdk.h
>

31 
SûUID
 
	t±e_osTh»adHªdË
;

33 
SûUID
 
	t±e_osSem­hÜeHªdË
;

35 
SûUID
 
	t±e_osMu‹xHªdË
;

38 
	#OS_IS_HANDLE_VALID
(
x
è((xè> 0)

	)

43 
	#OS_MAX_SIMUL_THREADS
 10

	)

45 
	#OS_DEFAULT_PRIO
 11

	)

47 
	#OS_MIN_PRIO
 17

	)

48 
	#OS_MAX_PRIO
 32

	)

52 
	#POLLING_DELAY_IN_us
 100

	)

56 
	#OS_MAX_SEM_VALUE
 254

	)

58 
P¥IÁ”lockedExchªge
(*
±¬g
, 
v®
);

59 
P¥IÁ”lockedCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
);

60 
P¥IÁ”lockedExchªgeAdd
(vŞ©e* 
pAdd’d
, 
v®ue
);

61 
P¥IÁ”lockedDeüem’t
(*
pde¡
);

62 
P¥IÁ”lockedInüem’t
(*
pde¡
);

	@platform/psp/pte_osal.h

2 #iâdeà
_OS_SUPPORT_H_


3 
	#_OS_SUPPORT_H_


	)

6 
	~"p¥_o§l.h
"

8 
	~"±e_g’”ic_o§l.h
"

	@platform/psp/pte_types.h

3 #iâdeà
PTE_TYPES_H


4 
	#PTE_TYPES_H


	)

6 
	~<”ºo.h
>

7 
	~<sys/ty³s.h
>

8 
	~<sys/timeb.h
>

10 
	tpid_t
;

	@pte_callUserDestroyRoutines.c

48 
	~<Çutus/Çutus.h
>

49 
	~"±h»ad.h
"

50 
	~"im¶em’t.h
"

52 
	~"nk/±e_o§l.h
"

54 #ifdeà
__ılu¥lus


55 
	~<exû±iÚ
>

56 
usšg
 
	g¡d
::
‹rmš©e
;

60 
	$±e_ÿÎU£rDe¡royRoutšes
 (
±h»ad_t
 
th»ad
)

78 
	`NK_PROFILE_ENTRY
();

79 
Th»adKeyAssoc
 * 
assoc
;

81 ià(
th»ad
.
p
 !ğ
NULL
)

83 
assocsRemaššg
;

84 
™”©iÚs
 = 0;

85 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
th»ad
.
p
;

95 
assocsRemaššg
 = 0;

96 
™”©iÚs
++;

98 (è
	`±h»ad_mu‹x_lock
(&(
¥
->
th»adLock
));

107 
¥
->
ÃxtAssoc
 = sp->
keys
;

108 (è
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

112 * 
v®ue
;

113 
±h»ad_key_t
 
k
;

114 (*
de¡ruùÜ
) (*);

121 (è
	`±h»ad_mu‹x_lock
(&(
¥
->
th»adLock
));

123 ià((
assoc
 = (
Th»adKeyAssoc
 *)
¥
->
ÃxtAssoc
è=ğ
NULL
)

126 
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

141 ià(
	`±h»ad_mu‹x_Œylock
(&(
assoc
->
key
->
keyLock
)è=ğ
EBUSY
)

143 
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

144 
	`±e_osTh»adSË•
(1);

156 
¥
->
ÃxtAssoc
 = 
assoc
->
ÃxtKey
;

165 
k
 = 
assoc
->
key
;

166 
de¡ruùÜ
 = 
k
->destructor;

167 
v®ue
 = 
	`±e_osTlsG‘V®ue
(
k
->
key
);

168 
	`±e_osTlsS‘V®ue
 (
k
->
key
, 
NULL
);

171 ià(
v®ue
 !ğ
NULL
 && 
™”©iÚs
 <ğ
PTHREAD_DESTRUCTOR_ITERATIONS
)

180 (è
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

181 (è
	`±h»ad_mu‹x_uÆock
(&(
k
->
keyLock
));

183 
assocsRemaššg
++;

185 #ifdeà
__ılu¥lus


187 
Œy


192 
	`de¡ruùÜ
 (
v®ue
);

194 
	`ÿtch
 (...)

205 
	`‹rmš©e
 ();

213 
	`de¡ruùÜ
 (
v®ue
);

224 
	`±e_tkAssocDe¡roy
 (
assoc
);

225 (è
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

226 (è
	`±h»ad_mu‹x_uÆock
(&(
k
->
keyLock
));

230 
assocsRemaššg
);

233 
	`NK_PROFILE_EXIT
();

234 
	}
}

	@pte_cancellable_wait.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"£m­hÜe.h
"

49 
	~"im¶em’t.h
"

52 
	$±e_ÿnûÎabË_wa™
 (
±e_osSem­hÜeHªdË
 
£mHªdË
, * 
timeout
)

54 
	`NK_PROFILE_ENTRY
();

55 
»suÉ
 = 
EINVAL
;

56 
±e_osResuÉ
 
osResuÉ
;

57 
ÿnûlEÇbËd
 = 0;

58 
±h»ad_t
 
£lf
;

59 
±e_th»ad_t
 * 
¥
;

61 
£lf
 = 
	`±h»ad_£lf
();

62 
¥
 = (
±e_th»ad_t
 *è
£lf
.
p
;

64 ià(
¥
 !ğ
NULL
)

69 ià(
¥
->
ÿnûlS‹
 =ğ
PTHREAD_CANCEL_ENABLE
)

71 
ÿnûlEÇbËd
 = 1;

76 ià(
ÿnûlEÇbËd
)

78 
osResuÉ
 = 
	`±e_osSem­hÜeCªûÎabËP’d
(
£mHªdË
, 
timeout
);

82 
osResuÉ
 = 
	`±e_osSem­hÜeP’d
(
£mHªdË
, 
timeout
);

85 
osResuÉ
)

87 
PTE_OS_OK
:

89 
»suÉ
 = 0;

93 
PTE_OS_TIMEOUT
:

95 
»suÉ
 = 
ETIMEDOUT
;

99 
PTE_OS_INTERRUPTED
:

101 ià(
¥
 !ğ
NULL
)

107 (è
	`±h»ad_mu‹x_lock
 (&
¥
->
ÿnûlLock
);

108 ià(
¥
->
¡©e
 < 
PTh»adS‹Cªûlšg
)

110 
¥
->
¡©e
 = 
PTh»adS‹Cªûlšg
;

111 
¥
->
ÿnûlS‹
 = 
PTHREAD_CANCEL_DISABLE
;

112 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

113 
	`±e_throw
 (
PTE_EPS_CANCEL
);

117 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

124 
»suÉ
 = 
EINVAL
;

130 
	`NK_PROFILE_EXIT
();

131  (
»suÉ
);

133 
	}
}

	@pte_cond_check_need_init.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

49 
	$±e_cÚd_check_Ãed_š™
 (
±h»ad_cÚd_t
 * 
cÚd
)

51 
	`NK_PROFILE_ENTRY
();

52 
»suÉ
 = 0;

77 
	`±e_osMu‹xLock
 (
±e_cÚd_‹¡_š™_lock
);

86 ià(*
cÚd
 =ğ
PTHREAD_COND_INITIALIZER
)

88 
»suÉ
 = 
	`±h»ad_cÚd_š™
 (
cÚd
, 
NULL
);

90 ià(*
cÚd
 =ğ
NULL
)

97 
»suÉ
 = 
EINVAL
;

101 
	`±e_osMu‹xUÆock
(
±e_cÚd_‹¡_š™_lock
);

103 
	`NK_PROFILE_EXIT
();

104  
»suÉ
;

105 
	}
}

	@pte_detach.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±e_th»ad_d‘ach_commÚ
 (
th»adShouldEx™
)

49 ià(
±e_´oûssIn™Ÿlized
)

55 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
	`±h»ad_g‘¥ecific
 (
±e_£lfTh»adKey
);

57 ià(
¥
 !ğ
NULL
)

60 
	`±e_ÿÎU£rDe¡royRoutšes
 (
¥
->
±HªdË
);

62 (è
	`±h»ad_mu‹x_lock
 (&
¥
->
ÿnûlLock
);

63 
¥
->
¡©e
 = 
PTh»adS‹La¡
;

69 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

71 ià(
¥
->
d‘achS‹
 =ğ
PTHREAD_CREATE_DETACHED
)

73 ià(
th»adShouldEx™
)

75 
	`±e_th»adEx™AndDe¡roy
 (
¥
->
±HªdË
);

79 
	`±e_th»adDe¡roy
 (
¥
->
±HªdË
);

86 ià(
th»adShouldEx™
)

88 
	`±e_osTh»adEx™
();

95 
	}
}

97 
	$±e_th»ad_d‘ach_ªd_ex™_Å
()

99  
	`±e_th»ad_d‘ach_commÚ
(1);

100 
	}
}

102 
	$±e_th»ad_d‘ach_Å
()

104  
	`±e_th»ad_d‘ach_commÚ
(0);

105 
	}
}

	@pte_generic_osal.h

29 #iâdeà
_GENERIC_OS_SUPPORT_H_


30 
	#_GENERIC_OS_SUPPORT_H_


	)

31 #ifdeà
__ılu¥lus


37 
	e±e_osResuÉ


41 
PTE_OS_OK
 = 0,

44 
PTE_OS_NO_RESOURCES
,

47 
PTE_OS_GENERAL_FAILURE
,

50 
PTE_OS_TIMEOUT
,

53 
PTE_OS_INTERRUPTED
,

56 
PTE_OS_INVALID_PARAM


59 } 
	t±e_osResuÉ
;

65 
±e_osResuÉ
 
±e_osIn™
();

79 
±e_osResuÉ
 
±e_osMu‹xC»©e
(
±e_osMu‹xHªdË
 *
pHªdË
);

88 
±e_osResuÉ
 
±e_osMu‹xD–‘e
(
±e_osMu‹xHªdË
 
hªdË
);

97 
±e_osResuÉ
 
±e_osMu‹xLock
(
±e_osMu‹xHªdË
 
hªdË
);

109 
±e_osResuÉ
 
±e_osMu‹xTimedLock
(
±e_osMu‹xHªdË
 
hªdË
, 
timeoutM£cs
);

118 
±e_osResuÉ
 
±e_osMu‹xUÆock
(
±e_osMu‹xHªdË
 
hªdË
);

123 (*
±e_osTh»adEÁryPošt
)(*
	t·¿ms
);

140 
±e_osResuÉ
 
±e_osTh»adC»©e
(
±e_osTh»adEÁryPošt
 
’ŒyPošt
,

141 
¡ackSize
,

142 
š™ŸlPriÜ™y
,

143 *
¬gv
,

144 
±e_osTh»adHªdË
* 
µ‹_osTh»adHªdË
);

153 
±e_osResuÉ
 
±e_osTh»adS¹
(
±e_osTh»adHªdË
 
osTh»adHªdË
);

160 
±e_osTh»adEx™
();

170 
±e_osResuÉ
 
±e_osTh»adWa™FÜEnd
(
±e_osTh»adHªdË
 
th»adHªdË
);

175 
±e_osTh»adHªdË
 
±e_osTh»adG‘HªdË
();

180 
±e_osTh»adG‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
);

187 
±e_osResuÉ
 
±e_osTh»adS‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
, 
ÃwPriÜ™y
);

194 
±e_osResuÉ
 
±e_osTh»adD–‘e
(
±e_osTh»adHªdË
 
hªdË
);

201 
±e_osResuÉ
 
±e_osTh»adEx™AndD–‘e
(
±e_osTh»adHªdË
 
hªdË
);

211 
±e_osResuÉ
 
±e_osTh»adCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
);

221 
±e_osResuÉ
 
±e_osTh»adCheckCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
);

226 
±e_osTh»adSË•
(
m£cs
);

231 
±e_osTh»adG‘MaxPriÜ™y
();

236 
±e_osTh»adG‘MšPriÜ™y
();

242 
±e_osTh»adG‘DeçuÉPriÜ™y
();

259 
±e_osResuÉ
 
±e_osSem­hÜeC»©e
(
š™ŸlV®ue
, 
±e_osSem­hÜeHªdË
 *
pHªdË
);

268 
±e_osResuÉ
 
±e_osSem­hÜeD–‘e
(
±e_osSem­hÜeHªdË
 
hªdË
);

278 
±e_osResuÉ
 
±e_osSem­hÜePo¡
(
±e_osSem­hÜeHªdË
 
hªdË
, 
couÁ
);

291 
±e_osResuÉ
 
±e_osSem­hÜeP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
);

306 
±e_osResuÉ
 
±e_osSem­hÜeCªûÎabËP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
);

319 
±e_osResuÉ
 
±e_osTlsS‘V®ue
(
key
, * 
v®ue
);

331 * 
±e_osTlsG‘V®ue
(
key
);

337 
±e_osTlsIn™
();

348 
±e_osResuÉ
 
±e_osTlsAÎoc
(*
pKey
);

357 
±e_osResuÉ
 
±e_osTlsF»e
(
key
);

377 
±e_osAtomicExchªge
(*
pT¬g
, 
v®
);

396 
±e_osAtomicCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
);

412 
±e_osAtomicExchªgeAdd
(vŞ©e* 
pde¡
, 
v®ue
);

427 
±e_osAtomicDeüem’t
(*
pde¡
);

437 
±e_osAtomicInüem’t
(*
pde¡
);

440 
timeb
;

442 
áime
(
timeb
 *
tb
);

444 #ifdeà
__ılu¥lus


	@pte_getprocessors.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

62 
	$±e_g‘´oûssÜs
 (*
couÁ
)

64 
»suÉ
 = 0;

66 *
couÁ
 = 1;

68  (
»suÉ
);

69 
	}
}

	@pte_is_attr.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±e_is_©Œ
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
)

51  (
©Œ
 =ğ
NULL
 ||

52 *
©Œ
 =ğ
NULL
 || (*©Œ)->
v®id
 !ğ
PTE_ATTR_VALID
);

53 
	}
}

	@pte_mutex_check_need_init.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

48 
±h»ad_mu‹x©Œ_t_
 
	g±e_»cursive_mu‹x©Œ_s
 =

50 
PTHREAD_PROCESS_PRIVATE
, 
PTHREAD_MUTEX_RECURSIVE


52 
±h»ad_mu‹x©Œ_t_
 
	g±e_”rÜcheck_mu‹x©Œ_s
 =

54 
PTHREAD_PROCESS_PRIVATE
, 
PTHREAD_MUTEX_ERRORCHECK


56 
±h»ad_mu‹x©Œ_t
 
	g±e_»cursive_mu‹x©Œ
 =

58 
PTHREAD_PROCESS_PRIVATE
, 
PTHREAD_MUTEX_RECURSIVE


61 
±h»ad_mu‹x©Œ_t
 
	g±e_”rÜcheck_mu‹x©Œ
 =

63 
PTHREAD_PROCESS_PRIVATE
, 
PTHREAD_MUTEX_ERRORCHECK


70 
	$±e_mu‹x_check_Ãed_š™
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

73 
	`NK_PROFILE_ENTRY
();

74 
»suÉ
 = 0;

75 
±h»ad_mu‹x_t
 
mtx
;

100 
	`±e_osMu‹xLock
 (
±e_mu‹x_‹¡_š™_lock
);

110 
mtx
 = *
mu‹x
;

112 ià(
mtx
 =ğ
PTHREAD_MUTEX_INITIALIZER
)

114 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (
mu‹x
, 
NULL
);

116 ià(
mtx
 =ğ
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
)

118 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (
mu‹x
, &
±e_»cursive_mu‹x©Œ
);

120 ià(
mtx
 =ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

122 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (
mu‹x
, &
±e_”rÜcheck_mu‹x©Œ
);

124 ià(
mtx
 =ğ
NULL
)

131 
»suÉ
 = 
EINVAL
;

134 
	`±e_osMu‹xUÆock
(
±e_mu‹x_‹¡_š™_lock
);

136 
	`NK_PROFILE_EXIT
();

137  (
»suÉ
);

138 
	}
}

	@pte_new.c

46 
	~<Çutus/Çutus.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

52 
±h»ad_t


53 
	$±e_Ãw
 ()

55 
	`NK_PROFILE_ENTRY
();

56 
±h»ad_t
 
t
;

57 
±h»ad_t
 
n
 = {
NULL
, 0};

58 
±e_th»ad_t
 * 

;

63 
t
 = 
	`±e_th»adReu£Pİ
 ();

65 ià(
NULL
 !ğ
t
.
p
)

67 

 = (
±e_th»ad_t
 *è
t
.
p
;

72 

 = (
±e_th»ad_t
 *è
	`ÿÎoc
 (1, (pte_thread_t));

73 
	`mem£t
(

, 0, (
±e_th»ad_t
)*1);

74 ià(

 =ğ
NULL
)

76  
n
;

80 
t
.
p
 = 

->
±HªdË
.p =p;

81 
t
.
x
 = 

->
±HªdË
.x = 0;

85 

->
sched_´iÜ™y
 = 
	`±e_osTh»adG‘MšPriÜ™y
();

87 

->
d‘achS‹
 = 
PTHREAD_CREATE_JOINABLE
;

88 

->
ÿnûlS‹
 = 
PTHREAD_CANCEL_ENABLE
;

89 

->
ÿnûlTy³
 = 
PTHREAD_CANCEL_DEFERRED
;

90 

->
ÿnûlLock
 = 
PTHREAD_MUTEX_INITIALIZER
;

91 

->
th»adLock
 = 
PTHREAD_MUTEX_INITIALIZER
;

93 
	`NK_PROFILE_EXIT
();

94  
t
;

96 
	}
}

	@pte_osal.h

2 #iâdeà
_OS_SUPPORT_H_


3 
	#_OS_SUPPORT_H_


	)

8 
	~<autocÚf.h
>

9 
	~<Çutus/Çutus.h
>

11 
	~"±e_g’”ic_o§l.h
"

	@pte_relmillisecs.c

43 
	~"nk/±e_o§l.h
"

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

48 
	tšt64_t
;

51 
	$±e_»lmli£cs
 (cÚ¡ 
time¥ec
 * 
ab¡ime
)

53 
	`NK_PROFILE_ENTRY
();

54 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

55 cÚ¡ 
MILLISEC_PER_SEC
 = 1000;

56 
mli£cÚds
;

57 
tmpAbsMli£cÚds
;

58 
tmpCu¼Mli£cÚds
;

59 
timeb
 
cu¼SysTime
;

72 
tmpAbsMli£cÚds
 = (
št64_t
)
ab¡ime
->
tv_£c
 * 
MILLISEC_PER_SEC
;

73 
tmpAbsMli£cÚds
 +ğ((
št64_t
)
ab¡ime
->
tv_n£c
 + (
NANOSEC_PER_MILLISEC
/2)) / NANOSEC_PER_MILLISEC;

77 
	`_áime
(&
cu¼SysTime
);

79 
tmpCu¼Mli£cÚds
 = (
št64_t
è
cu¼SysTime
.
time
 * 
MILLISEC_PER_SEC
;

80 
tmpCu¼Mli£cÚds
 +ğ(
št64_t
è
cu¼SysTime
.
ml™m
;

82 ià(
tmpAbsMli£cÚds
 > 
tmpCu¼Mli£cÚds
)

84 
mli£cÚds
 = (è(
tmpAbsMli£cÚds
 - 
tmpCu¼Mli£cÚds
);

85 ià(
mli£cÚds
 == 0xFFFFFFFF)

88 
mli£cÚds
--;

94 
mli£cÚds
 = 0;

97 
	`NK_PROFILE_EXIT
();

98  
mli£cÚds
;

99 
	}
}

	@pte_reuse.c

47 
	~<Çutus/Çutus.h
>

48 
	~<Çutus/Çut_¡ršg.h
>

49 
	~"±h»ad.h
"

50 
	~"im¶em’t.h
"

86 
±h»ad_t


87 
	$±e_th»adReu£Pİ
 ()

89 
±h»ad_t
 
t
 = {
NULL
, 0};

92 
	`±e_osMu‹xLock
 (
±e_th»ad_»u£_lock
);

94 ià(
PTE_THREAD_REUSE_EMPTY
 !ğ
±e_th»adReu£Tİ
)

96 
±e_th»ad_t
 * 

;

98 

 = 
±e_th»adReu£Tİ
;

100 
±e_th»adReu£Tİ
 = 

->
´evReu£
;

102 ià(
PTE_THREAD_REUSE_EMPTY
 =ğ
±e_th»adReu£Tİ
)

104 
±e_th»adReu£BÙtom
 = 
PTE_THREAD_REUSE_EMPTY
;

107 

->
´evReu£
 = 
NULL
;

109 
t
 = 

->
±HªdË
;

112 
	`±e_osMu‹xUÆock
(
±e_th»ad_»u£_lock
);

114  
t
;

116 
	}
}

125 
	$±e_th»adReu£Push
 (
±h»ad_t
 
th»ad
)

127 
	`NK_PROFILE_ENTRY
();

128 
±e_th»ad_t
 * 

 = (±e_th»ad_ˆ*è
th»ad
.
p
;

129 
±h»ad_t
 
t
;

132 
	`±e_osMu‹xLock
 (
±e_th»ad_»u£_lock
);

134 
t
 = 

->
±HªdË
;

135 
	`mem£t
(

, 0, (
±e_th»ad_t
));

138 

->
±HªdË
 = 
t
;

141 #ifdeà
PTE_THREAD_ID_REUSE_INCREMENT


142 

->
±HªdË
.
x
 +ğ
PTE_THREAD_ID_REUSE_INCREMENT
;

144 

->
±HªdË
.
x
++;

147 

->
´evReu£
 = 
PTE_THREAD_REUSE_EMPTY
;

149 ià(
PTE_THREAD_REUSE_EMPTY
 !ğ
±e_th»adReu£BÙtom
)

151 
±e_th»adReu£BÙtom
->
´evReu£
 = 

;

155 
±e_th»adReu£Tİ
 = 

;

158 
±e_th»adReu£BÙtom
 = 

;

160 
	`±e_osMu‹xUÆock
(
±e_th»ad_»u£_lock
);

162 
	`NK_PROFILE_EXIT
();

163 
	}
}

	@pte_rwlock_cancelwrwait.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±e_rwlock_ÿnûlwrwa™
 (*
¬g
)

50 
	`NK_PROFILE_ENTRY
();

51 
±h»ad_rwlock_t
 
rwl
 = (±h»ad_rwlock_tè
¬g
;

53 
rwl
->
nSh¬edAcûssCouÁ
 = -rwl->
nCom¶‘edSh¬edAcûssCouÁ
;

54 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

56 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

57 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

58 
	`NK_PROFILE_EXIT
();

59 
	}
}

	@pte_rwlock_check_need_init.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

48 
	$±e_rwlock_check_Ãed_š™
 (
±h»ad_rwlock_t
 * 
rwlock
)

50 
	`NK_PROFILE_ENTRY
();

51 
»suÉ
 = 0;

76 
	`±e_osMu‹xLock
 (
±e_rwlock_‹¡_š™_lock
);

86 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

88 
»suÉ
 = 
	`±h»ad_rwlock_š™
 (
rwlock
, 
NULL
);

90 ià(*
rwlock
 =ğ
NULL
)

97 
»suÉ
 = 
EINVAL
;

100 
	`±e_osMu‹xUÆock
(
±e_rwlock_‹¡_š™_lock
);

102 
	`NK_PROFILE_EXIT
();

103  
»suÉ
;

104 
	}
}

	@pte_spinlock_check_need_init.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±e_¥šlock_check_Ãed_š™
 (
±h»ad_¥šlock_t
 * 
lock
)

50 
	`NK_PROFILE_ENTRY
();

51 
»suÉ
 = 0;

63 
	`±e_osMu‹xLock
 (
±e_¥šlock_‹¡_š™_lock
);

73 ià(*
lock
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

75 
»suÉ
 = 
	`±h»ad_¥š_š™
 (
lock
, 
PTHREAD_PROCESS_PRIVATE
);

77 ià(*
lock
 =ğ
NULL
)

84 
»suÉ
 = 
EINVAL
;

87 
	`±e_osMu‹xUÆock
(
±e_¥šlock_‹¡_š™_lock
);

89 
	`NK_PROFILE_EXIT
();

90  (
»suÉ
);

91 
	}
}

	@pte_threadDestroy.c

47 
	~<Çutus/Çutus.h
>

48 
	~<Çutus/Çut_¡ršg.h
>

49 
	~"±h»ad.h
"

50 
	~"im¶em’t.h
"

55 
	$±e_th»adDe¡royCommÚ
 (
±h»ad_t
 
th»ad
, 
shouldTh»adEx™
)

57 
	`NK_PROFILE_ENTRY
();

58 
±e_th»ad_t
 * 

 = (±e_th»ad_ˆ*è
th»ad
.
p
;

59 
±e_th»ad_t
 
th»adCİy
;

61 ià(

 !ğ
NULL
)

66 
	`memıy
 (&
th»adCİy
, 

,  (threadCopy));

72 
	`±e_th»adReu£Push
 (
th»ad
);

74 (è
	`±h»ad_mu‹x_de¡roy
(&
th»adCİy
.
ÿnûlLock
);

75 (è
	`±h»ad_mu‹x_de¡roy
(&
th»adCİy
.
th»adLock
);

77 ià(
th»adCİy
.
th»adId
 != 0)

79 ià(
shouldTh»adEx™
)

81 
	`±e_osTh»adEx™AndD–‘e
(
th»adCİy
.
th»adId
);

85 
	`±e_osTh»adD–‘e
(
th»adCİy
.
th»adId
);

92 
	`NK_PROFILE_EXIT
();

93 
	}
}

95 
	$±e_th»adDe¡roy
 (
±h»ad_t
 
th»ad
)

97 
	`±e_th»adDe¡royCommÚ
(
th»ad
,0);

98 
	}
}

100 
	$±e_th»adEx™AndDe¡roy
 (
±h»ad_t
 
th»ad
)

102 
	`±e_th»adDe¡royCommÚ
(
th»ad
,1);

103 
	}
}

	@pte_threadStart.c

47 
	~<Çutus/Çutus.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

51 #ià
defšed
(
PTE_CLEANUP_CXX
)

53 #ià
defšed
(
__GNUC__
) && __GNUC__ < 3

54 
	~<Ãw
>

56 
	~<Ãw
>

57 
usšg


58 
	g¡d
::
‹rmš©e_hªdËr
;

59 
usšg


60 
	g¡d
::
‹rmš©e
;

61 
usšg


62 
	g¡d
::
£t_‹rmš©e
;

65 
‹rmš©e_hªdËr
 
	t‹rmš©e_funùiÚ
;

67 
‹rmš©e_funùiÚ
 
	g±e_ŞdT”mš©e
;

70 
	$±e_‹rmš©e
 ()

72 
	`£t_‹rmš©e
 (
±e_ŞdT”mš©e
);

73 (è
	`±e_th»ad_d‘ach_Å
();

75 
	}
}

79 
	$±e_th»ad_¡¬t
(*
_·rms
, ** 
out
){

81 
	`´štf
(cÚ¡ *
s
, ...);

82 
th»ad_·rms
 * 
·rms
 = (th»ad_·rms*è
_·rms
;

84 *(*
¡¬t
) (*);

85 * 
¬g
;

87 
¡¬t
 = 
·rms
->start;

88 
¬g
 = 
·rms
->arg;

89 
nk_th»ad_t
 * 
tid
 = (nk_th»ad_t*è
·rms
->tid;

90 * 
»s
 = (*
¡¬t
)(
¬g
);

91 
	`nk_th»ad_ex™
(
»s
);

93 
	}
}

	@pte_throw.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

58 
	$±e_throw
 (
exû±iÚ
)

60 
	`NK_PROFILE_ENTRY
();

65 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
	`±h»ad_g‘¥ecific
 (
±e_£lfTh»adKey
);

68 ià(
exû±iÚ
 !ğ
PTE_EPS_CANCEL
 &&ƒxû±iÚ !ğ
PTE_EPS_EXIT
)

71 
	`ex™
 (1);

74 ià(
NULL
 =ğ
¥
 || sp->
im¶ic™
)

82 
ex™Code
 = 0;

84 
exû±iÚ
)

86 
PTE_EPS_CANCEL
:

87 
ex™Code
 = (è
PTHREAD_CANCELED
;

89 
PTE_EPS_EXIT
:

90 
ex™Code
 = (è
¥
->
ex™Stus
;;

94 
	`±e_th»ad_d‘ach_ªd_ex™_Å
 ();

100 #ifdeà
PTE_CLEANUP_C


102 
	`±e_pİ_ş—nup_®l
 (1);

103 
	`lÚgjmp
 (
¥
->
¡¬t_m¬k
, 
exû±iÚ
);

107 #ifdeà
PTE_CLEANUP_CXX


109 
exû±iÚ
)

111 
PTE_EPS_CANCEL
:

112 
throw
 
	`±e_exû±iÚ_ÿnûl
 ();

114 
PTE_EPS_EXIT
:

115 
throw
 
	`±e_exû±iÚ_ex™
 ();

121 #”rÜ 
ERROR
 [
__FILE__
, 
lše
 
__LINE__
]: 
CËªup
 
ty³
 
undefšed
.

128 
	`NK_PROFILE_EXIT
();

129 
	}
}

133 
	$±e_pİ_ş—nup_®l
 (
execu‹
)

135 
NULL
 !ğ
	`±e_pİ_ş—nup
 (
execu‹
))

138 
	}
}

142 
	$±e_g‘_exû±iÚ_£rviûs_code
 ()

144  (è
NULL
;

145 
	}
}

	@pte_tkAssocCreate.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±e_tkAssocC»©e
 (
±e_th»ad_t
 * 
¥
, 
±h»ad_key_t
 
key
)

84 
	`NK_PROFILE_ENTRY
();

85 
Th»adKeyAssoc
 *
assoc
;

94 
assoc
 = (
Th»adKeyAssoc
 *è
	`ÿÎoc
 (1,  (*assoc));

95 
	`mem£t
(
assoc
, 0, 1*(*assoc));

96 ià(
assoc
 =ğ
NULL
)

98  
ENOMEM
;

101 
assoc
->
th»ad
 = 
¥
;

102 
assoc
->
key
 = key;

107 
assoc
->
´evTh»ad
 = 
NULL
;

108 
assoc
->
ÃxtTh»ad
 = (
Th»adKeyAssoc
 *è
key
->
th»ads
;

109 ià(
assoc
->
ÃxtTh»ad
 !ğ
NULL
)

111 
assoc
->
ÃxtTh»ad
->
´evTh»ad
 =‡ssoc;

113 
key
->
th»ads
 = (*è
assoc
;

118 
assoc
->
´evKey
 = 
NULL
;

119 
assoc
->
ÃxtKey
 = (
Th»adKeyAssoc
 *è
¥
->
keys
;

120 ià(
assoc
->
ÃxtKey
 !ğ
NULL
)

122 
assoc
->
ÃxtKey
->
´evKey
 =‡ssoc;

124 
¥
->
keys
 = (*è
assoc
;

126 
	`NK_PROFILE_EXIT
();

129 
	}
}

	@pte_tkAssocDestroy.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±e_tkAssocDe¡roy
 (
Th»adKeyAssoc
 * 
assoc
)

67 
	`NK_PROFILE_ENTRY
();

73 ià(
assoc
 !ğ
NULL
)

75 
Th»adKeyAssoc
 * 
´ev
, * 
Ãxt
;

78 
´ev
 = 
assoc
->
´evKey
;

79 
Ãxt
 = 
assoc
->
ÃxtKey
;

80 ià(
´ev
 !ğ
NULL
)

82 
´ev
->
ÃxtKey
 = 
Ãxt
;

84 ià(
Ãxt
 !ğ
NULL
)

86 
Ãxt
->
´evKey
 = 
´ev
;

89 ià(
assoc
->
th»ad
->
keys
 ==‡ssoc)

92 
assoc
->
th»ad
->
keys
 = 
Ãxt
;

94 ià(
assoc
->
th»ad
->
ÃxtAssoc
 ==‡ssoc)

100 
assoc
->
th»ad
->
ÃxtAssoc
 = 
Ãxt
;

104 
´ev
 = 
assoc
->
´evTh»ad
;

105 
Ãxt
 = 
assoc
->
ÃxtTh»ad
;

106 ià(
´ev
 !ğ
NULL
)

108 
´ev
->
ÃxtTh»ad
 = 
Ãxt
;

110 ià(
Ãxt
 !ğ
NULL
)

112 
Ãxt
->
´evTh»ad
 = 
´ev
;

115 ià(
assoc
->
key
->
th»ads
 ==‡ssoc)

118 
assoc
->
key
->
th»ads
 = 
Ãxt
;

121 
	`ä“
 (
assoc
);

124 
	`NK_PROFILE_EXIT
();

125 
	}
}

	@pte_types.h

3 #iâdeà
PTE_TYPES_H


4 
	#PTE_TYPES_H


	)

6 
	~<”ºo.h
>

7 
	~<sys/ty³s.h
>

8 
	~<sys/timeb.h
>

10 
	tpid_t
;

	@pthread.h

44 #ià!
defšed
Ğ
PTHREAD_H
 )

45 
	#PTHREAD_H


	)

47 
	~"nk/±e_ty³s.h
"

48 
	~"debug.h
"

49 
	~"sched.h
"

51 
	#PTE_VERSION
 2,8,0,0

	)

52 
	#PTE_VERSION_STRING
 "2, 8, 0, 0\0"

	)

76 #ià!
defšed
Ğ
PTE_CLEANUP_CXX
 ) && !defšedĞ
PTE_CLEANUP_C
 )

77 
	#PTE_CLEANUP_C


	)

80 #undeà
PTE_LEVEL


82 #ià
defšed
(
_POSIX_SOURCE
)

83 
	#PTE_LEVEL
 0

	)

87 #ià
defšed
(
_POSIX_C_SOURCE
) && _POSIX_C_SOURCE >= 199309

88 #undeà
PTE_LEVEL


89 
	#PTE_LEVEL
 1

	)

93 #ià
defšed
(
INCLUDE_NP
)

94 #undeà
PTE_LEVEL


95 
	#PTE_LEVEL
 2

	)

99 
	#PTE_LEVEL_MAX
 3

	)

101 #ià!
defšed
(
PTE_LEVEL
)

102 
	#PTE_LEVEL
 
PTE_LEVEL_MAX


	)

181 
	~<Çutus/£tjmp.h
>

182 
	~<lim™s.h
>

189 
	mPTE_FALSE
 = 0,

190 
	mPTE_TRUE
 = (! 
PTE_FALSE
)

284 #undeà
_POSIX_THREADS


285 
	#_POSIX_THREADS
 200112L

	)

287 #undeà
_POSIX_READER_WRITER_LOCKS


288 
	#_POSIX_READER_WRITER_LOCKS
 200112L

	)

290 #undeà
_POSIX_SPIN_LOCKS


291 
	#_POSIX_SPIN_LOCKS
 200112L

	)

293 #undeà
_POSIX_BARRIERS


294 
	#_POSIX_BARRIERS
 200112L

	)

296 #undeà
_POSIX_THREAD_SAFE_FUNCTIONS


297 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200112L

	)

299 #undeà
_POSIX_THREAD_ATTR_STACKSIZE


300 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200112L

	)

305 #undeà
_POSIX_THREAD_ATTR_STACKADDR


306 
	#_POSIX_THREAD_ATTR_STACKADDR
 -1

	)

308 #undeà
_POSIX_THREAD_PRIO_INHERIT


309 
	#_POSIX_THREAD_PRIO_INHERIT
 -1

	)

311 #undeà
_POSIX_THREAD_PRIO_PROTECT


312 
	#_POSIX_THREAD_PRIO_PROTECT
 -1

	)

315 #undeà
_POSIX_THREAD_PRIORITY_SCHEDULING


316 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 -1

	)

318 #undeà
_POSIX_THREAD_PROCESS_SHARED


319 
	#_POSIX_THREAD_PROCESS_SHARED
 -1

	)

354 #undeà
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


355 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

357 #undeà
PTHREAD_DESTRUCTOR_ITERATIONS


358 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

360 #undeà
_POSIX_THREAD_KEYS_MAX


361 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

363 #undeà
PTHREAD_KEYS_MAX


364 
	#PTHREAD_KEYS_MAX
 
_POSIX_THREAD_KEYS_MAX


	)

366 #undeà
PTHREAD_STACK_MIN


367 
	#PTHREAD_STACK_MIN
 0

	)

369 #undeà
_POSIX_THREAD_THREADS_MAX


370 
	#_POSIX_THREAD_THREADS_MAX
 256

	)

373 #undeà
PTHREAD_THREADS_MAX


374 
	#PTHREAD_THREADS_MAX
 2019

	)

376 #undeà
_POSIX_SEM_NSEMS_MAX


377 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

380 #undeà
SEM_NSEMS_MAX


381 
	#SEM_NSEMS_MAX
 1024

	)

383 #undeà
_POSIX_SEM_VALUE_MAX


384 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

386 #undeà
SEM_VALUE_MAX


387 
	#SEM_VALUE_MAX
 
INT_MAX


	)

397 * 
	mp
;

398 
	mx
;

401 } 
	t±e_hªdË_t
;

405 
nk_th»ad_id_t
 
	t±h»ad_t
;

406 
±h»ad_©Œ_t_
 * 
	t±h»ad_©Œ_t
;

407 
±h»ad_Úû_t_
 
	t±h»ad_Úû_t
;

409 
nk_s_key_t
 
	t±h»ad_key_t
;

410 
±h»ad_mu‹x_t_
 * 
	t±h»ad_mu‹x_t
;

411 
±h»ad_mu‹x©Œ_t_
 
	t±h»ad_mu‹x©Œ_t
;

413 
±h»ad_cÚd©Œ_t_
 * 
	t±h»ad_cÚd©Œ_t
;

414 
±h»ad_rwlock_t_
 * 
	t±h»ad_rwlock_t
;

415 
±h»ad_rwlock©Œ_t_
 * 
	t±h»ad_rwlock©Œ_t
;

416 
±h»ad_¥šlock_t_
 * 
	t±h»ad_¥šlock_t
;

418 
nk_±h»ad_b¬r›r_t_
 
	t±h»ad_b¬r›r_t
;

419 
nk_±h»ad_cÚd_t_
 
	t±h»ad_cÚd_t
;

421 
±h»ad_b¬r›¿‰r_t_
 * 
	t±h»ad_b¬r›¿‰r_t
;

436 
	mPTHREAD_CREATE_JOINABLE
 = 0,

437 
	mPTHREAD_CREATE_DETACHED
 = 1,

442 
	mPTHREAD_INHERIT_SCHED
 = 0,

443 
	mPTHREAD_EXPLICIT_SCHED
 = 1,

448 
	mPTHREAD_SCOPE_PROCESS
 = 0,

449 
	mPTHREAD_SCOPE_SYSTEM
 = 1,

450 
	mPTHREAD_SCOPE_PROCESS_VFPU
 = 2,

455 
	mPTHREAD_CANCEL_ENABLE
 = 0,

456 
	mPTHREAD_CANCEL_DISABLE
 = 1,

461 
	mPTHREAD_CANCEL_ASYNCHRONOUS
 = 0,

462 
	mPTHREAD_CANCEL_DEFERRED
 = 1,

468 
	mPTHREAD_PROCESS_PRIVATE
 = 0,

469 
	mPTHREAD_PROCESS_SHARED
 = 1,

474 
	mPTHREAD_BARRIER_SERIAL_THREAD
 = -1

484 
	#PTHREAD_CANCELED
 ((*è-1)

	)

494 
	#PTHREAD_ONCE_INIT
 { 
PTE_FALSE
, 0, 0, 0}

	)

496 
	s±h»ad_Úû_t_


498 
	m¡©e
;

499 * 
	m£m­hÜe
;

500 
	mnumSem­hÜeU£rs
;

501 
	mdÚe
;

515 
	#PTHREAD_MUTEX_INITIALIZER
 ((
±h»ad_mu‹x_t
è-1)

	)

516 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER
 ((
±h»ad_mu‹x_t
è-2)

	)

517 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
 ((
±h»ad_mu‹x_t
è-3)

	)

522 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 
PTHREAD_RECURSIVE_MUTEX_INITIALIZER


	)

523 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER


	)

525 
	#PTHREAD_COND_INITIALIZER
 {0,0,0,0,0,0,0}

	)

527 
	#PTHREAD_RWLOCK_INITIALIZER
 ((
±h»ad_rwlock_t
è-1)

	)

529 
	#PTHREAD_SPINLOCK_INITIALIZER
 ((
±h»ad_¥šlock_t
è-1)

	)

538 
	mPTHREAD_MUTEX_FAST_NP
,

539 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

540 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

541 
	mPTHREAD_MUTEX_TIMED_NP
 = 
PTHREAD_MUTEX_FAST_NP
,

542 
	mPTHREAD_MUTEX_ADAPTIVE_NP
 = 
PTHREAD_MUTEX_FAST_NP
,

544 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_FAST_NP
,

545 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

546 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

547 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


551 
±e_ş—nup_t
 
	t±e_ş—nup_t
;

553 (* 
	t±e_ş—nup_ÿÎback_t
)(*);

555 
	s±e_ş—nup_t


557 
±e_ş—nup_ÿÎback_t
 
routše
;

558 *
¬g
;

559 
±e_ş—nup_t
 *
´ev
;

562 #ifdeà
PTE_CLEANUP_C


568 
	#±h»ad_ş—nup_push
Ğ
_rout
, 
_¬g
 ) \

570 
±e_ş—nup_t
 
_ş—nup
; \

572 
	`±e_push_ş—nup
Ğ&
_ş—nup
, (
±e_ş—nup_ÿÎback_t
è(
_rout
), (
_¬g
) ); \

573 

	)

574 
	#±h»ad_ş—nup_pİ
Ğ
_execu‹
 ) \

575 (è
	`±e_pİ_ş—nup
Ğ
_execu‹
 ); \

576 
	}

	)
}

580 #ifdeà
PTE_CLEANUP_CXX


587 şas 
	cPTh»adCËªup


601 
±e_ş—nup_ÿÎback_t
 
	mş—nUpRout
;

602 * 
	mobj
;

603 
	mexecu‹It
;

605 
	mpublic
:

606 
	$PTh»adCËªup
() :

607 
	`ş—nUpRout
( 0 ),

608 
	`obj
( 0 ),

609 
	$execu‹It
( 0 )

616 
	$PTh»adCËªup
(

617 
±e_ş—nup_ÿÎback_t
 
routše
,

618 * 
¬g
 ) :

619 
	`ş—nUpRout
Ğ
routše
 ),

620 
	`obj
Ğ
¬g
 ),

621 
	$execu‹It
( 1 )

626 
	}
}

628 ~
	$PTh»adCËªup
()

630 iàĞ
execu‹It
 )

632 (è(*
ş—nUpRout
)Ğ
obj
 );

634 
	}
}

636 
	$execu‹
Ğ
exec
 )

638 
execu‹It
 = 
exec
;

639 
	}
}

648 
	#±h»ad_ş—nup_push
Ğ
_rout
, 
_¬g
 ) \

650 
PTh»adCËªup
 
	`ş—nup
((
±e_ş—nup_ÿÎback_t
)(
_rout
), \

651 (*è(
_¬g
è);

	)

653 
	#±h»ad_ş—nup_pİ
Ğ
_execu‹
 ) \

654 
ş—nup
.
	`execu‹
Ğ
_execu‹
 ); \

655 }

	)

659 #”rÜ 
ERROR
 [
__FILE__
, 
lše
 
__LINE__
]: 
CËªup
 
ty³
 
undefšed
.

673 
±h»ad_š™
 ();

674 
±h»ad_‹rmš©e
 ();

679 
±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 * 
©Œ
);

681 
±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 * 
©Œ
);

683 
±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

684 *
d‘ach¡©e
);

686 
±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

687 **
¡ackaddr
);

689 
±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

690 
size_t
 * 
¡acksize
);

691 
±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

692 **
¡ackaddr
,

693 
size_t
 *
¡acksize
);

694 
±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 * 
©Œ
,

695 
d‘ach¡©e
);

697 
±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 * 
©Œ
,

698 *
¡ackaddr
);

700 
±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 * 
©Œ
,

701 
size_t
 
¡acksize
);

703 
±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
©Œ
,

704 
sched_·¿m
 *
·¿m
);

706 
±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
©Œ
,

707 cÚ¡ 
sched_·¿m
 *
·¿m
);

709 
±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *,

712 
±h»ad_©Œ_g‘schedpŞicy
 (
±h»ad_©Œ_t
 *,

715 
±h»ad_©Œ_£tšh”™sched
(
±h»ad_©Œ_t
 * 
©Œ
,

716 
šh”™sched
);

718 
±h»ad_©Œ_g‘šh”™sched
(
±h»ad_©Œ_t
 * 
©Œ
,

719 * 
šh”™sched
);

721 
±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *,

724 
±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *,

730 
±h»ad_ü—‹
 (
±h»ad_t
 * 
tid
,

731 cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

732 *(*
¡¬t
) (*),

733 *
¬g
);

735 
±h»ad_d‘ach
 (
±h»ad_t
 
tid
);

737 
±h»ad_equ®
 (
±h»ad_t
 
t1
,

738 
±h»ad_t
 
t2
);

740 
±h»ad_ex™
 (*
v®ue_±r
);

742 
±h»ad_još
 (
±h»ad_t
 
th»ad
,

743 **
v®ue_±r
);

745 
±h»ad_t
 
±h»ad_£lf
 ();

748 
±h»ad_g‘©Œ_Å
(
±h»ad_t
 
th»ad
, 
±h»ad_©Œ_t
 * 
©Œ
);

750 
±h»ad_ÿnûl
 (
±h»ad_t
 
th»ad
);

752 
±h»ad_£tÿnûl¡©e
 (
¡©e
,

753 *
Şd¡©e
);

755 
±h»ad_£tÿnûÉy³
 (
ty³
,

756 *
Şdty³
);

758 
±h»ad_‹¡ÿnûl
 ();

760 
±h»ad_Úû
 (
±h»ad_Úû_t
 * 
Úû_cÚŒŞ
,

761 (*
š™_routše
) ());

763 #ià
PTE_LEVEL
 >ğ
PTE_LEVEL_MAX


764 
±e_ş—nup_t
 * 
	`±e_pİ_ş—nup
 (
execu‹
);

766 
	`±e_push_ş—nup
 (
±e_ş—nup_t
 * 
ş—nup
,

767 (*
routše
) (*),

768 *
¬g
);

774 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 * 
key
,

775 (*
de¡ruùÜ
) (*));

777 
	`±h»ad_key_d–‘e
 (
±h»ad_key_t
 
key
);

779 
	`±h»ad_£t¥ecific
 (
±h»ad_key_t
 
key
,

780 cÚ¡ *
v®ue
);

782 * 
	`±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
key
);

788 
	`±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
);

790 
	`±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
);

792 
	`±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t


793 * 
©Œ
,

794 *
psh¬ed
);

796 
	`±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
,

797 
psh¬ed
);

799 
	`±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, 
kšd
);

800 
	`±h»ad_mu‹x©Œ_g‘ty³
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, *
kšd
);

805 
	`±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
);

807 
	`±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
);

809 
	`±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t


810 * 
©Œ
,

811 *
psh¬ed
);

813 
	`±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
,

814 
psh¬ed
);

819 
	`±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 * 
mu‹x
,

820 cÚ¡ 
±h»ad_mu‹x©Œ_t
 * 
©Œ
);

822 
	`±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

824 
	`±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

826 
	`±h»ad_mu‹x_timedlock
(
±h»ad_mu‹x_t
 *
mu‹x
,

827 cÚ¡ 
time¥ec
 *
ab¡ime
);

829 
	`±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

831 
	`±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

836 
	`±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 * 
lock
, 
psh¬ed
);

838 
	`±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 * 
lock
);

840 
	`±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 * 
lock
);

842 
	`±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 * 
lock
);

844 
	`±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 * 
lock
);

849 
	`±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
,

850 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 * 
©Œ
,

851 
couÁ
);

853 
	`±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
);

855 
	`±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
);

860 
	`±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
);

862 
	`±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
);

864 
	`±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 * 
©Œ
,

865 *
psh¬ed
);

867 
	`±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
,

868 
psh¬ed
);

873 
	`±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 * 
cÚd
,

874 cÚ¡ 
±h»ad_cÚd©Œ_t
 * 
©Œ
);

876 
	`±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 * 
cÚd
);

878 
	`±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 * 
cÚd
,

879 
±h»ad_mu‹x_t
 * 
mu‹x
);

881 
	`±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 * 
cÚd
,

882 
±h»ad_mu‹x_t
 * 
mu‹x
,

883 cÚ¡ 
time¥ec
 *
ab¡ime
);

885 
	`±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 * 
cÚd
);

887 
	`±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 * 
cÚd
);

892 
	`±h»ad_£tsched·¿m
 (
±h»ad_t
 
th»ad
,

893 
pŞicy
,

894 cÚ¡ 
sched_·¿m
 *
·¿m
);

896 
	`±h»ad_g‘sched·¿m
 (
±h»ad_t
 
th»ad
,

897 *
pŞicy
,

898 
sched_·¿m
 *
·¿m
);

900 
	`±h»ad_£tcÚcu¼’cy
 ();

902 
	`±h»ad_g‘cÚcu¼’cy
 ();

907 
	`±h»ad_rwlock_š™
(
±h»ad_rwlock_t
 *
lock
,

908 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
©Œ
);

910 
	`±h»ad_rwlock_de¡roy
(
±h»ad_rwlock_t
 *
lock
);

912 
	`±h»ad_rwlock_Œyrdlock
(
±h»ad_rwlock_t
 *);

914 
	`±h»ad_rwlock_Œyw¾ock
(
±h»ad_rwlock_t
 *);

916 
	`±h»ad_rwlock_rdlock
(
±h»ad_rwlock_t
 *
lock
);

918 
	`±h»ad_rwlock_timedrdlock
(
±h»ad_rwlock_t
 *
lock
,

919 cÚ¡ 
time¥ec
 *
ab¡ime
);

921 
	`±h»ad_rwlock_w¾ock
(
±h»ad_rwlock_t
 *
lock
);

923 
	`±h»ad_rwlock_timedw¾ock
(
±h»ad_rwlock_t
 *
lock
,

924 cÚ¡ 
time¥ec
 *
ab¡ime
);

926 
	`±h»ad_rwlock_uÆock
(
±h»ad_rwlock_t
 *
lock
);

928 
	`±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
);

930 
	`±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
);

932 
	`±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 * 
©Œ
,

933 *
psh¬ed
);

935 
	`±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
,

936 
psh¬ed
);

938 #ià
PTE_LEVEL
 >ğ
PTE_LEVEL_MAX
 - 1

944 
	`±h»ad_kl
(
±h»ad_t
 
th»ad
, 
sig
);

953 
	`±h»ad_mu‹x©Œ_£tkšd_Å
(
±h»ad_mu‹x©Œ_t
 * 
©Œ
,

954 
kšd
);

955 
	`±h»ad_mu‹x©Œ_g‘kšd_Å
(
±h»ad_mu‹x©Œ_t
 * 
©Œ
,

956 *
kšd
);

961 
	`±h»ad_d–ay_Å
 (
time¥ec
 * 
š‹rv®
);

962 
	`±h»ad_num_´oûssÜs_Å
();

967 #ià
PTE_LEVEL
 >ğ
PTE_LEVEL_MAX


976 
	#_áime
 
áime


	)

977 
	#_timeb
 
timeb


	)

979 #ifdeà
__ılu¥lus


984 şas 
	c±e_exû±iÚ
 {};

985 şas 
	c±e_exû±iÚ_ÿnûl
 : 
public
 
±e_exû±iÚ
 {};

986 şas 
	c±e_exû±iÚ_ex™
 : 
public
 
±e_exû±iÚ
 {};

991 #ifdeà
PTE_CXX_EXCEPTIONS


997 
	#ÿtch
Ğ
E
 ) \

998 
	`ÿtch
Ğ
±e_exû±iÚ
 & ) { 
throw
; 
	}
} \

999 
	`ÿtch
Ğ
E
 )

	)

1003 #undeà
PTE_LEVEL


1004 #undeà
PTE_LEVEL_MAX


	@pthread_attr_destroy.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 * 
©Œ
)

75 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

77  
EINVAL
;

83 (*
©Œ
)->
v®id
 = 0;

84 
	`ä“
 (*
©Œ
);

85 *
©Œ
 = 
NULL
;

88 
	}
}

	@pthread_attr_getdetachstate.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, *
d‘ach¡©e
)

85 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
d‘ach¡©e
 =ğ
NULL
)

87 *
d‘ach¡©e
 = 
PTHREAD_CREATE_DETACHED
;

88  
EINVAL
;

91 *
d‘ach¡©e
 = (*
©Œ
)->detachstate;

93 
	}
}

	@pthread_attr_getinheritsched.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_©Œ_g‘šh”™sched
 (
±h»ad_©Œ_t
 * 
©Œ
, *
šh”™sched
)

50 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
šh”™sched
 =ğ
NULL
)

52  
EINVAL
;

55 *
šh”™sched
 = (*
©Œ
)->inheritsched;

57 
	}
}

	@pthread_attr_getschedparam.c

46 
	~<Çutus/Çutus.h
>

47 
	~<Çutus/Çut_¡ršg.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

50 
	~"sched.h
"

53 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

54 
sched_·¿m
 *
·¿m
)

56 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
·¿m
 =ğ
NULL
)

58  
EINVAL
;

61 
	`memıy
 (
·¿m
, &(*
©Œ
)->param,  (*param));

63 
	}
}

	@pthread_attr_getschedpolicy.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_©Œ_g‘schedpŞicy
 (
±h»ad_©Œ_t
 * 
©Œ
, *
pŞicy
)

50 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
pŞicy
 =ğ
NULL
)

52  
EINVAL
;

59 ià(
pŞicy
 <ğ(*è
SCHED_MAX
)

61  
EINVAL
;

64 *
pŞicy
 = 
SCHED_OTHER
;

67 
	}
}

	@pthread_attr_getscope.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, *
cÚ‹ÁiÚscİe
)

50 #ifdeà
_POSIX_THREAD_PRIORITY_SCHEDULING


51 *
cÚ‹ÁiÚscİe
 = (*
©Œ
)->contentionscope;

54  
ENOSYS
;

56 
	}
}

	@pthread_attr_getstack.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, **
¡ackaddr
, 
size_t
 *
¡acksize
)

50 
	`NK_PROFILE_ENTRY
();

51 
addr
 = 
	`±h»ad_©Œ_g‘¡ackaddr
(
©Œ
, 
¡ackaddr
);

52 
size
 = 
	`±h»ad_©Œ_g‘¡acksize
(
©Œ
,
¡acksize
);

53 
	`NK_PROFILE_EXIT
();

54 ià((
addr
 =ğ
size
) == 0){

59 
	}
}

	@pthread_attr_getstackaddr.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, **
¡ackaddr
)

84 #ià
	`defšed
Ğ
_POSIX_THREAD_ATTR_STACKADDR
 )

86 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

88  
EINVAL
;

91 *
¡ackaddr
 = (*
©Œ
)->stackaddr;

96  
ENOSYS
;

99 
	}
}

	@pthread_attr_getstacksize.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, 
size_t
 * 
¡acksize
)

85 #ifdeà
_POSIX_THREAD_ATTR_STACKSIZE


87 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

89  
EINVAL
;

93 *
¡acksize
 = (*
©Œ
)->stacksize;

98  
ENOSYS
;

102 
	}
}

	@pthread_attr_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 * 
©Œ
)

77 
	`NK_PROFILE_ENTRY
();

78 
±h»ad_©Œ_t
 
©Œ_»suÉ
;

80 ià(
©Œ
 =ğ
NULL
)

83  
EINVAL
;

86 
©Œ_»suÉ
 = (
±h»ad_©Œ_t
è
	`m®loc
 ( (*attr_result));

88 ià(
©Œ_»suÉ
 =ğ
NULL
)

90  
ENOMEM
;

93 #ifdeà
_POSIX_THREAD_ATTR_STACKSIZE


97 
©Œ_»suÉ
->
¡acksize
 = 0;

100 #ifdeà
_POSIX_THREAD_ATTR_STACKADDR


102 
©Œ_»suÉ
->
¡ackaddr
 = 
NULL
;

105 
©Œ_»suÉ
->
d‘ach¡©e
 = 
PTHREAD_CREATE_JOINABLE
;

112 
©Œ_»suÉ
->
·¿m
.
sched_´iÜ™y
 = 
	`±e_osTh»adG‘DeçuÉPriÜ™y
();

113 
©Œ_»suÉ
->
šh”™sched
 = 
PTHREAD_EXPLICIT_SCHED
;

114 
©Œ_»suÉ
->
cÚ‹ÁiÚscİe
 = 
PTHREAD_SCOPE_SYSTEM
;

116 
©Œ_»suÉ
->
v®id
 = 
PTE_ATTR_VALID
;

118 *
©Œ
 = 
©Œ_»suÉ
;

120 
	`NK_PROFILE_EXIT
();

122 
	}
}

	@pthread_attr_setdetachstate.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 * 
©Œ
, 
d‘ach¡©e
)

84 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

86  
EINVAL
;

89 ià(
d‘ach¡©e
 !ğ
PTHREAD_CREATE_JOINABLE
 &&

90 
d‘ach¡©e
 !ğ
PTHREAD_CREATE_DETACHED
)

92  
EINVAL
;

95 (*
©Œ
)->
d‘ach¡©e
 = detachstate;

97 
	}
}

	@pthread_attr_setinheritsched.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 * 
©Œ
, 
šh”™sched
)

50 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

52  
EINVAL
;

55 ià(
PTHREAD_INHERIT_SCHED
 !ğ
šh”™sched


56 && 
PTHREAD_EXPLICIT_SCHED
 !ğ
šh”™sched
)

58  
EINVAL
;

61 (*
©Œ
)->
šh”™sched
 = inheritsched;

63 
	}
}

	@pthread_attr_setschedparam.c

46 
	~<Çutus/Çutus.h
>

47 
	~<Çutus/Çut_¡ršg.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

50 
	~"sched.h
"

53 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 * 
©Œ
,

54 cÚ¡ 
sched_·¿m
 *
·¿m
)

56 
´iÜ™y
;

58 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
·¿m
 =ğ
NULL
)

60  
EINVAL
;

63 
´iÜ™y
 = 
·¿m
->
sched_´iÜ™y
;

66 ià(
´iÜ™y
 < 
	`sched_g‘_´iÜ™y_mš
 (
SCHED_OTHER
) ||

67 
´iÜ™y
 > 
	`sched_g‘_´iÜ™y_max
 (
SCHED_OTHER
))

69  
EINVAL
;

72 
	`memıy
 (&(*
©Œ
)->
·¿m
,…aram,  (*param));

74 
	}
}

	@pthread_attr_setschedpolicy.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 * 
©Œ
, 
pŞicy
)

50 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

52  
EINVAL
;

55 ià(
pŞicy
 !ğ
SCHED_OTHER
)

57  
ENOTSUP
;

61 
	}
}

	@pthread_attr_setscope.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 * 
©Œ
, 
cÚ‹ÁiÚscİe
)

50 #ifdeà
_POSIX_THREAD_PRIORITY_SCHEDULING


51 
cÚ‹ÁiÚscİe
)

53 
PTHREAD_SCOPE_SYSTEM
:

54 (*
©Œ
)->
cÚ‹ÁiÚscİe
 = contentionscope;

56 
PTHREAD_SCOPE_PROCESS
:

57  
ENOTSUP
;

59  
EINVAL
;

62  
ENOSYS
;

64 
	}
}

	@pthread_attr_setstackaddr.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 * 
©Œ
, *
¡ackaddr
)

88 #ià
	`defšed
Ğ
_POSIX_THREAD_ATTR_STACKADDR
 )

90 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

92  
EINVAL
;

95 (*
©Œ
)->
¡ackaddr
 = stackaddr;

100  
ENOSYS
;

103 
	}
}

	@pthread_attr_setstacksize.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 * 
©Œ
, 
size_t
 
¡acksize
)

89 #ifdeà
_POSIX_THREAD_ATTR_STACKSIZE


91 #ià
PTHREAD_STACK_MIN
 > 0

94 ià(
¡acksize
 < 
PTHREAD_STACK_MIN
)

96  
EINVAL
;

101 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

103  
EINVAL
;

107 (*
©Œ
)->
¡acksize
 = stacksize;

112  
ENOSYS
;

116 
	}
}

	@pthread_barrier_common.h

1 
	~<Çutus/ıu.h
>

2 
	~<Çutus/©omic.h
>

3 
	~<Çutus/šŒšsics.h
>

6 
šlše
 

7 
	$b¥š_lock
 (vŞ©* 
lock
)

9 
	`__sync_lock_‹¡_ªd_£t
(
lock
, 1));

10 
	}
}

12 
šlše
 

13 
	$b¥š_uÆock
 (vŞ©* 
lock
)

15 
	`__sync_lock_»Ëa£
(
lock
);

16 
	}
}

19 
	$b¬r›r_xÿÎ_hªdËr
 (* 
¬g
)

21 
	`nk_cÜe_b¬r›r_¬rive
();

22 
	}
}

	@pthread_barrier_destroy.c

7 
	~<Çutus/Çutus.h
>

8 
	~<Çutus/šŒšsics.h
>

9 
	~"debug.h
"

10 
	~"±h»ad.h
"

11 
	~"im¶em’t.h
"

12 
	~"±h»ad_b¬r›r_commÚ.h
"

15 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
)

17 
»s
;

19 ià(!
b¬r›r
) {

20  
EINVAL
;

23 
	`DEBUG
("De¡royšg b¬r›¸(%p)\n", (*)
b¬r›r
);

25 
	`b¥š_lock
(&
b¬r›r
->
lock
);

27 ià(
	`lik–y
(
b¬r›r
->
»maššg
 =ğb¬r›r->
š™_couÁ
)) {

28 
»s
 = 0;

31 
	`ERROR
("Someone still waiting‡t barrier, cannot destroy\n");

32 
»s
 = 
EINVAL
;

34 
	`b¥š_uÆock
(&
b¬r›r
->
lock
);

36  
»s
;

38 
	}
}

	@pthread_barrier_init.c

5 
	~"debug.h
"

6 
	~<Çutus/Çutus.h
>

7 
	~"±h»ad.h
"

8 
	~"im¶em’t.h
"

9 
	~"±h»ad_b¬r›r_commÚ.h
"

11 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
,

12 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 * 
©Œ
, 
couÁ
)

14 
	`NK_PROFILE_ENTRY
();

16 
»t
 = 0;

17 
	`mem£t
(
b¬r›r
, 0, (
±h»ad_b¬r›r_t
));

18 
b¬r›r
->
lock
 = 0;

20 ià(
	`uÆik–y
(
couÁ
 == 0)) {

21 
	`ERROR
("Barrier count must be greaterhan 0\n");

22 
	`NK_PROFILE_EXIT
();

23  
EINVAL
;

26 
	`DEBUG
("In™Ÿlizšg b¬›r, b¬r›¸© %p, couÁ=%u\n", (*)
b¬r›r
, 
couÁ
);

27 
b¬r›r
->
š™_couÁ
 = 
couÁ
;

28 
b¬r›r
->
»maššg
 = 
couÁ
;

29 
b¬r›r
->
psh¬ed
 = (
©Œ
 !ğ
NULL
 && *attr != NULL

30 ? (*
©Œ
)->
psh¬ed
 : 
PTHREAD_PROCESS_PRIVATE
);

32 
	`NK_PROFILE_EXIT
();

35 
	}
}

	@pthread_barrier_wait.c

4 
	~"debug.h
"

5 
	~"±h»ad.h
"

6 
	~"im¶em’t.h
"

7 
	~"±h»ad_b¬r›r_commÚ.h
"

10 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
)

12 
	`NK_PROFILE_ENTRY
();

14 ià(
b¬r›r
 =ğ
NULL
)

16  
EINVAL
;

19 
»s
 = 0;

21 
	`DEBUG
("Th»ad (%pè’‹ršg b¬r›¸(%p)\n", (*)
	`g‘_cur_th»ad
(), (*)
b¬r›r
);

23 
	`b¥š_lock
(&
b¬r›r
->
lock
);

25 ià(--
b¬r›r
->
»maššg
 == 0) {

26 
»s
 = 
NK_BARRIER_LAST
;

27 
»s
 = 
PTHREAD_BARRIER_SERIAL_THREAD
;

28 
	`©omic_cmpsw­
(
b¬r›r
->
nÙify
, 0, 1);

30 
	`b¥š_uÆock
(&
b¬r›r
->
lock
);

31 
	`BARRIER_WHILE
(
b¬r›r
->
nÙify
 != 1);

34 
	`DEBUG
("Th»ad (%pèex™šg b¬r›¸(%p)\n", (*)
	`g‘_cur_th»ad
(), (*)
b¬r›r
);

36 
š™_couÁ
 = 
b¬r›r
->init_count;

38 ià(
	`©omic_šc_v®
(
b¬r›r
->
»maššg
è=ğ
š™_couÁ
) {

40 
	`©omic_cmpsw­
(
b¬r›r
->
nÙify
, 1, 0);

41 
	`b¥š_uÆock
(&
b¬r›r
->
lock
);

43 
	`NK_PROFILE_EXIT
();

44  
»s
;

46 
	}
}

	@pthread_barrierattr_destroy.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
)

77 
»suÉ
 = 0;

79 ià(
©Œ
 =ğ
NULL
 || *attr == NULL)

81 
»suÉ
 = 
EINVAL
;

85 
±h»ad_b¬r›¿‰r_t
 
ba
 = *
©Œ
;

87 *
©Œ
 = 
NULL
;

88 
	`ä“
 (
ba
);

91  (
»suÉ
);

92 
	}
}

	@pthread_barrierattr_getpshared.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 * 
©Œ
,

49 *
psh¬ed
)

88 
»suÉ
;

90 ià((
©Œ
 !ğ
NULL
 && *©Œ !ğNULLè&& (
psh¬ed
 != NULL))

92 *
psh¬ed
 = (*
©Œ
)->pshared;

93 
»suÉ
 = 0;

97 
»suÉ
 = 
EINVAL
;

100  (
»suÉ
);

101 
	}
}

	@pthread_barrierattr_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
)

77 
±h»ad_b¬r›¿‰r_t
 
ba
;

78 
»suÉ
 = 0;

80 
ba
 = (
±h»ad_b¬r›¿‰r_t
è
	`ÿÎoc
 (1,  (*ba));

81 
	`mem£t
(
ba
, 0, 1*(*ba));

82 ià(
ba
 =ğ
NULL
)

84 
»suÉ
 = 
ENOMEM
;

88 
ba
->
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

91 *
©Œ
 = 
ba
;

93  (
»suÉ
);

94 
	}
}

	@pthread_barrierattr_setpshared.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
, 
psh¬ed
)

90 
»suÉ
;

92 ià((
©Œ
 !ğ
NULL
 && *attr != NULL) &&

93 ((
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
) ||

94 (
psh¬ed
 =ğ
PTHREAD_PROCESS_PRIVATE
)))

96 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

99 #ià!
	`defšed
Ğ
_POSIX_THREAD_PROCESS_SHARED
 )

101 
»suÉ
 = 
ENOSYS
;

102 
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

106 
»suÉ
 = 0;

113 
»suÉ
 = 0;

116 (*
©Œ
)->
psh¬ed
 =…shared;

120 
»suÉ
 = 
EINVAL
;

123  (
»suÉ
);

125 
	}
}

	@pthread_cancel.c

7 
	~"±h»ad.h
"

8 
	~"im¶em’t.h
"

10 
	~<Çutus/Çutus.h
>

12 
	$th»ad_d‘ach
(
nk_th»ad_t
 *
t
){

14 
	`´“m±_di§bË
();

16 
	`ASSERT
(
t
->
»fcouÁ
 > 0);

19 
	`li¡_d–
(&(
t
->
chd_node
));

21 --
t
->
»fcouÁ
;

31 ià(
t
->
»fcouÁ
==0) {

32 
	`nk_th»ad_de¡roy
(
t
);

35 
	`´“m±_’abË
();

38 
	}
}

41 
	$±h»ad_ÿnûl
 (
±h»ad_t
 
th»ad
)

65 
	`BOGUS
();

171 
	}
}

	@pthread_cond_common.h

1 #iâdeà
_PTHREAD_COND_COMMON_H_


2 
	#_PTHREAD_COND_COMMON_H_


	)

4 
	~<Çutus/queue.h
>

5 
	~<Çutus/th»ad.h
>

6 
	~<Çutus/œq.h
>

7 
	~<Çutus/ıu.h
>

8 
	~<Çutus/©omic.h
>

9 
	~<Çutus/mm.h
>

10 
	~<dev/­ic.h
>

11 
	~<Çutus/tim”.h
>

12 
	~"debug.h
"

	@pthread_cond_destroy.c

7 
	~<Çutus/Çutus.h
>

8 
	~"±h»ad.h
"

9 
	~"im¶em’t.h
"

10 
	~"±h»ad_cÚd_commÚ.h
"

13 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 * 
c
)

15 
	`DEBUG
("De¡royšg cÚdv¬ (%p)\n", (*)
c
);

17 
	`NK_LOCK
(&
c
->
lock
);

18 ià(
c
->
nwa™”s
 != 0) {

19 
	`NK_UNLOCK
(&
c
->
lock
);

20  
EINVAL
;

23 
	`s£m_de¡roy
(
c
->
£m
);

24 
	`NK_UNLOCK
(&
c
->
lock
);

25 
	`mem£t
(
c
, 0, (
±h»ad_cÚd_t
));

28 
	}
}

	@pthread_cond_init.c

6 
	~<Çutus/Çutus.h
>

7 
	~"±h»ad.h
"

8 
	~"im¶em’t.h
"

9 
	~"±h»ad_cÚd_commÚ.h
"

12 
ušt64_t
 
	gcouÁ
 = 0;

14 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 * 
c
, cÚ¡ 
±h»ad_cÚd©Œ_t
 * 
©Œ
)

17 
	`NK_PROFILE_ENTRY
();

18 
»suÉ
 = 0;

20 ià((
©Œ
 !ğ
NULL
 && *attr != NULL) &&

21 ((*
©Œ
)->
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
))

27 
»suÉ
 = 
ENOSYS
;

30 
buf
[
NK_WAIT_QUEUE_NAME_LEN
];

31 
	`DEBUG
("Condvar init\n");

33 
	`mem£t
(
c
, 0, (
±h»ad_cÚd_t
));

35 
	`¢´štf
(
buf
,
NK_WAIT_QUEUE_NAME_LEN
,"cÚdv¬%lu-wa™",
	`__sync_ãtch_ªd_add
(&
couÁ
,1));

36 
c
->
£m
 = 
	`m®loc
((
sim¶e_£m_t
));

37 
	`s£m_š™
(
c
->
£m
, 0);

40 
	`NK_LOCK_INIT
(&
c
->
lock
);

42 
	`NK_PROFILE_EXIT
();

43  
»suÉ
;

45 
	}
}

	@pthread_cond_signal.c

5 
	~"±h»ad.h
"

6 
	~"im¶em’t.h
"

7 
	~"±h»ad_cÚd_commÚ.h
"

11 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 * 
c
)

14 
	`DEBUG
("CÚdv¬ sigÇlšg oÀ(%p)\n", (*)
c
);

15 ià(
c
 =ğ
NULL
)

17  
EINVAL
;

20 
	`NK_PROFILE_ENTRY
();

21 
	`NK_LOCK
(&
c
->
lock
);

24 ià(
c
->
maš_£q
 > c->
wakeup_£q
) {

26 ++
c
->
wakeup_£q
;

28 
	`DEBUG
("CÚdv¬ sigÇlšg oÀ(%p)\n", (*)
c
);

29 
	`s£m_po¡
(
c
->
£m
,1);

33 
	`NK_UNLOCK
(&
c
->
lock
);

34 
	`NK_PROFILE_EXIT
();

37 
	}
}

40 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 * 
c
)

42 ià(
c
 =ğ
NULL
)

44  
EINVAL
;

47 
	`NK_PROFILE_ENTRY
();

49 
	`NK_LOCK
(&
c
->
lock
);

52 ià(
c
->
maš_£q
 > c->
wakeup_£q
) {

54 
c
->
wok’_£q
 = c->
maš_£q
;

55 
c
->
wakeup_£q
 = c->
maš_£q
;

56 ++
c
->
bÿ¡_£q
;

58 
	`NK_UNLOCK
(&
c
->
lock
);

60 
	`DEBUG_PRINT
("CÚdv¬ brßdÿ¡šg oÀ(%pè(cÜe=%u)\n", (*)
c
, 
	`my_ıu_id
());

61 
	`s£m_po¡
(
c
->
£m
, c->
nwa™”s
);

62 
	`NK_PROFILE_EXIT
();

68 
	`NK_UNLOCK
(&
c
->
lock
);

69 
	`NK_PROFILE_EXIT
();

72 
	}
}

	@pthread_cond_wait.c

6 
	~"±h»ad.h
"

7 
	~"im¶em’t.h
"

8 
	~"±h»ad_cÚd_commÚ.h
"

10 
	$no_check
(*
s
){

12 
	}
}

14 
	sİ
 {

15 
nk_tim”_t
 *
	mtim”
;

18 
	$check_tim”
(*
s
)

20 
İ
 *
o
 = (İ *)
s
;

21  
	`__sync_ãtch_ªd_Ü
(&
o
->
tim”
->
¡©e
,0)==
NK_TIMER_SIGNALLED
;

22 
	}
}

25 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 * 
c
,

26 
±h»ad_mu‹x_t
 * 
l
, cÚ¡ 
time¥ec
 *
ab¡ime
)

29 
	`NK_PROFILE_ENTRY
();

30 
»suÉ
 = 0;

31 ià(
c
 =ğ
NULL
 || 
ab¡ime
 == NULL){

32  
EINVAL
;

36 
ušt64_t
 
¡¬t
 = 
	`nk_sched_g‘_»®time
();

37 
ušt64_t
 
now
 = 
¡¬t
;

38 
ušt64_t
 
timeout_ns
 = 
ab¡ime
->
tv_£c
*1000000000ULL+ab¡ime->
tv_n£c
;

39 
	`DEBUG
("CÚdv¬ wa™ oÀ(%pèmu‹x=%p\n", (*)
c
, (*)
l
);

41 
	`NK_LOCK
(&
c
->
lock
);

44 
	`±h»ad_mu‹x_uÆock
(
l
);

46 ++
c
->
nwa™”s
;

47 ++
c
->
maš_£q
;

49 
v®
;

50 
£q
;

51 
bc
 = *(vŞ©*)&(
c
->
bÿ¡_£q
);

52 
v®
 = 
£q
 = 
c
->
wakeup_£q
;

55 if((
now
-
¡¬t
è> 
timeout_ns
){

56 
»suÉ
 = 
ETIMEDOUT
;

58 
bcout
;

62 
	`NK_UNLOCK
(&
c
->
lock
);

64 
	`s£m_timedwa™
(
c
->
£m
, 
timeout_ns
-(
now
-
¡¬t
));

66 
	`NK_LOCK
(&
c
->
lock
);

69 ià(
bc
 !ğ*(vŞ©*)&(
c
->
bÿ¡_£q
)) {

70 
bcout
;

73 
v®
 = *(vŞ©*)&(
c
->
wakeup_£q
);

74 
now
 = 
	`nk_sched_g‘_»®time
();

76 } 
v®
 =ğ
£q
 || v® =ğ*(vŞ©*)&(
c
->
wok’_£q
));

78 ++
c
->
wok’_£q
;

80 
bcout
:

82 --
c
->
nwa™”s
;

84 
	`NK_UNLOCK
(&
c
->
lock
);

87 
	`±h»ad_mu‹x_lock
(
l
);

89 
	`NK_PROFILE_EXIT
();

91  
»suÉ
;

92 
	}
}

95 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 * 
c
, 
±h»ad_mu‹x_t
 * 
l
)

97 
	`NK_PROFILE_ENTRY
();

98 ià(
c
 =ğ
NULL
){

99  
EINVAL
;

102 
	`DEBUG
("CÚdv¬ wa™ oÀ(%pèmu‹x=%p\n", (*)
c
, (*)
l
);

104 
	`NK_LOCK
(&
c
->
lock
);

107 
	`±h»ad_mu‹x_uÆock
(
l
);

109 ++
c
->
nwa™”s
;

110 ++
c
->
maš_£q
;

112 
v®
;

113 
£q
;

114 
bc
 = *(vŞ©*)&(
c
->
bÿ¡_£q
);

115 
v®
 = 
£q
 = 
c
->
wakeup_£q
;

119 
	`NK_UNLOCK
(&
c
->
lock
);

121 
	`DEBUG
("CÚdv¬ befÜs£m wa™ oÀ(%pèmu‹x=%p\n", (*)
c
, (*)
l
);

122 
	`s£m_wa™
(
c
->
£m
);

124 
	`DEBUG
("CÚdv¬‡á” s£m wa™ oÀ(%pèmu‹x=%p\n", (*)
c
, (*)
l
);

125 
	`NK_LOCK
(&
c
->
lock
);

127 ià(
bc
 !ğ*(vŞ©*)&(
c
->
bÿ¡_£q
)) {

128 
bcout
;

131 
v®
 = *(vŞ©*)&(
c
->
wakeup_£q
);

132 } 
v®
 =ğ
£q
 || v® =ğ*(vŞ©*)&(
c
->
wok’_£q
));

134 ++
c
->
wok’_£q
;

136 
bcout
:

138 --
c
->
nwa™”s
;

140 
	`NK_UNLOCK
(&
c
->
lock
);

143 
	`±h»ad_mu‹x_lock
(
l
);

145 
	`NK_PROFILE_EXIT
();

149 
	}
}

	@pthread_condattr_destroy.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
)

79 
»suÉ
 = 0;

81 ià(
©Œ
 =ğ
NULL
 || *attr == NULL)

83 
»suÉ
 = 
EINVAL
;

87 
	`ä“
(*
©Œ
);

90 *
©Œ
 = 
NULL
;

91 
»suÉ
 = 0;

94  
»suÉ
;

96 
	}
}

	@pthread_condattr_getpshared.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

49 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 * 
©Œ
, *
psh¬ed
)

89 
»suÉ
;

91 ià((
©Œ
 !ğ
NULL
 && *©Œ !ğNULLè&& (
psh¬ed
 != NULL))

93 *
psh¬ed
 = (*
©Œ
)->pshared;

94 
»suÉ
 = 0;

98 
»suÉ
 = 
EINVAL
;

101  
»suÉ
;

103 
	}
}

	@pthread_condattr_init.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
)

82 
±h»ad_cÚd©Œ_t
 
©Œ_»suÉ
;

83 
»suÉ
 = 0;

85 
©Œ_»suÉ
 = (
±h»ad_cÚd©Œ_t
è
	`ÿÎoc
 (1,  (*attr_result));

86 
	`mem£t
(
©Œ_»suÉ
, 0, 1*(*attr_result));

87 ià(
©Œ_»suÉ
 =ğ
NULL
)

89 
»suÉ
 = 
ENOMEM
;

92 *
©Œ
 = 
©Œ_»suÉ
;

94  
»suÉ
;

96 
	}
}

	@pthread_condattr_setpshared.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

49 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
, 
psh¬ed
)

91 
»suÉ
;

93 ià((
©Œ
 !ğ
NULL
 && *attr != NULL)

94 && ((
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

95 || (
psh¬ed
 =ğ
PTHREAD_PROCESS_PRIVATE
)))

97 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

100 #ià!
	`defšed
Ğ
_POSIX_THREAD_PROCESS_SHARED
 )

101 
»suÉ
 = 
ENOSYS
;

102 
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

104 
»suÉ
 = 0;

111 
»suÉ
 = 0;

114 (*
©Œ
)->
psh¬ed
 =…shared;

118 
»suÉ
 = 
EINVAL
;

121  
»suÉ
;

123 
	}
}

	@pthread_delay_np.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

91 
	$±h»ad_d–ay_Å
 (
time¥ec
 *
š‹rv®
)

93 
	`BOGUS
();

94 
	`NK_PROFILE_ENTRY
();

95 
wa™_time
;

96 
£cs_š_mli£cs
;

97 
mli£cs
;

98 
±h»ad_t
 
£lf
;

99 
±e_th»ad_t
 * 
¥
;

101 ià(
š‹rv®
 =ğ
NULL
)

103  
EINVAL
;

106 ià(
š‹rv®
->
tv_£c
 =ğ0L && iÁ”v®->
tv_n£c
 == 0L)

108 
	`nk_y›ld
();

117 
£cs_š_mli£cs
 = 
š‹rv®
->
tv_£c
 * 1000L;

120 
mli£cs
 = (
š‹rv®
->
tv_n£c
 + 999999L) / 1000000L;

122 
wa™_time
 = 
£cs_š_mli£cs
 + 
mli£cs
;

124 
	`±e_osTh»adSË•
 (
wa™_time
);

126 
	`NK_PROFILE_EXIT
();

128 
	}
}

	@pthread_detach.c

5 
	~"nk/±e_o§l.h
"

7 
	~"±h»ad.h
"

8 
	~"im¶em’t.h
"

11 
	$±h»ad_d‘ach
 (
±h»ad_t
 
th»ad
)

37 
nk_th»ad_t
 * 
t
 = (nk_th»ad_t*è
th»ad
;

38 
	`´“m±_di§bË
();

40 
	`ASSERT
(
t
->
»fcouÁ
 > 0);

43 
	`li¡_d–
(&(
t
->
chd_node
));

45 --
t
->
»fcouÁ
;

59 
	`´“m±_’abË
();

132 
	}
}

	@pthread_equal.c

5 
	~"±h»ad.h
"

6 
	~"im¶em’t.h
"

10 
	$±h»ad_equ®
 (
±h»ad_t
 
t1
,…th»ad_ˆ
t2
)

35  
t1
 =ğ
t2
;

47 
	}
}

	@pthread_exit.c

6 
	~"±h»ad.h
"

7 
	~"im¶em’t.h
"

10 
	$±h»ad_ex™
 (*
v®ue_±r
)

33 
	`nk_th»ad_ex™
(
v®ue_±r
);

65 
	}
}

	@pthread_getattr_np.c

1 
	~"±h»ad.h
"

2 
	~"im¶em’t.h
"

6 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
th»ad
 ,
±h»ad_©Œ_t
 * 
©Œ
)

11 
	}
}

	@pthread_getconcurrency.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_g‘cÚcu¼’cy
 ()

50  
±e_cÚcu¼’cy
;

51 
	}
}

	@pthread_getschedparam.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
th»ad
, *
pŞicy
,

49 
sched_·¿m
 *
·¿m
)

51 
»suÉ
;

54 
»suÉ
 = 
	`±h»ad_kl
 (
th»ad
, 0);

55 ià(0 !ğ
»suÉ
)

57  
»suÉ
;

64 ià(
pŞicy
 <ğ(*è
SCHED_MAX
 || 
·¿m
 =ğ
NULL
)

66  
EINVAL
;

70 *
pŞicy
 = 
SCHED_OTHER
;

79 
·¿m
->
sched_´iÜ™y
 = 0;

82 
	}
}

	@pthread_getspecific.c

8 
	~"±h»ad.h
"

9 
	~"im¶em’t.h
"

13 
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
key
)

38  
	`nk_s_g‘
(
key
);

51 
	}
}

	@pthread_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

49 
	$±h»ad_š™
()

52 ià(
±e_´oûssIn™Ÿlized
)

61  
PTE_TRUE
;

64 
±e_´oûssIn™Ÿlized
 = 
PTE_TRUE
;

67 
	`±e_osIn™
();

72 ià((
	`±h»ad_key_ü—‹
 (&
±e_£lfTh»adKey
, 
NULL
) != 0) ||

73 (
	`±h»ad_key_ü—‹
 (&
±e_ş—nupKey
, 
NULL
) != 0))

75 
	`±h»ad_‹rmš©e
();

81 
	`±e_osMu‹xC»©e
 (&
±e_th»ad_»u£_lock
);

82 
	`±e_osMu‹xC»©e
 (&
±e_mu‹x_‹¡_š™_lock
);

83 
	`±e_osMu‹xC»©e
 (&
±e_cÚd_li¡_lock
);

84 
	`±e_osMu‹xC»©e
 (&
±e_cÚd_‹¡_š™_lock
);

85 
	`±e_osMu‹xC»©e
 (&
±e_rwlock_‹¡_š™_lock
);

86 
	`±e_osMu‹xC»©e
 (&
±e_¥šlock_‹¡_š™_lock
);

89  (
±e_´oûssIn™Ÿlized
);

91 
	}
}

	@pthread_join.c

4 
	~"nk/±e_o§l.h
"

5 
	~<Çutus/Çutus.h
>

6 
	~"±h»ad.h
"

7 
	~"im¶em’t.h
"

12 
	$±h»ad_još
 (
±h»ad_t
 
th»ad
, **
v®ue_±r
)

47  
	`nk_još
(
th»ad
, 
v®ue_±r
);

49 
nk_th»ad_t
 * 
th‘h»ad
 = (nk_th»ad_ˆ*è
th»ad
;

51 if(
th‘h»ad
->
·»Á
 =ğ
	`g‘_cur_th»ad
()){

52  
	`nk_još
(
th»ad
, 
v®ue_±r
);

140 
	}
}

	@pthread_key_create.c

7 
	~<Çutus/Çutus.h
>

8 
	~"nk/±e_o§l.h
"

10 
	~"±h»ad.h
"

11 
	~"im¶em’t.h
"

15 
	$±h»ad_key_ü—‹
 (
±h»ad_key_t
 * 
key
, (*
de¡ruùÜ
) (*))

46  
	`nk_s_key_ü—‹
(
key
, 
de¡ruùÜ
);

88 
	}
}

	@pthread_key_delete.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
key
)

79  
	`nk_s_key_d–‘e
(
key
);

143 
	}
}

	@pthread_kill.c

8 
	~<Çutus/Çutus.h
>

9 
	~<Çutus/Çut_¡ršg.h
>

10 
	~"±h»ad.h
"

11 
	~"im¶em’t.h
"

14 
	$±h»ad_kl
 (
±h»ad_t
 
th»ad
, 
sig
)

43 
	`BOGUS
();

44 
»suÉ
 = 0;

61 ià(
th»ad
 =ğ
NULL
){

62 
»suÉ
 = 
ESRCH
;

64 ià(0 =ğ
»suÉ
 && 0 !ğ
sig
)

69 
»suÉ
 = 
EINVAL
;

72  
»suÉ
;

74 
	}
}

	@pthread_mutex_destroy.c

43 
	~<Çutus/Çutus.h
>

44 
	~<Çutus/Çut_¡ršg.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

53 
	`NK_PROFILE_ENTRY
();

54 
»suÉ
 = 0;

55 
±h»ad_mu‹x_t
 
mx
;

64 ià(*
mu‹x
 < 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

66 
mx
 = *
mu‹x
;

68 
»suÉ
 = 
	`±h»ad_mu‹x_Œylock
 (&
mx
);

74 ià(
»suÉ
 == 0)

76 ià(
mx
->
kšd
 !ğ
PTHREAD_MUTEX_RECURSIVE
 || 1 =ğmx->
»cursive_couÁ
)

89 *
mu‹x
 = 
NULL
;

91 
»suÉ
 = 
	`±h»ad_mu‹x_uÆock
 (&
mx
);

93 ià(
»suÉ
 == 0)

96 
	`s£m_de¡roy
(
mx
->
£m
);

98 
	`ä“
(
mx
);

106 *
mu‹x
 = 
mx
;

114 
mx
->
»cursive_couÁ
--;

115 
»suÉ
 = 
EBUSY
;

125 
	`±e_osMu‹xLock
 (
±e_mu‹x_‹¡_š™_lock
);

131 ià(*
mu‹x
 >ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

139 *
mu‹x
 = 
NULL
;

147 
»suÉ
 = 
EBUSY
;

150 
	`±e_osMu‹xUÆock
(
±e_mu‹x_‹¡_š™_lock
);

153 
	`NK_PROFILE_EXIT
();

154  (
»suÉ
);

155 
	}
}

	@pthread_mutex_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

48 
	~"debug.h
"

51 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 * 
mu‹x
, cÚ¡ 
±h»ad_mu‹x©Œ_t
 * 
©Œ
)

53 
	`NK_PROFILE_ENTRY
();

54 
»suÉ
 = 0;

55 
±h»ad_mu‹x_t
 
mx
;

58 ià(
mu‹x
 =ğ
NULL
)

60  
EINVAL
;

63 
mx
 = (
±h»ad_mu‹x_t
è
	`ÿÎoc
 (1,  (*mx));

64 
	`mem£t
(
mx
, 0, (*mx));

65 ià(
mx
 =ğ
NULL
)

67 
»suÉ
 = 
ENOMEM
;

71 
mx
->
lock_idx
 = 0;

72 
mx
->
»cursive_couÁ
 = 0;

79 
mx
->
kšd
 = ((
©Œ
 =ğ
NULL
 ) ? 
PTHREAD_MUTEX_DEFAULT
 :‡ttr->kind);

82 
mx
->
owÃrTh»ad
 = 
NULL
;

83 
mx
->
£m
 = 
	`m®loc
((
sim¶e_£m_t
));

85 
	`s£m_š™
(
mx
->
£m
, 0);

90 *
mu‹x
 = 
mx
;

91 
	`NK_PROFILE_EXIT
();

92  (
»suÉ
);

93 
	}
}

	@pthread_mutex_lock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

48 
	~"debug.h
"

51 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

53 
	`NK_PROFILE_ENTRY
();

54 
»suÉ
 = 0;

55 
±h»ad_mu‹x_t
 
mx
;

60 ià(*
mu‹x
 =ğ
NULL
)

62  
EINVAL
;

71 ià(*
mu‹x
 >ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

73 ià((
»suÉ
 = 
	`±e_mu‹x_check_Ãed_š™
 (
mu‹x
)) != 0)

75  (
»suÉ
);

80 
mx
 = *
mu‹x
;

83 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_NORMAL
)

85 ià(
	`PTE_ATOMIC_EXCHANGE
(

86 &
mx
->
lock_idx
,

89 
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,-1) != 0)

93 
	`s£m_wa™
(
mx
->
£m
);

99 
±h»ad_t
 
£lf
 = 
	`±h»ad_£lf
();

101 ià(
	`PTE_ATOMIC_COMPARE_EXCHANGE
(&
mx
->
lock_idx
,1,0) == 0)

103 
mx
->
»cursive_couÁ
 = 1;

104 
mx
->
owÃrTh»ad
 = 
£lf
;

108 ià(
	`±h»ad_equ®
 (
mx
->
owÃrTh»ad
, 
£lf
))

110 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_RECURSIVE
)

112 
mx
->
»cursive_couÁ
++;

116 
»suÉ
 = 
EDEADLK
;

121 
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,-1) != 0)

124 
	`s£m_wa™
(
mx
->
£m
);

127 ià(0 =ğ
»suÉ
)

129 
mx
->
»cursive_couÁ
 = 1;

130 
mx
->
owÃrTh»ad
 = 
£lf
;

136 
	`DEBUG
("mx :%d, mu‹x:%d \n", 
mx
->
lock_idx
, (*
mu‹x
)->lock_idx);

137 
	`NK_PROFILE_EXIT
();

138  (
»suÉ
);

139 
	}
}

	@pthread_mutex_timedlock.c

43 
	~"nk/±e_o§l.h
"

47 
	~<Çutus/Çutus.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

53 
	$±e_timed_ev’twa™
 (
±e_osSem­hÜeHªdË
 
ev’t
, cÚ¡ 
time¥ec
 *
ab¡ime
)

77 
mli£cÚds
;

78 
±e_osResuÉ
 
¡©us
;

79 
»tv®
;

81 ià(
ab¡ime
 =ğ
NULL
)

83 
¡©us
 = 
	`±e_osSem­hÜeP’d
(
ev’t
, 
NULL
);

90 
mli£cÚds
 = 
	`±e_»lmli£cs
 (
ab¡ime
);

92 
¡©us
 = 
	`±e_osSem­hÜeP’d
(
ev’t
, &
mli£cÚds
);

96 ià(
¡©us
 =ğ
PTE_OS_TIMEOUT
)

98 
»tv®
 = 
ETIMEDOUT
;

102 
»tv®
 = 0;

105  
»tv®
;

107 
	}
}

111 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 * 
mu‹x
,

112 cÚ¡ 
time¥ec
 *
ab¡ime
)

114 
	`NK_PROFILE_ENTRY
();

115 
»suÉ
;

116 
±h»ad_mu‹x_t
 
mx
;

117 
ušt64_t
 
timeout_ns
=0;

118 if(
ab¡ime
 !ğ
NULL
){

119 
timeout_ns
 = 
ab¡ime
->
tv_£c
*1000000000ULL+ab¡ime->
tv_n£c
;

131 ià(*
mu‹x
 >ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

133 ià((
»suÉ
 = 
	`±e_mu‹x_check_Ãed_š™
 (
mu‹x
)) != 0)

135  (
»suÉ
);

139 
mx
 = *
mu‹x
;

141 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_NORMAL
)

143 ià(
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,1) != 0)

145 
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,-1) != 0)

147 if(
ab¡ime
 =ğ
NULL
){

149 
	`s£m_wa™
(
mx
->
£m
);

152 ià(0 !ğ(
»suÉ
 = 
	`s£m_timedwa™
(
mx
->
£m
, 
timeout_ns
)))

154  
ETIMEDOUT
;

161 
±h»ad_t
 
£lf
 = 
	`±h»ad_£lf
();

163 ià(
	`PTE_ATOMIC_COMPARE_EXCHANGE
(&
mx
->
lock_idx
,1,0) == 0)

165 
mx
->
»cursive_couÁ
 = 1;

166 
mx
->
owÃrTh»ad
 = 
£lf
;

170 ià(
	`±h»ad_equ®
 (
mx
->
owÃrTh»ad
, 
£lf
))

172 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_RECURSIVE
)

174 
mx
->
»cursive_couÁ
++;

178  
EDEADLK
;

183 
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,-1) != 0)

185 if(
ab¡ime
 =ğ
NULL
){

187 
	`s£m_wa™
(
mx
->
£m
);

190 ià(0 !ğ(
»suÉ
 = 
	`s£m_timedwa™
(
mx
->
£m
, 
timeout_ns
)))

192  
ETIMEDOUT
;

196 
mx
->
»cursive_couÁ
 = 1;

197 
mx
->
owÃrTh»ad
 = 
£lf
;

201 
	`NK_PROFILE_EXIT
();

203 
	}
}

	@pthread_mutex_trylock.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

50 
	`NK_PROFILE_ENTRY
();

51 
»suÉ
 = 0;

52 
±h»ad_mu‹x_t
 
mx
;

64 ià(*
mu‹x
 >ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

66 ià((
»suÉ
 = 
	`±e_mu‹x_check_Ãed_š™
 (
mu‹x
)) != 0)

68  (
»suÉ
);

72 
mx
 = *
mu‹x
;

74 ià(0 =ğ
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (&
mx
->
lock_idx
,1,0))

76 ià(
mx
->
kšd
 !ğ
PTHREAD_MUTEX_NORMAL
)

78 
mx
->
»cursive_couÁ
 = 1;

79 
mx
->
owÃrTh»ad
 = 
	`±h»ad_£lf
 ();

84 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_RECURSIVE
 &&

85 
	`±h»ad_equ®
 (
mx
->
owÃrTh»ad
, 
	`±h»ad_£lf
 ()))

87 
mx
->
»cursive_couÁ
++;

91 
»suÉ
 = 
EBUSY
;

94 
	`NK_PROFILE_EXIT
();

95  (
»suÉ
);

96 
	}
}

	@pthread_mutex_unlock.c

43 
	~"nk/±e_o§l.h
"

47 
	~<Çutus/Çutus.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

52 
	#TEST_IE
 
IÁ”lockedExchªge


	)

55 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

57 
	`NK_PROFILE_ENTRY
();

58 
»suÉ
 = 0;

59 
±h»ad_mu‹x_t
 
mx
;

65 
mx
 = *
mu‹x
;

75 ià(
mx
 < 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

77 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_NORMAL
)

79 
idx
;

81 
idx
 = 
	`PTE_ATOMIC_EXCHANGE
 (&
mx
->
lock_idx
,0);

82 ià(
idx
 != 0)

84 ià(
idx
 < 0)

90 
	`s£m_po¡
(
mx
->
£m
,1);

98 
»suÉ
 = 
EPERM
;

103 ià(
	`±h»ad_equ®
 (
mx
->
owÃrTh»ad
, 
	`±h»ad_£lf
 ()))

105 ià(
mx
->
kšd
 !ğ
PTHREAD_MUTEX_RECURSIVE


106 || 0 =ğ--
mx
->
»cursive_couÁ
)

108 
mx
->
owÃrTh»ad
 = 
NULL
;

110 ià(
	`PTE_ATOMIC_EXCHANGE
 (&
mx
->
lock_idx
,0) < 0)

113 
	`s£m_po¡
(
mx
->
£m
,1);

119 
»suÉ
 = 
EPERM
;

125 
»suÉ
 = 
EINVAL
;

128 
	`NK_PROFILE_EXIT
();

130  (
»suÉ
);

131 
	}
}

	@pthread_mutexattr_destroy.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
)

76 
»suÉ
 = 0;

78 ià(
©Œ
 =ğ
NULL
)

80 
»suÉ
 = 
EINVAL
;

84 
	`ä“
 (
©Œ
);

87  (
»suÉ
);

88 
	}
}

	@pthread_mutexattr_getkind_np.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±h»ad_mu‹x©Œ_g‘kšd_Å
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, *
kšd
)

49  
	`±h»ad_mu‹x©Œ_g‘ty³
 (
©Œ
, 
kšd
);

50 
	}
}

	@pthread_mutexattr_getpshared.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 * 
©Œ
, *
psh¬ed
)

87 
»suÉ
;

89 ià((
©Œ
 !ğ
NULL
 ) && (
psh¬ed
 != NULL))

91 *
psh¬ed
 = 
©Œ
->pshared;

92 
»suÉ
 = 0;

96 
»suÉ
 = 
EINVAL
;

99  (
»suÉ
);

101 
	}
}

	@pthread_mutexattr_gettype.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x©Œ_g‘ty³
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, *
kšd
)

50 
»suÉ
 = 0;

52 ià(
©Œ
 !ğ
NULL
 && 
kšd
 != NULL)

54 *
kšd
 = 
©Œ
->kind;

58 
»suÉ
 = 
EINVAL
;

61  (
»suÉ
);

62 
	}
}

	@pthread_mutexattr_init.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
)

76 
»suÉ
 = 0;

79 
±h»ad_mu‹x©Œ_t
* 
ma
 = 
©Œ
;

81 ià(
ma
 =ğ
NULL
)

83 
»suÉ
 = 
ENOMEM
;

87 
ma
->
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

88 
ma
->
kšd
 = 
PTHREAD_MUTEX_DEFAULT
;

93  (
»suÉ
);

94 
	}
}

	@pthread_mutexattr_setkind_np.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±h»ad_mu‹x©Œ_£tkšd_Å
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, 
kšd
)

49  
	`±h»ad_mu‹x©Œ_£‰y³
 (
©Œ
, 
kšd
);

50 
	}
}

	@pthread_mutexattr_setpshared.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, 
psh¬ed
)

90 
»suÉ
;

92 ià((
©Œ
 !ğ
NULL
 ) &&

93 ((
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
) ||

94 (
psh¬ed
 =ğ
PTHREAD_PROCESS_PRIVATE
)))

96 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

99 #ià!
	`defšed
Ğ
_POSIX_THREAD_PROCESS_SHARED
 )

101 
»suÉ
 = 
ENOSYS
;

102 
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

106 
»suÉ
 = 0;

113 
»suÉ
 = 0;

116 
©Œ
->
psh¬ed
 =…shared;

120 
»suÉ
 = 
EINVAL
;

123  (
»suÉ
);

125 
	}
}

	@pthread_mutexattr_settype.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, 
kšd
)

127 
»suÉ
 = 0;

129 
	`ERROR
("£ˆw™h %d \n", 
kšd
);

130 ià((
©Œ
 !ğ
NULL
 ))

132 
kšd
)

134 
PTHREAD_MUTEX_FAST_NP
:

135 
PTHREAD_MUTEX_RECURSIVE_NP
:

136 
PTHREAD_MUTEX_ERRORCHECK_NP
:

137 
©Œ
->
kšd
 = kind;

140 
»suÉ
 = 
EINVAL
;

146 
»suÉ
 = 
EINVAL
;

149  (
»suÉ
);

150 
	}
}

	@pthread_num_processors_np.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

52 
	$±h»ad_num_´oûssÜs_Å
 ()

54 
couÁ
;

56 ià(
	`±e_g‘´oûssÜs
 (&
couÁ
) != 0)

58 
couÁ
 = 1;

61  (
couÁ
);

62 
	}
}

	@pthread_once.c

43 
	~"nk/±e_o§l.h
"

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

47 
	#PTE_ONCE_STARTED
 1

	)

48 
	#PTE_ONCE_INIT
 0

	)

49 
	#PTE_ONCE_DONE
 2

	)

52 
	$±e_Úû_š™_routše_ş—nup
(* 
¬g
)

54 
±h»ad_Úû_t
 * 
Úû_cÚŒŞ
 = (±h»ad_Úû_ˆ*è
¬g
;

56 (è
	`PTE_ATOMIC_EXCHANGE
(&
Úû_cÚŒŞ
->
¡©e
,
PTE_ONCE_INIT
);

58 ià(
	`PTE_ATOMIC_EXCHANGE_ADD
((*)&
Úû_cÚŒŞ
->
£m­hÜe
, 0L))

60 
	`±e_osSem­hÜePo¡
((
±e_osSem­hÜeHªdË
è
Úû_cÚŒŞ
->
£m­hÜe
, 1);

62 
	}
}

65 
	$±h»ad_Úû
 (
±h»ad_Úû_t
 * 
Úû_cÚŒŞ
, (*
š™_routše
) ())

103 
	`NK_PROFILE_ENTRY
();

104 
»suÉ
;

105 
¡©e
;

106 
±e_osSem­hÜeHªdË
 
£ma
;

108 ià(
Úû_cÚŒŞ
 =ğ
NULL
 || 
š™_routše
 == NULL)

110 
»suÉ
 = 
EINVAL
;

111 
FAIL0
;

115 
»suÉ
 = 0;

118 (
¡©e
 =

119 
	`PTE_ATOMIC_COMPARE_EXCHANGE
(&
Úû_cÚŒŞ
->
¡©e
,

120 
PTE_ONCE_STARTED
,

121 
PTE_ONCE_INIT
))

122 !ğ
PTE_ONCE_DONE
)

124 ià(
PTE_ONCE_INIT
 =ğ
¡©e
)

128 
	`±h»ad_ş—nup_push
(
±e_Úû_š™_routše_ş—nup
, (*è
Úû_cÚŒŞ
);

129 (*
š™_routše
)();

130 
	`±h»ad_ş—nup_pİ
(0);

132 (è
	`PTE_ATOMIC_EXCHANGE
(&
Úû_cÚŒŞ
->
¡©e
,
PTE_ONCE_DONE
);

138 ià(
	`PTE_ATOMIC_EXCHANGE_ADD
((*)&
Úû_cÚŒŞ
->
£m­hÜe
, 0L))

140 
	`±e_osSem­hÜePo¡
((
±e_osSem­hÜeHªdË
è
Úû_cÚŒŞ
->
£m­hÜe
,Úû_cÚŒŞ->
numSem­hÜeU£rs
);

145 
	`PTE_ATOMIC_INCREMENT
(&
Úû_cÚŒŞ
->
numSem­hÜeU£rs
);

147 ià(!
	`PTE_ATOMIC_EXCHANGE_ADD
((*)&
Úû_cÚŒŞ
->
£m­hÜe
, 0L))

149 
	`±e_osSem­hÜeC»©e
(0, (
±e_osSem­hÜeHªdË
*è&
£ma
);

151 ià(
	`PTE_ATOMIC_COMPARE_EXCHANGE
((*è&
Úû_cÚŒŞ
->
£m­hÜe
,

152 (è
£ma
,

155 
	`±e_osSem­hÜeD–‘e
((
±e_osSem­hÜeHªdË
)
£ma
);

163 ià(
	`PTE_ATOMIC_EXCHANGE_ADD
(&
Úû_cÚŒŞ
->
¡©e
, 0Lè=ğ
PTE_ONCE_STARTED
)

165 
	`±e_osSem­hÜeP’d
((
±e_osSem­hÜeHªdË
è
Úû_cÚŒŞ
->
£m­hÜe
,
NULL
);

168 ià(0 =ğ
	`PTE_ATOMIC_DECREMENT
(&
Úû_cÚŒŞ
->
numSem­hÜeU£rs
))

171 ià((
£ma
 =

172 (
±e_osSem­hÜeHªdË
)()
	`PTE_ATOMIC_EXCHANGE
((*è&
Úû_cÚŒŞ
->
£m­hÜe
,0)))

174 
	`±e_osSem­hÜeD–‘e
(
£ma
);

186 
	`NK_PROFILE_EXIT
();

187 
FAIL0
:

188  (
»suÉ
);

189 
	}
}

	@pthread_rwlock_destroy.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

51 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 * 
rwlock
)

53 
±h»ad_rwlock_t
 
rwl
;

54 
»suÉ
 = 0, 
»suÉ1
 = 0, 
»suÉ2
 = 0;

56 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

58  
EINVAL
;

61 ià(*
rwlock
 !ğ
PTHREAD_RWLOCK_INITIALIZER
)

63 
rwl
 = *
rwlock
;

65 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

67  
EINVAL
;

70 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

72  
»suÉ
;

75 ià((
»suÉ
 =

76 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

78 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

79  
»suÉ
;

86 ià(
rwl
->
nExşusiveAcûssCouÁ
 > 0

87 || 
rwl
->
nSh¬edAcûssCouÁ
 >„wl->
nCom¶‘edSh¬edAcûssCouÁ
)

89 
»suÉ
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

90 
»suÉ1
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

91 
»suÉ2
 = 
EBUSY
;

95 
rwl
->
nMagic
 = 0;

97 ià((
»suÉ
 =

98 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

100 
	`±h»ad_mu‹x_uÆock
 (&
rwl
->
mtxExşusiveAcûss
);

101  
»suÉ
;

104 ià((
»suÉ
 =

105 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

107  
»suÉ
;

110 *
rwlock
 = 
NULL
;

111 
»suÉ
 = 
	`±h»ad_cÚd_de¡roy
 (&(
rwl
->
údSh¬edAcûssCom¶‘ed
));

112 
»suÉ1
 = 
	`±h»ad_mu‹x_de¡roy
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

113 
»suÉ2
 = 
	`±h»ad_mu‹x_de¡roy
 (&(
rwl
->
mtxExşusiveAcûss
));

114 
	`ä“
 (
rwl
);

123 
	`±e_osMu‹xLock
 (
±e_rwlock_‹¡_š™_lock
);

128 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

136 *
rwlock
 = 
NULL
;

144 
»suÉ
 = 
EBUSY
;

147 
	`±e_osMu‹xUÆock
(
±e_rwlock_‹¡_š™_lock
);

151  ((
»suÉ
 !ğ0è?„esuÉ : ((
»suÉ1
 !ğ0è?„esuÉ1 : 
»suÉ2
));

152 
	}
}

	@pthread_rwlock_init.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

51 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 * 
rwlock
,

52 cÚ¡ 
±h»ad_rwlock©Œ_t
 * 
©Œ
)

54 
»suÉ
;

55 
±h»ad_rwlock_t
 
rwl
 = 0;

57 ià(
rwlock
 =ğ
NULL
)

59  
EINVAL
;

62 ià(
©Œ
 !ğ
NULL
 && *attr != NULL)

64 
»suÉ
 = 
EINVAL
;

65 
DONE
;

68 
rwl
 = (
±h»ad_rwlock_t
è
	`ÿÎoc
 (1,  (*rwl));

69 
	`mem£t
(
rwl
, 0, 1*(*rwl));

70 ià(
rwl
 =ğ
NULL
)

72 
»suÉ
 = 
ENOMEM
;

73 
DONE
;

76 
rwl
->
nSh¬edAcûssCouÁ
 = 0;

77 
rwl
->
nExşusiveAcûssCouÁ
 = 0;

78 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

80 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (&
rwl
->
mtxExşusiveAcûss
, 
NULL
);

81 ià(
»suÉ
 != 0)

83 
FAIL0
;

86 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (&
rwl
->
mtxSh¬edAcûssCom¶‘ed
, 
NULL
);

87 ià(
»suÉ
 != 0)

89 
FAIL1
;

92 
»suÉ
 = 
	`±h»ad_cÚd_š™
 (&
rwl
->
údSh¬edAcûssCom¶‘ed
, 
NULL
);

93 ià(
»suÉ
 != 0)

95 
FAIL2
;

98 
rwl
->
nMagic
 = 
PTE_RWLOCK_MAGIC
;

100 
»suÉ
 = 0;

101 
DONE
;

103 
FAIL2
:

104 (è
	`±h»ad_mu‹x_de¡roy
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

106 
FAIL1
:

107 (è
	`±h»ad_mu‹x_de¡roy
 (&(
rwl
->
mtxExşusiveAcûss
));

109 
FAIL0
:

110 
	`ä“
(
rwl
)

112 
rwl
 = 
NULL
;

114 
DONE
:

115 *
rwlock
 = 
rwl
;

117  
»suÉ
;

118 
	}
}

	@pthread_rwlock_rdlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  
EINVAL
;

66 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

70 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

72  
»suÉ
;

76 
rwl
 = *
rwlock
;

78 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

80  
EINVAL
;

83 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

85  
»suÉ
;

88 ià(++
rwl
->
nSh¬edAcûssCouÁ
 =ğ
INT_MAX
)

90 ià((
»suÉ
 =

91 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

93 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

94  
»suÉ
;

97 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

98 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

100 ià((
»suÉ
 =

101 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

103 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

104  
»suÉ
;

108  (
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
)));

109 
	}
}

	@pthread_rwlock_timedrdlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 * 
rwlock
,

51 cÚ¡ 
time¥ec
 *
ab¡ime
)

53 
»suÉ
;

54 
±h»ad_rwlock_t
 
rwl
;

56 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

58  
EINVAL
;

67 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

69 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

71 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

73  
»suÉ
;

77 
rwl
 = *
rwlock
;

79 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

81  
EINVAL
;

84 ià((
»suÉ
 =

85 
	`±h»ad_mu‹x_timedlock
 (&(
rwl
->
mtxExşusiveAcûss
), 
ab¡ime
)) != 0)

87  
»suÉ
;

90 ià(++
rwl
->
nSh¬edAcûssCouÁ
 =ğ
INT_MAX
)

92 ià((
»suÉ
 =

93 
	`±h»ad_mu‹x_timedlock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
),

94 
ab¡ime
)) != 0)

96 ià(
»suÉ
 =ğ
ETIMEDOUT
)

98 ++
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
;

100 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

101  
»suÉ
;

104 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

105 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

107 ià((
»suÉ
 =

108 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

110 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

111  
»suÉ
;

115  (
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
)));

116 
	}
}

	@pthread_rwlock_timedwrlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 * 
rwlock
,

51 cÚ¡ 
time¥ec
 *
ab¡ime
)

53 
»suÉ
;

54 
±h»ad_rwlock_t
 
rwl
;

56 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

58  
EINVAL
;

67 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

69 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

71 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

73  
»suÉ
;

77 
rwl
 = *
rwlock
;

79 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

81  
EINVAL
;

84 ià((
»suÉ
 =

85 
	`±h»ad_mu‹x_timedlock
 (&(
rwl
->
mtxExşusiveAcûss
), 
ab¡ime
)) != 0)

87  
»suÉ
;

90 ià((
»suÉ
 =

91 
	`±h»ad_mu‹x_timedlock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
),

92 
ab¡ime
)) != 0)

94 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

95  
»suÉ
;

98 ià(
rwl
->
nExşusiveAcûssCouÁ
 == 0)

100 ià(
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 > 0)

102 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

103 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

106 ià(
rwl
->
nSh¬edAcûssCouÁ
 > 0)

108 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = -rwl->
nSh¬edAcûssCouÁ
;

114 
	`±h»ad_ş—nup_push
 (
±e_rwlock_ÿnûlwrwa™
, (*è
rwl
);

118 
»suÉ
 =

119 
	`±h»ad_cÚd_timedwa™
 (&(
rwl
->
údSh¬edAcûssCom¶‘ed
),

120 &(
rwl
->
mtxSh¬edAcûssCom¶‘ed
),

121 
ab¡ime
);

123 
»suÉ
 =ğ0 && 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 < 0);

125 
	`±h»ad_ş—nup_pİ
 ((
»suÉ
 != 0) ? 1 : 0);

127 ià(
»suÉ
 == 0)

129 
rwl
->
nSh¬edAcûssCouÁ
 = 0;

134 ià(
»suÉ
 == 0)

136 
rwl
->
nExşusiveAcûssCouÁ
++;

139  
»suÉ
;

140 
	}
}

	@pthread_rwlock_tryrdlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  
EINVAL
;

66 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

70 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

72  
»suÉ
;

76 
rwl
 = *
rwlock
;

78 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

80  
EINVAL
;

83 ià((
»suÉ
 = 
	`±h»ad_mu‹x_Œylock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

85  
»suÉ
;

88 ià(++
rwl
->
nSh¬edAcûssCouÁ
 =ğ
INT_MAX
)

90 ià((
»suÉ
 =

91 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

93 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

94  
»suÉ
;

97 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

98 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

100 ià((
»suÉ
 =

101 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

103 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

104  
»suÉ
;

108  (
	`±h»ad_mu‹x_uÆock
 (&
rwl
->
mtxExşusiveAcûss
));

109 
	}
}

	@pthread_rwlock_trywrlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
, 
»suÉ1
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  
EINVAL
;

66 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

70 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

72  
»suÉ
;

76 
rwl
 = *
rwlock
;

78 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

80  
EINVAL
;

83 ià((
»suÉ
 = 
	`±h»ad_mu‹x_Œylock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

85  
»suÉ
;

88 ià((
»suÉ
 =

89 
	`±h»ad_mu‹x_Œylock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

91 
»suÉ1
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

92  ((
»suÉ1
 !ğ0è?„esuÉ1 : 
»suÉ
);

95 ià(
rwl
->
nExşusiveAcûssCouÁ
 == 0)

97 ià(
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 > 0)

99 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

100 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

103 ià(
rwl
->
nSh¬edAcûssCouÁ
 > 0)

105 ià((
»suÉ
 =

106 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

108 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

109  
»suÉ
;

112 ià((
»suÉ
 =

113 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
))) == 0)

115 
»suÉ
 = 
EBUSY
;

120 
rwl
->
nExşusiveAcûssCouÁ
 = 1;

125 
»suÉ
 = 
EBUSY
;

128  
»suÉ
;

129 
	}
}

	@pthread_rwlock_unlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
, 
»suÉ1
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  (
EINVAL
);

60 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
rwl
 = *
rwlock
;

70 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

72  
EINVAL
;

75 ià(
rwl
->
nExşusiveAcûssCouÁ
 == 0)

77 ià((
»suÉ
 =

78 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

80  
»suÉ
;

83 ià(++
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 == 0)

85 
»suÉ
 = 
	`±h»ad_cÚd_sigÇl
 (&(
rwl
->
údSh¬edAcûssCom¶‘ed
));

88 
»suÉ1
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

92 
rwl
->
nExşusiveAcûssCouÁ
--;

94 
»suÉ
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

95 
»suÉ1
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

99  ((
»suÉ
 !ğ0è?„esuÉ : 
»suÉ1
);

100 
	}
}

	@pthread_rwlock_wrlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  
EINVAL
;

66 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

70 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

72  
»suÉ
;

76 
rwl
 = *
rwlock
;

78 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

80  
EINVAL
;

83 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

85  
»suÉ
;

88 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

90 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

91  
»suÉ
;

94 ià(
rwl
->
nExşusiveAcûssCouÁ
 == 0)

96 ià(
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 > 0)

98 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

99 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

102 ià(
rwl
->
nSh¬edAcûssCouÁ
 > 0)

104 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = -rwl->
nSh¬edAcûssCouÁ
;

110 
	`±h»ad_ş—nup_push
 (
±e_rwlock_ÿnûlwrwa™
, (*è
rwl
);

114 
»suÉ
 = 
	`±h»ad_cÚd_wa™
 (&(
rwl
->
údSh¬edAcûssCom¶‘ed
),

115 &(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

117 
»suÉ
 =ğ0 && 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 < 0);

119 
	`±h»ad_ş—nup_pİ
 ((
»suÉ
 != 0) ? 1 : 0);

121 ià(
»suÉ
 == 0)

123 
rwl
->
nSh¬edAcûssCouÁ
 = 0;

128 ià(
»suÉ
 == 0)

130 
rwl
->
nExşusiveAcûssCouÁ
++;

133  
»suÉ
;

134 
	}
}

	@pthread_rwlockattr_destroy.c

46 
	~<Çutus/Çutus.h
>

47 
	~<Çutus/Çut_¡ršg.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

52 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
)

78 
»suÉ
 = 0;

80 ià(
©Œ
 =ğ
NULL
 || *attr == NULL)

82 
»suÉ
 = 
EINVAL
;

86 
±h»ad_rwlock©Œ_t
 
rwa
 = *
©Œ
;

88 *
©Œ
 = 
NULL
;

89 
	`ä“
 (
rwa
);

92  (
»suÉ
);

93 
	}
}

	@pthread_rwlockattr_getpshared.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 * 
©Œ
,

51 *
psh¬ed
)

90 
»suÉ
;

92 ià((
©Œ
 !ğ
NULL
 && *©Œ !ğNULLè&& (
psh¬ed
 != NULL))

94 *
psh¬ed
 = (*
©Œ
)->pshared;

95 
»suÉ
 = 0;

99 
»suÉ
 = 
EINVAL
;

102  (
»suÉ
);

104 
	}
}

	@pthread_rwlockattr_init.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

51 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
)

74 
»suÉ
 = 0;

75 
±h»ad_rwlock©Œ_t
 
rwa
;

77 
rwa
 = (
±h»ad_rwlock©Œ_t
è
	`ÿÎoc
 (1,  (*rwa));

78 
	`mem£t
(
rwa
, 0, (*rwa));

79 ià(
rwa
 =ğ
NULL
)

81 
»suÉ
 = 
ENOMEM
;

85 
rwa
->
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

88 *
©Œ
 = 
rwa
;

90  (
»suÉ
);

91 
	}
}

	@pthread_rwlockattr_setpshared.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
, 
psh¬ed
)

92 
»suÉ
;

94 ià((
©Œ
 !ğ
NULL
 && *attr != NULL) &&

95 ((
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
) ||

96 (
psh¬ed
 =ğ
PTHREAD_PROCESS_PRIVATE
)))

98 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

101 #ià!
	`defšed
Ğ
_POSIX_THREAD_PROCESS_SHARED
 )

103 
»suÉ
 = 
ENOSYS
;

104 
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

108 
»suÉ
 = 0;

115 
»suÉ
 = 0;

118 (*
©Œ
)->
psh¬ed
 =…shared;

122 
»suÉ
 = 
EINVAL
;

125  (
»suÉ
);

127 
	}
}

	@pthread_self.c

8 
	~<Çutus/Çutus.h
>

9 
	~"±h»ad.h
"

10 
	~"im¶em’t.h
"

12 
±h»ad_t


13 
	$±h»ad_£lf
 ()

34  
	`g‘_cur_th»ad
();

86 
	}
}

	@pthread_setcancelstate.c

6 
	~"±h»ad.h
"

7 
	~"im¶em’t.h
"

11 
	$±h»ad_£tÿnûl¡©e
 (
¡©e
, *
Şd¡©e
)

51 
	`BOGUS
();

95 
	}
}

	@pthread_setcanceltype.c

5 
	~"±h»ad.h
"

6 
	~"im¶em’t.h
"

10 
	$±h»ad_£tÿnûÉy³
 (
ty³
, *
Şdty³
)

53 
»suÉ
 = 0;

57 #iâdeà
PTE_SUPPORT_ASYNC_CANCEL


58 ià(
ty³
 =ğ
PTHREAD_CANCEL_ASYNCHRONOUS
)

63  
EPERM
;

67 iàĞ(
ty³
 !ğ
PTHREAD_CANCEL_DEFERRED


68 && 
ty³
 !ğ
PTHREAD_CANCEL_ASYNCHRONOUS
))

70  
EINVAL
;

103  (
»suÉ
);

105 
	}
}

	@pthread_setconcurrency.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_£tcÚcu¼’cy
 (
Ëv–
)

50 ià(
Ëv–
 < 0)

52  
EINVAL
;

56 
±e_cÚcu¼’cy
 = 
Ëv–
;

59 
	}
}

	@pthread_setschedparam.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
th»ad
, 
pŞicy
,

49 cÚ¡ 
sched_·¿m
 *
·¿m
)

51 
	`BOGUS
();

52 
»suÉ
;

55 
»suÉ
 = 
	`±h»ad_kl
 (
th»ad
, 0);

56 ià(0 !ğ
»suÉ
)

58  
»suÉ
;

62 ià(
pŞicy
 < 
SCHED_MIN
 ||…Şicy > 
SCHED_MAX
)

64  
EINVAL
;

68 ià(
pŞicy
 !ğ
SCHED_OTHER
)

70  
ENOTSUP
;

73  (
	`±e_£‰h»ad´iÜ™y
 (
th»ad
, 
pŞicy
, 
·¿m
->
sched_´iÜ™y
));

74 
	}
}

78 
	$±e_£‰h»ad´iÜ™y
 (
±h»ad_t
 
th»ad
, 
pŞicy
, 
´iÜ™y
)

117 
	}
}

	@pthread_setspecific.c

6 
	~"±h»ad.h
"

7 
	~"im¶em’t.h
"

12 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
key
, cÚ¡ *
v®ue
)

38  
	`nk_s_£t
(
key
, 
v®ue
);

142 
	}
}

	@pthread_spin_destroy.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 * 
lock
)

52 
±h»ad_¥šlock_t
 
s
;

53 
»suÉ
 = 0;

55 ià(
lock
 =ğ
NULL
 || *lock == NULL)

57  
EINVAL
;

60 ià((
s
 = *
lock
è!ğ
PTHREAD_SPINLOCK_INITIALIZER
)

62 ià(
s
->
š‹¾ock
 =ğ
PTE_SPIN_USE_MUTEX
)

64 
»suÉ
 = 
	`±h»ad_mu‹x_de¡roy
 (&(
s
->
u
.
mu‹x
));

66 ià(
PTE_SPIN_UNLOCKED
 !=

67 
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (

68 & (
s
->
š‹¾ock
),

69 (è
PTE_OBJECT_INVALID
,

70 
PTE_SPIN_UNLOCKED
))

72 
»suÉ
 = 
EINVAL
;

75 ià(0 =ğ
»suÉ
)

81 *
lock
 = 
NULL
;

82 
	`ä“
(
s
);

92 
	`±e_osMu‹xLock
 (
±e_¥šlock_‹¡_š™_lock
);

97 ià(*
lock
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

105 *
lock
 = 
NULL
;

113 
»suÉ
 = 
EBUSY
;

116 
	`±e_osMu‹xUÆock
(
±e_¥šlock_‹¡_š™_lock
);

120  (
»suÉ
);

121 
	}
}

	@pthread_spin_init.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 * 
lock
, 
psh¬ed
)

52 
±h»ad_¥šlock_t
 
s
;

53 
ıus
 = 0;

54 
»suÉ
 = 0;

56 ià(
lock
 =ğ
NULL
)

58  
EINVAL
;

61 ià(0 !ğ
	`±e_g‘´oûssÜs
 (&
ıus
))

63 
ıus
 = 1;

66 ià(
ıus
 > 1)

68 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

74 #ià
_POSIX_THREAD_PROCESS_SHARED
 >= 0

80 #”rÜ 
ERROR
 [
__FILE__
, 
lše
 
__LINE__
]: 
Proûss
 
sh¬ed
 
¥š
 
locks
 
¬e
 
nÙ
 
suµÜ‹d
 
y‘
.

84  
ENOSYS
;

91 
s
 = (
±h»ad_¥šlock_t
è
	`ÿÎoc
 (1,  (*s));

92 
	`mem£t
(
s
, 0, (*s));

93 ià(
s
 =ğ
NULL
)

95  
ENOMEM
;

98 ià(
ıus
 > 1)

100 
s
->
u
.
ıus
 = cpus;

101 
s
->
š‹¾ock
 = 
PTE_SPIN_UNLOCKED
;

105 
±h»ad_mu‹x©Œ_t
 
ma
;

106 
»suÉ
 = 
	`±h»ad_mu‹x©Œ_š™
 (&
ma
);

108 ià(0 =ğ
»suÉ
)

110 
ma
.
psh¬ed
 =…shared;

111 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (&(
s
->
u
.
mu‹x
), &
ma
);

112 ià(0 =ğ
»suÉ
)

114 
s
->
š‹¾ock
 = 
PTE_SPIN_USE_MUTEX
;

117 (è
	`±h»ad_mu‹x©Œ_de¡roy
 (&
ma
);

120 ià(0 =ğ
»suÉ
)

122 *
lock
 = 
s
;

126 
	`ä“
(
s
);

128 *
lock
 = 
NULL
;

131  (
»suÉ
);

132 
	}
}

	@pthread_spin_lock.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 * 
lock
)

50 
±h»ad_¥šlock_t
 
s
;

52 ià(
NULL
 =ğ
lock
 || NULL == *lock)

54  (
EINVAL
);

57 ià(*
lock
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

59 
»suÉ
;

61 ià((
»suÉ
 = 
	`±e_¥šlock_check_Ãed_š™
 (
lock
)) != 0)

63  (
»suÉ
);

67 
s
 = *
lock
;

69  
PTE_SPIN_LOCKED
 ==

70 
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (&(
s
->
š‹¾ock
),

71 
PTE_SPIN_LOCKED
,

72 
PTE_SPIN_UNLOCKED
))

76 ià(
s
->
š‹¾ock
 =ğ
PTE_SPIN_LOCKED
)

80 ià(
s
->
š‹¾ock
 =ğ
PTE_SPIN_USE_MUTEX
)

82  
	`±h»ad_mu‹x_lock
 (&(
s
->
u
.
mu‹x
));

85  
EINVAL
;

86 
	}
}

	@pthread_spin_trylock.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

49 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 * 
lock
)

51 
±h»ad_¥šlock_t
 
s
;

53 ià(
NULL
 =ğ
lock
 || NULL == *lock)

55  (
EINVAL
);

58 ià(*
lock
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

60 
»suÉ
;

62 ià((
»suÉ
 = 
	`±e_¥šlock_check_Ãed_š™
 (
lock
)) != 0)

64  (
»suÉ
);

68 
s
 = *
lock
;

71 
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (&(
s
->
š‹¾ock
),

72 
PTE_SPIN_LOCKED
,

73 
PTE_SPIN_UNLOCKED
))

75 
PTE_SPIN_UNLOCKED
:

77 
PTE_SPIN_LOCKED
:

78  
EBUSY
;

79 
PTE_SPIN_USE_MUTEX
:

80  
	`±h»ad_mu‹x_Œylock
 (&(
s
->
u
.
mu‹x
));

83  
EINVAL
;

84 
	}
}

	@pthread_spin_unlock.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 * 
lock
)

50 
±h»ad_¥šlock_t
 
s
;

52 ià(
NULL
 =ğ
lock
 || NULL == *lock)

54  (
EINVAL
);

57 
s
 = *
lock
;

59 ià(
s
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

61  
EPERM
;

65 
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (&(
s
->
š‹¾ock
),

66 
PTE_SPIN_UNLOCKED
,

67 
PTE_SPIN_LOCKED
))

69 
PTE_SPIN_LOCKED
:

71 
PTE_SPIN_UNLOCKED
:

72  
EPERM
;

73 
PTE_SPIN_USE_MUTEX
:

74  
	`±h»ad_mu‹x_uÆock
 (&(
s
->
u
.
mu‹x
));

77  
EINVAL
;

78 
	}
}

	@pthread_terminate.c

45 
	~<Çutus/Çutus.h
>

46 
	~<Çutus/Çut_¡ršg.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

51 
	$±h»ad_‹rmš©e
()

53 
	`nk_th»ad_ex™
(
NULL
);

95 
	}
}

	@pthread_testcancel.c

6 
	~"±h»ad.h
"

7 
	~"im¶em’t.h
"

11 
	$±h»ad_‹¡ÿnûl
 ()

40 
	`BOGUS
();

74 
	}
}

	@pthread_timechange_handler_np.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

71 
	$±h»ad_timechªge_hªdËr_Å
 (*
¬g
)

97 
»suÉ
 = 0;

98 
±h»ad_cÚd_t
 
cv
;

101 
	`±e_osMu‹xLock
 (
±e_cÚd_li¡_lock
);

103 
cv
 = 
±e_cÚd_li¡_h—d
;

105 
cv
 !ğ
NULL
 && 0 =ğ
»suÉ
)

107 
»suÉ
 = 
	`±h»ad_cÚd_brßdÿ¡
 (&
cv
);

108 
cv
 = cv->
Ãxt
;

111 
	`±e_osMu‹xUÆock
(
±e_cÚd_li¡_lock
);

113  (*)()(
»suÉ
 !ğ0 ? 
EAGAIN
 : 0);

114 
	}
}

	@sched.h

51 #iâdeà
_SCHED_H


52 
	#_SCHED_H


	)

54 
	~"nk/±e_ty³s.h
"

56 #undeà
PTE_LEVEL


58 #ià
defšed
(
_POSIX_SOURCE
)

59 
	#PTE_LEVEL
 0

	)

63 #ià
defšed
(
_POSIX_C_SOURCE
) && _POSIX_C_SOURCE >= 199309

64 #undeà
PTE_LEVEL


65 
	#PTE_LEVEL
 1

	)

69 #ià
defšed
(
INCLUDE_NP
)

70 #undeà
PTE_LEVEL


71 
	#PTE_LEVEL
 2

	)

75 
	#PTE_LEVEL_MAX
 3

	)

77 #ià!
defšed
(
PTE_LEVEL
)

78 
	#PTE_LEVEL
 
PTE_LEVEL_MAX


	)

90 
	mSCHED_OTHER
 = 0,

91 
	mSCHED_FIFO
,

92 
	mSCHED_RR
,

93 
	mSCHED_MIN
 = 
SCHED_OTHER
,

94 
	mSCHED_MAX
 = 
SCHED_RR


97 
	ssched_·¿m


99 
	msched_´iÜ™y
;

102 #ifdeà
__ılu¥lus


107 
sched_y›ld
 ();

109 
sched_g‘_´iÜ™y_mš
 (
pŞicy
);

111 
sched_g‘_´iÜ™y_max
 (
pŞicy
);

113 
sched_£tscheduËr
 (
pid_t
 
pid
, 
pŞicy
);

125 
	#sched_¼_g‘_š‹rv®
(
_pid
, 
_š‹rv®
) \

126 Ğ
”ºo
 = 
ENOTSUP
, (è-1 )

	)

129 #ifdeà
__ılu¥lus


133 #undeà
PTE_LEVEL


134 #undeà
PTE_LEVEL_MAX


	@sched_get_priority_max.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$sched_g‘_´iÜ™y_max
 (
pŞicy
)

50  
	`±e_osTh»adG‘MaxPriÜ™y
();

51 
	}
}

	@sched_get_priority_min.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$sched_g‘_´iÜ™y_mš
 (
pŞicy
)

50  
	`±e_osTh»adG‘MšPriÜ™y
();

51 
	}
}

	@sched_setscheduler.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$sched_£tscheduËr
 (
pid_t
 
pid
, 
pŞicy
)

50 
”ºo
 = 
EPERM
;

52 
	}
}

	@sched_yield.c

45 
	~<Çutus/Çutus.h
>

46 
	~"nk/±e_o§l.h
"

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

50 
	~"sched.h
"

53 
	$sched_y›ld
 ()

79 
	`NK_PROFILE_ENTRY
();

81 
	`nk_y›ld
();

82 
	`NK_PROFILE_EXIT
();

84 
	}
}

	@sem_close.c

50 
	~"±h»ad.h
"

51 
	~"£m­hÜe.h
"

52 
	~"im¶em’t.h
"

56 
	$£m_şo£
 (
£m_t
 * 
£m
)

58 
”ºo
 = 
ENOSYS
;

60 
	}
}

	@sem_common.h

1 
	~"debug.h
"

2 
	~<Çutus/£m­hÜe.h
>

3 
	~<Çutus/¥šlock.h
>

	@sem_destroy.c

1 
	~<Çutus/Çutus.h
>

2 
	~"nk/±e_o§l.h
"

4 
	~"±h»ad.h
"

5 
	~"£m­hÜe.h
"

6 
	~"im¶em’t.h
"

10 
	$£m_de¡roy
 (
£m_t
 * 
£m
)

12 
	`nk_£m­hÜe_»Ëa£
(
£m
);

15 
	}
}

	@sem_getvalue.c

1 
	~"±h»ad.h
"

2 
	~"£m­hÜe.h
"

3 
	~"im¶em’t.h
"

4 
	~"£m_commÚ.h
"

7 
	$£m_g‘v®ue
 (
£m_t
 * 
£m
, *
sv®
)

37 ià(
£m
 =ğ
NULL
 || 
sv®
 == NULL)

39 
”ºo
 = 
EINVAL
;

44 
	`¥š_lock
(&(
£m
->
lock
));

45 
v®ue
 = 
£m
->
couÁ
;

46 
	`¥š_uÆock
(&(
£m
->
lock
));

47 *
sv®
 = 
v®ue
;

51 
	}
}

	@sem_init.c

1 
	~<Çutus/Çutus.h
>

2 
	~"±h»ad.h
"

3 
	~"£m­hÜe.h
"

4 
	~"im¶em’t.h
"

5 
	~"£m_commÚ.h
"

7 
	$£m_š™
 (
£m_t
 * 
£m
, 
psh¬ed
, 
v®ue
)

46 ià(
psh¬ed
 != 0)

52  
EPERM
;

55 ià(
£m
 =ğ
NULL
){

56  
EINVAL
;

59 
	`¥šlock_š™
(&(
£m
->
lock
));

60 
£m
->
couÁ
 = 
v®ue
;

64 
	}
}

	@sem_open.c

50 
	~"±h»ad.h
"

51 
	~"£m­hÜe.h
"

52 
	~"im¶em’t.h
"

56 
	$£m_İ’
 (cÚ¡ *
Çme
, 
oæag
, 
mode_t
 
mode
, 
v®ue
)

58 
”ºo
 = 
ENOSYS
;

60 
	}
}

	@sem_post.c

52 
	~<Çutus/Çutus.h
>

53 
	~"±h»ad.h
"

54 
	~"£m­hÜe.h
"

55 
	~"im¶em’t.h
"

56 
	~"£m_commÚ.h
"

59 
	$£m_po¡
 (
£m_t
 * 
£m
)

85 
	`NK_PROFILE_ENTRY
();

86 
	`nk_£m­hÜe_up
(
£m
);

87 
	`NK_PROFILE_EXIT
();

89 
	}
}

	@sem_post_multiple.c

1 
	~<Çutus/Çutus.h
>

2 
	~"±h»ad.h
"

3 
	~"£m­hÜe.h
"

4 
	~"im¶em’t.h
"

5 
	~"£m_commÚ.h
"

8 
	$£m_po¡_muÉË
 (
£m_t
 * 
£m
, 
couÁ
)

10 
	`NK_PROFILE_ENTRY
();

11  
couÁ
--){

12 if(
	`nk_wa™_queue_em±y
(
£m
->
wa™_queue
)){

15 
	`nk_£m­hÜe_up
(
£m
);

17 
	`NK_PROFILE_EXIT
();

19 
	}
}

	@sem_timedwait.c

1 
	~<Çutus/Çutus.h
>

2 
	~"±h»ad.h
"

3 
	~"£m­hÜe.h
"

4 
	~"im¶em’t.h
"

5 
	~"£m_commÚ.h
"

9 
	$£m_timedwa™
 (
£m_t
 * 
£m
, cÚ¡ 
time¥ec
 *
ab¡ime
)

11 
ušt64_t
 
timeout_ns
 = 
ab¡ime
->
tv_£c
*1000000000ULL+ab¡ime->
tv_n£c
;

12 
»suÉ
 = 
	`nk_£m­hÜe_down_timeout
(
£m
, 
timeout_ns
);

13  
»suÉ
;

15 
	}
}

	@sem_trywait.c

1 
	~"±h»ad.h
"

2 
	~"£m­hÜe.h
"

3 
	~"im¶em’t.h
"

4 
	~"£m_commÚ.h
"

7 
	$£m_Œywa™
 (
£m_t
 * 
£m
)

36 ià(
£m
 =ğ
NULL
)

38  
EINVAL
;

40 
	`NK_PROFILE_ENTRY
();

42 
»suÉ
 = 
	`nk_£m­hÜe_Œy_down
(
£m
);

44 
	`NK_PROFILE_EXIT
();

45  
»suÉ
;

47 
	}
}

	@sem_unlink.c

50 
	~"±h»ad.h
"

51 
	~"£m­hÜe.h
"

52 
	~"im¶em’t.h
"

56 
	$£m_uÆšk
 (cÚ¡ *
Çme
)

58 
”ºo
 = 
ENOSYS
;

60 
	}
}

	@sem_wait.c

1 
	~<Çutus/Çutus.h
>

2 
	~"±h»ad.h
"

3 
	~"£m­hÜe.h
"

4 
	~"im¶em’t.h
"

5 
	~"£m_commÚ.h
"

9 
	$£m_wa™
 (
£m_t
 * 
£m
)

11 
	`NK_PROFILE_ENTRY
();

12 
	`nk_£m­hÜe_down
(
£m
);

13 
	`NK_PROFILE_EXIT
();

15 
	}
}

19 
	$£m_wa™_noÿnûl
 (
£m_t
 * 
£m
)

50 
	`NK_PROFILE_ENTRY
();

51 
	`nk_£m­hÜe_down
(
£m
);

52 
	`NK_PROFILE_EXIT
();

55 
	}
}

	@semaphore.h

52 #ià!
defšed
Ğ
SEMAPHORE_H
 )

53 
	#SEMAPHORE_H


	)

55 #ià
defšed
(
_POSIX_SOURCE
)

56 
	#PTE_LEVEL
 0

	)

60 #ià
defšed
(
INCLUDE_NP
)

61 #undeà
PTE_LEVEL


62 
	#PTE_LEVEL
 2

	)

70 
	#_POSIX_SEMAPHORES


	)

71 #ifdeà
__ılu¥lus


75 
	snk_£m­hÜe
 {

76 
¥šlock_t
 
lock
;

77 
li¡_h—d
 
node
;

78 
ušt64_t
 
»fcouÁ
;

79 
Çme
[
NK_SEMAPHORE_NAME_LEN
];

84 
couÁ
;

85 
nk_wa™_queue_t
 *
wa™_queue
;

86 
´o¥eùive_couÁ
;

89 
nk_£m­hÜe
 
	t£m_t
;

91 
£m_š™
 (
£m_t
 * 
£m
,

92 
psh¬ed
,

93 
v®ue
);

95 
£m_de¡roy
 (
£m_t
 * 
£m
);

97 
£m_Œywa™
 (
£m_t
 * 
£m
);

99 
£m_wa™
 (
£m_t
 * 
£m
);

101 
£m_timedwa™
 (
£m_t
 * 
£m
,

102 cÚ¡ 
time¥ec
 * 
ab¡ime
);

104 
£m_po¡
 (
£m_t
 * 
£m
);

106 
£m_po¡_muÉË
 (
£m_t
 * 
£m
,

107 
couÁ
);

109 
£m_İ’
 (cÚ¡ * 
Çme
,

110 
oæag
,

111 
mode_t
 
mode
,

112 
v®ue
);

114 
£m_şo£
 (
£m_t
 * 
£m
);

116 
£m_uÆšk
 (cÚ¡ * 
Çme
);

118 
£m_g‘v®ue
 (
£m_t
 * 
£m
,

119 * 
sv®
);

121 #ifdeà
__ılu¥lus


	@simple_sem/ssem.c

1 
	~"s£m.h
"

3 
	~<Çutus/li¡.h
>

4 
	~<Çutus/scheduËr.h
>

6 
	#SLEEP_COUNT
 0x10

	)

7 
	#SPIN_TIME_NS
 5000

	)

9 
	$s£m_š™
(
sim¶e_£m_t
 *
s
, 
š™Ÿl_couÁ
){

10 
	`NK_LOCK_INIT
(&
s
->
lock
);

11 
s
->
couÁ
 = 
š™Ÿl_couÁ
;

12 
s
->
¦“pcouÁ
 = 0;

13 
s
->
wa™_queue
 = 
	`nk_wa™_queue_ü—‹
(
NULL
);

14 
	}
}

16 
	$s£m_de¡roy
(
sim¶e_£m_t
 *
s
){

18 
	`NK_LOCK
(&
s
->
lock
);

19 
	`nk_wa™_queue_wake_®l
(
s
->
wa™_queue
);

20 
	`nk_wa™_queue_de¡roy
(
s
->
wa™_queue
);

21 
	`ä“
(
s
);

22 
	`NK_UNLOCK
(&
s
->
lock
);

25 
	}
}

26 
	$s£m_po¡
(
sim¶e_£m_t
 *
s
, 
couÁ
){

28 
	`NK_LOCK
(&
s
->
lock
);

29 
s
->
couÁ
+=count;

30 
	`DEBUG
("s£m_po¡: couÁ: %d \n", 
s
->
couÁ
);

31 if(
s
->
¦“pcouÁ
 > 0){

32 
	`DEBUG
("s£m_po¡: sË• couÁ: %d \n", 
s
->
¦“pcouÁ
);

33 
a
 = 
couÁ
;

34 ià(
a
 > 
s
->
¦“pcouÁ
){

35 
a
 = 
s
->
¦“pcouÁ
;

37 
s
->
¦“pcouÁ
 -ğ
a
;

38 
a
--){

39 
	`nk_wa™_queue_wake_Úe
(
s
->
wa™_queue
);

42 
	`NK_UNLOCK
(&
s
->
lock
);

43 
	}
}

45 
	$s£m_timedwa™
Ğ
sim¶e_£m_t
 *
s
, 
ušt64_t
 
timeout_ns
){

48 
ušt64_t
 
¡¬t
 = 
	`nk_sched_g‘_»®time
(), 
now
;

51 ià(
s
 =ğ
NULL
){

54 
	`NK_LOCK
(&
s
->
lock
);

55 if(
s
->
couÁ
 > 0){

56 
s
->
couÁ
--;

60 
	`NK_UNLOCK
(&
s
->
lock
);

61 
	`nk_y›ld
();

64 
now
 = 
	`nk_sched_g‘_»®time
();

66 ifĞ
now
-
¡¬t
 > 
timeout_ns
){

67 
	`NK_UNLOCK
(&
s
->
lock
);

73 
	`NK_UNLOCK
(&
s
->
lock
);

75 
	}
}

77 
šlše
 
	$fÜû_¦“p
(
sim¶e_£m_t
 *
£m
){

79 
nk_th»ad_t
 *
t
 = 
	`g‘_cur_th»ad
();

82 
	`´“m±_di§bË
();

85 
t
->
¡©us
 = 
NK_THR_WAITING
;

86 
	`nk_wa™_queue_’queue
(
£m
->
wa™_queue
,
t
);

90 
	`nk_sched_¦“p
(&
£m
->
lock
);

93 
	}
}

96 
	$s£m_wa™
Ğ
sim¶e_£m_t
 *
s
){

98 
busy_wa™
 = 0;

100 
busy_wa™
 = 
	`s£m_timedwa™
(
s
, 
SPIN_TIME_NS
);

101 ià(
busy_wa™
 == 0){

104 
s
->
¦“pcouÁ
++;

105 
	`DEBUG
("s£m wa™ iÀqueu£m %p\n", 
s
);

106 
	`fÜû_¦“p
(
s
);

107 
	`DEBUG
("s£m wa™ wakeu°š queu£m %p\n", 
s
);

112 
	}
}

	@simple_sem/ssem.h

1 #iâdeà
_PTHREAD_SIMPLE_SEM_H_


2 
	#_PTHREAD_SIMPLE_SEM_H_


	)

3 
	~<Çutus/¥šlock.h
>

4 
	~<Çutus/wa™queue.h
>

5 
	~"../debug.h
"

6 
	ssim¶e_£m
{

7 
¥šlock_t
 
	mlock
;

8 
ušt64_t
 
	mcouÁ
;

9 
	m¦“pcouÁ
;

10 
nk_wa™_queue_t
 *
	mwa™_queue
;

15 
sim¶e_£m
 
	tsim¶e_£m_t
;

17 
s£m_de¡roy
(
sim¶e_£m_t
 *
s
);

19 
s£m_š™
(
sim¶e_£m_t
 *
s
, 
š™Ÿl_couÁ
);

21 
s£m_po¡
(
sim¶e_£m_t
 *
s
, 
couÁ
);

23 
s£m_wa™
Ğ
sim¶e_£m_t
 *
s
);

25 
s£m_timedwa™
Ğ
sim¶e_£m_t
 *
s
, 
ušt64_t
 
timeout_ns
);

	@simple_sem/ssem_init.c

	@tests/barrier1.c

46 
	~"‹¡.h
"

48 
±h»ad_b¬r›r_t
 
	gb¬r›r
;

50 
	$±h»ad_‹¡_b¬r›r1
()

54 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
b¬r›r
, 
NULL
, 1) == 0);

58 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
b¬r›r
) == 0);

63 
	}
}

	@tests/barrier2.c

47 
	~"‹¡.h
"

49 
±h»ad_b¬r›r_t
 
	gb¬r›r
;

51 
	$±h»ad_‹¡_b¬r›r2
()

53 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
b¬r›r
, 
NULL
, 1) == 0);

55 
	`as£¹
(
	`±h»ad_b¬r›r_wa™
(&
b¬r›r
è=ğ
PTHREAD_BARRIER_SERIAL_THREAD
);

57 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
b¬r›r
) == 0);

60 
	}
}

	@tests/barrier3.c

47 
	~"‹¡.h
"

49 
±h»ad_b¬r›r_t
 
	gb¬r›r
;

50 
	g»suÉ
 = 1;

52 * 
	$func
(* 
¬g
)

54  (*è
	`±h»ad_b¬r›r_wa™
(&
b¬r›r
);

55 
	}
}

58 
	$±h»ad_‹¡_b¬r›r3
()

60 
±h»ad_t
 
t
;

61 
±h»ad_b¬r›¿‰r_t
 
ba
;

63 
	`as£¹
(
	`±h»ad_b¬r›¿‰r_š™
(&
ba
) == 0);

64 
	`as£¹
(
	`±h»ad_b¬r›¿‰r_£sh¬ed
(&
ba
, 
PTHREAD_PROCESS_PRIVATE
) == 0);

65 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
b¬r›r
, &
ba
, 1) == 0);

67 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

69 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

71 
	`as£¹
(
»suÉ
 =ğ
PTHREAD_BARRIER_SERIAL_THREAD
);

73 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
b¬r›r
) == 0);

74 
	`as£¹
(
	`±h»ad_b¬r›¿‰r_de¡roy
(&
ba
) == 0);

77 
	}
}

	@tests/barrier4.c

47 
	~"‹¡.h
"

51 
	mNUMTHREADS
 = 4

54 
±h»ad_b¬r›r_t
 
	gb¬r›r
;

55 
±h»ad_mu‹x_t
 
	gmx
 = 
PTHREAD_MUTEX_INITIALIZER
;

56 
	g£rŸlTh»adCouÁ
 = 0;

57 
	gÙh”Th»adCouÁ
 = 0;

60 
	$func
(* 
¬g
)

62 
»suÉ
 = 
	`±h»ad_b¬r›r_wa™
(&
b¬r›r
);

64 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mx
) == 0);

66 ià(
»suÉ
 =ğ
PTHREAD_BARRIER_SERIAL_THREAD
)

68 
£rŸlTh»adCouÁ
++;

70 ià(0 =ğ
»suÉ
)

72 
Ùh”Th»adCouÁ
++;

76  
NULL
;

78 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mx
) == 0);

80  
NULL
;

81 
	}
}

83 
	$±h»ad_‹¡_b¬r›r4
()

85 
i
, 
j
;

86 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

92 
mx
 = 
PTHREAD_MUTEX_INITIALIZER
;

94 
	`±h»ad_mu‹x_š™
(&
mx
, 
NULL
);

96 
j
 = 1; j <ğ
NUMTHREADS
; j++)

98 
	`´štf
("v®uj %d\n",
j
 );

99 
£rŸlTh»adCouÁ
 = 0;

101 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
b¬r›r
, 
NULL
, 
j
) == 0);

103 
i
 = 1; i <ğ
j
; i++)

105 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
func
, NULL) == 0);

108 
i
 = 1; i <ğ
j
; i++)

110 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], 
NULL
) == 0);

113 
	`as£¹
(
£rŸlTh»adCouÁ
 == 1);

115 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
b¬r›r
) == 0);

118 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mx
) == 0);

121 
	}
}

	@tests/barrier5.c

47 
	~"‹¡.h
"

51 
	mNUMTHREADS
 = 4,

52 
	mBARRIERS
 = 10

55 
±h»ad_b¬r›r_t
 
	gb¬r›r
;

56 
±h»ad_mu‹x_t
 
	gmx
 = 
PTHREAD_MUTEX_INITIALIZER
;

58 
	gb¬r›rR–—£s
[
BARRIERS
 + 1];

61 
	$func
(* 
b¬r›rHeight
)

63 
i
;

64 
»suÉ
;

65 
£rŸlTh»ads
 = 0;

67 
	`´štf
 (cÚ¡ * 
s
, ...);

69 
i
 = 1; i < 
BARRIERS
; i++)

71 
»suÉ
 = 
	`±h»ad_b¬r›r_wa™
(&
b¬r›r
);

73 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mx
) == 0);

74 
b¬r›rR–—£s
[
i
]++;

75 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mx
) == 0);

81 ià(
»suÉ
 =ğ
PTHREAD_BARRIER_SERIAL_THREAD
)

83 
£rŸlTh»ads
++;

84 
	`as£¹
(
b¬r›rR–—£s
[
i
 - 1] =ğ(è
b¬r›rHeight
);

85 
b¬r›rR–—£s
[
i
 + 1] = 0;

87 ià(
»suÉ
 != 0)

89  
NULL
;

93  (*è
£rŸlTh»ads
;

94 
	}
}

96 
	$±h»ad_‹¡_b¬r›r5
()

98 
i
, 
j
;

99 
»suÉ
;

100 
£rŸlTh»adsTÙ®
;

101 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

103 
mx
 = 
PTHREAD_MUTEX_INITIALIZER
;

105 
j
 = 1; j <ğ
NUMTHREADS
; j++)

108 
b¬r›rR–—£s
[0] = 
j
;

109 
b¬r›rR–—£s
[1] = 0;

111 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
b¬r›r
, 
NULL
, 
j
) == 0);

113 
i
 = 1; i <ğ
j
; i++)

115 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
func
, (*è
j
) == 0);

118 
£rŸlTh»adsTÙ®
 = 0;

119 
i
 = 1; i <ğ
j
; i++)

121 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

122 
£rŸlTh»adsTÙ®
 +ğ
»suÉ
;

125 
	`as£¹
(
£rŸlTh»adsTÙ®
 =ğ
BARRIERS
 - 1);

126 
	`as£¹
(
b¬r›rR–—£s
[
BARRIERS
 - 1] =ğ
j
);

127 
	`as£¹
(
b¬r›rR–—£s
[
BARRIERS
] == 0);

129 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
b¬r›r
) == 0);

132 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mx
) == 0);

135 
	}
}

	@tests/benchlib.c

48 
	~"‹¡.h
"

51 
	$dummy_ÿÎ
(* 
a
)

53 
	}
}

56 
	$š‹¾ocked_šc_w™h_cÚd™iÚ®s
(* 
a
)

58 ià(
a
 !ğ
NULL
)

59 ià(
	`PTE_ATOMIC_INCREMENT
(
a
) == -1)

61 *
a
 = 0;

63 
	}
}

66 
	$š‹¾ocked_dec_w™h_cÚd™iÚ®s
(* 
a
)

68 ià(
a
 !ğ
NULL
)

69 ià(
	`PTE_ATOMIC_DECREMENT
(
a
) == -1)

71 *
a
 = 0;

73 
	}
}

	@tests/benchtest.h

46 
	#PTW32_OBJECT_AUTO_INIT
 ((*è-1)

	)

48 
dummy_ÿÎ
(* 
a
);

49 
š‹¾ocked_šc_w™h_cÚd™iÚ®s
(*
a
);

50 
š‹¾ocked_dec_w™h_cÚd™iÚ®s
(*
a
);

	@tests/benchtest1.c

48 
	~"‹¡.h
"

51 #ifdeà
__GNUC__


55 
	~"b’ch‹¡.h
"

57 
	#PTW32_MUTEX_TYPES


	)

58 
	#ITERATIONS
 100000L

	)

60 
±h»ad_mu‹x_t
 
	gmx
;

61 
±h»ad_mu‹x©Œ_t
 
	gma
;

62 
_timeb
 
	gcu¼SysTimeS¹
;

63 
_timeb
 
	gcu¼SysTimeStİ
;

64 
	gdu¿tiÚMliSecs
;

65 
	gov”H—dMliSecs
 = 0;

66 
	gÚe
 = 1;

67 
	gz”o
 = 0;

69 
	#G‘Du¿tiÚMliSecs
(
_TS¹
, 
_TStİ
è((_TStİ.
time
*1000+_TStİ.
ml™m
) \

70 - (
_TS¹
.
time
*1000+_TS¹.
ml™m
))

	)

76 
	#TESTSTART
 \

77 { 
i
, 
j
 = 0, 
k
 = 0; 
	`_áime
(&
cu¼SysTimeS¹
); ˜ğ0; i < 
ITERATIONS
; i++è{ j++;

	)

79 
	#TESTSTOP
 \

80 }; 
	`_áime
(&
cu¼SysTimeStİ
); ià(
j
 + 
k
 =ğ
i
èj++; }

	)

84 
	$runTe¡
 (* 
‹¡NameSŒšg
, 
mTy³
)

86 #ifdeà
PTW32_MUTEX_TYPES


87 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
ma
, 
mTy³
) == 0);

89 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mx
, &
ma
) == 0);

91 
TESTSTART


92 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mx
è=ğ
z”o
);

93 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mx
è=ğ
z”o
);

94 
TESTSTOP


96 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mx
) == 0);

98 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

100 
	`´štf
( "%-45s %15ld %15.3f\n",

101 
‹¡NameSŒšg
,

102 
du¿tiÚMliSecs
,

103 (è
du¿tiÚMliSecs
 * 1E3 / 
ITERATIONS
);

104 
	}
}

107 
	$±h»ad_‹¡_b’ch1
()

109 
i
 = 0;

110 
±e_osMu‹xHªdË
 
cs
;

112 
ov”H—dMliSecs
 = 0;

113 
Úe
 = 1;

114 
z”o
 = 0;

116 
	`±h»ad_mu‹x©Œ_š™
(&
ma
);

118 
	`´štf
( "=============================================================================\n");

119 
	`´štf
( "\nLock…lus unlock on‡n unlocked mutex.\n%ld iterations\n\n",

120 
ITERATIONS
);

121 
	`´štf
( "%-45s %15s %15s\n",

130 
TESTSTART


131 
	`as£¹
(1 =ğ
Úe
);

132 
	`as£¹
(1 =ğ
Úe
);

133 
TESTSTOP


135 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

136 
ov”H—dMliSecs
 = 
du¿tiÚMliSecs
;

139 
TESTSTART


140 
	`as£¹
((
	`dummy_ÿÎ
(&
i
), 1è=ğ
Úe
);

141 
	`as£¹
((
	`dummy_ÿÎ
(&
i
), 1è=ğ
Úe
);

142 
TESTSTOP


144 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

146 
	`´štf
( "%-45s %15ld %15.3f\n",

148 
du¿tiÚMliSecs
,

149 (è
du¿tiÚMliSecs
 * 1E3 / 
ITERATIONS
);

152 
TESTSTART


153 
	`as£¹
((
	`š‹¾ocked_šc_w™h_cÚd™iÚ®s
(&
i
), 1è=ğ
Úe
);

154 
	`as£¹
((
	`š‹¾ocked_dec_w™h_cÚd™iÚ®s
(&
i
), 1è=ğ
Úe
);

155 
TESTSTOP


157 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

159 
	`´štf
( "%-45s %15ld %15.3f\n",

161 
du¿tiÚMliSecs
,

162 (è
du¿tiÚMliSecs
 * 1E3 / 
ITERATIONS
);

164 
TESTSTART


165 
	`as£¹
((
	`PTE_ATOMIC_INCREMENT
(&
i
), 1è=ğ
Úe
);

166 
	`as£¹
((
	`PTE_ATOMIC_INCREMENT
(&
i
), 1è=ğ
Úe
);

167 
TESTSTOP


169 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

171 
	`´štf
( "%-45s %15ld %15.3f\n",

173 
du¿tiÚMliSecs
,

174 (è
du¿tiÚMliSecs
 * 1E3 / 
ITERATIONS
);

177 
	`±e_osMu‹xC»©e
(&
cs
);

179 
TESTSTART


182 
	`±e_osMu‹xLock
(
cs
);

183 
	`±e_osMu‹xUÆock
(
cs
);

185 
TESTSTOP


187 
	`±e_osMu‹xD–‘e
(
cs
);

190 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

192 
	`´štf
( "%-45s %15ld %15.3f\n",

194 
du¿tiÚMliSecs
,

195 (è
du¿tiÚMliSecs
 * 1E3 / 
ITERATIONS
);

199 
	`´štf
( ".............................................................................\n");

204 #ifdeà
PTW32_MUTEX_TYPES


205 
	`runTe¡
("PTHREAD_MUTEX_DEFAULT", 
PTHREAD_MUTEX_DEFAULT
);

207 
	`runTe¡
("PTHREAD_MUTEX_NORMAL", 
PTHREAD_MUTEX_NORMAL
);

209 
	`runTe¡
("PTHREAD_MUTEX_ERRORCHECK", 
PTHREAD_MUTEX_ERRORCHECK
);

211 
	`runTe¡
("PTHREAD_MUTEX_RECURSIVE", 
PTHREAD_MUTEX_RECURSIVE
);

213 
	`runTe¡
("Non-blocking†ock", 0);

216 
	`´štf
( "=============================================================================\n");

222 
	`±h»ad_mu‹x©Œ_de¡roy
(&
ma
);

224 
Úe
 = 
i
;

226 
	}
}

	@tests/benchtest2.c

51 
	~"‹¡.h
"

54 #ifdeà
__GNUC__


58 
	~"b’ch‹¡.h
"

60 
	#PTW32_MUTEX_TYPES


	)

61 
	#ITERATIONS
 10000L

	)

63 
±h»ad_mu‹x_t
 
	gg©e1
, 
	gg©e2
;

64 
±h»ad_mu‹x©Œ_t
 
	gma
;

65 
	gdu¿tiÚMliSecs
;

66 
	gov”H—dMliSecs
 = 0;

67 
_timeb
 
	gcu¼SysTimeS¹
;

68 
_timeb
 
	gcu¼SysTimeStİ
;

69 
±h»ad_t
 
	gwÜk”
;

70 
	gruÂšg
 = 0;

72 
	#G‘Du¿tiÚMliSecs
(
_TS¹
, 
_TStİ
è((_TStİ.
time
*1000+_TStİ.
ml™m
) \

73 - (
_TS¹
.
time
*1000+_TS¹.
ml™m
))

	)

79 
	#TESTSTART
 \

80 { 
i
, 
j
 = 0, 
k
 = 0; 
	`_áime
(&
cu¼SysTimeS¹
); ˜ğ0; i < 
ITERATIONS
; i++è{ j++;

	)

82 
	#TESTSTOP
 \

83 }; 
	`_áime
(&
cu¼SysTimeStİ
); ià(
j
 + 
k
 =ğ
i
èj++; }

	)

87 
	$ov”h—dTh»ad
(* 
¬g
)

91 
	`sched_y›ld
();

93 
ruÂšg
);

95  
NULL
;

96 
	}
}

100 
	$wÜk”Th»ad
(* 
¬g
)

104 (è
	`±h»ad_mu‹x_lock
(&
g©e1
);

105 (è
	`±h»ad_mu‹x_lock
(&
g©e2
);

106 (è
	`±h»ad_mu‹x_uÆock
(&
g©e1
);

107 
	`sched_y›ld
();

108 (è
	`±h»ad_mu‹x_uÆock
(&
g©e2
);

110 
ruÂšg
);

112  
NULL
;

113 
	}
}

116 
	$runTe¡
 (* 
‹¡NameSŒšg
, 
mTy³
)

118 #ifdeà
PTW32_MUTEX_TYPES


119 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
ma
, 
mTy³
) == 0);

121 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
g©e1
, &
ma
) == 0);

122 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
g©e2
, &
ma
) == 0);

123 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
g©e1
) == 0);

124 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
g©e2
) == 0);

125 
ruÂšg
 = 1;

126 
	`as£¹
(
	`±h»ad_ü—‹
(&
wÜk”
, 
NULL
, 
wÜk”Th»ad
, NULL) == 0);

127 
TESTSTART


128 (è
	`±h»ad_mu‹x_uÆock
(&
g©e1
);

129 
	`sched_y›ld
();

130 (è
	`±h»ad_mu‹x_uÆock
(&
g©e2
);

131 (è
	`±h»ad_mu‹x_lock
(&
g©e1
);

132 (è
	`±h»ad_mu‹x_lock
(&
g©e2
);

133 
TESTSTOP


134 
ruÂšg
 = 0;

135 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
g©e2
) == 0);

136 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
g©e1
) == 0);

137 
	`as£¹
(
	`±h»ad_još
(
wÜk”
, 
NULL
) == 0);

138 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
g©e2
) == 0);

139 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
g©e1
) == 0);

140 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

141 
	`´štf
( "%-45s %15ld %15.3f\n",

142 
‹¡NameSŒšg
,

143 
du¿tiÚMliSecs
,

144 (è
du¿tiÚMliSecs
 * 1E3 / 
ITERATIONS
 / 4 );

145 
	}
}

148 
	$±h»ad_‹¡_b’ch2
()

150 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
ma
) == 0);

152 
	`´štf
( "=============================================================================\n");

153 
	`´štf
( "\nLock…lus unlock on‡†ocked mutex.\n");

154 
	`´štf
("%ld i‹¿tiÚs, fou¸locks/uÆock ³¸™”©iÚ.\n\n", 
ITERATIONS
);

156 
	`´štf
( "%-45s %15s %15s\n",

165 
ruÂšg
 = 1;

166 
	`as£¹
(
	`±h»ad_ü—‹
(&
wÜk”
, 
NULL
, 
ov”h—dTh»ad
, NULL) == 0);

167 
TESTSTART


168 
	`sched_y›ld
();

169 
	`sched_y›ld
();

170 
TESTSTOP


171 
ruÂšg
 = 0;

172 
	`as£¹
(
	`±h»ad_još
(
wÜk”
, 
NULL
) == 0);

173 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

174 
ov”H—dMliSecs
 = 
du¿tiÚMliSecs
;

180 #ifdeà
PTW32_MUTEX_TYPES


181 
	`runTe¡
("PTHREAD_MUTEX_DEFAULT", 
PTHREAD_MUTEX_DEFAULT
);

183 
	`runTe¡
("PTHREAD_MUTEX_NORMAL", 
PTHREAD_MUTEX_NORMAL
);

185 
	`runTe¡
("PTHREAD_MUTEX_ERRORCHECK", 
PTHREAD_MUTEX_ERRORCHECK
);

187 
	`runTe¡
("PTHREAD_MUTEX_RECURSIVE", 
PTHREAD_MUTEX_RECURSIVE
);

189 
	`runTe¡
("Blocking†ocks", 0);

192 
	`´štf
( "=============================================================================\n");

197 
	`±h»ad_mu‹x©Œ_de¡roy
(&
ma
);

200 
	}
}

	@tests/benchtest3.c

48 
	~"‹¡.h
"

50 #ifdeà
__GNUC__


54 
	~"b’ch‹¡.h
"

56 
	#PTW32_MUTEX_TYPES


	)

57 
	#ITERATIONS
 100000L

	)

59 
±h»ad_mu‹x_t
 
	gmx
;

60 
±h»ad_mu‹x©Œ_t
 
	gma
;

61 
_timeb
 
	gcu¼SysTimeS¹
;

62 
_timeb
 
	gcu¼SysTimeStİ
;

63 
	gdu¿tiÚMliSecs
;

64 
	gov”H—dMliSecs
 = 0;

66 
	#G‘Du¿tiÚMliSecs
(
_TS¹
, 
_TStİ
è((_TStİ.
time
*1000+_TStİ.
ml™m
) \

67 - (
_TS¹
.
time
*1000+_TS¹.
ml™m
))

	)

73 
	#TESTSTART
 \

74 { 
i
, 
j
 = 0, 
k
 = 0; 
	`_áime
(&
cu¼SysTimeS¹
); ˜ğ0; i < 
ITERATIONS
; i++è{ j++;

	)

76 
	#TESTSTOP
 \

77 }; 
	`_áime
(&
cu¼SysTimeStİ
); ià(
j
 + 
k
 =ğ
i
èj++; }

	)

81 
	$ŒylockTh»ad
 (* 
¬g
)

83 
TESTSTART


84 (è
	`±h»ad_mu‹x_Œylock
(&
mx
);

85 
TESTSTOP


87  
NULL
;

88 
	}
}

92 
	$runTe¡
 (* 
‹¡NameSŒšg
, 
mTy³
)

94 
±h»ad_t
 
t
;

96 #ifdeà
PTW32_MUTEX_TYPES


97 (è
	`±h»ad_mu‹x©Œ_£‰y³
(&
ma
, 
mTy³
);

99 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mx
, &
ma
) == 0);

100 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mx
) == 0);

101 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
ŒylockTh»ad
, 0) == 0);

102 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

103 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mx
) == 0);

104 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mx
) == 0);

106 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

108 
	`´štf
( "%-45s %15ld %15.3f\n",

109 
‹¡NameSŒšg
,

110 
du¿tiÚMliSecs
,

111 (è
du¿tiÚMliSecs
 * 1E3 / 
ITERATIONS
);

112 
	}
}

115 
	$±h»ad_‹¡_b’ch3
()

117 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
ma
) == 0);

119 
	`´štf
( "=============================================================================\n");

120 
	`´štf
( "\nTrylock on‡†ocked mutex.\n");

121 
	`´štf
Ğ"%ld i‹¿tiÚs.\n\n", 
ITERATIONS
);

122 
	`´štf
( "%-45s %15s %15s\n",

131 
TESTSTART


132 
TESTSTOP


134 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

135 
ov”H—dMliSecs
 = 
du¿tiÚMliSecs
;

138 
	`´štf
( ".............................................................................\n");

143 #ifdeà
PTW32_MUTEX_TYPES


144 
	`runTe¡
("PTHREAD_MUTEX_DEFAULT (W9x,WNT)", 
PTHREAD_MUTEX_DEFAULT
);

146 
	`runTe¡
("PTHREAD_MUTEX_NORMAL (W9x,WNT)", 
PTHREAD_MUTEX_NORMAL
);

148 
	`runTe¡
("PTHREAD_MUTEX_ERRORCHECK (W9x,WNT)", 
PTHREAD_MUTEX_ERRORCHECK
);

150 
	`runTe¡
("PTHREAD_MUTEX_RECURSIVE (W9x,WNT)", 
PTHREAD_MUTEX_RECURSIVE
);

152 
	`runTe¡
("Non-blocking†ock", 0);

155 
	`´štf
( "=============================================================================\n");

161 
	`±h»ad_mu‹x©Œ_de¡roy
(&
ma
);

164 
	}
}

	@tests/benchtest4.c

48 
	~"‹¡.h
"

50 #ifdeà
__GNUC__


54 
	~"b’ch‹¡.h
"

56 
	#PTW32_MUTEX_TYPES


	)

57 
	#ITERATIONS
 100000L

	)

59 
±h»ad_mu‹x_t
 
	gmx
;

60 
±h»ad_mu‹x©Œ_t
 
	gma
;

61 
_timeb
 
	gcu¼SysTimeS¹
;

62 
_timeb
 
	gcu¼SysTimeStİ
;

63 
	gdu¿tiÚMliSecs
;

64 
	gov”H—dMliSecs
 = 0;

66 
	#G‘Du¿tiÚMliSecs
(
_TS¹
, 
_TStİ
è((_TStİ.
time
*1000+_TStİ.
ml™m
) \

67 - (
_TS¹
.
time
*1000+_TS¹.
ml™m
))

	)

73 
	#TESTSTART
 \

74 { 
i
, 
j
 = 0, 
k
 = 0; 
	`_áime
(&
cu¼SysTimeS¹
); ˜ğ0; i < 
ITERATIONS
; i++è{ j++;

	)

76 
	#TESTSTOP
 \

77 }; 
	`_áime
(&
cu¼SysTimeStİ
); ià(
j
 + 
k
 =ğ
i
èj++; }

	)

81 
	$runTe¡
 (* 
‹¡NameSŒšg
, 
mTy³
)

83 #ifdeà
PTW32_MUTEX_TYPES


84 
	`±h»ad_mu‹x©Œ_£‰y³
(&
ma
, 
mTy³
);

86 
	`±h»ad_mu‹x_š™
(&
mx
, &
ma
);

88 
TESTSTART


89 (è
	`±h»ad_mu‹x_Œylock
(&
mx
);

90 (è
	`±h»ad_mu‹x_uÆock
(&
mx
);

91 
TESTSTOP


93 
	`±h»ad_mu‹x_de¡roy
(&
mx
);

95 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

97 
	`´štf
( "%-45s %15ld %15.3f\n",

98 
‹¡NameSŒšg
,

99 
du¿tiÚMliSecs
,

100 (è
du¿tiÚMliSecs
 * 1E3 / 
ITERATIONS
);

101 
	}
}

104 
	$±h»ad_‹¡_b’ch4
()

106 
	`±h»ad_mu‹x©Œ_š™
(&
ma
);

108 
	`´štf
( "=============================================================================\n");

109 
	`´štf
( "Trylock…lus unlock on‡n unlocked mutex.\n");

110 
	`´štf
Ğ"%ld i‹¿tiÚs.\n\n", 
ITERATIONS
);

111 
	`´štf
( "%-45s %15s %15s\n",

120 
TESTSTART


121 
TESTSTOP


123 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

124 
ov”H—dMliSecs
 = 
du¿tiÚMliSecs
;

129 #ifdeà
PTW32_MUTEX_TYPES


130 
	`runTe¡
("PTHREAD_MUTEX_DEFAULT", 
PTHREAD_MUTEX_DEFAULT
);

132 
	`runTe¡
("PTHREAD_MUTEX_NORMAL", 
PTHREAD_MUTEX_NORMAL
);

134 
	`runTe¡
("PTHREAD_MUTEX_ERRORCHECK", 
PTHREAD_MUTEX_ERRORCHECK
);

136 
	`runTe¡
("PTHREAD_MUTEX_RECURSIVE", 
PTHREAD_MUTEX_RECURSIVE
);

138 
	`runTe¡
("Non-blocking†ock", 0);

141 
	`´štf
( "=============================================================================\n");

147 
	`±h»ad_mu‹x©Œ_de¡roy
(&
ma
);

150 
	}
}

	@tests/benchtest5.c

48 
	~"‹¡.h
"

51 #ifdeà
__GNUC__


55 
	~"b’ch‹¡.h
"

57 
	#ITERATIONS
 1000000L

	)

59 
£m_t
 
	g£ma
;

62 
_timeb
 
	gcu¼SysTimeS¹
;

63 
_timeb
 
	gcu¼SysTimeStİ
;

64 
	gdu¿tiÚMliSecs
;

65 
	gov”H—dMliSecs
 = 0;

66 
	gÚe
 = 1;

67 
	gz”o
 = 0;

69 
	#G‘Du¿tiÚMliSecs
(
_TS¹
, 
_TStİ
è((_TStİ.
time
*1000+_TStİ.
ml™m
) \

70 - (
_TS¹
.
time
*1000+_TS¹.
ml™m
))

	)

76 
	#TESTSTART
 \

77 { 
i
, 
j
 = 0, 
k
 = 0; 
	`_áime
(&
cu¼SysTimeS¹
); ˜ğ0; i < 
ITERATIONS
; i++è{ j++;

	)

79 
	#TESTSTOP
 \

80 }; 
	`_áime
(&
cu¼SysTimeStİ
); ià(
j
 + 
k
 =ğ
i
èj++; }

	)

84 
	$»pÜtTe¡
 (* 
‹¡NameSŒšg
)

86 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

88 
	`´štf
( "%-45s %15ld %15.3f\n",

89 
‹¡NameSŒšg
,

90 
du¿tiÚMliSecs
,

91 (è
du¿tiÚMliSecs
 * 1E3 / 
ITERATIONS
);

92 
	}
}

96 
	$maš
 (
¬gc
, *
¬gv
[])

98 
	`´štf
( "=============================================================================\n");

99 
	`´štf
( "\nOperations on‡ semaphore.\n%ld iterations\n\n",

100 
ITERATIONS
);

101 
	`´štf
( "%-45s %15s %15s\n",

105 <<<<<<< .
mše


106 <<<<<<< .
mše


111 * 
Pth»ads
-
	`embedded
 (
PTE
è- 
POSIX
 
Th»ads
 
Lib¿ry
 
embedded
 
sy¡ems


112 * 
	`Cİyright
(
C
è2008 
JasÚ
 
SchmidÏµ


114 * 
CÚù
 
Ema
: 
jschmidÏµ
@
u£rs
.
sourûfÜge
.
Ãt


118 >>>>>>> .
r47


119 >>>>>>> .
r51


125 
TESTSTART


126 
	`as£¹
(1 =ğ
Úe
);

127 
TESTSTOP


129 
du¿tiÚMliSecs
 = 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
è- 
ov”H—dMliSecs
;

130 
ov”H—dMliSecs
 = 
du¿tiÚMliSecs
;

136 
	`as£¹
((
w32£ma
 = 
	`C»©eSem­hÜe
(
NULL
, (è0, (è
ITERATIONS
, NULL)) != 0);

137 
TESTSTART


138 
	`as£¹
(
	`R–—£Sem­hÜe
(
w32£ma
, 1, 
NULL
è!ğ
z”o
);

139 
TESTSTOP


140 
	`as£¹
(
	`Clo£HªdË
(
w32£ma
) != 0);

142 
	`»pÜtTe¡
("W32 Post with‚o waiters");

145 
	`as£¹
((
w32£ma
 = 
	`C»©eSem­hÜe
(
NULL
, (è
ITERATIONS
, () ITERATIONS, NULL)) != 0);

146 
TESTSTART


147 
	`as£¹
(
	`Wa™FÜSšgËObjeù
(
w32£ma
, 
INFINITE
è=ğ
WAIT_OBJECT_0
);

148 
TESTSTOP


149 
	`as£¹
(
	`Clo£HªdË
(
w32£ma
) != 0);

151 
	`»pÜtTe¡
("W32 Wait without blocking");

154 
	`as£¹
(
	`£m_š™
(&
£ma
, 0, 0) == 0);

155 
TESTSTART


156 
	`as£¹
(
	`£m_po¡
(&
£ma
è=ğ
z”o
);

157 
TESTSTOP


158 
	`as£¹
(
	`£m_de¡roy
(&
£ma
) == 0);

160 
	`»pÜtTe¡
("POSIX Post with‚o waiters");

163 
	`as£¹
(
	`£m_š™
(&
£ma
, 0, 
ITERATIONS
) == 0);

164 
TESTSTART


165 
	`as£¹
(
	`£m_wa™
(&
£ma
è=ğ
z”o
);

166 
TESTSTOP


167 
	`as£¹
(
	`£m_de¡roy
(&
£ma
) == 0);

169 
	`»pÜtTe¡
("POSIX Wait without blocking");

172 
	`´štf
( "=============================================================================\n");

179 
	}
}

	@tests/cancel1.c

81 
	~"‹¡.h
"

88 
	mNUMTHREADS
 = 2

91 
bag_t_
 
	tbag_t
;

92 
	sbag_t_


94 
	mth»adnum
;

95 
	m¡¬‹d
;

99 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

102 
	$myth»ad
(* 
¬g
)

104 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

106 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

107 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

108 
bag
->
¡¬‹d
 = 1;

112 
Şd¡©e
;

114 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_DISABLE
, &
Şd¡©e
) == 0);

115 
	`as£¹
(
Şd¡©e
 =ğ
PTHREAD_CANCEL_ENABLE
);

116 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

117 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_DISABLE
, 
NULL
) == 0);

118 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
Şd¡©e
, &oldstate) == 0);

119 
	`as£¹
(
Şd¡©e
 =ğ
PTHREAD_CANCEL_DISABLE
);

123 
Şdty³
;

125 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_ASYNCHRONOUS
, &
Şdty³
) == 0);

126 
	`as£¹
(
Şdty³
 =ğ
PTHREAD_CANCEL_DEFERRED
);

127 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_DEFERRED
, 
NULL
) == 0);

128 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
) == 0);

129 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
Şdty³
, &oldtype) == 0);

130 
	`as£¹
(
Şdty³
 =ğ
PTHREAD_CANCEL_ASYNCHRONOUS
);

136 
	}
}

138 
	$±h»ad_‹¡_ÿnûl1
()

140 
çed
 = 0;

141 
i
;

142 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

144 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

146 
i
 = 1; i <ğ
NUMTHREADS
; i++)

148 
th»adbag
[
i
].
¡¬‹d
 = 0;

149 
th»adbag
[
i
].
th»adnum
 = i;

150 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

160 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 1000);

165 
i
 = 1; i <ğ
NUMTHREADS
; i++)

167 
çed
 = !
th»adbag
[
i
].
¡¬‹d
;

169 ià(
çed
)

171 
	`årštf
(
¡d”r
, "Th»ad %d: s¹ed %d\n", 
i
, 
th»adbag
[i].
¡¬‹d
);

175 
	`as£¹
(!
çed
);

177 
i
 = 1; i <ğ
NUMTHREADS
; i++)

179 
	`as£¹
(
	`±h»ad_još
(
t
[
i
],
NULL
) == 0);

182 
	`as£¹
(!
çed
);

188 
	}
}

	@tests/cancel2.c

81 
	~"‹¡.h
"

88 
	mNUMTHREADS
 = 1

91 
bag_t_
 
	tbag_t
;

92 
	sbag_t_


94 
	mth»adnum
;

95 
	m¡¬‹d
;

99 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

101 
±h»ad_mu‹x_t
 
	gwa™Lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

104 
	$myth»ad
(* 
¬g
)

107 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

109 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

110 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

111 
bag
->
¡¬‹d
 = 1;

115 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

117 
bag
->
th»adnum
 % 2)

120 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
) == 0);

124 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_DEFERRED
, 
NULL
) == 0);

129 #ià
	`defšed
(
__ılu¥lus
)

130 
Œy


134 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
wa™Lock
) == 0);

135 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
wa™Lock
) == 0);

136 
	`sched_y›ld
();

140 
	`±h»ad_‹¡ÿnûl
();

141 
	`sched_y›ld
();

145 #ià
	`defšed
(
__ılu¥lus
)

146 
	`ÿtch
 (...)

159 
	}
}

161 
	$±h»ad_‹¡_ÿnûl2
()

163 
çed
 = 0;

164 
i
;

165 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

167 
wa™Lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

169 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

170 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
wa™Lock
) == 0);

172 
i
 = 1; i <ğ
NUMTHREADS
; i++)

174 
th»adbag
[
i
].
¡¬‹d
 = 0;

175 
th»adbag
[
i
].
th»adnum
 = i;

176 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

182 
	`±e_osTh»adSË•
(500);

184 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
wa™Lock
) == 0);

186 
	`±e_osTh»adSË•
(500);

188 
i
 = 1; i <ğ
NUMTHREADS
; i++)

190 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[
i
]) == 0);

196 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 100);

201 
i
 = 1; i <ğ
NUMTHREADS
; i++)

203 ià(!
th»adbag
[
i
].
¡¬‹d
)

205 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

209 
	`as£¹
(!
çed
);

214 
çed
 = 0;

215 
i
 = 1; i <ğ
NUMTHREADS
; i++)

217 
ç
 = 0;

218 
»suÉ
 = 0;

220 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

221 
ç
 = (
»suÉ
 !ğ(è
PTHREAD_CANCELED
);

222 
çed
 |ğ
ç
;

225 
	`as£¹
(!
çed
);

227 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
wa™Lock
) == 0);

233 
	}
}

	@tests/cancel3.c

81 
	~"‹¡.h
"

83 #ifdeà
PTE_SUPPORT_ASYNC_CANCEL


90 
	mNUMTHREADS
 = 4

93 
bag_t_
 
	tbag_t
;

94 
	sbag_t_


96 
	mth»adnum
;

97 
	m¡¬‹d
;

99 
	mcouÁ
;

102 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

105 
	$myth»ad
 (*
¬g
)

107 
»suÉ
 = ((è
PTHREAD_CANCELED
 + 1);

108 
bag_t
 *
bag
 = (bag_ˆ*è
¬g
;

110 
	`as£¹
 (
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

111 
	`as£¹
 (
bag
->
¡¬‹d
 == 0);

112 
bag
->
¡¬‹d
 = 1;

116 
	`as£¹
 (
	`±h»ad_£tÿnûl¡©e
 (
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

118 
	`as£¹
 (
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
) == 0);

124 
bag
->
couÁ
 = 0; bag->count < 100; bag->count++)

125 
	`±e_osTh»adSË•
 (100);

127  (*è
»suÉ
;

128 
	}
}

130 
	$±h»ad_‹¡_ÿnûl3
()

132 
çed
 = 0;

133 
i
;

134 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

136 
	`as£¹
 ((
t
[0] = 
	`±h»ad_£lf
 ()).
p
 !ğ
NULL
);

138 
i
 = 1; i <ğ
NUMTHREADS
; i++)

140 
th»adbag
[
i
].
¡¬‹d
 = 0;

141 
th»adbag
[
i
].
th»adnum
 = i;

142 
	`as£¹
 (
	`±h»ad_ü—‹
 (&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i])

149 
	`±e_osTh»adSË•
 (500);

151 
i
 = 1; i <ğ
NUMTHREADS
; i++)

153 
	`as£¹
 (
	`±h»ad_ÿnûl
 (
t
[
i
]) == 0);

159 
	`±e_osTh»adSË•
 (
NUMTHREADS
 * 100);

164 
i
 = 1; i <ğ
NUMTHREADS
; i++)

166 ià(!
th»adbag
[
i
].
¡¬‹d
)

168 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

169 
	`årštf
 (
¡d”r
, "Th»ad %d: s¹ed %d\n", 
i
,

170 
th»adbag
[
i
].
¡¬‹d
);

174 
	`as£¹
 (!
çed
);

179 
çed
 = 0;

180 
i
 = 1; i <ğ
NUMTHREADS
; i++)

182 
ç
 = 0;

183 
»suÉ
 = 0;

190 
	`as£¹
 (
	`±h»ad_još
 (
t
[
i
], (**è&
»suÉ
) == 0);

192 
ç
 = (
»suÉ
 !ğ(è
PTHREAD_CANCELED
);

194 ià(
ç
)

196 
	`årštf
 (
¡d”r
, "Thread %d: started %d: count %d\n",

197 
i
, 
th»adbag
[i].
¡¬‹d
,h»adbag[i].
couÁ
);

199 
çed
 = (çed || 
ç
);

202 
	`as£¹
 (!
çed
);

208 
	}
}

212 
	$±h»ad_‹¡_ÿnûl3
()

214 
	`´štf
("Test‚ot„un -‡sync cancellation‚ot supported\n");

217 
	}
}

	@tests/cancel4.c

85 
	~"‹¡.h
"

92 
	mNUMTHREADS
 = 4

95 
bag_t_
 
	tbag_t
;

96 
	sbag_t_


98 
	mth»adnum
;

99 
	m¡¬‹d
;

101 
	mcouÁ
;

104 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

107 
	$myth»ad
(* 
¬g
)

109 
»suÉ
 = (()
PTHREAD_CANCELED
 + 1);

110 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

112 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

113 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

114 
bag
->
¡¬‹d
 = 1;

118 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

120 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_DEFERRED
, 
NULL
) == 0);

126 
bag
->
couÁ
 = 0; bag->count < 20; bag->count++)

127 
	`±e_osTh»adSË•
(100);

129  (*è
»suÉ
;

130 
	}
}

132 
	$±h»ad_‹¡_ÿnûl4
()

134 
çed
 = 0;

135 
i
;

136 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

138 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

140 
i
 = 1; i <ğ
NUMTHREADS
; i++)

142 
th»adbag
[
i
].
¡¬‹d
 = 0;

143 
th»adbag
[
i
].
th»adnum
 = i;

144 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

150 
	`±e_osTh»adSË•
(500);

152 
i
 = 1; i <ğ
NUMTHREADS
; i++)

154 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[
i
]) == 0);

160 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 100);

165 
i
 = 1; i <ğ
NUMTHREADS
; i++)

167 ià(!
th»adbag
[
i
].
¡¬‹d
)

169 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

173 
	`as£¹
(!
çed
);

178 
çed
 = 0;

179 
i
 = 1; i <ğ
NUMTHREADS
; i++)

181 
ç
 = 0;

182 
»suÉ
 = 0;

189 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

191 
ç
 = (
»suÉ
 =ğ(è
PTHREAD_CANCELED
);

193 
çed
 = (çed || 
ç
);

196 
	`as£¹
(!
çed
);

202 
	}
}

	@tests/cancel5.c

81 
	~"‹¡.h
"

83 #ifdeà
PTE_SUPPORT_ASYNC_CANCEL


90 
	mNUMTHREADS
 = 4

93 
bag_t_
 
	tbag_t
;

94 
	sbag_t_


96 
	mth»adnum
;

97 
	m¡¬‹d
;

99 
	mcouÁ
;

102 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

105 
	$myth»ad
 (*
¬g
)

107 
»suÉ
 = ((è
PTHREAD_CANCELED
 + 1);

108 
bag_t
 *
bag
 = (bag_ˆ*è
¬g
;

110 
	`as£¹
 (
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

111 
	`as£¹
 (
bag
->
¡¬‹d
 == 0);

112 
bag
->
¡¬‹d
 = 1;

116 
	`as£¹
 (
	`±h»ad_£tÿnûl¡©e
 (
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

118 
	`as£¹
 (
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
) == 0);

124 
bag
->
couÁ
 = 0; bag->count < 100; bag->count++)

125 
	`±e_osTh»adSË•
 (100);

127  (*è
»suÉ
;

128 
	}
}

130 
	$±h»ad_‹¡_ÿnûl5
()

132 
çed
 = 0;

133 
i
;

134 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

136 
i
 = 1; i <ğ
NUMTHREADS
; i++)

138 
th»adbag
[
i
].
¡¬‹d
 = 0;

139 
th»adbag
[
i
].
th»adnum
 = i;

140 
	`as£¹
 (
	`±h»ad_ü—‹
 (&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i])

147 
	`±e_osTh»adSË•
 (500);

149 
i
 = 1; i <ğ
NUMTHREADS
; i++)

151 
	`as£¹
 (
	`±h»ad_ÿnûl
 (
t
[
i
]) == 0);

157 
	`±e_osTh»adSË•
 (
NUMTHREADS
 * 100);

162 
i
 = 1; i <ğ
NUMTHREADS
; i++)

164 ià(!
th»adbag
[
i
].
¡¬‹d
)

166 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

170 
	`as£¹
 (!
çed
);

175 
çed
 = 0;

176 
i
 = 1; i <ğ
NUMTHREADS
; i++)

178 
ç
 = 0;

179 
»suÉ
 = 0;

186 
	`as£¹
 (
	`±h»ad_još
 (
t
[
i
], (**è&
»suÉ
) == 0);

188 
ç
 = (
»suÉ
 !ğ(è
PTHREAD_CANCELED
);

190 
çed
 = (çed || 
ç
);

193 
	`as£¹
 (!
çed
);

199 
	}
}

203 
	$±h»ad_‹¡_ÿnûl5
()

205 
	`´štf
("Test‚ot„un -‡sync cancellation‚ot supported\n");

208 
	}
}

	@tests/cancel6a.c

72 
	~"‹¡.h
"

74 #ifdeà
PTE_SUPPORT_ASYNC_CANCEL


81 
	mNUMTHREADS
 = 4

84 
bag_t_
 
	tbag_t
;

85 
	sbag_t_


87 
	mth»adnum
;

88 
	m¡¬‹d
;

90 
	mcouÁ
;

93 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

96 
	$myth»ad
(* 
¬g
)

98 
»suÉ
 = (()
PTHREAD_CANCELED
 + 1);

99 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

101 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

102 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

103 
bag
->
¡¬‹d
 = 1;

107 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

109 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
) == 0);

115 
bag
->
couÁ
 = 0; bag->count < 100; bag->count++)

116 
	`±e_osTh»adSË•
(100);

118  (*è
»suÉ
;

119 
	}
}

121 
	$±h»ad_‹¡_ÿnûl6a
()

123 
çed
 = 0;

124 
i
;

125 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

127 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()).
p
 !ğ
NULL
);

129 
i
 = 1; i <ğ
NUMTHREADS
; i++)

131 
th»adbag
[
i
].
¡¬‹d
 = 0;

132 
th»adbag
[
i
].
th»adnum
 = i;

133 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

139 
	`±e_osTh»adSË•
(500);

141 
i
 = 1; i <ğ
NUMTHREADS
; i++)

143 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[
i
]) == 0);

144 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[
i
]è=ğ
ESRCH
);

150 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 100);

155 
i
 = 1; i <ğ
NUMTHREADS
; i++)

157 ià(!
th»adbag
[
i
].
¡¬‹d
)

159 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

163 
	`as£¹
(!
çed
);

168 
çed
 = 0;

169 
i
 = 1; i <ğ
NUMTHREADS
; i++)

171 
ç
 = 0;

172 
»suÉ
 = 0;

179 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

181 
ç
 = (
»suÉ
 !ğ(è
PTHREAD_CANCELED
);

183 
çed
 = (çed || 
ç
);

186 
	`as£¹
(!
çed
);

192 
	}
}

196 
	$±h»ad_‹¡_ÿnûl6a
()

198 
	`´štf
("Test‚ot„un -‡sync cancellation‚ot supported\n");

201 
	}
}

	@tests/cancel6d.c

73 
	~"‹¡.h
"

80 
	mNUMTHREADS
 = 4

83 
bag_t_
 
	tbag_t
;

84 
	sbag_t_


86 
	mth»adnum
;

87 
	m¡¬‹d
;

89 
	mcouÁ
;

92 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

95 
	$myth»ad
(* 
¬g
)

97 
»suÉ
 = (()
PTHREAD_CANCELED
 + 1);

98 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

100 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

101 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

102 
bag
->
¡¬‹d
 = 1;

106 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

108 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_DEFERRED
, 
NULL
) == 0);

114 
bag
->
couÁ
 = 0; bag->count < 100; bag->count++)

116 
	`±e_osTh»adSË•
(100);

117 
	`±h»ad_‹¡ÿnûl
();

120  (*è
»suÉ
;

121 
	}
}

123 
	$±h»ad_‹¡_ÿnûl6d
()

125 
çed
 = 0;

126 
i
;

127 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

129 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

131 
i
 = 1; i <ğ
NUMTHREADS
; i++)

133 
th»adbag
[
i
].
¡¬‹d
 = 0;

134 
th»adbag
[
i
].
th»adnum
 = i;

135 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

141 
	`±e_osTh»adSË•
(500);

143 
i
 = 1; i <ğ
NUMTHREADS
; i++)

145 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[
i
]) == 0);

146 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[
i
]) == 0);

152 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 100);

157 
i
 = 1; i <ğ
NUMTHREADS
; i++)

159 ià(!
th»adbag
[
i
].
¡¬‹d
)

161 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

165 
	`as£¹
(!
çed
);

170 
çed
 = 0;

171 
i
 = 1; i <ğ
NUMTHREADS
; i++)

173 
ç
 = 0;

174 
»suÉ
 = 0;

176 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

178 
ç
 = (
»suÉ
 !ğ(è
PTHREAD_CANCELED
);

180 
çed
 = (çed || 
ç
);

183 
	`as£¹
(!
çed
);

189 
	}
}

	@tests/cleanup0.c

80 
	~"‹¡.h
"

82 #ifdeà
PTE_SUPPORT_ASYNC_CANCEL


89 
	mNUMTHREADS
 = 10

92 
bag_t_
 
	tbag_t
;

93 
	sbag_t_


95 
	mth»adnum
;

96 
	m¡¬‹d
;

98 
	mcouÁ
;

101 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

105 
	mi
;

106 
	mnuÎ
;

107 
±e_osMu‹xHªdË
 
	mcs
;

108 } 
	tsh¬edIÁ_t
;

110 
sh¬edIÁ_t
 
	gpİ_couÁ
 = {0, 0};

113 
	$šüem’t_pİ_couÁ
(* 
¬g
)

115 
sh¬edIÁ_t
 * 
sI
 = (sh¬edIÁ_ˆ*è
¬g
;

117 
	`±e_osMu‹xLock
(
sI
->
cs
);

118 
sI
->
i
++;

119 
	`±e_osMu‹xUÆock
(
sI
->
cs
);

120 
	}
}

123 
	$myth»ad
(* 
¬g
)

125 
»suÉ
 = 0;

126 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

128 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

129 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

130 
bag
->
¡¬‹d
 = 1;

134 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

136 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
) == 0);

138 
	`±h»ad_ş—nup_push
(
šüem’t_pİ_couÁ
, (*è&
pİ_couÁ
);

140 
	`±e_osTh»adSË•
(100);

142 
	`±h»ad_ş—nup_pİ
(1);

144  (*è
»suÉ
;

145 
	}
}

147 
	$±h»ad_‹¡_ş—nup0
()

149 
çed
 = 0;

150 
i
;

151 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

153 
	`±e_osMu‹xC»©e
(&
pİ_couÁ
.
cs
);

155 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()).
p
 !ğ
NULL
);

157 
i
 = 1; i <ğ
NUMTHREADS
; i++)

159 
th»adbag
[
i
].
¡¬‹d
 = 0;

160 
th»adbag
[
i
].
th»adnum
 = i;

161 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

167 
	`±e_osTh»adSË•
(500);

172 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 100);

177 
i
 = 1; i <ğ
NUMTHREADS
; i++)

179 ià(!
th»adbag
[
i
].
¡¬‹d
)

181 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

185 
	`as£¹
(!
çed
);

190 
çed
 = 0;

191 
i
 = 1; i <ğ
NUMTHREADS
; i++)

193 
ç
 = 0;

194 
»suÉ
 = 0;

196 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

198 
ç
 = (
»suÉ
 =ğ(è
PTHREAD_CANCELED
);

200 
çed
 = (çed || 
ç
);

203 
	`as£¹
(!
çed
);

205 
	`as£¹
(
pİ_couÁ
.
i
 =ğ
NUMTHREADS
);

207 
	`±e_osMu‹xD–‘e
(
pİ_couÁ
.
cs
);

213 
	}
}

217 
	$±h»ad_‹¡_ş—nup0
()

219 
	`´štf
("Test‚ot„un -‡sync cancellation‚ot supported\n");

222 
	}
}

	@tests/cleanup1.c

81 
	~"‹¡.h
"

83 #ifdeà
PTE_SUPPORT_ASYNC_CANCEL


90 
	mNUMTHREADS
 = 10

93 
bag_t_
 
	tbag_t
;

94 
	sbag_t_


96 
	mth»adnum
;

97 
	m¡¬‹d
;

99 
	mcouÁ
;

102 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

106 
	mi
;

107 
	mnuÎ
;

108 
±e_osMu‹xHªdË
 
	mcs
;

109 } 
	tsh¬edIÁ_t
;

111 
sh¬edIÁ_t
 
	gpİ_couÁ
 = {0, 0};

114 
	$šüem’t_pİ_couÁ
(* 
¬g
)

116 
sh¬edIÁ_t
 * 
sI
 = (sh¬edIÁ_ˆ*è
¬g
;

118 
	`±e_osMu‹xLock
(
sI
->
cs
);

120 
sI
->
i
++;

122 
	`±e_osMu‹xUÆock
(
sI
->
cs
);

124 
	}
}

127 
	$myth»ad
(* 
¬g
)

129 
»suÉ
 = 0;

130 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

132 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

133 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

134 
bag
->
¡¬‹d
 = 1;

138 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

140 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
) == 0);

142 
	`±h»ad_ş—nup_push
(
šüem’t_pİ_couÁ
, (*è&
pİ_couÁ
);

149 
bag
->
couÁ
 = 0; bag->count < 100; bag->count++)

150 
	`±e_osTh»adSË•
(100);

152 
	`±h»ad_ş—nup_pİ
(0);

154  (*è
»suÉ
;

155 
	}
}

157 
	$±h»ad_‹¡_ş—nup1
()

159 
çed
 = 0;

160 
i
;

161 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

163 
	`±e_osMu‹xC»©e
(&
pİ_couÁ
.
cs
);

165 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()).
p
 !ğ
NULL
);

167 
i
 = 1; i <ğ
NUMTHREADS
; i++)

169 
th»adbag
[
i
].
¡¬‹d
 = 0;

170 
th»adbag
[
i
].
th»adnum
 = i;

171 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

177 
	`±e_osTh»adSË•
(500);

179 
i
 = 1; i <ğ
NUMTHREADS
; i++)

181 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[
i
]) == 0);

187 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 100);

192 
i
 = 1; i <ğ
NUMTHREADS
; i++)

194 ià(!
th»adbag
[
i
].
¡¬‹d
)

196 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

200 
	`as£¹
(!
çed
);

205 
çed
 = 0;

206 
i
 = 1; i <ğ
NUMTHREADS
; i++)

208 
ç
 = 0;

209 
»suÉ
 = 0;

211 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

213 
ç
 = (
»suÉ
 !ğ(è
PTHREAD_CANCELED
);

215 
çed
 = (çed || 
ç
);

218 
	`as£¹
(!
çed
);

220 
	`as£¹
(
pİ_couÁ
.
i
 =ğ
NUMTHREADS
);

222 
	`±e_osMu‹xD–‘e
(
pİ_couÁ
.
cs
);

228 
	}
}

232 
	$±h»ad_‹¡_ş—nup1
()

234 
	`´štf
("Test‚ot„un -‡sync cancellation‚ot supported\n");

237 
	}
}

	@tests/cleanup2.c

81 
	~"‹¡.h
"

83 #ifdeà
PTE_SUPPORT_ASYNC_CANCEL


90 
	mNUMTHREADS
 = 10

93 
bag_t_
 
	tbag_t
;

94 
	sbag_t_


96 
	mth»adnum
;

97 
	m¡¬‹d
;

99 
	mcouÁ
;

102 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

106 
	mi
;

107 
	mnuÎ
;

108 
±e_osMu‹xHªdË
 
	mcs
;

109 } 
	tsh¬edIÁ_t
;

111 
sh¬edIÁ_t
 
	gpİ_couÁ
 = {0, 0};

114 
	$šüem’t_pİ_couÁ
(* 
¬g
)

116 
sh¬edIÁ_t
 * 
sI
 = (sh¬edIÁ_ˆ*è
¬g
;

118 
	`±e_osMu‹xLock
(
sI
->
cs
);

119 
sI
->
i
++;

120 
	`±e_osMu‹xUÆock
(
sI
->
cs
);

121 
	}
}

124 
	$myth»ad
(* 
¬g
)

126 
»suÉ
 = 0;

127 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

129 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

130 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

131 
bag
->
¡¬‹d
 = 1;

133 
	`±h»ad_ş—nup_push
(
šüem’t_pİ_couÁ
, (*è&
pİ_couÁ
);

135 
	`sched_y›ld
();

137 
	`±h»ad_ş—nup_pİ
(1);

139  (*è
»suÉ
;

140 
	}
}

142 
	$±h»ad_‹¡_ş—nup2
()

144 
çed
 = 0;

145 
i
;

146 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

148 
	`±e_osMu‹xC»©e
(&
pİ_couÁ
.
cs
);

150 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()).
p
 !ğ
NULL
);

152 
i
 = 1; i <ğ
NUMTHREADS
; i++)

154 
th»adbag
[
i
].
¡¬‹d
 = 0;

155 
th»adbag
[
i
].
th»adnum
 = i;

156 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

162 
	`±e_osTh»adSË•
(1000);

167 
i
 = 1; i <ğ
NUMTHREADS
; i++)

169 ià(!
th»adbag
[
i
].
¡¬‹d
)

171 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

175 
	`as£¹
(!
çed
);

180 
çed
 = 0;

181 
i
 = 1; i <ğ
NUMTHREADS
; i++)

183 
ç
 = 0;

184 
»suÉ
 = 0;

186 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

188 
ç
 = (
»suÉ
 != 0);

190 
çed
 = (çed || 
ç
);

193 
	`as£¹
(!
çed
);

195 
	`as£¹
(
pİ_couÁ
.
i
 =ğ
NUMTHREADS
);

197 
	`±e_osMu‹xD–‘e
(
pİ_couÁ
.
cs
);

203 
	}
}

207 
	$±h»ad_‹¡_ş—nup2
()

209 
	`´štf
("Test‚ot„un -‡sync cancellation‚ot supported\n");

212 
	}
}

	@tests/cleanup3.c

82 
	~"‹¡.h
"

84 #ifdeà
PTE_SUPPORT_ASYNC_CANCEL


91 
	mNUMTHREADS
 = 10

94 
bag_t_
 
	tbag_t
;

95 
	sbag_t_


97 
	mth»adnum
;

98 
	m¡¬‹d
;

100 
	mcouÁ
;

103 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

107 
	mi
;

108 
	mnuÎ
;

109 
±e_osMu‹xHªdË
 
	mcs
;

110 } 
	tsh¬edIÁ_t
;

112 
sh¬edIÁ_t
 
	gpİ_couÁ
 = {0, 0};

115 
	$šüem’t_pİ_couÁ
(* 
¬g
)

117 
sh¬edIÁ_t
 * 
sI
 = (sh¬edIÁ_ˆ*è
¬g
;

119 
	`±e_osMu‹xLock
(
sI
->
cs
);

121 
sI
->
i
++;

123 
	`±e_osMu‹xUÆock
(
sI
->
cs
);

125 
	}
}

128 
	$myth»ad
(* 
¬g
)

130 
»suÉ
 = 0;

131 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

133 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

134 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

135 
bag
->
¡¬‹d
 = 1;

137 
	`±h»ad_ş—nup_push
(
šüem’t_pİ_couÁ
, (*è&
pİ_couÁ
);

139 
	`sched_y›ld
();

141 
	`±e_osMu‹xLock
(
pİ_couÁ
.
cs
);

143 
pİ_couÁ
.
i
--;

145 
	`±e_osMu‹xUÆock
(
pİ_couÁ
.
cs
);

148 
	`±h»ad_ş—nup_pİ
(0);

150  (*è
»suÉ
;

151 
	}
}

153 
	$±h»ad_‹¡_ş—nup3
()

155 
çed
 = 0;

156 
i
;

157 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

159 
	`±e_osMu‹xC»©e
(&
pİ_couÁ
.
cs
);

161 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()).
p
 !ğ
NULL
);

163 
i
 = 1; i <ğ
NUMTHREADS
; i++)

165 
th»adbag
[
i
].
¡¬‹d
 = 0;

166 
th»adbag
[
i
].
th»adnum
 = i;

167 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

173 
	`±e_osTh»adSË•
(1000);

178 
i
 = 1; i <ğ
NUMTHREADS
; i++)

180 ià(!
th»adbag
[
i
].
¡¬‹d
)

182 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

186 
	`as£¹
(!
çed
);

191 
çed
 = 0;

192 
i
 = 1; i <ğ
NUMTHREADS
; i++)

194 
ç
 = 0;

195 
»suÉ
 = 0;

197 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

199 
ç
 = (
»suÉ
 != 0);

201 
çed
 = (çed || 
ç
);

204 
	`as£¹
(!
çed
);

206 
	`as£¹
(
pİ_couÁ
.
i
 =ğ-(
NUMTHREADS
));

208 
	`±e_osMu‹xD–‘e
(
pİ_couÁ
.
cs
);

214 
	}
}

219 
	$±h»ad_‹¡_ş—nup3
()

221 
	`´štf
("Test‚ot„un -‡sync cancellation‚ot supported\n");

224 
	}
}

	@tests/condvar1.c

85 
	~"‹¡.h
"

87 
±h»ad_cÚd_t
 
	gcv
;

89 
	$±h»ad_‹¡_cÚdv¬1
()

95 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
cv
, 
NULL
) == 0);

99 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cv
) == 0);

104 
	}
}

	@tests/condvar1_1.c

84 
	~"‹¡.h
"

88 
	mNUM_CV
 = 10

91 
±h»ad_cÚd_t
 
	gcv
[
NUM_CV
];

93 
	$±h»ad_‹¡_cÚdv¬1_1
()

95 
i
, 
j
;

97 
i
 = 0; i < 
NUM_CV
; i++)

100 
	`as£¹
(
	`±h»ad_timechªge_hªdËr_Å
(
NULL
) == (*) 0);

101 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
cv
[
i
], 
NULL
) == 0);

104 
j
 = 
NUM_CV
;

105 (è
	`¤ªd
(()
	`time
(
NULL
));

109 
i
 = 
	`¿nd
(è% 
NUM_CV
;

111 ià(&(
cv
[
i
]è!ğ
NULL
)

113 
j
--;

114 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cv
[
i
]) == 0);

116 
	`as£¹
(
	`±h»ad_timechªge_hªdËr_Å
(
NULL
) == (*) 0);

119 
j
 > 0);

122 
	}
}

	@tests/condvar1_2.c

85 
	~"‹¡.h
"

89 
	mNUM_CV
 = 5,

90 
	mNUM_LOOPS
 = 5

93 
±h»ad_cÚd_t
 
	gcv
[
NUM_CV
];

95 
	$±h»ad_‹¡_cÚdv¬1_2
()

97 
i
, 
j
, 
k
;

98 
»suÉ
 = -1;

99 
±h»ad_t
 
t
;

101 
k
 = 0; k < 
NUM_LOOPS
; k++)

103 
i
 = 0; i < 
NUM_CV
; i++)

105 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
cv
[
i
], 
NULL
) == 0);

108 
j
 = 
NUM_CV
;

109 (è
	`¤ªd
(()
	`time
(
NULL
));

112 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
±h»ad_timechªge_hªdËr_Å
, NULL) == 0);

116 
i
 = 
	`¿nd
(è% 
NUM_CV
;

117 ià(
cv
[
i
] !ğ
NULL
)

119 
j
--;

120 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cv
[
i
]) == 0);

123 
j
 > 0);

125 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

126 
	`as£¹
 (
»suÉ
 == 0);

130 
	}
}

	@tests/condvar2.c

82 
	#_WIN32_WINNT
 0x400

	)

84 
	~"‹¡.h
"

87 
±h»ad_cÚd_t
 
	gcv
;

88 
±h»ad_mu‹x_t
 
	gmu‹x
;

92 
	$±h»ad_‹¡_cÚdv¬2
()

94 
time¥ec
 
ab¡ime
 =

98 
_timeb
 
cu¼SysTime
;

99 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

101 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
cv
, 
NULL
) == 0);

103 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
) == 0);

105 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

108 
	`_áime
(&
cu¼SysTime
);

110 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

111 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

113 
ab¡ime
.
tv_£c
 += 1;

115 
»s
 = 
	`±h»ad_cÚd_timedwa™
(&
cv
, &
mu‹x
, &
ab¡ime
);

116 
	`as£¹
(
»s
 =ğ
ETIMEDOUT
);

118 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

121 
»suÉ
 = 
	`±h»ad_cÚd_de¡roy
(&
cv
);

123 
	`as£¹
(
»suÉ
 == 0);

126 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

129 
	}
}

	@tests/condvar2_1.c

82 
	#_WIN32_WINNT
 0x400

	)

84 
	~"‹¡.h
"

87 
±h»ad_cÚd_t
 
	gcv
;

88 
±h»ad_mu‹x_t
 
	gmu‹x
;

89 
time¥ec
 
	gab¡ime
 =

96 
	mNUMTHREADS
 = 8

100 
	$myth»ad
(* 
¬g
)

102 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

104 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cv
, &
mu‹x
, &
ab¡ime
è=ğ
ETIMEDOUT
);

106 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

108  
¬g
;

109 
	}
}

111 
	~"../im¶em’t.h
"

113 
	$±h»ad_‹¡_cÚdv¬2_1
()

115 
i
;

116 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

117 
»suÉ
 = 0;

118 
_timeb
 
cu¼SysTime
;

119 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

121 
	`´štf
("num oàth»ad %d\n", 
NUMTHREADS
);

122 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
cv
, 
NULL
) == 0);

124 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
) == 0);

127 
	`_áime
(&
cu¼SysTime
);

129 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

130 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

132 
ab¡ime
.
tv_£c
 += 5;

134 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

136 
i
 = 1; i <ğ
NUMTHREADS
; i++)

138 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*) i) == 0);

141 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

143 
i
 = 1; i <ğ
NUMTHREADS
; i++)

145 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

147 
	`as£¹
(
»suÉ
 =ğ
i
);

150 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cv
) == 0);

152 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

155 
	}
}

	@tests/condvar3.c

86 
	~"‹¡.h
"

89 
±h»ad_cÚd_t
 
	gcv
;

90 
±h»ad_mu‹x_t
 
	gmu‹x
;

91 
	gsh¬ed
 = 0;

95 
	mNUMTHREADS
 = 2

99 
	$myth»ad
(* 
¬g
)

101 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

102 
sh¬ed
++;

103 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

105 
	`as£¹
(
	`±h»ad_cÚd_sigÇl
(&
cv
) == 0);

108 
	}
}

110 
	$±h»ad_‹¡_cÚdv¬3
()

112 
±h»ad_t
 
t
[
NUMTHREADS
];

113 
time¥ec
 
ab¡ime
 =

117 
_timeb
 
cu¼SysTime
;

118 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

120 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

122 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
cv
, 
NULL
) == 0);

124 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
) == 0);

126 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

129 
	`_áime
(&
cu¼SysTime
);

131 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

132 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

134 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[1], 
NULL
, 
myth»ad
, (*) 1) == 0);

136 
ab¡ime
.
tv_£c
 += 5;

138 ! (
sh¬ed
 > 0))

139 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cv
, &
mu‹x
, &
ab¡ime
) == 0);

141 
	`as£¹
(
sh¬ed
 > 0);

143 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

145 
	`as£¹
(
	`±h»ad_još
(
t
[1], 
NULL
) == 0);

147 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cv
) == 0);

149 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

152 
	}
}

	@tests/condvar3_1.c

84 
	#_WIN32_WINNT
 0x400

	)

86 
	~"‹¡.h
"

89 
±h»ad_cÚd_t
 
	gcv
;

90 
±h»ad_cÚd_t
 
	gcv1
;

91 
±h»ad_mu‹x_t
 
	gmu‹x
;

92 
±h»ad_mu‹x_t
 
	gmu‹x1
;

93 
time¥ec
 
	gab¡ime
 =

97 
	gtimedout
 = 0;

98 
	gsigÇËd
 = 0;

99 
	gawok’
 = 0;

100 
	gwa™šg
 = 0;

104 
	mNUMTHREADS
 = 4

108 
	$myth»ad
(* 
¬g
)

110 
»suÉ
;

111 
_timeb
 
cu¼SysTime
;

112 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

114 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x1
) == 0);

115 ++
wa™šg
;

116 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
) == 0);

117 
	`as£¹
(
	`±h»ad_cÚd_sigÇl
(&
cv1
) == 0);

119 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

122 
	`_áime
(&
cu¼SysTime
);

124 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

125 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

127 
ab¡ime
.
tv_£c
 += 5;

129 
»suÉ
 = 
	`±h»ad_cÚd_timedwa™
(&
cv
, &
mu‹x
, &
ab¡ime
);

130 ià(
»suÉ
 =ğ
ETIMEDOUT
)

132 
timedout
++;

136 
awok’
++;

138 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

140  
¬g
;

141 
	}
}

143 
	~"../im¶em’t.h
"

145 
	$±h»ad_‹¡_cÚdv¬3_1
()

147 
i
;

148 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

149 
»suÉ
 = 0;

151 
timedout
 = 0;

152 
sigÇËd
 = 0;

153 
awok’
 = 0;

154 
wa™šg
 = 0;

157 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
cv
, 
NULL
) == 0);

158 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
cv1
, 
NULL
) == 0);

160 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
) == 0);

161 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x1
, 
NULL
) == 0);

163 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x1
) == 0);

165 
i
 = 1; i <ğ
NUMTHREADS
; i++)

167 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*) i) == 0);

172 
	`as£¹
(
	`±h»ad_cÚd_wa™
(&
cv1
,&
mu‹x1
) == 0);

174  
NUMTHREADS
 > 
wa™šg
 );

176 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
) == 0);

178 
i
 = 
NUMTHREADS
/3; i <= 2*NUMTHREADS/3; i++)

181 
	`as£¹
(
	`±h»ad_cÚd_sigÇl
(&
cv
) == 0);

184 
sigÇËd
++;

187 
i
 = 1; i <ğ
NUMTHREADS
; i++)

189 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

190 
	`as£¹
(
»suÉ
 =ğ
i
);

193 
	`as£¹
(
sigÇËd
 =ğ
awok’
);

194 
	`as£¹
(
timedout
 =ğ
NUMTHREADS
 - 
sigÇËd
);

196 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cv1
) == 0);

199 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cv
) == 0);

202 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x1
) == 0);

203 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

206 
	}
}

	@tests/condvar3_2.c

84 
	#_WIN32_WINNT
 0x400

	)

86 
	~"‹¡.h
"

90 
±h»ad_cÚd_t
 
	gcv
;

91 
±h»ad_mu‹x_t
 
	gmu‹x
;

92 
time¥ec
 
	gab¡ime
 =

96 
time¥ec
 
	gab¡ime2
 =

100 
	gtimedout
 = 0;

101 
	gawok’
 = 0;

105 
	mNUMTHREADS
 = 
OS_MAX_SIMUL_THREADS


109 
	$myth»ad
(* 
¬g
)

111 
»suÉ
;

113 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

115 
ab¡ime2
.
tv_£c
 = 
ab¡ime
.tv_sec;

117 ià((è
¬g
 % 3 == 0)

119 
ab¡ime2
.
tv_£c
 += 2;

122 
»suÉ
 = 
	`±h»ad_cÚd_timedwa™
(&
cv
, &
mu‹x
, &
ab¡ime2
);

123 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

124 ià(
»suÉ
 =ğ
ETIMEDOUT
)

126 
	`PTE_ATOMIC_INCREMENT
(&
timedout
);

130 
	`PTE_ATOMIC_INCREMENT
(&
awok’
);

134  
¬g
;

135 
	}
}

137 
	~"../im¶em’t.h
"

139 
	$±h»ad_‹¡_cÚdv¬3_2
()

141 
i
;

142 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

143 
»suÉ
 = 0;

144 
_timeb
 
cu¼SysTime
;

145 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

147 
timedout
 = 0;

148 
awok’
 = 0;

151 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
cv
, 
NULL
) == 0);

153 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
) == 0);

156 
	`_áime
(&
cu¼SysTime
);

158 
ab¡ime
.
tv_£c
 =‡b¡ime.tv_£øğ
cu¼SysTime
.
time
 + 5;

159 
ab¡ime
.
tv_n£c
 = 
ab¡ime2
.tv_n£øğ
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

161 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

163 
i
 = 1; i <ğ
NUMTHREADS
; i++)

165 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*) i) == 0);

168 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

170 
i
 = 1; i <ğ
NUMTHREADS
; i++)

172 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], (**è&
»suÉ
) == 0);

173 
	`as£¹
(
»suÉ
 =ğ
i
);

183 ià(
	`PTE_ATOMIC_EXCHANGE_ADD
(&
awok’
, 0Lè> 
NUMTHREADS
/3)

185 
	`as£¹
(
	`±h»ad_cÚd_brßdÿ¡
(&
cv
) == 0);

192 
	`as£¹
(
awok’
 =ğ
NUMTHREADS
 - 
timedout
);

195 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cv
) == 0);

198 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

201 
	}
}

	@tests/condvar3_3.c

84 
	~"‹¡.h
"

87 
±h»ad_cÚd_t
 
	gúd
;

88 
±h»ad_mu‹x_t
 
	gmtx
;

90 
	$±h»ad_‹¡_cÚdv¬3_3
()

92 
rc
;

94 
time¥ec
 
ab¡ime
 =

98 
_timeb
 
cu¼SysTime
;

99 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

101 
	`as£¹
(
	`±h»ad_cÚd_š™
(&
úd
, 0) == 0);

102 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mtx
, 0) == 0);

105 
	`_áime
(&
cu¼SysTime
);

107 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

108 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

109 
ab¡ime
.
tv_£c
 += 1;

113 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mtx
) == 0);

115 
	`as£¹
((
rc
 = 
	`±h»ad_cÚd_timedwa™
(&
úd
, &
mtx
, &
ab¡ime
)è=ğ
ETIMEDOUT
);

118 
rc
 =„c;

120 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mtx
) == 0);

128 
	`as£¹
((
rc
 = 
	`±h»ad_cÚd_sigÇl
(&
úd
)) == 0);

131 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mtx
) == 0);

133 
	`_áime
(&
cu¼SysTime
);

134 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

135 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

136 
ab¡ime
.
tv_£c
 += 1;

138 
	`as£¹
((
rc
 = 
	`±h»ad_cÚd_timedwa™
(&
úd
, &
mtx
, &
ab¡ime
)è=ğ
ETIMEDOUT
);

139 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mtx
) == 0);

141 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
úd
) == 0);

142 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mtx
) == 0);

145 
	}
}

	@tests/condvar4.c

83 
	~"‹¡.h
"

85 
cvthšg_t_
 
	tcvthšg_t
;

87 
	scvthšg_t_


89 
±h»ad_cÚd_t
 
	mnÙbusy
;

90 
±h»ad_mu‹x_t
 
	mlock
;

91 
	msh¬ed
;

94 
cvthšg_t
 
	gcvthšg
 =

96 
PTHREAD_COND_INITIALIZER
,

97 
PTHREAD_MUTEX_INITIALIZER
,

103 
	mNUMTHREADS
 = 2

107 
	$myth»ad
(* 
¬g
)

109 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

110 
cvthšg
.
sh¬ed
++;

111 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

113 
	`as£¹
(
	`±h»ad_cÚd_sigÇl
(&
cvthšg
.
nÙbusy
) == 0);

116 
	}
}

118 
	$±h»ad_‹¡_cÚdv¬4
()

120 
±h»ad_t
 
t
[
NUMTHREADS
];

121 
time¥ec
 
ab¡ime
 =

125 
_timeb
 
cu¼SysTime
;

126 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

128 
cvthšg
.
sh¬ed
 = 0;

130 
cvthšg
.
nÙbusy
 = 
PTHREAD_COND_INITIALIZER
;

131 
cvthšg
.
lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

134 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

136 
	`as£¹
(
cvthšg
.
nÙbusy
 =ğ
PTHREAD_COND_INITIALIZER
);

138 
	`as£¹
(
cvthšg
.
lock
 =ğ
PTHREAD_MUTEX_INITIALIZER
);

140 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

142 
	`as£¹
(
cvthšg
.
lock
 !ğ
PTHREAD_MUTEX_INITIALIZER
);

145 
	`_áime
(&
cu¼SysTime
);

147 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

148 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

150 
ab¡ime
.
tv_£c
 += 5;

152 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cvthšg
.
nÙbusy
, &cvthšg.
lock
, &
ab¡ime
è=ğ
ETIMEDOUT
);

153 
	`as£¹
(
cvthšg
.
nÙbusy
 !ğ
PTHREAD_COND_INITIALIZER
);

155 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[1], 
NULL
, 
myth»ad
, (*) 1) == 0);

157 
	`_áime
(&
cu¼SysTime
);

159 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

160 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

162 
ab¡ime
.
tv_£c
 += 5;

164 ! (
cvthšg
.
sh¬ed
 > 0))

165 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cvthšg
.
nÙbusy
, &cvthšg.
lock
, &
ab¡ime
) == 0);

167 
	`as£¹
(
cvthšg
.
sh¬ed
 > 0);

169 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

171 
	`as£¹
(
	`±h»ad_još
(
t
[1], 
NULL
) == 0);

172 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
cvthšg
.
lock
) == 0);

174 
	`as£¹
(
cvthšg
.
lock
 =ğ
NULL
);

176 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cvthšg
.
nÙbusy
) == 0);

178 
	`as£¹
(&(
cvthšg
.
nÙbusy
è=ğ
NULL
);

181 
	}
}

	@tests/condvar5.c

82 
	~"‹¡.h
"

85 
cvthšg_t_
 
	tcvthšg_t
;

87 
	scvthšg_t_


89 
±h»ad_cÚd_t
 
	mnÙbusy
;

90 
±h»ad_mu‹x_t
 
	mlock
;

91 
	msh¬ed
;

94 
cvthšg_t
 
	gcvthšg
 =

96 
PTHREAD_COND_INITIALIZER
,

97 
PTHREAD_MUTEX_INITIALIZER
,

103 
	mNUMTHREADS
 = 2

107 
	$myth»ad
(* 
¬g
)

109 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

110 
cvthšg
.
sh¬ed
++;

111 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

113 
	`as£¹
(
	`±h»ad_cÚd_brßdÿ¡
(&
cvthšg
.
nÙbusy
) == 0);

116 
	}
}

118 
	$±h»ad_‹¡_cÚdv¬5
()

120 
±h»ad_t
 
t
[
NUMTHREADS
];

121 
time¥ec
 
ab¡ime
 =

125 
_timeb
 
cu¼SysTime
;

126 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

129 
cvthšg
.
lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

131 
	`±h»ad_cÚd_š™
(&
cvthšg
.
nÙbusy
,
NULL
);

132 
cvthšg
.
sh¬ed
 = 0;

134 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

138 
	`as£¹
(
cvthšg
.
lock
 =ğ
PTHREAD_MUTEX_INITIALIZER
);

140 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

142 
	`as£¹
(
cvthšg
.
lock
 !ğ
PTHREAD_MUTEX_INITIALIZER
);

145 
	`_áime
(&
cu¼SysTime
);

147 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

148 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

150 
ab¡ime
.
tv_£c
 += 5;

152 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cvthšg
.
nÙbusy
, &cvthšg.
lock
, &
ab¡ime
è=ğ
ETIMEDOUT
);

156 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[1], 
NULL
, 
myth»ad
, (*) 1) == 0);

158 
	`_áime
(&
cu¼SysTime
);

160 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

161 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

163 
ab¡ime
.
tv_£c
 += 5;

165 ! (
cvthšg
.
sh¬ed
 > 0))

166 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cvthšg
.
nÙbusy
, &cvthšg.
lock
, &
ab¡ime
) == 0);

168 
	`as£¹
(
cvthšg
.
sh¬ed
 > 0);

170 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

172 
	`as£¹
(
	`±h»ad_još
(
t
[1], 
NULL
) == 0);

174 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
cvthšg
.
lock
) == 0);

176 
	`as£¹
(
cvthšg
.
lock
 =ğ
NULL
);

178 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cvthšg
.
nÙbusy
) == 0);

180 
	`as£¹
(&
cvthšg
.
nÙbusy
 =ğ
NULL
);

183 
	}
}

	@tests/condvar6.c

81 
	~"‹¡.h
"

89 
	mNUMTHREADS
 = 5

92 
bag_t_
 
	tbag_t
;

93 
	sbag_t_


95 
	mth»adnum
;

96 
	m¡¬‹d
;

100 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

102 
cvthšg_t_
 
	tcvthšg_t
;

104 
	scvthšg_t_


106 
±h»ad_cÚd_t
 
	mnÙbusy
;

107 
±h»ad_mu‹x_t
 
	mlock
;

108 
	msh¬ed
;

111 
cvthšg_t
 
	gcvthšg
 =

113 
PTHREAD_COND_INITIALIZER
,

114 
PTHREAD_MUTEX_INITIALIZER
,

118 
±h»ad_mu‹x_t
 
	g¡¬t_æag
 = 
PTHREAD_MUTEX_INITIALIZER
;

120 
time¥ec
 
	gab¡ime
 =

125 
	gawok’
;

128 
	$myth»ad
(* 
¬g
)

130 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

131 
_timeb
 
cu¼SysTime
;

132 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

134 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

135 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

136 
bag
->
¡¬‹d
 = 1;

139 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
¡¬t_æag
) == 0);

140 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
¡¬t_æag
) == 0);

142 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

144 ! (
cvthšg
.
sh¬ed
 > 0))

146 
	`_áime
(&
cu¼SysTime
);

148 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

149 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

151 
ab¡ime
.
tv_£c
 += 5;

153 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cvthšg
.
nÙbusy
, &cvthšg.
lock
, &
ab¡ime
) == 0);

156 
	`as£¹
(
cvthšg
.
sh¬ed
 > 0);

158 
awok’
++;

160 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

163 
	}
}

165 
	$±h»ad_‹¡_cÚdv¬6
()

167 
çed
 = 0;

168 
i
;

169 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

172 
¡¬t_æag
 = 
PTHREAD_MUTEX_INITIALIZER
;

174 
cvthšg
.
lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

176 
	`±h»ad_cÚd_š™
(&
cvthšg
.
nÙbusy
, 
NULL
);

178 
cvthšg
.
sh¬ed
 = 0;

180 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

184 
	`as£¹
(
cvthšg
.
lock
 =ğ
PTHREAD_MUTEX_INITIALIZER
);

186 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
¡¬t_æag
) == 0);

190 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

192 
awok’
 = 0;

194 
i
 = 1; i <ğ
NUMTHREADS
; i++)

196 
th»adbag
[
i
].
¡¬‹d
 = 0;

197 
th»adbag
[
i
].
th»adnum
 = i;

198 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

205 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
¡¬t_æag
) == 0);

210 
	`±e_osTh»adSË•
(1000);

212 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

213 
cvthšg
.
sh¬ed
++;

214 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

216 
	`as£¹
(
	`±h»ad_cÚd_brßdÿ¡
(&
cvthšg
.
nÙbusy
) == 0);

221 
i
 = 1; i <ğ
NUMTHREADS
; i++)

223 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], 
NULL
) == 0);

230 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
cvthšg
.
lock
) == 0);

232 
	`as£¹
(
cvthšg
.
lock
 =ğ
NULL
);

234 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cvthšg
.
nÙbusy
) == 0);

241 
i
 = 1; i <ğ
NUMTHREADS
; i++)

243 
çed
 = !
th»adbag
[
i
].
¡¬‹d
;

246 
	`as£¹
(!
çed
);

252 
	`as£¹
(
awok’
 =ğ
NUMTHREADS
);

254 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
¡¬t_æag
) == 0);

260 
	}
}

	@tests/condvar7.c

80 
	~"‹¡.h
"

88 
	mNUMTHREADS
 = 5

91 
bag_t_
 
	tbag_t
;

92 
	sbag_t_


94 
	mth»adnum
;

95 
	m¡¬‹d
;

99 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

101 
cvthšg_t_
 
	tcvthšg_t
;

103 
	scvthšg_t_


105 
±h»ad_cÚd_t
 
	mnÙbusy
;

106 
±h»ad_mu‹x_t
 
	mlock
;

107 
	msh¬ed
;

110 
cvthšg_t
 
	gcvthšg
 =

112 
PTHREAD_COND_INITIALIZER
,

113 
PTHREAD_MUTEX_INITIALIZER
,

117 
±h»ad_mu‹x_t
 
	g¡¬t_æag
 = 
PTHREAD_MUTEX_INITIALIZER
;

119 
time¥ec
 
	gab¡ime
 =

124 
	gawok’
;

127 
	$myth»ad
(* 
¬g
)

129 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

131 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

132 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

133 
bag
->
¡¬‹d
 = 1;

136 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
¡¬t_æag
) == 0);

137 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
¡¬t_æag
) == 0);

139 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

141 
	`±h»ad_ş—nup_push
(
±h»ad_mu‹x_uÆock
, (*è&
cvthšg
.
lock
);

143 ! (
cvthšg
.
sh¬ed
 > 0))

145 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cvthšg
.
nÙbusy
, &cvthšg.
lock
, &
ab¡ime
) == 0);

148 
	`±h»ad_ş—nup_pİ
(0);

150 
	`as£¹
(
cvthšg
.
sh¬ed
 > 0);

152 
awok’
++;

154 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

157 
	}
}

159 
	$±h»ad_‹¡_cÚdv¬7
()

161 
çed
 = 0;

162 
i
;

163 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

165 
_timeb
 
cu¼SysTime
;

166 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

169 
cvthšg
.
lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

171 
cvthšg
.
sh¬ed
 = 0;

173 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

177 
	`±h»ad_cÚd_š™
(&
cvthšg
.
nÙbusy
, 
NULL
);

179 
	`as£¹
(
cvthšg
.
lock
 =ğ
PTHREAD_MUTEX_INITIALIZER
);

181 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
¡¬t_æag
) == 0);

183 
	`_áime
(&
cu¼SysTime
);

185 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

186 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

188 
ab¡ime
.
tv_£c
 += 10;

190 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

192 
awok’
 = 0;

194 
i
 = 1; i <ğ
NUMTHREADS
; i++)

196 
th»adbag
[
i
].
¡¬‹d
 = 0;

197 
th»adbag
[
i
].
th»adnum
 = i;

198 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

205 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
¡¬t_æag
) == 0);

210 
	`±e_osTh»adSË•
(1000);

215 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[1]) == 0);

216 
	`as£¹
(
	`±h»ad_još
(
t
[1], 
NULL
) == 0);

218 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

219 
cvthšg
.
sh¬ed
++;

220 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

225 
	`as£¹
(
	`±h»ad_cÚd_brßdÿ¡
(&
cvthšg
.
nÙbusy
) == 0);

230 
i
 = 2; i <ğ
NUMTHREADS
; i++)

231 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], 
NULL
) == 0);

237 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
cvthšg
.
lock
) == 0);

239 
	`as£¹
(
cvthšg
.
lock
 =ğ
NULL
);

241 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cvthšg
.
nÙbusy
) == 0);

248 
i
 = 1; i <ğ
NUMTHREADS
; i++)

250 
çed
 = !
th»adbag
[
i
].
¡¬‹d
;

253 
	`as£¹
(!
çed
);

259 
	`as£¹
(
awok’
 =ğ(
NUMTHREADS
 - 1));

265 
	}
}

	@tests/condvar8.c

80 
	~"‹¡.h
"

88 
	mNUMTHREADS
 = 5

91 
bag_t_
 
	tbag_t
;

92 
	sbag_t_


94 
	mth»adnum
;

95 
	m¡¬‹d
;

99 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

101 
cvthšg_t_
 
	tcvthšg_t
;

103 
	scvthšg_t_


105 
±h»ad_cÚd_t
 
	mnÙbusy
;

106 
±h»ad_mu‹x_t
 
	mlock
;

107 
	msh¬ed
;

110 
cvthšg_t
 
	gcvthšg
 =

112 
PTHREAD_COND_INITIALIZER
,

113 
PTHREAD_MUTEX_INITIALIZER
,

117 
±h»ad_mu‹x_t
 
	g¡¬t_æag
 = 
PTHREAD_MUTEX_INITIALIZER
;

119 
time¥ec
 
	gab¡ime
 =

124 
	gawok’
;

127 
	$myth»ad
(* 
¬g
)

129 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

131 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

132 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

133 
bag
->
¡¬‹d
 = 1;

136 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
¡¬t_æag
) == 0);

137 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
¡¬t_æag
) == 0);

139 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

141 
	`±h»ad_ş—nup_push
(
±h»ad_mu‹x_uÆock
, (*è&
cvthšg
.
lock
);

143 ! (
cvthšg
.
sh¬ed
 > 0))

144 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cvthšg
.
nÙbusy
, &cvthšg.
lock
, &
ab¡ime
) == 0);

146 
	`±h»ad_ş—nup_pİ
(0);

148 
	`as£¹
(
cvthšg
.
sh¬ed
 > 0);

150 
awok’
++;

152 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

155 
	}
}

157 
	$±h»ad_‹¡_cÚdv¬8
()

159 
çed
 = 0;

160 
i
;

161 
fœ¡
, 
Ï¡
;

162 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

164 
_timeb
 
cu¼SysTime
;

165 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

168 
	`±h»ad_cÚd_š™
(&
cvthšg
.
nÙbusy
, 
NULL
);

169 
cvthšg
.
lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

170 
¡¬t_æag
 = 
PTHREAD_MUTEX_INITIALIZER
;

172 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

176 
	`as£¹
(
cvthšg
.
lock
 =ğ
PTHREAD_MUTEX_INITIALIZER
);

178 
	`_áime
(&
cu¼SysTime
);

180 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

181 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

183 
ab¡ime
.
tv_£c
 += 10;

185 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

187 
awok’
 = 0;

189 
fœ¡
 = 1, 
Ï¡
 = 
NUMTHREADS
 / 2;

190 
fœ¡
 < 
NUMTHREADS
;

191 
fœ¡
 = 
Ï¡
 + 1,†a¡ = 
NUMTHREADS
)

193 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
¡¬t_æag
) == 0);

195 
i
 = 
fœ¡
; i <ğ
Ï¡
; i++)

197 
th»adbag
[
i
].
¡¬‹d
 = 0;

198 
th»adbag
[
i
].
th»adnum
 = i;

199 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

205 
cvthšg
.
sh¬ed
 = 0;

207 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
¡¬t_æag
) == 0);

212 
	`±e_osTh»adSË•
(100);

214 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

215 
cvthšg
.
sh¬ed
++;

216 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

218 
	`as£¹
(
	`±h»ad_cÚd_brßdÿ¡
(&
cvthšg
.
nÙbusy
) == 0);

223 
i
 = 
fœ¡
; i <ğ
Ï¡
; i++)

225 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], 
NULL
) == 0);

228 
	`as£¹
(
awok’
 =ğ(
i
 - 1));

235 
i
 = 1; i <ğ
NUMTHREADS
; i++)

237 
çed
 = !
th»adbag
[
i
].
¡¬‹d
;

244 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
cvthšg
.
lock
) == 0);

246 
	`as£¹
(
cvthšg
.
lock
 =ğ
NULL
);

248 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cvthšg
.
nÙbusy
) == 0);

252 
	`as£¹
(!
çed
);

258 
	`as£¹
(
awok’
 =ğ
NUMTHREADS
);

260 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
¡¬t_æag
) == 0);

266 
	}
}

	@tests/condvar9.c

81 
	~"‹¡.h
"

89 
	mNUMTHREADS
 = 9

92 
bag_t_
 
	tbag_t
;

93 
	sbag_t_


95 
	mth»adnum
;

96 
	m¡¬‹d
;

97 
	mfšished
;

101 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

103 
cvthšg_t_
 
	tcvthšg_t
;

105 
	scvthšg_t_


107 
±h»ad_cÚd_t
 
	mnÙbusy
;

108 
±h»ad_mu‹x_t
 
	mlock
;

109 
	msh¬ed
;

112 
cvthšg_t
 
	gcvthšg
 =

114 
PTHREAD_COND_INITIALIZER
,

115 
PTHREAD_MUTEX_INITIALIZER
,

119 
±h»ad_mu‹x_t
 
	g¡¬t_æag
 = 
PTHREAD_MUTEX_INITIALIZER
;

121 
time¥ec
 
	gab¡ime
 =

126 
	gawok’
;

129 
	$myth»ad
(* 
¬g
)

131 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

133 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

134 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

135 
bag
->
¡¬‹d
 = 1;

138 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
¡¬t_æag
) == 0);

139 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
¡¬t_æag
) == 0);

141 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

147 
	`±h»ad_ş—nup_push
(
±h»ad_mu‹x_uÆock
, (*è&
cvthšg
.
lock
);

149 ! (
cvthšg
.
sh¬ed
 > 0))

150 
	`as£¹
(
	`±h»ad_cÚd_timedwa™
(&
cvthšg
.
nÙbusy
, &cvthšg.
lock
, &
ab¡ime
) == 0);

152 
	`±h»ad_ş—nup_pİ
(0);

154 
	`as£¹
(
cvthšg
.
sh¬ed
 > 0);

156 
awok’
++;

157 
bag
->
fšished
 = 1;

159 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

162 
	}
}

164 
	$±h»ad_‹¡_cÚdv¬9
()

166 
çed
 = 0;

167 
i
;

168 
fœ¡
, 
Ï¡
;

169 
ÿnûËdTh»ads
 = 0;

170 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

172 
_timeb
 
cu¼SysTime
;

173 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

176 
	`±h»ad_cÚd_š™
(&
cvthšg
.
nÙbusy
, 
NULL
);

177 
cvthšg
.
lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

179 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

183 
	`as£¹
(
cvthšg
.
lock
 =ğ
PTHREAD_MUTEX_INITIALIZER
);

185 
	`_áime
(&
cu¼SysTime
);

187 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

188 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

190 
ab¡ime
.
tv_£c
 += 5;

192 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

194 
awok’
 = 0;

196 
fœ¡
 = 1, 
Ï¡
 = 
NUMTHREADS
 / 2;

197 
fœ¡
 < 
NUMTHREADS
;

198 
fœ¡
 = 
Ï¡
 + 1,†a¡ = 
NUMTHREADS
)

200 
ù
;

202 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
¡¬t_æag
) == 0);

204 
i
 = 
fœ¡
; i <ğ
Ï¡
; i++)

206 
th»adbag
[
i
].
¡¬‹d
 =h»adbag[i].
fšished
 = 0;

207 
th»adbag
[
i
].
th»adnum
 = i;

208 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

214 
cvthšg
.
sh¬ed
 = 0;

216 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
¡¬t_æag
) == 0);

221 
	`±e_osTh»adSË•
(1000);

223 
ù
 = (
fœ¡
 + 
Ï¡
) / 2;

224 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[
ù
]) == 0);

225 
ÿnûËdTh»ads
++;

226 
	`as£¹
(
	`±h»ad_još
(
t
[
ù
], 
NULL
) == 0);

228 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cvthšg
.
lock
) == 0);

229 
cvthšg
.
sh¬ed
++;

230 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cvthšg
.
lock
) == 0);

232 
	`as£¹
(
	`±h»ad_cÚd_brßdÿ¡
(&
cvthšg
.
nÙbusy
) == 0);

237 
i
 = 
fœ¡
; i <ğ
Ï¡
; i++)

239 
çed
 = !
th»adbag
[
i
].
¡¬‹d
;

241 ià(!
çed
)

243 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], 
NULL
è=ğ0 || 
th»adbag
[i].
fšished
 == 0);

252 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
cvthšg
.
lock
) == 0);

254 
	`as£¹
(
cvthšg
.
lock
 =ğ
NULL
);

256 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cvthšg
.
nÙbusy
) == 0);

260 
	`as£¹
(!
çed
);

266 
	`as£¹
(
awok’
 =ğ
NUMTHREADS
 - 
ÿnûËdTh»ads
);

272 
	}
}

	@tests/count1.c

49 
	~"‹¡.h
"

51 
	#NUMTHREADS
 
OS_MAX_SIMUL_THREADS


	)

53 
±h»ad_mu‹x_t
 
	glock
 = 
PTHREAD_MUTEX_INITIALIZER
;

54 
±h»ad_t
 
	gth»ads
[
NUMTHREADS
];

55 
	gnumTh»ads
 = 0;

58 
	$myfunc
(*
¬g
)

60 
	`±h»ad_mu‹x_lock
(&
lock
);

61 
numTh»ads
++;

62 
	`±h»ad_mu‹x_uÆock
(&
lock
);

64 
	`±e_osTh»adSË•
(1000);

66 
	}
}

68 
	$±h»ad_‹¡_couÁ1
()

70 
i
;

71 
maxTh»ads
 = (
th»ads
è/ (
±h»ad_t
);

73 
numTh»ads
 = 0;

75 
lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

81 
i
 = 0; i < 
maxTh»ads
; i++)

83 
	`as£¹
(
	`±h»ad_ü—‹
(&
th»ads
[
i
], 
NULL
, 
myfunc
, 0) == 0);

89 
i
 = 0; i < 
maxTh»ads
; i++)

91 
	`as£¹
(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) == 0);

97 
	`as£¹
((è
numTh»ads
 =ğ
maxTh»ads
);

99 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
lock
) == 0);

105 
	}
}

	@tests/create1.c

50 
	~"‹¡.h
"

52 
	gwash”e
 = 0;

54 * 
	$func
(* 
¬g
)

56 
wash”e
 = 1;

58 
	}
}

60 
	$±h»ad_‹¡_ü—‹1
()

62 
±h»ad_t
 
t
;

64 
wash”e
 = 0;

66 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

70 
	`±e_osTh»adSË•
(2000);

72 
	`as£¹
(
wash”e
 == 1);

74 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

77 
	}
}

	@tests/create2.c

80 
	~"‹¡.h
"

84 
	mNUMTHREADS
 = 100

87 vŞ©
	gwash”e
 = 0;

89 * 
	$func
(* 
¬g
)

92 
wash”e
++;

94 
	}
}

96 
	$±h»ad_‹¡_ü—‹2
()

98 
±h»ad_t
 
t
;

99 
±h»ad_©Œ_t
 
©Œ
;

100 * 
»suÉ
 = 
NULL
;

101 
i
;

103 
wash”e
 = 0;

105 
	`±h»ad_©Œ_š™
(&
©Œ
);

106 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

108 
i
 = 0; i < 
NUMTHREADS
; i++)

110 
wash”e
 = 0;

111 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, &
©Œ
, 
func
, 
NULL
) == 0);

112 
	`±h»ad_još
(
t
, &
»suÉ
);

113 
	`as£¹
(
wash”e
 == 1);

117 
	}
}

	@tests/create3.c

80 #ifdeà
__GNUC__


84 
	~"‹¡.h
"

91 
	mNUMTHREADS
 = 10

96 
	$th»adFunc
(* 
¬g
)

99 
	}
}

101 
	$±h»ad_‹¡_ü—‹3
()

103 
i
;

104 
±h»ad_t
 
mt
;

105 
±h»ad_t
 
t
[
NUMTHREADS
];

107 
	`as£¹
((
mt
 = 
	`±h»ad_£lf
()è!ğ
NULL
);

111 
i
 = 0; i < 
NUMTHREADS
; i++)

113 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
th»adFunc
, NULL) == 0);

116 
i
 = 0; i < 
NUMTHREADS
; i++)

118 
	`as£¹
(
	`±h»ad_još
(
t
[
i
],
NULL
) == 0);

125 
	}
}

	@tests/delay1.c

46 
	~"‹¡.h
"

48 
	$±h»ad_‹¡_d–ay1
()

50 
time¥ec
 
š‹rv®
 =

55 
	`±h»ad_d–ay_Å
(&
š‹rv®
);

57 
	`as£¹
(
	`±h»ad_d–ay_Å
(&
š‹rv®
) == 0);

60 
	}
}

	@tests/delay2.c

46 
	~"‹¡.h
"

48 
±h»ad_mu‹x_t
 
	gmx
 = 
PTHREAD_MUTEX_INITIALIZER
;

51 
	$func
(* 
¬g
)

53 
time¥ec
 
š‹rv®
 =

58 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mx
) == 0);

60 
	`±h»ad_ş—nup_push
(
±h»ad_mu‹x_uÆock
, &
mx
);

61 
	`as£¹
(
	`±h»ad_d–ay_Å
(&
š‹rv®
) == 0);

62 
	`±h»ad_ş—nup_pİ
(1);

65 
	}
}

67 
	$±h»ad_‹¡_d–ay2
()

69 
±h»ad_t
 
t
;

70 
»suÉ
 = 0;

72 
mx
 = 
PTHREAD_MUTEX_INITIALIZER
;

74 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mx
) == 0);

76 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

77 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
) == 0);

79 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mx
) == 0);

81 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

82 
	`as£¹
(
»suÉ
 =ğ(è
PTHREAD_CANCELED
);

84 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mx
) == 0);

87 
	}
}

	@tests/detach1.c

45 
	~"‹¡.h
"

50 
	mNUMTHREADS
 = 20

54 
	$func
(* 
¬g
)

56 
i
 = (è
¬g
;

58 
	`±e_osTh»adSË•
(
i
 * 10);

60 
	`±h»ad_ex™
(
¬g
);

63 
	`ex™
(1);

66  
NULL
;

67 
	}
}

69 
	$±h»ad_‹¡_d‘ach1
()

71 
±h»ad_t
 
id
[
NUMTHREADS
];

72 
i
;

75 
i
 = 0; i < 
NUMTHREADS
; i++)

77 
	`as£¹
(
	`±h»ad_ü—‹
(&
id
[
i
], 
NULL
, 
func
, (*) i) == 0);

82 
	`±e_osTh»adSË•
(
NUMTHREADS
/2 * 10 + 50);

84 
i
 = 0; i < 
NUMTHREADS
; i++)

86 
	`as£¹
(
	`±h»ad_d‘ach
(
id
[
i
]) == 0);

89 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 10 + 1000);

96 
i
 = 0; i < 
NUMTHREADS
; i++)

98 
	`as£¹
(
	`±h»ad_kl
(
id
[
i
], 0è=ğ
ESRCH
);

103 
	}
}

	@tests/equal1.c

45 
	~"‹¡.h
"

47 * 
	$func
(* 
¬g
)

49 
	`±e_osTh»adSË•
(2000);

51 
	}
}

53 
	$±h»ad_‹¡_equ®1
()

55 
±h»ad_t
 
t1
, 
t2
;

57 
	`as£¹
(
	`±h»ad_ü—‹
(&
t1
, 
NULL
, 
func
, (*) 1) == 0);

59 
	`as£¹
(
	`±h»ad_ü—‹
(&
t2
, 
NULL
, 
func
, (*) 2) == 0);

61 
	`as£¹
(
	`±h»ad_equ®
(
t1
, 
t2
) == 0);

63 
	`as£¹
(
	`±h»ad_equ®
(
t1
,t1) != 0);

65 
	`as£¹
(
	`±h»ad_još
(
t1
,
NULL
) == 0);

66 
	`as£¹
(
	`±h»ad_još
(
t2
,
NULL
) == 0);

70 
	}
}

	@tests/errno1.c

80 
	~"‹¡.h
"

87 
	mNUMTHREADS
 = 3

90 
bag_t_
 
	tbag_t
;

91 
	sbag_t_


93 
	mth»adnum
;

94 
	m¡¬‹d
;

98 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

100 
±h»ad_mu‹x_t
 
	g¡İ_h”e
 = 
PTHREAD_MUTEX_INITIALIZER
;

103 
	$myth»ad
(* 
¬g
)

105 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

107 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

108 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

109 
bag
->
¡¬‹d
 = 1;

111 
”ºo
 = 
bag
->
th»adnum
;

113 
	`±e_osTh»adSË•
(1000);

115 
	`±h»ad_mu‹x_lock
(&
¡İ_h”e
);

117 
	`as£¹
(
”ºo
 =ğ
bag
->
th»adnum
);

119 
	`±h»ad_mu‹x_uÆock
(&
¡İ_h”e
);

121 
	`±e_osTh»adSË•
(1000);

124 
	}
}

126 
	$±h»ad_‹¡_”ºo1
()

128 
çed
 = 0;

129 
i
;

130 
±h»ad_t
 
t
[
NUMTHREADS
 + 1];

132 
	`±h»ad_mu‹x_lock
(&
¡İ_h”e
);

133 
”ºo
 = 0;

135 
	`as£¹
((
t
[0] = 
	`±h»ad_£lf
()è!ğ
NULL
);

137 
i
 = 1; i <ğ
NUMTHREADS
; i++)

139 
th»adbag
[
i
].
¡¬‹d
 = 0;

140 
th»adbag
[
i
].
th»adnum
 = i;

141 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
myth»ad
, (*è&
th»adbag
[i]) == 0);

147 
	`±e_osTh»adSË•
(2000);

148 
	`±h»ad_mu‹x_uÆock
(&
¡İ_h”e
);

153 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 1000);

158 
i
 = 1; i <ğ
NUMTHREADS
; i++)

160 
çed
 = !
th»adbag
[
i
].
¡¬‹d
;

163 
	`as£¹
(!
çed
);

168 
i
 = 1; i <ğ
NUMTHREADS
; i++)

173 
	`as£¹
(!
çed
);

179 
	}
}

	@tests/exception1.c

76 
	~"‹¡.h
"

78 #ià
defšed
(
__ılu¥lus
è&& defšed(
PTE_SUPPORT_ASYNC_CANCEL
)

84 
	mNUMTHREADS
 = 4

88 
	$exû±iÚedTh»ad
(* 
¬g
)

90 
dummy
 = 0;

91 
»suÉ
 = (()
PTHREAD_CANCELED
 + 1);

94 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

96 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
) == 0);

98 
	`±e_osTh»adSË•
(100);

100 
Œy


107 
throw
 
dummy
;

109 
	`ÿtch
 (...)

112 
»suÉ
 = (()
PTHREAD_CANCELED
 + 2);

115  (*è
»suÉ
;

116 
	}
}

119 
	$ÿnûËdTh»ad
(* 
¬g
)

121 
»suÉ
 = (()
PTHREAD_CANCELED
 + 1);

122 
couÁ
;

127 
	`as£¹
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
) == 0);

129 
	`as£¹
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
) == 0);

131 
Œy


137 
couÁ
 = 0; count < 100; count++)

138 
	`±e_osTh»adSË•
(100);

140 
	`ÿtch
 (...)

143 
»suÉ
 = (()
PTHREAD_CANCELED
 + 2);

146  (*è
»suÉ
;

147 
	}
}

151 
	$±h»ad_‹¡_exû±iÚ1
()

153 
çed
 = 0;

154 
i
;

155 
±h»ad_t
 
mt
;

156 
±h»ad_t
 
‘
[
NUMTHREADS
];

157 
±h»ad_t
 
ù
[
NUMTHREADS
];

159 
	`as£¹
((
mt
 = 
	`±h»ad_£lf
()).
p
 !ğ
NULL
);

161 
i
 = 0; i < 
NUMTHREADS
; i++)

163 
	`as£¹
(
	`±h»ad_ü—‹
(&
‘
[
i
], 
NULL
, 
exû±iÚedTh»ad
, (*) 0) == 0);

164 
	`as£¹
(
	`±h»ad_ü—‹
(&
ù
[
i
], 
NULL
, 
ÿnûËdTh»ad
, NULL) == 0);

170 
	`±e_osTh»adSË•
(1000);

172 
i
 = 0; i < 
NUMTHREADS
; i++)

174 
	`as£¹
(
	`±h»ad_ÿnûl
(
ù
[
i
]) == 0);

180 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 1000);

185 
çed
 = 0;

186 
i
 = 0; i < 
NUMTHREADS
; i++)

188 
ç
 = 0;

189 
»suÉ
 = 0;

192 
	`as£¹
(
	`±h»ad_još
(
ù
[
i
], (**è&
»suÉ
) == 0);

193 
	`as£¹
(!(
ç
 = (
»suÉ
 !ğ(è
PTHREAD_CANCELED
)));

195 
çed
 = (çed || 
ç
);

198 
	`as£¹
(
	`±h»ad_još
(
‘
[
i
], (**è&
»suÉ
) == 0);

199 
	`as£¹
(!(
ç
 = (
»suÉ
 !ğ((è
PTHREAD_CANCELED
 + 2))));

201 
çed
 = (çed || 
ç
);

204 
	`as£¹
(!
çed
);

210 
	}
}

215 
	$±h»ad_‹¡_exû±iÚ1
()

217 
	`´štf
("Test N/A forhis compilerƒnvironment.\n");

219 
	}
}

	@tests/exception2.c

75 #ià
defšed
(
__ılu¥lus
)

77 
	~<exû±iÚ
>

78 
	~<Ãw
>

80 #ifdeà
__GNUC__


84 
	~"‹¡.h
"

90 
	mNUMTHREADS
 = 1

94 
	$exû±iÚedTh»ad
(* 
¬g
)

96 
dummy
 = 0x1;

98 
throw
 
dummy
;

101 
	}
}

105 
	$±h»ad_‹¡_exû±iÚ2
()

107 
i
;

108 
±h»ad_t
 
mt
;

109 
±h»ad_t
 
‘
[
NUMTHREADS
];

111 
¡d
::
	`£t_‹rmš©e
(0);

124 
	`as£¹
((
mt
 = 
	`±h»ad_£lf
()).
p
 !ğ
NULL
);

126 
i
 = 0; i < 
NUMTHREADS
; i++)

128 
	`as£¹
(
	`±h»ad_ü—‹
(&
‘
[
i
], 
NULL
, 
exû±iÚedTh»ad
, NULL) == 0);

131 
	`±e_osTh»adSË•
(1000);

137 
	}
}

141 
	~<¡dio.h
>

144 
	$±h»ad_‹¡_exû±iÚ2
()

146 
	`´štf
("Test N/A forhis compilerƒnvironment.\n");

148 
	}
}

	@tests/exception3.c

74 
	~"‹¡.h
"

76 #ià
defšed
(
__ılu¥lus
)

78 #ià
defšed
(
__GNUC__
) && __GNUC__ < 3

79 
	~<Ãw.h
>

81 
	~<Ãw
>

82 
usšg
 
	g¡d
::
£t_‹rmš©e
;

90 
	mNUMTHREADS
 = 1

93 
	gÿught
 = 0;

94 
±h»ad_mu‹x_t
 
	gÿughtLock
;

99 
	$‹rmš©eFunùiÚ
 ()

101 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
ÿughtLock
) == 0);

102 
ÿught
++;

103 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
ÿughtLock
) == 0);

105 
	`±h»ad_ex™
((*) 0);

106 
	}
}

109 
	$exû±iÚedTh»ad
(* 
¬g
)

111 
dummy
 = 0x1;

113 (è
	`£t_‹rmš©e
(&
‹rmš©eFunùiÚ
);

115 
throw
 
dummy
;

118 
	}
}

121 
	$±h»ad_‹¡_exû±iÚ3
()

123 
i
;

124 
±h»ad_t
 
mt
;

125 
±h»ad_t
 
‘
[
NUMTHREADS
];

126 
±h»ad_mu‹x©Œ_t
 
ma
;

128 
	`as£¹
((
mt
 = 
	`±h»ad_£lf
()).
p
 !ğ
NULL
);

130 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
ma
) == 0);

131 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
ma
, 
PTHREAD_MUTEX_ERRORCHECK
) == 0);

132 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
ÿughtLock
, &
ma
) == 0);

133 
	`as£¹
(
	`±h»ad_mu‹x©Œ_de¡roy
(&
ma
) == 0);

135 
i
 = 0; i < 
NUMTHREADS
; i++)

137 
	`as£¹
(
	`±h»ad_ü—‹
(&
‘
[
i
], 
NULL
, 
exû±iÚedTh»ad
, NULL) == 0);

140 
	`±e_osTh»adSË•
(1000);

142 
	`as£¹
(
ÿught
 =ğ
NUMTHREADS
);

148 
	}
}

152 
	~<¡dio.h
>

155 
	$±h»ad_‹¡_exû±iÚ3
()

157 
	`´štf
("Test N/A forhis compilerƒnvironment.\n");

159 
	}
}

	@tests/exit1.c

45 
	~"‹¡.h
"

47 * 
	$func
(* 
·¿m
)

49 
	`±h»ad_ex™
((*) 0);

52 
	`as£¹
(0);

54 
	}
}

56 
	$±h»ad_‹¡_ex™1
()

58 
±h»ad_t
 
id
;

61 
	`as£¹
(
	`±h»ad_ü—‹
(&
id
, 
NULL
, 
func
, 0) == 0);

64 
	`±e_osTh»adSË•
(1000);

66 
	`as£¹
(
	`±h»ad_još
(
id
,
NULL
) == 0);

69 
	}
}

	@tests/exit2.c

47 
	~"‹¡.h
"

50 
	$func
(* 
¬g
)

52 
	`±h»ad_ex™
(
¬g
);

55 
	`as£¹
(0);

57  
NULL
;

58 
	}
}

60 
	$±h»ad_‹¡_ex™2
()

62 
±h»ad_t
 
t
;

64 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, (*) NULL) == 0);

66 
	`±e_osTh»adSË•
(1000);

68 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

71 
	}
}

	@tests/exit3.c

45 
	~"‹¡.h
"

48 
	$func
(* 
¬g
)

50 
	`±h»ad_ex™
(
¬g
);

53 
	`as£¹
(0);

55  
NULL
;

56 
	}
}

58 
	$±h»ad_‹¡_ex™3
()

60 
±h»ad_t
 
id
[4];

61 
i
;

64 
i
 = 0; i < 4; i++)

66 
	`as£¹
(
	`±h»ad_ü—‹
(&
id
[
i
], 
NULL
, 
func
, (*) i) == 0);

69 
	`±e_osTh»adSË•
(1000);

71 
i
 = 0; i < 4; i++)

73 * 
»tV®ue
;

74 
	`as£¹
(
	`±h»ad_još
(
id
[
i
],&
»tV®ue
) == 0);

75 
	`as£¹
(()
»tV®ue
 =ğ
i
);

80 
	}
}

	@tests/exit4.c

81 
	~"‹¡.h
"

90 
	mNUMTHREADS
 = 5

93 
bag_t_
 
	tbag_t
;

94 
	sbag_t_


96 
	mth»adnum
;

97 
	m¡¬‹d
;

99 
	mcouÁ
;

102 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

105 
	$osTh»ad
(* 
¬g
)

107 
»suÉ
 = 1;

108 
bag_t
 * 
bag
 = *((bag_ˆ**è
¬g
);

110 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

111 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

112 
bag
->
¡¬‹d
 = 1;

117 
	`±h»ad_ex™
((*è
»suÉ
);

120 
	}
}

124 
	$±h»ad_‹¡_ex™4
()

126 
çed
 = 0;

127 
i
;

128 
±e_osTh»adHªdË
 
h
[
NUMTHREADS
 + 1];

130 
i
 = 1; i <ğ
NUMTHREADS
; i++)

132 *
±r
;

139 
th»adbag
[
i
].
¡¬‹d
 = 0;

140 
th»adbag
[
i
].
th»adnum
 = i;

142 
±r
 = &(
th»adbag
[
i
]);

144 
	`±e_osTh»adC»©e
(
osTh»ad
, 4096, 10,

145 &
±r
,

146 &
h
[
i
]);

148 
	`±e_osTh»adS¹
(
h
[
i
]);

155 
	`±e_osTh»adSË•
(500);

160 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 100);

165 
i
 = 1; i <ğ
NUMTHREADS
; i++)

167 ià(!
th»adbag
[
i
].
¡¬‹d
)

169 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

173 
	`as£¹
(!
çed
);

178 
çed
 = 0;

179 
i
 = 1; i <ğ
NUMTHREADS
; i++)

181 
ç
 = 0;

182 
»suÉ
 = 0;

187 
»suÉ
 = 1;

189 
ç
 = (
»suÉ
 != 1);

191 
çed
 = (çed || 
ç
);

194 
	`as£¹
(!
çed
);

200 
	}
}

	@tests/exit5.c

81 
	~"‹¡.h
"

88 
	mNUMTHREADS
 = 4

91 
bag_t_
 
	tbag_t
;

92 
	sbag_t_


94 
	mth»adnum
;

95 
	m¡¬‹d
;

97 
	mcouÁ
;

98 
±h»ad_t
 
	m£lf
;

101 
bag_t
 
	gth»adbag
[
NUMTHREADS
 + 1];

103 
	$osTh»ad
(* 
¬g
)

105 
»suÉ
 = 1;

106 
bag_t
 * 
bag
 = *((bag_ˆ**è
¬g
);

108 
	`as£¹
(
bag
 =ğ&
th»adbag
[bag->
th»adnum
]);

109 
	`as£¹
(
bag
->
¡¬‹d
 == 0);

110 
bag
->
¡¬‹d
 = 1;

112 
	`as£¹
((
bag
->
£lf
 = 
	`±h»ad_£lf
()è!ğ
NULL
);

113 
	`as£¹
(
	`±h»ad_kl
(
bag
->
£lf
, 0) == 0);

118 
	`±h»ad_ex™
((*è
»suÉ
);

121 
	}
}

125 
	$±h»ad_‹¡_ex™5
()

127 
çed
 = 0;

128 
i
;

129 
±e_osTh»adHªdË
 
h
[
NUMTHREADS
 + 1];

131 
i
 = 1; i <ğ
NUMTHREADS
; i++)

133 *
±r
;

135 
th»adbag
[
i
].
¡¬‹d
 = 0;

136 
th»adbag
[
i
].
th»adnum
 = i;

138 
±r
 = &(
th»adbag
[
i
]);

140 
	`±e_osTh»adC»©e
(
osTh»ad
, 4096, 10,

141 &
±r
,

142 &
h
[
i
]);

144 
	`±e_osTh»adS¹
(
h
[
i
]);

150 
	`±e_osTh»adSË•
(500);

156 
	`±e_osTh»adSË•
(
NUMTHREADS
 * 100);

161 
i
 = 1; i <ğ
NUMTHREADS
; i++)

163 ià(!
th»adbag
[
i
].
¡¬‹d
)

165 
çed
 |ğ!
th»adbag
[
i
].
¡¬‹d
;

166 
	`årštf
(
¡d”r
, "Th»ad %d: s¹ed %d\n", 
i
, 
th»adbag
[i].
¡¬‹d
);

170 
	`as£¹
(!
çed
);

175 
çed
 = 0;

176 
i
 = 1; i <ğ
NUMTHREADS
; i++)

178 
ç
 = 0;

179 
»suÉ
 = 0;

184 
»suÉ
 = 1;

186 
	`as£¹
(
th»adbag
[
i
].
£lf
 !ğ
NULL
 && 
	`±h»ad_kl
Ñh»adbag[i].£lf, 0è=ğ
ESRCH
);

188 
ç
 = (
»suÉ
 != 1);

190 ià(
ç
)

192 
	`årštf
(
¡d”r
, "Thread %d: started %d: count %d\n",

193 
i
,

194 
th»adbag
[
i
].
¡¬‹d
,

195 
th»adbag
[
i
].
couÁ
);

197 
çed
 = (çed || 
ç
);

200 
	`as£¹
(!
çed
);

206 
	}
}

	@tests/inherit1.c

80 
	~"‹¡.h
"

84 
	mPTW32TEST_THREAD_INIT_PRIO
 = 0,

85 
	mPTW32TEST_MAXPRIORITIES
 = 512

88 * 
	$func
(* 
¬g
)

90 
pŞicy
;

91 
sched_·¿m
 
·¿m
;

93 
	`as£¹
(
	`±h»ad_g‘sched·¿m
(
	`±h»ad_£lf
(), &
pŞicy
, &
·¿m
) == 0);

95  (*è
·¿m
.
sched_´iÜ™y
;

96 
	}
}

98 
	$±h»ad_‹¡_šh”™1
()

100 
±h»ad_t
 
t
;

101 
±h»ad_t
 
mašTh»ad
 = 
	`±h»ad_£lf
();

102 
±h»ad_©Œ_t
 
©Œ
;

103 
»suÉ
 = 0;

104 
sched_·¿m
 
·¿m
;

105 
sched_·¿m
 
mašP¬am
;

106 
´io
;

107 
pŞicy
;

108 
šh”™sched
 = -1;

110 
	`as£¹
(
	`±h»ad_©Œ_š™
(&
©Œ
) == 0);

111 
	`as£¹
(
	`±h»ad_©Œ_£tšh”™sched
(&
©Œ
, 
PTHREAD_INHERIT_SCHED
) == 0);

112 
	`as£¹
(
	`±h»ad_©Œ_g‘šh”™sched
(&
©Œ
, &
šh”™sched
) == 0);

113 
	`as£¹
(
šh”™sched
 =ğ
PTHREAD_INHERIT_SCHED
);

115 
´io
 = 
	`±e_osTh»adG‘MšPriÜ™y
();

116 
´io
 <ğ
	`±e_osTh»adG‘MaxPriÜ™y
();

117 
´io
++)

119 
mašP¬am
.
sched_´iÜ™y
 = 
´io
;

122 
	`as£¹
(
	`±h»ad_£tsched·¿m
(
mašTh»ad
, 
SCHED_OTHER
, &
mašP¬am
) == 0);

123 
	`as£¹
(
	`±h»ad_g‘sched·¿m
(
mašTh»ad
, &
pŞicy
, &
mašP¬am
) == 0);

124 
	`as£¹
(
pŞicy
 =ğ
SCHED_OTHER
);

126 
	`as£¹
(
mašP¬am
.
sched_´iÜ™y
 =ğ
´io
);

128 
	`±e_osTh»adS‘PriÜ™y
(
	`±e_osTh»adG‘HªdË
(), 
´io
);

130 
	`as£¹
(
	`±e_osTh»adG‘PriÜ™y
(
	`±e_osTh»adG‘HªdË
()è=ğ
´io
);

132 
·¿m
.
sched_´iÜ™y
 = 
´io
;

133 
·¿m
.
sched_´iÜ™y
 <ğ
	`±e_osTh»adG‘MaxPriÜ™y
();

134 
·¿m
.
sched_´iÜ™y
++)

137 
	`as£¹
(
	`±h»ad_©Œ_£tsched·¿m
(&
©Œ
, &
·¿m
) == 0);

138 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, &
©Œ
, 
func
, 
NULL
) == 0);

139 
	`±h»ad_još
(
t
, (**)&
»suÉ
);

140 
	`as£¹
((è
»suÉ
 =ğ
mašP¬am
.
sched_´iÜ™y
);

145 
	}
}

	@tests/join0.c

45 
	~"‹¡.h
"

48 
	$func
(* 
¬g
)

50 
	`±e_osTh»adSË•
(2000);

52 
	`±h»ad_ex™
(
¬g
);

55 
	`ex™
(1);

58 
	}
}

61 
	$±h»ad_‹¡_još0
()

63 
±h»ad_t
 
id
;

64 
»suÉ
;

67 
	`as£¹
(
	`±h»ad_ü—‹
(&
id
, 
NULL
, 
func
, (*) 123) == 0);

69 
	`as£¹
(
	`±h»ad_još
(
id
, (**è&
»suÉ
) == 0);

71 
	`as£¹
(
»suÉ
 == 123);

75 
	}
}

	@tests/join1.c

45 
	~"‹¡.h
"

48 
	$func
(* 
¬g
)

50 
i
 = (è
¬g
;

52 
	`±e_osTh»adSË•
(
i
 * 100);

54 
	`±h»ad_ex™
(
¬g
);

58 
	}
}

60 
	$±h»ad_‹¡_još1
()

62 
±h»ad_t
 
id
[4];

63 
i
;

64 
»suÉ
;

67 
i
 = 0; i < 4; i++)

69 
	`as£¹
(
	`±h»ad_ü—‹
(&
id
[
i
], 
NULL
, 
func
, (*) i) == 0);

73 
	`±e_osTh»adSË•
(20 * 100 + 50);

75 
i
 = 0; i < 4; i++)

77 
	`as£¹
(
	`±h»ad_još
(
id
[
i
], (**è&
»suÉ
) == 0);

78 
	`as£¹
(
»suÉ
 =ğ
i
);

83 
	}
}

	@tests/join2.c

45 
	~"‹¡.h
"

48 
	$func
(* 
¬g
)

50 
	`±e_osTh»adSË•
(2000);

51  
¬g
;

52 
	}
}

54 
	$±h»ad_‹¡_još2
()

56 
±h»ad_t
 
id
[4];

57 
i
;

58 
»suÉ
;

61 
i
 = 0; i < 4; i++)

63 
	`as£¹
(
	`±h»ad_ü—‹
(&
id
[
i
], 
NULL
, 
func
, (*) i) == 0);

66 
i
 = 0; i < 4; i++)

68 
	`as£¹
(
	`±h»ad_još
(
id
[
i
], (**è&
»suÉ
) == 0);

69 
	`as£¹
(
»suÉ
 =ğ
i
);

74 
	}
}

	@tests/join3.c

45 
	~"‹¡.h
"

48 
	$func
(* 
¬g
)

50 
	`sched_y›ld
();

51  
¬g
;

52 
	}
}

54 
	$±h»ad_‹¡_još3
()

56 
±h»ad_t
 
id
[4];

57 
i
;

58 
»suÉ
;

61 
i
 = 0; i < 4; i++)

63 
	`as£¹
(
	`±h»ad_ü—‹
(&
id
[
i
], 
NULL
, 
func
, (*) i) == 0);

70 
	`±e_osTh»adSË•
(1000);

72 
i
 = 0; i < 4; i++)

74 
	`as£¹
(
	`±h»ad_još
(
id
[
i
], (**è&
»suÉ
) == 0);

75 
	`as£¹
(
»suÉ
 =ğ
i
);

80 
	}
}

	@tests/join4.c

32 
	~"‹¡.h
"

34 
±h»ad_t
 
	ghªdË1
;

35 
±h»ad_t
 
	ghªdË2
;

37 
	gth»ad2_¡©us
;

40 
	$thr1
(* 
¬g
)

42 
	`±e_osTh»adSË•
(5000);

44  
NULL
;

45 
	}
}

48 
	$thr2
(* 
¬g
)

50 
»suÉ
;

52 
	`as£¹
(
	`±h»ad_još
(
hªdË1
,
NULL
) == 0);

54 
th»ad2_¡©us
 = 1;

56  
NULL
;

57 
	}
}

59 
	$±h»ad_‹¡_još4
()

61 
th»ad2_¡©us
 = 0;

63 
	`as£¹
(
	`±h»ad_ü—‹
(&
hªdË1
, 
NULL
, 
thr1
, NULL) == 0);

64 
	`as£¹
(
	`±h»ad_ü—‹
(&
hªdË2
, 
NULL
, 
thr2
, NULL) == 0);

67 
	`±e_osTh»adSË•
(500);

70 
	`as£¹
(
	`±h»ad_ÿnûl
(
hªdË2
) == 0);

73 
	`±e_osTh»adSË•
(500);

76 
	`as£¹
(
th»ad2_¡©us
 == 1);

78 
	`as£¹
(
	`±h»ad_još
(
hªdË1
, 
NULL
) == 0);

79 
	`as£¹
(
	`±h»ad_još
(
hªdË2
, 
NULL
) == 0);

83 
	}
}

	@tests/kill1.c

80 
	~"‹¡.h
"

83 
	$±h»ad_‹¡_kl1
()

85 
	`as£¹
(
	`±h»ad_kl
(
	`±h»ad_£lf
(), 1è=ğ
EINVAL
);

88 
	}
}

	@tests/mutex1.c

55 
	~"‹¡.h
"

59 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
NULL
;

62 
	$±h»ad_‹¡_mu‹x1
()

64 
	`as£¹
(
mu‹x
 =ğ
NULL
);

66 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
) == 0);

68 
	`as£¹
(
mu‹x
 !ğ
NULL
);

70 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

72 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

74 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

76 
	`as£¹
(
mu‹x
 =ğ
NULL
);

79 
	}
}

	@tests/mutex1e.c

56 
	~"‹¡.h
"

58 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
NULL
;

59 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

62 
	$±h»ad_‹¡_mu‹x1e
()

64 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

66 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_ERRORCHECK
) == 0);

68 
	`as£¹
(
mu‹x
 =ğ
NULL
);

70 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

72 
	`as£¹
(
mu‹x
 !ğ
NULL
);

74 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

76 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

78 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

80 
	`as£¹
(
mu‹x
 =ğ
NULL
);

83 
	}
}

	@tests/mutex1n.c

55 
	~"‹¡.h
"

57 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
NULL
;

58 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

61 
	$±h»ad_‹¡_mu‹x1n
()

63 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

65 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_NORMAL
) == 0);

67 
	`as£¹
(
mu‹x
 =ğ
NULL
);

69 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

71 
	`as£¹
(
mu‹x
 !ğ
NULL
);

73 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

75 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

77 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

79 
	`as£¹
(
mu‹x
 =ğ
NULL
);

82 
	}
}

	@tests/mutex1r.c

56 
	~"‹¡.h
"

58 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
NULL
;

59 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

62 
	$±h»ad_‹¡_mu‹x1r
()

64 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

66 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_RECURSIVE
) == 0);

68 
	`as£¹
(
mu‹x
 =ğ
NULL
);

70 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

72 
	`as£¹
(
mu‹x
 !ğ
NULL
);

74 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

76 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

78 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

80 
	`as£¹
(
mu‹x
 =ğ
NULL
);

83 
	}
}

	@tests/mutex2.c

53 
	~"‹¡.h
"

55 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

58 
	$±h»ad_‹¡_mu‹x2
()

60 
mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

62 
	`as£¹
(
mu‹x
 =ğ
PTHREAD_MUTEX_INITIALIZER
);

64 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

66 
	`as£¹
(
mu‹x
 !ğ
PTHREAD_MUTEX_INITIALIZER
);

68 
	`as£¹
(
mu‹x
 !ğ
NULL
);

70 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

72 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

74 
	`as£¹
(
mu‹x
 =ğ
NULL
);

77 
	}
}

	@tests/mutex2e.c

53 
	~"‹¡.h
"

55 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
;

58 
	$±h»ad_‹¡_mu‹x2e
()

60 
mu‹x
 = 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
;

62 
	`as£¹
(
mu‹x
 =ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
);

64 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

66 
	`as£¹
(
mu‹x
 !ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
);

68 
	`as£¹
(
mu‹x
 !ğ
NULL
);

70 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

72 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

74 
	`as£¹
(
mu‹x
 =ğ
NULL
);

77 
	}
}

	@tests/mutex2r.c

53 
	~"‹¡.h
"

55 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
;

58 
	$±h»ad_‹¡_mu‹x2r
()

60 
mu‹x
 = 
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
;

62 
	`as£¹
(
mu‹x
 =ğ
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
);

64 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

66 
	`as£¹
(
mu‹x
 !ğ
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
);

68 
	`as£¹
(
mu‹x
 !ğ
NULL
);

70 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

72 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

74 
	`as£¹
(
mu‹x
 =ğ
NULL
);

77 
	}
}

	@tests/mutex3.c

54 
	~"‹¡.h
"

56 
±h»ad_mu‹x_t
 
	gmu‹x1
 = 
PTHREAD_MUTEX_INITIALIZER
;

58 
	gwash”e
 = 0;

60 * 
	$func
(* 
¬g
)

62 
	`as£¹
(
	`±h»ad_mu‹x_Œylock
(&
mu‹x1
è=ğ
EBUSY
);

64 
wash”e
 = 1;

67 
	}
}

70 
	$±h»ad_‹¡_mu‹x3
()

72 
±h»ad_t
 
t
;

74 
mu‹x1
 = 
PTHREAD_MUTEX_INITIALIZER
;

76 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x1
) == 0);

78 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

79 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

81 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
) == 0);

83 
	`as£¹
(
wash”e
 == 1);

85 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x1
) == 0);

88 
	}
}

	@tests/mutex3e.c

54 
	~"‹¡.h
"

56 
±h»ad_mu‹x_t
 
	gmu‹x1
 = 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
;

58 
	gwash”e
 = 0;

60 * 
	$func
(* 
¬g
)

62 
	`as£¹
(
	`±h»ad_mu‹x_Œylock
(&
mu‹x1
è=ğ
EBUSY
);

64 
wash”e
 = 1;

67 
	}
}

70 
	$±h»ad_‹¡_mu‹x3e
()

72 
±h»ad_t
 
t
;

74 
mu‹x1
 = 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
;

76 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x1
) == 0);

78 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

80 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

82 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
) == 0);

84 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x1
) == 0);

86 
	`as£¹
(
wash”e
 == 1);

89 
	}
}

	@tests/mutex3r.c

54 
	~"‹¡.h
"

56 
±h»ad_mu‹x_t
 
	gmu‹x1
 = 
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
;

58 
	gwash”e
 = 0;

60 * 
	$func
(* 
¬g
)

62 
	`as£¹
(
	`±h»ad_mu‹x_Œylock
(&
mu‹x1
è=ğ
EBUSY
);

64 
wash”e
 = 1;

67 
	}
}

70 
	$±h»ad_‹¡_mu‹x3r
()

72 
±h»ad_t
 
t
;

74 
mu‹x1
 = 
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
;

76 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x1
) == 0);

78 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

79 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

81 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
) == 0);

83 
	`as£¹
(
wash”e
 == 1);

85 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x1
) == 0);

88 
	}
}

	@tests/mutex4.c

53 
	~"‹¡.h
"

55 
	gwasH”e
 = 0;

57 
±h»ad_mu‹x_t
 
	gmu‹x1
;

59 * 
	$uÆock”
(* 
¬g
)

61 
	`´štf
 (cÚ¡ * 
s
, ...);

62 
ex³ùedResuÉ
 = (è
¬g
;

64 
wasH”e
++;

66 
»s
 =
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
);

67 
	`as£¹
(
»s
 =ğ
ex³ùedResuÉ
);

68 
wasH”e
++;

69  
NULL
;

70 
	}
}

73 
	$±h»ad_‹¡_mu‹x4
()

75 
±h»ad_t
 
t
;

76 
±h»ad_mu‹x©Œ_t
 
ma
;

78 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
ma
) == 0);

80 
wasH”e
 = 0;

81 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
ma
, 
PTHREAD_MUTEX_DEFAULT
) == 0);

82 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x1
, &
ma
) == 0);

83 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x1
) == 0);

87 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
uÆock”
, (*) 0) == 0);

88 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

89 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
è=ğ
EPERM
);

90 
	`as£¹
(
wasH”e
 == 2);

91 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x1
) == 0);

93 
wasH”e
 = 0;

94 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
ma
, 
PTHREAD_MUTEX_NORMAL
) == 0);

95 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x1
, &
ma
) == 0);

96 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x1
) == 0);

100 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
uÆock”
, (*) 0) == 0);

101 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

102 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
è=ğ
EPERM
);

103 
	`as£¹
(
wasH”e
 == 2);

104 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x1
) == 0);

107 
wasH”e
 = 0;

108 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
ma
, 
PTHREAD_MUTEX_ERRORCHECK
) == 0);

109 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x1
, &
ma
) == 0);

110 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x1
) == 0);

111 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
uÆock”
, (*è
EPERM
) == 0);

112 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

113 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
) == 0);

114 
	`as£¹
(
wasH”e
 == 2);

115 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x1
) == 0);

117 
wasH”e
 = 0;

118 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
ma
, 
PTHREAD_MUTEX_RECURSIVE
) == 0);

119 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x1
, &
ma
) == 0);

120 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x1
) == 0);

121 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
uÆock”
, (*è
EPERM
) == 0);

122 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

123 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x1
) == 0);

124 
	`as£¹
(
wasH”e
 == 2);

125 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x1
) == 0);

128 
	}
}

	@tests/mutex5.c

49 
	~"‹¡.h
"

51 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

54 
	g_İtimi£Fo
;

55 
	#FOIL
(
x
è(
_İtimi£Fo
 = x)

	)

58 
	$±h»ad_‹¡_mu‹x5
()

60 
mxTy³
 = -1;

62 
	`as£¹
(
	`FOIL
(
PTHREAD_MUTEX_DEFAULT
è=ğ
PTHREAD_MUTEX_NORMAL
);

63 
	`as£¹
(
	`FOIL
(
PTHREAD_MUTEX_DEFAULT
è!ğ
PTHREAD_MUTEX_ERRORCHECK
);

64 
	`as£¹
(
	`FOIL
(
PTHREAD_MUTEX_DEFAULT
è!ğ
PTHREAD_MUTEX_RECURSIVE
);

65 
	`as£¹
(
	`FOIL
(
PTHREAD_MUTEX_RECURSIVE
è!ğ
PTHREAD_MUTEX_ERRORCHECK
);

67 
	`as£¹
(
	`FOIL
(
PTHREAD_MUTEX_NORMAL
è=ğ
PTHREAD_MUTEX_FAST_NP
);

68 
	`as£¹
(
	`FOIL
(
PTHREAD_MUTEX_RECURSIVE
è=ğ
PTHREAD_MUTEX_RECURSIVE_NP
);

69 
	`as£¹
(
	`FOIL
(
PTHREAD_MUTEX_ERRORCHECK
è=ğ
PTHREAD_MUTEX_ERRORCHECK_NP
);

71 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

72 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

73 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_NORMAL
);

76 
	}
}

	@tests/mutex6.c

58 
	~"‹¡.h
"

60 
	glockCouÁ
 = 0;

62 
±h»ad_mu‹x_t
 
	gmu‹x
;

64 * 
	$lock”
(* 
¬g
)

66 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

67 
lockCouÁ
++;

70 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

71 
lockCouÁ
++;

73 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

76 
	}
}

79 
	$±h»ad_‹¡_mu‹x6
()

81 
±h»ad_t
 
t
;

83 
lockCouÁ
 = 0;

85 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
) == 0);

87 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

89 
	`±e_osTh»adSË•
(1000);

91 
	`as£¹
(
lockCouÁ
 == 1);

97 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

99 
	`±e_osTh»adSË•
 (1000);

101 
	`as£¹
(
lockCouÁ
 == 2);

103 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

105 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

108 
	}
}

	@tests/mutex6e.c

63 
	~"‹¡.h
"

65 
	glockCouÁ
 = 0;

67 
±h»ad_mu‹x_t
 
	gmu‹x
;

68 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

70 * 
	$lock”
(* 
¬g
)

72 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

73 
lockCouÁ
++;

74 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
è=ğ
EDEADLK
);

75 
lockCouÁ
++;

76 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

77 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
è=ğ
EPERM
);

80 
	}
}

83 
	$±h»ad_‹¡_mu‹x6e
()

85 
±h»ad_t
 
t
;

86 
»suÉ
 = 0;

87 
mxTy³
 = -1;

89 
lockCouÁ
 = 0;

90 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

91 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_ERRORCHECK
) == 0);

92 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

93 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_ERRORCHECK
);

95 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

97 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

99 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

100 
	`as£¹
(
»suÉ
 == 555);

102 
	`as£¹
(
lockCouÁ
 == 2);

104 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

105 
	`as£¹
(
	`±h»ad_mu‹x©Œ_de¡roy
(&
mxA‰r
) == 0);

108 
	}
}

	@tests/mutex6es.c

63 
	~"‹¡.h
"

65 
	glockCouÁ
 = 0;

67 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
;

69 * 
	$lock”
(* 
¬g
)

71 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

72 
lockCouÁ
++;

73 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
è=ğ
EDEADLK
);

74 
lockCouÁ
++;

75 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

76 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
è=ğ
EPERM
);

79 
	}
}

82 
	$±h»ad_‹¡_mu‹x6es
()

84 
±h»ad_t
 
t
;

85 
»suÉ
 = 0;

87 
lockCouÁ
 = 0;

89 
mu‹x
 = 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
;

91 
	`as£¹
(
mu‹x
 =ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
);

93 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

95 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

96 
	`as£¹
(
»suÉ
 == 555);

98 
	`as£¹
(
lockCouÁ
 == 2);

100 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

103 
	}
}

	@tests/mutex6n.c

59 
	~"‹¡.h
"

61 
	glockCouÁ
 = 0;

63 
±h»ad_mu‹x_t
 
	gmu‹x
;

64 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

66 * 
	$lock”
(* 
¬g
)

68 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

69 
lockCouÁ
++;

72 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

73 
lockCouÁ
++;

81 
	}
}

84 
	$±h»ad_‹¡_mu‹x6n
()

86 
±h»ad_t
 
t
;

87 
mxTy³
 = -1;

89 
lockCouÁ
 = 0;

91 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

92 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_NORMAL
) == 0);

93 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

94 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_NORMAL
);

96 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

98 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

100 
	`±e_osTh»adSË•
(1000);

102 
	`as£¹
(
lockCouÁ
 == 1);

108 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

110 
	`±e_osTh»adSË•
 (1000);

112 
	`as£¹
(
lockCouÁ
 == 2);

114 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

116 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

117 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

120 
	}
}

	@tests/mutex6r.c

62 
	~"‹¡.h
"

64 
	glockCouÁ
 = 0;

66 
±h»ad_mu‹x_t
 
	gmu‹x
;

67 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

69 * 
	$lock”
(* 
¬g
)

71 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

72 
lockCouÁ
++;

73 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

74 
lockCouÁ
++;

75 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

76 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

79 
	}
}

82 
	$±h»ad_‹¡_mu‹x6r
()

84 
±h»ad_t
 
t
;

85 
»suÉ
 = 0;

86 
mxTy³
 = -1;

88 
lockCouÁ
 = 0;

90 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

91 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_RECURSIVE
) == 0);

92 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

93 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_RECURSIVE
);

95 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

97 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

99 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

100 
	`as£¹
(
»suÉ
 == 555);

102 
	`as£¹
(
lockCouÁ
 == 2);

104 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

105 
	`as£¹
(
	`±h»ad_mu‹x©Œ_de¡roy
(&
mxA‰r
) == 0);

108 
	}
}

	@tests/mutex6rs.c

62 
	~"‹¡.h
"

64 
	glockCouÁ
 = 0;

66 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
;

68 * 
	$lock”
(* 
¬g
)

70 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

71 
lockCouÁ
++;

72 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

73 
lockCouÁ
++;

74 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

75 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

78 
	}
}

81 
	$±h»ad_‹¡_mu‹x6rs
()

83 
±h»ad_t
 
t
;

84 
»suÉ
 = 0;

86 
lockCouÁ
 = 0;

87 
mu‹x
 = 
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
;

89 
	`as£¹
(
mu‹x
 =ğ
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
);

91 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

93 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

94 
	`as£¹
(
»suÉ
 == 555);

96 
	`as£¹
(
lockCouÁ
 == 2);

98 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

101 
	}
}

	@tests/mutex6s.c

56 
	~"‹¡.h
"

58 
	glockCouÁ
 = 0;

60 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

62 * 
	$lock”
(* 
¬g
)

64 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

65 
lockCouÁ
++;

68 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

69 
lockCouÁ
++;

73 
	}
}

76 
	$±h»ad_‹¡_mu‹x6s
()

78 
±h»ad_t
 
t
;

80 
lockCouÁ
 = 0;

81 
mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

83 
	`as£¹
(
mu‹x
 =ğ
PTHREAD_MUTEX_INITIALIZER
);

85 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

87 
	`±e_osTh»adSË•
(1000);

89 
	`as£¹
(
lockCouÁ
 == 1);

95 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

97 
	`±e_osTh»adSË•
 (1000);

99 
	`as£¹
(
lockCouÁ
 == 2);

101 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

103 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

105 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

108 
	}
}

	@tests/mutex7.c

56 
	~"‹¡.h
"

58 
	glockCouÁ
 = 0;

60 
±h»ad_mu‹x_t
 
	gmu‹x
;

62 * 
	$lock”
(* 
¬g
)

64 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

65 
lockCouÁ
++;

66 
	`as£¹
(
	`±h»ad_mu‹x_Œylock
(&
mu‹x
è=ğ
EBUSY
);

67 
lockCouÁ
++;

68 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

69 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
è=ğ
EPERM
);

72 
	}
}

75 
	$±h»ad_‹¡_mu‹x7
()

77 
±h»ad_t
 
t
;

79 
lockCouÁ
 = 0;

81 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
) == 0);

83 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

85 
	`±e_osTh»adSË•
(1000);

87 
	`as£¹
(
lockCouÁ
 == 2);

89 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

91 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

95 
	}
}

	@tests/mutex7e.c

63 
	~"‹¡.h
"

65 
	glockCouÁ
 = 0;

67 
±h»ad_mu‹x_t
 
	gmu‹x
;

68 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

70 * 
	$lock”
(* 
¬g
)

72 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

73 
lockCouÁ
++;

74 
	`as£¹
(
	`±h»ad_mu‹x_Œylock
(&
mu‹x
è=ğ
EBUSY
);

75 
lockCouÁ
++;

76 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

77 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
è=ğ
EPERM
);

80 
	}
}

83 
	$±h»ad_‹¡_mu‹x7e
()

85 
±h»ad_t
 
t
;

86 
»suÉ
 = 0;

87 
mxTy³
 = -1;

89 
lockCouÁ
 = 0;

91 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

92 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_ERRORCHECK
) == 0);

93 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

94 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_ERRORCHECK
);

96 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

98 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

100 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

101 
	`as£¹
(
»suÉ
 == 555);

103 
	`as£¹
(
lockCouÁ
 == 2);

105 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

106 
	`as£¹
(
	`±h»ad_mu‹x©Œ_de¡roy
(&
mxA‰r
) == 0);

110 
	}
}

	@tests/mutex7n.c

58 
	~"‹¡.h
"

60 
	glockCouÁ
 = 0;

62 
±h»ad_mu‹x_t
 
	gmu‹x
;

63 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

65 * 
	$lock”
(* 
¬g
)

67 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

68 
lockCouÁ
++;

69 
	`as£¹
(
	`±h»ad_mu‹x_Œylock
(&
mu‹x
è=ğ
EBUSY
);

70 
lockCouÁ
++;

71 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

72 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
è=ğ
EPERM
);

75 
	}
}

78 
	$±h»ad_‹¡_mu‹x7n
()

80 
±h»ad_t
 
t
;

81 
mxTy³
 = -1;

83 
lockCouÁ
 = 0;

85 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

86 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_NORMAL
) == 0);

87 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

88 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_NORMAL
);

90 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

92 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

94 
	`±e_osTh»adSË•
(1000);

96 
	`as£¹
(
lockCouÁ
 == 2);

98 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

100 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

104 
	}
}

	@tests/mutex7r.c

62 
	~"‹¡.h
"

64 
	glockCouÁ
 = 0;

66 
±h»ad_mu‹x_t
 
	gmu‹x
;

67 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

69 * 
	$lock”
(* 
¬g
)

71 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

72 
lockCouÁ
++;

73 
	`as£¹
(
	`±h»ad_mu‹x_Œylock
(&
mu‹x
) == 0);

74 
lockCouÁ
++;

75 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

76 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

79 
	}
}

82 
	$±h»ad_‹¡_mu‹x7r
()

84 
±h»ad_t
 
t
;

85 
»suÉ
 = 0;

86 
mxTy³
 = -1;

88 
lockCouÁ
 = 0;

90 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

91 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_RECURSIVE
) == 0);

92 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

93 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_RECURSIVE
);

95 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

97 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

99 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

100 
	`as£¹
(
»suÉ
 == 555);

102 
	`as£¹
(
lockCouÁ
 == 2);

104 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

105 
	`as£¹
(
	`±h»ad_mu‹x©Œ_de¡roy
(&
mxA‰r
) == 0);

108 
	}
}

	@tests/mutex8.c

46 
	~"‹¡.h
"

49 
	glockCouÁ
 = 0;

51 
±h»ad_mu‹x_t
 
	gmu‹x
;

53 * 
	$lock”
(* 
¬g
)

55 
	`´štf
 (cÚ¡ * 
s
, ...);

57 
time¥ec
 
ab¡ime
 =

61 
timeb
 
cu¼SysTime
;

62 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

64 
	`_áime
(&
cu¼SysTime
);

66 
cu¼SysTime
.
time
 += 1;

68 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

69 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

70 
	`´štf
("wa™im£cÚd %d \n", 
ab¡ime
.
tv_£c
+ab¡ime.
tv_n£c
/1000000000ULL);

71 
	`as£¹
(
	`±h»ad_mu‹x_timedlock
(&
mu‹x
, &
ab¡ime
è=ğ
ETIMEDOUT
);

73 
lockCouÁ
++;

76 
	}
}

79 
	$±h»ad_‹¡_mu‹x8
()

81 
±h»ad_t
 
t
;

83 
lockCouÁ
 = 0;

85 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
) == 0);

87 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

89 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

91 
	`±e_osTh»adSË•
(2000);

93 
	`as£¹
(
lockCouÁ
 == 1);

95 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

97 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

99 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

102 
	}
}

	@tests/mutex8e.c

53 
	~"‹¡.h
"

55 
	glockCouÁ
 = 0;

57 
±h»ad_mu‹x_t
 
	gmu‹x
;

58 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

60 * 
	$lock”
(* 
¬g
)

62 
time¥ec
 
ab¡ime
 =

66 
_timeb
 
cu¼SysTime
;

67 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

69 
	`_áime
(&
cu¼SysTime
);

71 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

72 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

74 
ab¡ime
.
tv_£c
 += 1;

76 
	`as£¹
(
	`±h»ad_mu‹x_timedlock
(&
mu‹x
, &
ab¡ime
è=ğ
ETIMEDOUT
);

78 
lockCouÁ
++;

81 
	}
}

84 
	$±h»ad_‹¡_mu‹x8e
()

86 
±h»ad_t
 
t
;

87 
mxTy³
 = -1;

89 
lockCouÁ
 = 0;

91 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

92 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_ERRORCHECK
) == 0);

93 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

94 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_ERRORCHECK
);

96 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

98 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

100 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

102 
	`±e_osTh»adSË•
(2000);

104 
	`as£¹
(
lockCouÁ
 == 1);

106 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

108 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

110 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

113 
	}
}

	@tests/mutex8n.c

53 
	~"‹¡.h
"

55 
	glockCouÁ
 = 0;

57 
±h»ad_mu‹x_t
 
	gmu‹x
;

58 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

60 * 
	$lock”
(* 
¬g
)

62 
time¥ec
 
ab¡ime
 =

66 
_timeb
 
cu¼SysTime
;

67 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

69 
	`_áime
(&
cu¼SysTime
);

71 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

72 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

74 
ab¡ime
.
tv_£c
 += 1;

76 
	`as£¹
(
	`±h»ad_mu‹x_timedlock
(&
mu‹x
, &
ab¡ime
è=ğ
ETIMEDOUT
);

78 
lockCouÁ
++;

81 
	}
}

84 
	$±h»ad_‹¡_mu‹x8n
()

86 
±h»ad_t
 
t
;

87 
mxTy³
 = -1;

89 
lockCouÁ
 = 0;

91 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

92 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_NORMAL
) == 0);

93 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

94 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_NORMAL
);

96 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

98 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

100 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

102 
	`±e_osTh»adSË•
(2000);

104 
	`as£¹
(
lockCouÁ
 == 1);

106 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

108 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

110 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

113 
	}
}

	@tests/mutex8r.c

53 
	~"‹¡.h
"

55 
	glockCouÁ
 = 0;

57 
±h»ad_mu‹x_t
 
	gmu‹x
;

58 
±h»ad_mu‹x©Œ_t
 
	gmxA‰r
;

60 * 
	$lock”
(* 
¬g
)

62 
time¥ec
 
ab¡ime
 =

66 
_timeb
 
cu¼SysTime
;

67 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

69 
	`_áime
(&
cu¼SysTime
);

71 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

72 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

74 
ab¡ime
.
tv_£c
 += 1;

76 
	`as£¹
(
	`±h»ad_mu‹x_timedlock
(&
mu‹x
, &
ab¡ime
è=ğ
ETIMEDOUT
);

78 
lockCouÁ
++;

81 
	}
}

84 
	$±h»ad_‹¡_mu‹x8r
()

86 
±h»ad_t
 
t
;

87 
mxTy³
 = -1;

89 
lockCouÁ
 = 0;

91 
	`as£¹
(
	`±h»ad_mu‹x©Œ_š™
(&
mxA‰r
) == 0);

92 
	`as£¹
(
	`±h»ad_mu‹x©Œ_£‰y³
(&
mxA‰r
, 
PTHREAD_MUTEX_RECURSIVE
) == 0);

93 
	`as£¹
(
	`±h»ad_mu‹x©Œ_g‘ty³
(&
mxA‰r
, &
mxTy³
) == 0);

94 
	`as£¹
(
mxTy³
 =ğ
PTHREAD_MUTEX_RECURSIVE
);

96 
	`as£¹
(
	`±h»ad_mu‹x_š™
(&
mu‹x
, &
mxA‰r
) == 0);

98 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
mu‹x
) == 0);

100 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
lock”
, NULL) == 0);

102 
	`±e_osTh»adSË•
(2000);

104 
	`as£¹
(
lockCouÁ
 == 1);

106 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
mu‹x
) == 0);

108 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

110 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
) == 0);

113 
	}
}

	@tests/once1.c

49 
	~"‹¡.h
"

51 
±h»ad_Úû_t
 
	gÚû
 = 
PTHREAD_ONCE_INIT
;

53 
	gwash”e
 = 0;

56 
	$myfunc
()

58 
wash”e
++;

59 
	}
}

62 
	$myth»ad
(* 
¬g
)

64 
	`as£¹
(
	`±h»ad_Úû
(&
Úû
, 
myfunc
) == 0);

67 
	}
}

69 
	$±h»ad_‹¡_Úû1
()

71 
±h»ad_t
 
t1
, 
t2
;

72 
±h»ad_Úû_t
 
Úûš™
 = 
PTHREAD_ONCE_INIT
;

74 
wash”e
 = 0;

76 
Úû
 = 
Úûš™
;

78 
	`as£¹
(
	`±h»ad_ü—‹
(&
t1
, 
NULL
, 
myth»ad
, NULL) == 0);

80 
	`as£¹
(
	`±h»ad_ü—‹
(&
t2
, 
NULL
, 
myth»ad
, NULL) == 0);

82 
	`±e_osTh»adSË•
(2000);

84 
	`as£¹
(
wash”e
 == 1);

86 
	`as£¹
(
	`±h»ad_još
(
t1
,
NULL
) == 0);

87 
	`as£¹
(
	`±h»ad_još
(
t2
,
NULL
) == 0);

90 
	}
}

	@tests/once2.c

50 
	~"‹¡.h
"

52 
	#NUM_THREADS
 
OS_MAX_SIMUL_THREADS
 / 5

	)

53 
	#NUM_ONCE
 5

	)

56 
±h»ad_Úû_t
 
	go
 = 
PTHREAD_ONCE_INIT
;

57 
±h»ad_Úû_t
 
	gÚû
[
NUM_ONCE
];

61 
	mi
;

62 
±e_osMu‹xHªdË
 
	mcs
;

63 } 
	tsh¬edIÁ_t
;

65 
sh¬edIÁ_t
 
	gnumOnû
 = {0, 0};

66 
sh¬edIÁ_t
 
	gnumTh»ads
 = {0, 0};

69 
	$myfunc
()

72 
	`±e_osMu‹xLock
(
numOnû
.
cs
);

74 
numOnû
.
i
++;

76 
	`±e_osMu‹xUÆock
(
numOnû
.
cs
);

79 
	`±e_osTh»adSË•
(100);

80 
	}
}

83 
	$myth»ad
(* 
¬g
)

86 
	`as£¹
(
	`±h»ad_Úû
(&
Úû
[(è
¬g
], 
myfunc
) == 0);

88 
	`±e_osMu‹xLock
(
numTh»ads
.
cs
);

89 
numTh»ads
.
i
++;

90 
	`±e_osMu‹xUÆock
(
numTh»ads
.
cs
);

93 
	}
}

95 
	$±h»ad_‹¡_Úû2
()

97 
±h»ad_t
 
t
[
NUM_THREADS
][
NUM_ONCE
];

98 
i
, 
j
;

99 
»suÉ
;

101 
numOnû
.
i
 = 0;

102 
numTh»ads
.
i
 = 0;

104 
	`±e_osMu‹xC»©e
(&
numTh»ads
.
cs
);

105 
	`±e_osMu‹xC»©e
(&
numOnû
.
cs
);

107 
j
 = 0; j < 
NUM_ONCE
; j++)

109 
Úû
[
j
] = 
o
;

111 
i
 = 0; i < 
NUM_THREADS
; i++)

112 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
][
j
], 
NULL
, 
myth»ad
, (*) j) == 0);

115 
j
 = 0; j < 
NUM_ONCE
; j++)

116 
i
 = 0; i < 
NUM_THREADS
; i++)

117 ià((
»suÉ
 = 
	`±h»ad_još
(
t
[
i
][
j
], 
NULL
)) != 0)

119 
	`as£¹
(0);

123 
»suÉ
 =„esult;

125 
	`±e_osTh»adSË•
(1000);

127 
	`as£¹
(
numOnû
.
i
 =ğ
NUM_ONCE
);

128 
	`as£¹
(
numTh»ads
.
i
 =ğ
NUM_THREADS
 * 
NUM_ONCE
);

130 
	`±e_osMu‹xD–‘e
(
numOnû
.
cs
);

131 
	`±e_osMu‹xD–‘e
(
numTh»ads
.
cs
);

134 
	}
}

	@tests/once3.c

56 
	~"‹¡.h
"

58 
	#NUM_THREADS
 
OS_MAX_SIMUL_THREADS
 / 5

	)

59 
	#NUM_ONCE
 5

	)

62 
±h»ad_Úû_t
 
	go
 = 
PTHREAD_ONCE_INIT
;

63 
±h»ad_Úû_t
 
	gÚû
[
NUM_ONCE
];

67 
	mi
;

68 
	mnuÎ
;

69 
±e_osMu‹xHªdË
 
	mcs
;

70 } 
	tsh¬edIÁ_t
;

72 
sh¬edIÁ_t
 
	gnumOnû
 = {0, 0, 0};

73 
sh¬edIÁ_t
 
	gnumTh»ads
 = {0, 0, 0};

76 
	$myfunc
()

79 
	`±e_osMu‹xLock
(
numOnû
.
cs
);

80 
numOnû
.
i
++;

81 
	`as£¹
(
numOnû
.
i
 > 0);

82 
	`±e_osMu‹xUÆock
(
numOnû
.
cs
);

85 
	`±e_osTh»adSË•
(10);

87 
	`±h»ad_‹¡ÿnûl
();

88 
	}
}

91 
	$myth»ad
(* 
¬g
)

100 
	`as£¹
(
	`±h»ad_ÿnûl
(
	`±h»ad_£lf
()) == 0);

101 
	`as£¹
(
	`±h»ad_Úû
(&
Úû
[(è
¬g
], 
myfunc
) == 0);

102 
	`±e_osMu‹xLock
(
numTh»ads
.
cs
);

103 
numTh»ads
.
i
++;

104 
	`±e_osMu‹xUÆock
(
numTh»ads
.
cs
);

107 
	}
}

109 
	$±h»ad_‹¡_Úû3
()

111 
±h»ad_t
 
t
[
NUM_THREADS
][
NUM_ONCE
];

112 
i
, 
j
;

113 
±h»ad_Úû_t
 
Úûš™
 = 
PTHREAD_ONCE_INIT
;

115 
numOnû
.
i
 = 0;

116 
numTh»ads
.
i
 = 0;

118 
o
 = 
Úûš™
;

120 
	`±e_osMu‹xC»©e
(&
numTh»ads
.
cs
);

121 
	`±e_osMu‹xC»©e
(&
numOnû
.
cs
);

124 
j
 = 0; j < 
NUM_ONCE
; j++)

126 
Úû
[
j
] = 
o
;

128 
i
 = 0; i < 
NUM_THREADS
; i++)

130 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
][
j
], 
NULL
, 
myth»ad
, (*) j) == 0);

134 
j
 = 0; j < 
NUM_ONCE
; j++)

135 
i
 = 0; i < 
NUM_THREADS
; i++)

136 ià(
	`±h»ad_još
(
t
[
i
][
j
], 
NULL
) != 0)

137 
	`as£¹
(0);

144 
	`as£¹
(
numOnû
.
i
 =ğ
NUM_ONCE
 * 
NUM_THREADS
);

145 
	`as£¹
(
numTh»ads
.
i
 == 0);

147 
	`±e_osMu‹xD–‘e
(
numOnû
.
cs
);

148 
	`±e_osMu‹xD–‘e
(
numTh»ads
.
cs
);

151 
	}
}

	@tests/once4.c

54 
	~"‹¡.h
"

56 
	#NUM_THREADS
 
OS_MAX_SIMUL_THREADS
 / 5

	)

57 
	#NUM_ONCE
 5

	)

59 
±h»ad_Úû_t
 
	go
 = 
PTHREAD_ONCE_INIT
;

60 
±h»ad_Úû_t
 
	gÚû
[
NUM_ONCE
];

64 
	mi
;

65 
	mnuÎ
;

66 
±e_osMu‹xHªdË
 
	mcs
;

67 } 
	tsh¬edIÁ_t
;

69 
sh¬edIÁ_t
 
	gnumOnû
 = {0, 0};

70 
sh¬edIÁ_t
 
	gnumTh»ads
 = {0, 0};

74 
	mth»adnum
;

75 
	mÚûnum
;

76 
	mmyPrio
;

78 } 
	tbag_t
;

80 
bag_t
 
	gth»adbag
[
NUM_THREADS
][
NUM_ONCE
];

85 
	$myş—nupfunc
(* 
¬g
)

88 
	}
}

91 
	$myš™func
()

94 
	`±e_osMu‹xLock
(
numOnû
.
cs
);

95 
numOnû
.
i
++;

96 
	`±e_osMu‹xUÆock
(
numOnû
.
cs
);

99 
	`±e_osTh»adSË•
(10);

101 
	`±h»ad_‹¡ÿnûl
();

102 
	}
}

105 
	$myth»ad
(* 
¬g
)

107 
bag_t
 * 
bag
 = (bag_ˆ*è
¬g
;

108 
sched_·¿m
 
·¿m
;

116 
±h»ad_t
 
£lf
 = 
	`±h»ad_£lf
();

121 
bag
->
myPrio
 = (bag->
th»adnum
 % 5) - 2;

122 
·¿m
.
sched_´iÜ™y
 = 
bag
->
myPrio
;

123 
	`±h»ad_£tsched·¿m
(
£lf
, 
SCHED_OTHER
, &
·¿m
);

126 
	`±h»ad_ÿnûl
(
£lf
);

127 
	`±h»ad_ş—nup_push
(
myş—nupfunc
, 
¬g
);

128 
	`as£¹
(
	`±h»ad_Úû
(&
Úû
[
bag
->
Úûnum
], 
myš™func
) == 0);

129 
	`±h»ad_ş—nup_pİ
(1);

131 
	`±e_osMu‹xLock
(
numTh»ads
.
cs
);

132 
numTh»ads
.
i
++;

133 
	`±e_osMu‹xUÆock
(
numTh»ads
.
cs
);

135 
	}
}

137 
	$±h»ad_‹¡_Úû4
()

139 
±h»ad_t
 
t
[
NUM_THREADS
][
NUM_ONCE
];

140 
i
, 
j
;

142 
numOnû
.
i
 = 0;

143 
numTh»ads
.
i
 = 0;

157 
j
 = 0; j < 
NUM_ONCE
; j++)

159 
Úû
[
j
] = 
o
;

161 
i
 = 0; i < 
NUM_THREADS
; i++)

163 
bag_t
 * 
bag
 = &
th»adbag
[
i
][
j
];

164 
bag
->
th»adnum
 = 
i
;

165 
bag
->
Úûnum
 = 
j
;

166 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
][
j
], 
NULL
, 
myth»ad
, (*è
bag
) == 0);

170 
j
 = 0; j < 
NUM_ONCE
; j++)

171 
i
 = 0; i < 
NUM_THREADS
; i++)

172 ià(
	`±h»ad_još
(
t
[
i
][
j
], 
NULL
) != 0)

173 
	`as£¹
(0);

180 
	`as£¹
(
numOnû
.
i
 =ğ
NUM_ONCE
 * 
NUM_THREADS
);

181 
	`as£¹
(
numTh»ads
.
i
 == 0);

188 
	}
}

	@tests/priority1.c

80 
	~"‹¡.h
"

84 
	mPTW32TEST_THREAD_INIT_PRIO
 = 0,

85 
	mPTW32TEST_MAXPRIORITIES
 = 512

94 
	g±h»adPrio
;

97 
	$func
(* 
¬g
)

99 
pŞicy
;

100 
sched_·¿m
 
·¿m
;

101 
±h»ad_t
 
th»adID
 = 
	`±h»ad_£lf
();

103 
	`as£¹
(
	`±h»ad_g‘sched·¿m
(
th»adID
, &
pŞicy
, &
·¿m
) == 0);

104 
	`as£¹
(
pŞicy
 =ğ
SCHED_OTHER
);

105 
	`as£¹
(
·¿m
.
sched_´iÜ™y
 =ğ(è
±h»adPrio
);

107 
	`as£¹
(
	`±e_osTh»adG‘PriÜ™y
(
	`±e_osTh»adG‘HªdË
()è=ğ
·¿m
.
sched_´iÜ™y
);

111 
	}
}

113 
	$±h»ad_‹¡_´iÜ™y1
()

115 
±h»ad_t
 
t
;

116 
±h»ad_©Œ_t
 
©Œ
;

117 * 
»suÉ
 = 
NULL
;

118 
sched_·¿m
 
·¿m
;

120 
	`as£¹
(
	`±h»ad_©Œ_š™
(&
©Œ
) == 0);

121 
	`as£¹
(
	`±h»ad_©Œ_£tšh”™sched
(&
©Œ
, 
PTHREAD_EXPLICIT_SCHED
) == 0);

123 
·¿m
.
sched_´iÜ™y
 = 
	`sched_g‘_´iÜ™y_mš
(
SCHED_OTHER
) + 1;

124 
±h»adPrio
 = 
	`sched_g‘_´iÜ™y_mš
(
SCHED_OTHER
) + 1;

125 
	`as£¹
(
	`±h»ad_©Œ_£tsched·¿m
(&
©Œ
, &
·¿m
) == 0);

127 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, &
©Œ
, 
func
, (*) &attr) == 0);

128 
	`as£¹
(
	`±h»ad_još
(
t
, &
»suÉ
) == 0);

131 
	}
}

	@tests/priority2.c

80 
	~"‹¡.h
"

84 
	mPTW32TEST_THREAD_INIT_PRIO
 = 0,

85 
	mPTW32TEST_MAXPRIORITIES
 = 512

88 
±h»ad_b¬r›r_t
 
	g¡¬tB¬r›r
, 
	g’dB¬r›r
;

90 * 
	$func
(* 
¬g
)

92 
pŞicy
;

93 
»suÉ
;

94 
sched_·¿m
 
·¿m
;

96 
»suÉ
 = 
	`±h»ad_b¬r›r_wa™
(&
¡¬tB¬r›r
);

97 
	`as£¹
(
»suÉ
 =ğ0 ||„esuÉ =ğ
PTHREAD_BARRIER_SERIAL_THREAD
);

98 
	`as£¹
(
	`±h»ad_g‘sched·¿m
(
	`±h»ad_£lf
(), &
pŞicy
, &
·¿m
) == 0);

99 
	`as£¹
(
pŞicy
 =ğ
SCHED_OTHER
);

100 
»suÉ
 = 
	`±h»ad_b¬r›r_wa™
(&
’dB¬r›r
);

101 
	`as£¹
(
»suÉ
 =ğ0 ||„esuÉ =ğ
PTHREAD_BARRIER_SERIAL_THREAD
);

103 
	`as£¹
(
	`±e_osTh»adG‘PriÜ™y
(
	`±e_osTh»adG‘HªdË
()è=ğ
·¿m
.
sched_´iÜ™y
);

105  (*è
·¿m
.
sched_´iÜ™y
;

106 
	}
}

110 
	$±h»ad_‹¡_´iÜ™y2
()

112 
±h»ad_t
 
t
;

113 * 
»suÉ
 = 
NULL
;

114 
»suÉ2
;

115 
sched_·¿m
 
·¿m
;

123 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
¡¬tB¬r›r
, 
NULL
, 2) == 0);

124 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
’dB¬r›r
, 
NULL
, 2) == 0);

134 
·¿m
.
sched_´iÜ™y
 = 
	`±e_osTh»adG‘MšPriÜ™y
();

135 
·¿m
.
sched_´iÜ™y
 <ğ
	`±e_osTh»adG‘MaxPriÜ™y
();

136 
·¿m
.
sched_´iÜ™y
++)

138 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

139 
	`as£¹
(
	`±h»ad_£tsched·¿m
(
t
, 
SCHED_OTHER
, &
·¿m
) == 0);

140 
»suÉ2
 = 
	`±h»ad_b¬r›r_wa™
(&
¡¬tB¬r›r
);

141 
	`as£¹
(
»suÉ2
 =ğ0 ||„esuÉ2 =ğ
PTHREAD_BARRIER_SERIAL_THREAD
);

142 
»suÉ2
 = 
	`±h»ad_b¬r›r_wa™
(&
’dB¬r›r
);

143 
	`as£¹
(
»suÉ2
 =ğ0 ||„esuÉ2 =ğ
PTHREAD_BARRIER_SERIAL_THREAD
);

148 
	`±h»ad_još
(
t
, &
»suÉ
);

149 
	`as£¹
(
·¿m
.
sched_´iÜ™y
 =ğ()
»suÉ
);

152 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
¡¬tB¬r›r
) == 0);

153 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
’dB¬r›r
) == 0);

156 
	}
}

	@tests/reuse1.c

80 
	~"‹¡.h
"

84 
	mNUMTHREADS
 = 50

87 
	gwash”e
 = 0;

89 * 
	$func
(* 
¬g
)

91 
wash”e
 = 1;

92  
¬g
;

93 
	}
}

95 
	$±h»ad_‹¡_»u£1
()

97 
±h»ad_t
 
t
,

98 
Ï¡_t
;

99 
±h»ad_©Œ_t
 
©Œ
;

100 * 
»suÉ
 = 
NULL
;

101 
i
;

103 
	`as£¹
(
	`±h»ad_©Œ_š™
(&
©Œ
) == 0);;

104 
	`as£¹
(
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
) == 0);

106 
wash”e
 = 0;

107 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, &
©Œ
, 
func
, 
NULL
) == 0);

108 
	`as£¹
(
	`±h»ad_još
(
t
, &
»suÉ
) == 0);;

109 
	`as£¹
(
»suÉ
 == 0);

110 
	`as£¹
(
wash”e
 == 1);

111 
Ï¡_t
 = 
t
;

113 
i
 = 1; i < 
NUMTHREADS
; i++)

115 
wash”e
 = 0;

116 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, &
©Œ
, 
func
, (*è
i
) == 0);

117 
	`±h»ad_još
(
t
, &
»suÉ
);

118 
	`as£¹
((è
»suÉ
 =ğ
i
);

119 
	`as£¹
(
wash”e
 == 1);

121 
	`as£¹
(!
	`±h»ad_equ®
(
t
, 
Ï¡_t
));

123 
	`as£¹
(
t
.
p
 =ğ
Ï¡_t
.p);

125 
	`as£¹
(
t
.
x
 =ğ
Ï¡_t
.x+1);

126 
Ï¡_t
 = 
t
;

130 
	}
}

	@tests/reuse2.c

83 
	~"‹¡.h
"

92 
	mNUMTHREADS
 = 100

96 
	gdÚe
 = 0;

98 * 
	$func
(* 
¬g
)

100 
	`sched_y›ld
();

102 
	`PTE_ATOMIC_INCREMENT
(&
dÚe
);

105 
	}
}

107 
	$±h»ad_‹¡_»u£2
()

109 
±h»ad_t
 
t
[
NUMTHREADS
];

110 
±h»ad_©Œ_t
 
©Œ
;

111 
i
;

112 
nÙUnique
 = 0,

113 
tÙ®HªdËs
 = 0,

114 
»u£Max
 = 0,

115 
»u£Mš
 = 
NUMTHREADS
;

117 
	`as£¹
(
	`±h»ad_©Œ_š™
(&
©Œ
) == 0);

118 
	`as£¹
(
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_DETACHED
) == 0);

120 
i
 = 0; i < 
NUMTHREADS
; i++)

122 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], &
©Œ
, 
func
, 
NULL
) == 0);

125 
NUMTHREADS
 > 
	`PTE_ATOMIC_EXCHANGE_ADD
(&
dÚe
, 0L))

126 
	`±e_osTh»adSË•
(100);

128 
	`±e_osTh»adSË•
(100);

134 
i
 = 0; i < 
NUMTHREADS
; i++)

136 ià(
t
[
i
].
p
 !ğ
NULL
)

138 
j
, 
thisMax
;

140 
thisMax
 = 
t
[
i
].
x
;

142 
j
 = 
i
+1; j < 
NUMTHREADS
; j++)

143 ià(
t
[
i
].
p
 =ğt[
j
].p)

145 ià(
t
[
i
].
x
 =ğt[
j
].x)

146 
nÙUnique
++;

147 ià(
thisMax
 < 
t
[
j
].
x
)

148 
thisMax
 = 
t
[
j
].
x
;

149 
t
[
j
].
p
 = 
NULL
;

152 ià(
»u£Mš
 > 
thisMax
)

153 
»u£Mš
 = 
thisMax
;

155 ià(
»u£Max
 < 
thisMax
)

156 
»u£Max
 = 
thisMax
;

160 
i
 = 0; i < 
NUMTHREADS
; i++)

161 ià(
t
[
i
].
p
 !ğ
NULL
)

162 
tÙ®HªdËs
++;

170 
	}
}

	@tests/rwlock1.c

49 
	~"‹¡.h
"

51 
±h»ad_rwlock_t
 
	grwlock
 = 
NULL
;

53 
	$±h»ad_‹¡_rwlock1
()

55 
rwlock
 = 
NULL
;

57 
	`as£¹
(
rwlock
 =ğ
NULL
);

59 
	`as£¹
(
	`±h»ad_rwlock_š™
(&
rwlock
, 
NULL
) == 0);

61 
	`as£¹
(
rwlock
 !ğ
NULL
);

63 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock
) == 0);

65 
	`as£¹
(
rwlock
 =ğ
NULL
);

68 
	}
}

	@tests/rwlock2.c

50 
	~"‹¡.h
"

52 
±h»ad_rwlock_t
 
	grwlock
 = 
PTHREAD_RWLOCK_INITIALIZER
;

54 
	$±h»ad_‹¡_rwlock2
()

56 
rwlock
 = 
PTHREAD_RWLOCK_INITIALIZER
;

58 
	`as£¹
(
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
);

60 
	`as£¹
(
	`±h»ad_rwlock_rdlock
(&
rwlock
) == 0);

62 
	`as£¹
(
rwlock
 !ğ
PTHREAD_RWLOCK_INITIALIZER
);

64 
	`as£¹
(
rwlock
 !ğ
NULL
);

66 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock
) == 0);

68 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock
) == 0);

70 
	`as£¹
(
rwlock
 =ğ
NULL
);

73 
	}
}

	@tests/rwlock2_t.c

50 
	~"‹¡.h
"

52 
±h»ad_rwlock_t
 
	grwlock
 = 
PTHREAD_RWLOCK_INITIALIZER
;

54 
	$±h»ad_‹¡_rwlock2t
()

56 
time¥ec
 
ab¡ime
 =

60 
_timeb
 
cu¼SysTime
;

61 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

63 
rwlock
 = 
PTHREAD_RWLOCK_INITIALIZER
;

65 
	`_áime
(&
cu¼SysTime
);

67 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

68 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

70 
ab¡ime
.
tv_£c
 += 1;

72 
	`as£¹
(
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
);

74 
	`as£¹
(
	`±h»ad_rwlock_timedrdlock
(&
rwlock
, &
ab¡ime
) == 0);

76 
	`as£¹
(
rwlock
 !ğ
PTHREAD_RWLOCK_INITIALIZER
);

78 
	`as£¹
(
rwlock
 !ğ
NULL
);

80 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock
) == 0);

82 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock
) == 0);

84 
	`as£¹
(
rwlock
 =ğ
NULL
);

87 
	}
}

	@tests/rwlock3.c

51 
	~"‹¡.h
"

53 
±h»ad_rwlock_t
 
	grwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

55 
	gwash”e
 = 0;

57 * 
	$func
(* 
¬g
)

59 
	`as£¹
(
	`±h»ad_rwlock_Œyw¾ock
(&
rwlock1
è=ğ
EBUSY
);

61 
wash”e
 = 1;

64 
	}
}

66 
	$±h»ad_‹¡_rwlock3
()

68 
±h»ad_t
 
t
;

70 
rwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

72 
	`as£¹
(
	`±h»ad_rwlock_w¾ock
(&
rwlock1
) == 0);

74 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

76 
	`±e_osTh»adSË•
(2000);

78 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

80 
	`as£¹
(
wash”e
 == 1);

82 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

84 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock1
) == 0);

87 
	}
}

	@tests/rwlock3_t.c

51 
	~"‹¡.h
"

53 
±h»ad_rwlock_t
 
	grwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

55 
	gwash”e
 = 0;

57 * 
	$func
(* 
¬g
)

59 
	`as£¹
(
	`±h»ad_rwlock_Œyw¾ock
(&
rwlock1
è=ğ
EBUSY
);

61 
wash”e
 = 1;

64 
	}
}

66 
	$±h»ad_‹¡_rwlock3t
()

68 
±h»ad_t
 
t
;

69 
time¥ec
 
ab¡ime
 =

73 
_timeb
 
cu¼SysTime
;

74 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

76 
rwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

78 
	`_áime
(&
cu¼SysTime
);

80 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

81 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

83 
ab¡ime
.
tv_£c
 += 1;

85 
	`as£¹
(
	`±h»ad_rwlock_timedw¾ock
(&
rwlock1
, &
ab¡ime
) == 0);

87 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

89 
	`±e_osTh»adSË•
(2000);

91 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

93 
	`as£¹
(
wash”e
 == 1);

95 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

97 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock1
) == 0);

100 
	}
}

	@tests/rwlock4.c

51 
	~"‹¡.h
"

53 
±h»ad_rwlock_t
 
	grwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

55 
	gwash”e
 = 0;

57 * 
	$func
(* 
¬g
)

59 
	`as£¹
(
	`±h»ad_rwlock_Œyw¾ock
(&
rwlock1
è=ğ
EBUSY
);

61 
wash”e
 = 1;

64 
	}
}

66 
	$±h»ad_‹¡_rwlock4
()

68 
±h»ad_t
 
t
;

70 
rwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

72 
	`as£¹
(
	`±h»ad_rwlock_rdlock
(&
rwlock1
) == 0);

74 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

76 
	`±e_osTh»adSË•
(2000);

78 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

80 
	`as£¹
(
wash”e
 == 1);

82 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

84 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock1
) == 0);

87 
	}
}

	@tests/rwlock4_t.c

51 
	~"‹¡.h
"

53 
±h»ad_rwlock_t
 
	grwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

55 
	gwash”e
 = 0;

57 * 
	$func
(* 
¬g
)

59 
	`as£¹
(
	`±h»ad_rwlock_Œyw¾ock
(&
rwlock1
è=ğ
EBUSY
);

61 
wash”e
 = 1;

64 
	}
}

66 
	$±h»ad_‹¡_rwlock4t
()

68 
±h»ad_t
 
t
;

69 
time¥ec
 
ab¡ime
 =

73 
_timeb
 
cu¼SysTime
;

74 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

76 
rwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

78 
	`_áime
(&
cu¼SysTime
);

80 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

81 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

83 
ab¡ime
.
tv_£c
 += 1;

85 
	`as£¹
(
	`±h»ad_rwlock_timedrdlock
(&
rwlock1
, &
ab¡ime
) == 0);

87 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

89 
	`±e_osTh»adSË•
(2000);

91 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

93 
	`as£¹
(
wash”e
 == 1);

95 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

97 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock1
) == 0);

100 
	}
}

	@tests/rwlock5.c

51 
	~"‹¡.h
"

53 
±h»ad_rwlock_t
 
	grwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

55 
	gwash”e
 = 0;

57 * 
	$func
(* 
¬g
)

59 
	`as£¹
(
	`±h»ad_rwlock_Œyrdlock
(&
rwlock1
) == 0);

61 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

63 
wash”e
 = 1;

66 
	}
}

68 
	$±h»ad_‹¡_rwlock5
()

70 
±h»ad_t
 
t
;

72 
rwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

74 
	`as£¹
(
	`±h»ad_rwlock_rdlock
(&
rwlock1
) == 0);

76 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

78 
	`±e_osTh»adSË•
(2000);

80 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

82 
	`as£¹
(
wash”e
 == 1);

84 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

86 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock1
) == 0);

89 
	}
}

	@tests/rwlock5_t.c

51 
	~"‹¡.h
"

54 
±h»ad_rwlock_t
 
	grwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

56 
	gwash”e
 = 0;

58 * 
	$func
(* 
¬g
)

60 
	`as£¹
(
	`±h»ad_rwlock_Œyrdlock
(&
rwlock1
) == 0);

62 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

64 
wash”e
 = 1;

67 
	}
}

69 
	$±h»ad_‹¡_rwlock5t
()

71 
±h»ad_t
 
t
;

72 
time¥ec
 
ab¡ime
 =

76 
_timeb
 
cu¼SysTime
;

77 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

79 
wash”e
 = 0;

81 
rwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

83 
	`_áime
(&
cu¼SysTime
);

85 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

86 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

88 
ab¡ime
.
tv_£c
 += 1;

90 
	`as£¹
(
	`±h»ad_rwlock_timedrdlock
(&
rwlock1
, &
ab¡ime
) == 0);

92 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

94 
	`±e_osTh»adSË•
(2000);

96 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

98 
	`as£¹
(
wash”e
 == 1);

100 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

102 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock1
) == 0);

105 
	}
}

	@tests/rwlock6.c

50 
	~"‹¡.h
"

52 
±h»ad_rwlock_t
 
	grwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

54 
	gbªkAccouÁ
 = 0;

56 * 
	$wrfunc
(* 
¬g
)

58 
ba
;

60 
	`as£¹
(
	`±h»ad_rwlock_w¾ock
(&
rwlock1
) == 0);

61 
	`±e_osTh»adSË•
(2000);

62 
bªkAccouÁ
 += 10;

63 
ba
 = 
bªkAccouÁ
;

64 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

66  ((*è
ba
);

67 
	}
}

69 * 
	$rdfunc
(* 
¬g
)

71 
ba
;

73 
	`as£¹
(
	`±h»ad_rwlock_rdlock
(&
rwlock1
) == 0);

74 
ba
 = 
bªkAccouÁ
;

75 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

77  ((*è
ba
);

78 
	}
}

80 
	$±h»ad_‹¡_rwlock6
()

82 
±h»ad_t
 
w¹1
;

83 
±h»ad_t
 
w¹2
;

84 
±h»ad_t
 
rdt
;

85 
wr1ResuÉ
 = 0;

86 
wr2ResuÉ
 = 0;

87 
rdResuÉ
 = 0;

89 
rwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

91 
bªkAccouÁ
 = 0;

93 
	`as£¹
(
	`±h»ad_ü—‹
(&
w¹1
, 
NULL
, 
wrfunc
, NULL) == 0);

94 
	`±e_osTh»adSË•
(500);

95 
	`as£¹
(
	`±h»ad_ü—‹
(&
rdt
, 
NULL
, 
rdfunc
, NULL) == 0);

96 
	`±e_osTh»adSË•
(500);

97 
	`as£¹
(
	`±h»ad_ü—‹
(&
w¹2
, 
NULL
, 
wrfunc
, NULL) == 0);

99 
	`as£¹
(
	`±h»ad_još
(
w¹1
, (**è&
wr1ResuÉ
) == 0);

100 
	`as£¹
(
	`±h»ad_još
(
rdt
, (**è&
rdResuÉ
) == 0);

101 
	`as£¹
(
	`±h»ad_još
(
w¹2
, (**è&
wr2ResuÉ
) == 0);

103 
	`as£¹
(
wr1ResuÉ
 == 10);

104 
	`as£¹
(
rdResuÉ
 == 10);

105 
	`as£¹
(
wr2ResuÉ
 == 20);

107 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock1
) == 0);

110 
	}
}

	@tests/rwlock6_t.c

50 
	~"‹¡.h
"

52 
±h»ad_rwlock_t
 
	grwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

54 
	gbªkAccouÁ
 = 0;

56 * 
	$wrfunc
(* 
¬g
)

58 
	`as£¹
(
	`±h»ad_rwlock_w¾ock
(&
rwlock1
) == 0);

59 
	`±e_osTh»adSË•
(2000);

60 
bªkAccouÁ
 += 10;

61 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

63  ((*è
bªkAccouÁ
);

64 
	}
}

66 * 
	$rdfunc
(* 
¬g
)

68 
ba
 = -1;

69 
time¥ec
 
ab¡ime
 =

73 
_timeb
 
cu¼SysTime
;

74 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

76 
	`_áime
(&
cu¼SysTime
);

78 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

79 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

82 ià((è
¬g
 == 1)

84 
ab¡ime
.
tv_£c
 += 1;

85 
	`as£¹
(
	`±h»ad_rwlock_timedrdlock
(&
rwlock1
, &
ab¡ime
è=ğ
ETIMEDOUT
);

86 
ba
 = 0;

88 ià((è
¬g
 == 2)

90 
ab¡ime
.
tv_£c
 += 3;

91 
	`as£¹
(
	`±h»ad_rwlock_timedrdlock
(&
rwlock1
, &
ab¡ime
) == 0);

92 
ba
 = 
bªkAccouÁ
;

93 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

96  ((*è
ba
);

97 
	}
}

99 
	$±h»ad_‹¡_rwlock6t
()

101 
±h»ad_t
 
w¹1
;

102 
±h»ad_t
 
w¹2
;

103 
±h»ad_t
 
rdt1
;

104 
±h»ad_t
 
rdt2
;

105 
wr1ResuÉ
 = 0;

106 
wr2ResuÉ
 = 0;

107 
rd1ResuÉ
 = 0;

108 
rd2ResuÉ
 = 0;

110 
rwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

112 
bªkAccouÁ
 = 0;

114 
	`as£¹
(
	`±h»ad_ü—‹
(&
w¹1
, 
NULL
, 
wrfunc
, NULL) == 0);

115 
	`±e_osTh»adSË•
(500);

116 
	`as£¹
(
	`±h»ad_ü—‹
(&
rdt1
, 
NULL
, 
rdfunc
, (*) 1) == 0);

117 
	`±e_osTh»adSË•
(500);

118 
	`as£¹
(
	`±h»ad_ü—‹
(&
w¹2
, 
NULL
, 
wrfunc
, NULL) == 0);

119 
	`±e_osTh»adSË•
(500);

120 
	`as£¹
(
	`±h»ad_ü—‹
(&
rdt2
, 
NULL
, 
rdfunc
, (*) 2) == 0);

122 
	`as£¹
(
	`±h»ad_još
(
w¹1
, (**è&
wr1ResuÉ
) == 0);

123 
	`as£¹
(
	`±h»ad_još
(
rdt1
, (**è&
rd1ResuÉ
) == 0);

124 
	`as£¹
(
	`±h»ad_još
(
w¹2
, (**è&
wr2ResuÉ
) == 0);

125 
	`as£¹
(
	`±h»ad_još
(
rdt2
, (**è&
rd2ResuÉ
) == 0);

127 
	`as£¹
(
wr1ResuÉ
 == 10);

128 
	`as£¹
(
rd1ResuÉ
 == 0);

129 
	`as£¹
(
wr2ResuÉ
 == 20);

130 
	`as£¹
(
rd2ResuÉ
 == 20);

132 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock1
) == 0);

135 
	}
}

	@tests/rwlock6_t2.c

50 
	~"‹¡.h
"

53 
±h»ad_rwlock_t
 
	grwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

55 
	gbªkAccouÁ
 = 0;

56 
time¥ec
 
	gab¡ime
 =

61 * 
	$wrfunc
(* 
¬g
)

63 
»suÉ
;

65 
»suÉ
 = 
	`±h»ad_rwlock_timedw¾ock
(&
rwlock1
, &
ab¡ime
);

66 ià((è
¬g
 == 1)

68 
	`as£¹
(
»suÉ
 == 0);

69 
	`±e_osTh»adSË•
(2000);

70 
bªkAccouÁ
 += 10;

71 
	`as£¹
(
	`±h»ad_rwlock_uÆock
(&
rwlock1
) == 0);

72  ((*è
bªkAccouÁ
);

74 ià((è
¬g
 == 2)

76 
	`as£¹
(
»suÉ
 =ğ
ETIMEDOUT
);

81 
	}
}

83 * 
	$rdfunc
(* 
¬g
)

85 
ba
 = 0;

87 
	`as£¹
(
	`±h»ad_rwlock_timedrdlock
(&
rwlock1
, &
ab¡ime
è=ğ
ETIMEDOUT
);

89  ((*è
ba
);

90 
	}
}

92 
	$±h»ad_‹¡_rwlock6t2
()

94 
±h»ad_t
 
w¹1
;

95 
±h»ad_t
 
w¹2
;

96 
±h»ad_t
 
rdt
;

97 
wr1ResuÉ
 = 0;

98 
wr2ResuÉ
 = 0;

99 
rdResuÉ
 = 0;

100 
_timeb
 
cu¼SysTime
;

101 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

103 
rwlock1
 = 
PTHREAD_RWLOCK_INITIALIZER
;

105 
	`_áime
(&
cu¼SysTime
);

107 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

108 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

110 
ab¡ime
.
tv_£c
 += 1;

112 
bªkAccouÁ
 = 0;

114 
	`as£¹
(
	`±h»ad_ü—‹
(&
w¹1
, 
NULL
, 
wrfunc
, (*) 1) == 0);

115 
	`±e_osTh»adSË•
(100);

116 
	`as£¹
(
	`±h»ad_ü—‹
(&
rdt
, 
NULL
, 
rdfunc
, NULL) == 0);

117 
	`±e_osTh»adSË•
(100);

118 
	`as£¹
(
	`±h»ad_ü—‹
(&
w¹2
, 
NULL
, 
wrfunc
, (*) 2) == 0);

120 
	`as£¹
(
	`±h»ad_još
(
w¹1
, (**è&
wr1ResuÉ
) == 0);

121 
	`as£¹
(
	`±h»ad_još
(
rdt
, (**è&
rdResuÉ
) == 0);

122 
	`as£¹
(
	`±h»ad_još
(
w¹2
, (**è&
wr2ResuÉ
) == 0);

124 
	`as£¹
(
wr1ResuÉ
 == 10);

125 
	`as£¹
(
rdResuÉ
 == 0);

126 
	`as£¹
(
wr2ResuÉ
 == 100);

128 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
(&
rwlock1
) == 0);

131 
	}
}

	@tests/rwlock7.c

8 
	~"‹¡.h
"

10 #ifdeà
__GNUC__


14 
	#THREADS
 5

	)

15 
	#DATASIZE
 7

	)

16 
	#ITERATIONS
 100000

	)

21 
	sth»ad_g


23 
	mth»ad_num
;

24 
±h»ad_t
 
	mth»ad_id
;

25 
	mupd©es
;

26 
	m»ads
;

27 
	mchªged
;

28 
	m£ed
;

29 } 
	tth»ad_t
;

34 
	sd©a_g


36 
±h»ad_rwlock_t
 
	mlock
;

37 
	md©a
;

38 
	mupd©es
;

39 } 
	td©a_t
;

41 
th»ad_t
 
	gth»ads
[
THREADS
];

42 
d©a_t
 
	gd©a
[
DATASIZE
];

47 *
	$th»ad_routše
 (*
¬g
)

49 
th»ad_t
 *
£lf
 = (th»ad_t*)
¬g
;

50 
™”©iÚ
;

51 
–em’t
 = 0;

52 
š‹rv®
 = 1 + 
	`¿nd
() % 71;

54 
£lf
->
chªged
 = 0;

56 
™”©iÚ
 = 0; i‹¿tiÚ < 
ITERATIONS
; iteration++)

70 ià((
™”©iÚ
 % 
š‹rv®
) == 0)

72 
	`as£¹
(
	`±h»ad_rwlock_w¾ock
 (&
d©a
[
–em’t
].
lock
) == 0);

73 
d©a
[
–em’t
].d©¨ğ
£lf
->
th»ad_num
;

74 
d©a
[
–em’t
].
upd©es
++;

75 
£lf
->
upd©es
++;

76 
š‹rv®
 = 1 + 
	`¿nd
 () % 71;

77 
	`as£¹
(
	`±h»ad_rwlock_uÆock
 (&
d©a
[
–em’t
].
lock
) == 0);

86 
	`as£¹
(
	`±h»ad_rwlock_rdlock
 (&
d©a
[
–em’t
].
lock
) == 0);

88 
£lf
->
»ads
++;

90 ià(
d©a
[
–em’t
].d©¨!ğ
£lf
->
th»ad_num
)

92 
£lf
->
chªged
++;

93 
š‹rv®
 = 1 + 
£lf
->
chªged
 % 71;

96 
	`as£¹
(
	`±h»ad_rwlock_uÆock
 (&
d©a
[
–em’t
].
lock
) == 0);

99 
–em’t
 = (–em’ˆ+ 1è% 
DATASIZE
;

103  
NULL
;

104 
	}
}

106 
	$±h»ad_‹¡_rwlock7
()

108 
couÁ
;

109 
d©a_couÁ
;

110 
th»ad_upd©es
 = 0;

111 
d©a_upd©es
 = 0;

113 
_timeb
 
cu¼SysTime1
;

114 
_timeb
 
cu¼SysTime2
;

119 
d©a_couÁ
 = 0; d©a_couÁ < 
DATASIZE
; data_count++)

121 
d©a
[
d©a_couÁ
].data = 0;

122 
d©a
[
d©a_couÁ
].
upd©es
 = 0;

124 
	`as£¹
(
	`±h»ad_rwlock_š™
 (&
d©a
[
d©a_couÁ
].
lock
, 
NULL
) == 0);

127 
	`_áime
(&
cu¼SysTime1
);

132 
couÁ
 = 0; couÁ < 
THREADS
; count++)

134 
th»ads
[
couÁ
].
th»ad_num
 = count;

135 
th»ads
[
couÁ
].
upd©es
 = 0;

136 
th»ads
[
couÁ
].
»ads
 = 0;

137 
th»ads
[
couÁ
].
£ed
 = 1 + 
	`¿nd
() % 71;

139 
	`as£¹
(
	`±h»ad_ü—‹
 (&
th»ads
[
couÁ
].
th»ad_id
,

140 
NULL
, 
th»ad_routše
, (*)&
th»ads
[
couÁ
]) == 0);

147 
couÁ
 = 0; couÁ < 
THREADS
; count++)

149 
	`as£¹
(
	`±h»ad_još
 (
th»ads
[
couÁ
].
th»ad_id
, 
NULL
) == 0);

157 
couÁ
 = 0; couÁ < 
THREADS
; count++)

166 
couÁ
 = 0; couÁ < 
THREADS
; count++)

168 
th»ad_upd©es
 +ğ
th»ads
[
couÁ
].
upd©es
;

179 
d©a_couÁ
 = 0; d©a_couÁ < 
DATASIZE
; data_count++)

181 
d©a_upd©es
 +ğ
d©a
[
d©a_couÁ
].
upd©es
;

182 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
 (&
d©a
[
d©a_couÁ
].
lock
) == 0);

185 
	`_áime
(&
cu¼SysTime2
);

188 
	}
}

	@tests/rwlock8.c

11 
	~"‹¡.h
"

13 #ifdeà
__GNUC__


17 
	#THREADS
 5

	)

18 
	#DATASIZE
 7

	)

19 
	#ITERATIONS
 10000

	)

24 
	sth»ad_g


26 
	mth»ad_num
;

27 
±h»ad_t
 
	mth»ad_id
;

28 
	mupd©es
;

29 
	m»ads
;

30 
	mchªged
;

31 
	m£ed
;

32 } 
	tth»ad_t
;

37 
	sd©a_g


39 
±h»ad_rwlock_t
 
	mlock
;

40 
	md©a
;

41 
	mupd©es
;

42 } 
	td©a_t
;

44 
th»ad_t
 
	gth»ads
[
THREADS
];

45 
d©a_t
 
	gd©a
[
DATASIZE
];

50 *
	$th»ad_routše
 (*
¬g
)

52 
th»ad_t
 *
£lf
 = (th»ad_t*)
¬g
;

53 
™”©iÚ
;

54 
–em’t
 = 0;

55 
š‹rv®
 = 1 + 
	`¿nd
() % 71;

57 
£lf
->
chªged
 = 0;

59 
™”©iÚ
 = 0; i‹¿tiÚ < 
ITERATIONS
; iteration++)

73 ià((
™”©iÚ
 % 
š‹rv®
) == 0)

75 
	`as£¹
(
	`±h»ad_rwlock_w¾ock
 (&
d©a
[
–em’t
].
lock
) == 0);

76 
d©a
[
–em’t
].d©¨ğ
£lf
->
th»ad_num
;

77 
d©a
[
–em’t
].
upd©es
++;

78 
£lf
->
upd©es
++;

79 
š‹rv®
 = 1 + 
	`¿nd
() % 71;

80 
	`sched_y›ld
();

81 
	`as£¹
(
	`±h»ad_rwlock_uÆock
 (&
d©a
[
–em’t
].
lock
) == 0);

90 
	`as£¹
(
	`±h»ad_rwlock_rdlock
 (&
d©a
[
–em’t
].
lock
) == 0);

92 
£lf
->
»ads
++;

94 ià(
d©a
[
–em’t
].d©¨!ğ
£lf
->
th»ad_num
)

96 
£lf
->
chªged
++;

97 
š‹rv®
 = 1 + 
£lf
->
chªged
 % 71;

100 
	`sched_y›ld
();

102 
	`as£¹
(
	`±h»ad_rwlock_uÆock
 (&
d©a
[
–em’t
].
lock
) == 0);

105 
–em’t
 = (–em’ˆ+ 1è% 
DATASIZE
;

109  
NULL
;

110 
	}
}

112 
	$±h»ad_‹¡_rwlock8
()

114 
couÁ
;

115 
d©a_couÁ
;

116 
th»ad_upd©es
 = 0;

117 
d©a_upd©es
 = 0;

119 
_timeb
 
cu¼SysTime1
;

120 
_timeb
 
cu¼SysTime2
;

125 
d©a_couÁ
 = 0; d©a_couÁ < 
DATASIZE
; data_count++)

127 
d©a
[
d©a_couÁ
].data = 0;

128 
d©a
[
d©a_couÁ
].
upd©es
 = 0;

130 
	`as£¹
(
	`±h»ad_rwlock_š™
 (&
d©a
[
d©a_couÁ
].
lock
, 
NULL
) == 0);

133 
	`_áime
(&
cu¼SysTime1
);

138 
couÁ
 = 0; couÁ < 
THREADS
; count++)

140 
th»ads
[
couÁ
].
th»ad_num
 = count;

141 
th»ads
[
couÁ
].
upd©es
 = 0;

142 
th»ads
[
couÁ
].
»ads
 = 0;

143 
th»ads
[
couÁ
].
£ed
 = 1 + 
	`¿nd
() % 71;

145 
	`as£¹
(
	`±h»ad_ü—‹
 (&
th»ads
[
couÁ
].
th»ad_id
,

146 
NULL
, 
th»ad_routše
, (*)&
th»ads
[
couÁ
]) == 0);

153 
couÁ
 = 0; couÁ < 
THREADS
; count++)

155 
	`as£¹
(
	`±h»ad_još
 (
th»ads
[
couÁ
].
th»ad_id
, 
NULL
) == 0);

157 
couÁ
 = 0; couÁ < 
THREADS
; count++)

159 
th»ad_upd©es
 +ğ
th»ads
[
couÁ
].
upd©es
;

169 
d©a_couÁ
 = 0; d©a_couÁ < 
DATASIZE
; data_count++)

171 
d©a_upd©es
 +ğ
d©a
[
d©a_couÁ
].
upd©es
;

172 
	`as£¹
(
	`±h»ad_rwlock_de¡roy
 (&
d©a
[
d©a_couÁ
].
lock
) == 0);

175 
	`_áime
(&
cu¼SysTime2
);

178 
	}
}

	@tests/self1.c

54 
	~"‹¡.h
"

56 
	$±h»ad_‹¡_£lf1
()

62 
±h»ad_t
 
£lf
;

64 #ifdeà
PTW32_STATIC_LIB


68 
£lf
 = 
	`±h»ad_£lf
();

70 
	`as£¹
(
£lf
 !ğ
NULL
);

72 #ifdeà
PTW32_STATIC_LIB


76 
	}
}

	@tests/self2.c

56 
	~"‹¡.h
"

59 
±h»ad_t
 
	gme
;

62 
	$’Œy
(* 
¬g
)

64 
me
 = 
	`±h»ad_£lf
();

66  
¬g
;

67 
	}
}

69 
	$±h»ad_‹¡_£lf2
()

71 
±h»ad_t
 
t
;

73 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
’Œy
, NULL) == 0);

75 
	`±e_osTh»adSË•
(100);

77 
	`as£¹
(
	`±h»ad_equ®
(
t
, 
me
) != 0);

79 
	`as£¹
(
	`±h»ad_još
(
t
,
NULL
) == 0);

83 
	}
}

	@tests/semaphore1.c

80 
	~"‹¡.h
"

83 
	$thr
(* 
¬g
)

85 
£m_t
 
s
;

86 
»suÉ
;

88 
	`as£¹
(
	`£m_š™
(&
s
, 
PTHREAD_PROCESS_PRIVATE
, 0) == 0);

90 
	`as£¹
((
»suÉ
 = 
	`£m_Œywa™
(&
s
)) == -1);

92 iàĞ
»suÉ
 == -1 )

94 
”r
 = 
”ºo
;

95 
	`as£¹
(
”r
 =ğ
EAGAIN
);

98 
	`as£¹
((
»suÉ
 = 
	`£m_po¡
(&
s
)) == 0);

100 
	`as£¹
((
»suÉ
 = 
	`£m_Œywa™
(&
s
)) == 0);

102 
	`as£¹
(
	`£m_po¡
(&
s
) == 0);

104 
	`as£¹
(
	`£m_de¡roy
(&
s
) == 0);

107 
	}
}

110 
	$±h»ad_‹¡_£m­hÜe1
()

112 
±h»ad_t
 
t
;

113 
£m_t
 
s
;

114 
»suÉ
;

116 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
thr
, NULL) == 0);

117 
	`as£¹
(
	`±h»ad_još
(
t
, (**)&
»suÉ
) == 0);

118 
	`as£¹
(
»suÉ
 == 0);

120 
	`as£¹
(
	`£m_š™
(&
s
, 
PTHREAD_PROCESS_PRIVATE
, 0) == 0);

122 
	`as£¹
((
»suÉ
 = 
	`£m_Œywa™
(&
s
)) == -1);

124 iàĞ
»suÉ
 == -1 )

126 
”r
 = 
”ºo
;

127 
	`as£¹
(
”r
 =ğ
EAGAIN
);

130 
	`as£¹
((
»suÉ
 = 
	`£m_po¡
(&
s
)) == 0);

132 
	`as£¹
((
»suÉ
 = 
	`£m_Œywa™
(&
s
)) == 0);

134 
	`as£¹
(
	`£m_po¡
(&
s
) == 0);

136 
	`as£¹
(
	`£m_de¡roy
(&
s
) == 0);

138 
	}
}

	@tests/semaphore2.c

80 
	~"‹¡.h
"

82 
	#MAX_COUNT
 100

	)

84 
	$±h»ad_‹¡_£m­hÜe2
()

86 
£m_t
 
s
;

87 
v®ue
 = 0;

88 
i
;

90 
	`as£¹
(
	`£m_š™
(&
s
, 
PTHREAD_PROCESS_PRIVATE
, 
MAX_COUNT
) == 0);

91 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

92 
	`as£¹
(
v®ue
 =ğ
MAX_COUNT
);

94 
i
 = 
MAX_COUNT
 - 1; i >= 0; i--)

96 
	`as£¹
(
	`£m_wa™
(&
s
) == 0);

97 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

98 
	`as£¹
(
v®ue
 =ğ
i
);

101 
i
 = 1; i <ğ
MAX_COUNT
; i++)

103 
	`as£¹
(
	`£m_po¡
(&
s
) == 0);

104 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

105 
	`as£¹
(
v®ue
 =ğ
i
);

108 
	`as£¹
(
	`£m_de¡roy
(&
s
) == 0);

111 
	}
}

	@tests/semaphore3.c

80 
	~"‹¡.h
"

82 
	#MAX_COUNT
 5

	)

84 
£m_t
 
	gs
;

87 
	$thr
 (* 
¬g
)

89 
	`as£¹
(
	`£m_wa™
(&
s
) == 0);

90 
	`as£¹
(
	`±h»ad_d‘ach
(
	`±h»ad_£lf
()) == 0);

91  
NULL
;

92 
	}
}

94 
	$±h»ad_‹¡_£m­hÜe3
()

96 
v®ue
 = 0;

97 
i
;

98 
±h»ad_t
 
t
[
MAX_COUNT
+1];

100 
	`as£¹
(
	`£m_š™
(&
s
, 
PTHREAD_PROCESS_PRIVATE
, 0) == 0);

101 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

102 
	`as£¹
(
v®ue
 == 0);

104 
i
 = 1; i <ğ
MAX_COUNT
; i++)

106 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
thr
, NULL) == 0);

109 
	`sched_y›ld
();

110 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

112 
v®ue
 !ğ-
i
);

113 
	`as£¹
(-
v®ue
 =ğ
i
);

116 
i
 = 
MAX_COUNT
 - 1; i >= 0; i--)

118 
	`as£¹
(
	`£m_po¡
(&
s
) == 0);

119 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

120 
	`as£¹
(-
v®ue
 =ğ
i
);

123 
	`±e_osTh»adSË•
(1000);

125 
	`as£¹
(
	`£m_de¡roy
(&
s
) == 0);

128 
	}
}

	@tests/semaphore4.c

81 
	~"‹¡.h
"

86 
	#MAX_COUNT
 
OS_MAX_SIMUL_THREADS


	)

88 
£m_t
 
	gs
;

91 
	$thr
 (* 
¬g
)

94 ià((è
¬g
 == 5)

98 
	`as£¹
(
	`£m_wa™
(&
s
) == -1);

99 
	`as£¹
(
”ºo
 =ğ
EINTR
);

104 
	`as£¹
(
	`£m_wa™
(&
s
) == 0);

107  
NULL
;

108 
	}
}

110 
	$±h»ad_‹¡_£m­hÜe4
()

112 
v®ue
 = 0;

113 
i
;

114 
±h»ad_t
 
t
[
MAX_COUNT
+1];

116 
	`as£¹
(
	`£m_š™
(&
s
, 
PTHREAD_PROCESS_PRIVATE
, 0) == 0);

117 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

118 
	`as£¹
(
v®ue
 == 0);

120 
i
 = 1; i <ğ
MAX_COUNT
; i++)

122 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
thr
, (*)i) == 0);

125 
	`sched_y›ld
();

126 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

128 
v®ue
 !ğ-
i
);

130 
	`as£¹
(-
v®ue
 =ğ
i
);

133 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

134 
	`as£¹
(-
v®ue
 =ğ
MAX_COUNT
);

136 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[5]) == 0);

138 
»suÉ
;

139 
	`as£¹
(
	`±h»ad_još
(
t
[5], (**è&
»suÉ
) == 0);

141 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

143 
	`as£¹
(-
v®ue
 =ğ(
MAX_COUNT
 - 1));

145 
i
 = 
MAX_COUNT
 - 2; i >= 0; i--)

147 
	`as£¹
(
	`£m_po¡
(&
s
) == 0);

148 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

149 
	`as£¹
(-
v®ue
 =ğ
i
);

153 
i
 = 1; i <ğ
MAX_COUNT
; i++)

155 ià(
i
 != 5)

156 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], 
NULL
) == 0);

159 
	`as£¹
(
	`£m_de¡roy
(&
s
) == 0);

162 
	}
}

	@tests/semaphore4t.c

81 
	~"‹¡.h
"

83 
	#MAX_COUNT
 
OS_MAX_SIMUL_THREADS


	)

85 
£m_t
 
	gs
;

88 
	$thr
 (* 
¬g
)

90 ià((è
¬g
 == 5)

94 
	`as£¹
(
	`£m_timedwa™
(&
s
,
NULL
) == -1);

95 
	`as£¹
(
”ºo
 =ğ
EINTR
);

99 
	`as£¹
(
	`£m_timedwa™
(&
s
,
NULL
) == 0);

102  
NULL
;

103 
	}
}

105 
	$±h»ad_‹¡_£m­hÜe4t
()

107 
v®ue
 = 0;

108 
i
;

109 
±h»ad_t
 
t
[
MAX_COUNT
+1];

111 
	`as£¹
(
	`£m_š™
(&
s
, 
PTHREAD_PROCESS_PRIVATE
, 0) == 0);

112 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

113 
	`as£¹
(
v®ue
 == 0);

115 
i
 = 1; i <ğ
MAX_COUNT
; i++)

117 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
[
i
], 
NULL
, 
thr
, (*) i) == 0);

120 
	`sched_y›ld
();

121 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

123 
v®ue
 !ğ-
i
);

124 
	`as£¹
(-
v®ue
 =ğ
i
);

127 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

128 
	`as£¹
(-
v®ue
 =ğ
MAX_COUNT
);

129 
	`as£¹
(
	`±h»ad_ÿnûl
(
t
[5]) == 0);

130 
	`as£¹
(
	`±h»ad_još
(
t
[5], 
NULL
) == 0);

131 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

132 
	`as£¹
(-
v®ue
 =ğ
MAX_COUNT
 - 1);

134 
i
 = 
MAX_COUNT
 - 2; i >= 0; i--)

136 
	`as£¹
(
	`£m_po¡
(&
s
) == 0);

137 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

138 
	`as£¹
(-
v®ue
 =ğ
i
);

141 
i
 = 1; i <ğ
MAX_COUNT
; i++)

143 ià(
i
 != 5)

144 
	`as£¹
(
	`±h»ad_još
(
t
[
i
], 
NULL
) == 0);

147 
	`as£¹
(
	`£m_de¡roy
(&
s
) == 0);

150 
	}
}

	@tests/semaphore5.c

67 
	~"‹¡.h
"

69 
£m_t
 
	gs
;

72 
	$thr
 (* 
¬g
)

74 
time¥ec
 
ab¡ime
 =

78 
_timeb
 
cu¼SysTime
;

79 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

81 
	`_áime
(&
cu¼SysTime
);

83 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

84 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

86 
ab¡ime
.
tv_£c
 += 5;

87 
	`as£¹
(
	`£m_timedwa™
(&
s
, &
ab¡ime
) == -1);

88 
	`as£¹
(
”ºo
 =ğ
ETIMEDOUT
);

90  
NULL
;

91 
	}
}

93 
	$±h»ad_‹¡_£m­hÜe5
()

95 
v®ue
 = 0;

96 
±h»ad_t
 
hªdË
;

98 
	`as£¹
(
	`£m_š™
(&
s
, 
PTHREAD_PROCESS_PRIVATE
, 0) == 0);

99 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

100 
	`as£¹
(
v®ue
 == 0);

103 
	`as£¹
(
	`±h»ad_ü—‹
(&
hªdË
, 
NULL
, 
thr
, NULL) == 0);

105 
	`as£¹
(
	`±h»ad_još
(
hªdË
, 
NULL
) == 0);

107 
	`as£¹
(
	`£m_de¡roy
(&
s
) == 0);

110 
	}
}

	@tests/semaphore6.c

68 
	~"‹¡.h
"

70 
£m_t
 
	gs
;

71 
	g£mStus
;

74 
	$thr
 (* 
¬g
)

76 
time¥ec
 
ab¡ime
 =

80 
_timeb
 
cu¼SysTime
;

81 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

83 
	`_áime
(&
cu¼SysTime
);

85 
ab¡ime
.
tv_£c
 = 
cu¼SysTime
.
time
;

86 
ab¡ime
.
tv_n£c
 = 
NANOSEC_PER_MILLISEC
 * 
cu¼SysTime
.
ml™m
;

88 
ab¡ime
.
tv_£c
 += 5;

89 
	`as£¹
(
	`£m_timedwa™
(&
s
, &
ab¡ime
) == -1);

90 
	`as£¹
(
”ºo
 =ğ
ETIMEDOUT
);

92 
£mStus
 = 1;

94  
NULL
;

95 
	}
}

97 
	$±h»ad_‹¡_£m­hÜe6
()

99 
v®ue
 = 0;

100 
±h»ad_t
 
hªdË
;

102 
	`as£¹
(
	`£m_š™
(&
s
, 
PTHREAD_PROCESS_PRIVATE
, 0) == 0);

103 
	`as£¹
(
	`£m_g‘v®ue
(&
s
, &
v®ue
) == 0);

104 
	`as£¹
(
v®ue
 == 0);

106 
£mStus
 = 0;

108 
	`as£¹
(
	`±h»ad_ü—‹
(&
hªdË
, 
NULL
, 
thr
, NULL) == 0);

110 
	`±e_osTh»adSË•
(3000);

113 
	`as£¹
(
£mStus
 == 0);

115 
	`as£¹
(
	`±h»ad_još
(
hªdË
, 
NULL
) == 0);

117 
	`as£¹
(
	`£m_de¡roy
(&
s
) == 0);

120 
	}
}

	@tests/spin1.c

47 
	~"‹¡.h
"

49 
±h»ad_¥šlock_t
 
	glock
;

51 
	$±h»ad_‹¡_¥š1
()

53 
	`as£¹
(
	`±h»ad_¥š_š™
(&
lock
, 
PTHREAD_PROCESS_PRIVATE
) == 0);

55 
	`as£¹
(
	`±h»ad_¥š_lock
(&
lock
) == 0);

57 
	`as£¹
(
	`±h»ad_¥š_uÆock
(&
lock
) == 0);

59 
	`as£¹
(
	`±h»ad_¥š_de¡roy
(&
lock
) == 0);

61 
	`as£¹
(
	`±h»ad_¥š_lock
(&
lock
è=ğ
EINVAL
);

64 
	}
}

	@tests/spin2.c

47 
	~"‹¡.h
"

49 
±h»ad_¥šlock_t
 
	glock
 = 
NULL
;

51 
	gwash”e
 = 0;

53 * 
	$func
(* 
¬g
)

55 
	`as£¹
(
	`±h»ad_¥š_Œylock
(&
lock
è=ğ
EBUSY
);

57 
wash”e
 = 1;

60 
	}
}

62 
	$±h»ad_‹¡_¥š2
()

64 
±h»ad_t
 
t
;

66 
	`as£¹
(
	`±h»ad_¥š_š™
(&
lock
, 
PTHREAD_PROCESS_PRIVATE
) == 0);

68 
	`as£¹
(
	`±h»ad_¥š_lock
(&
lock
) == 0);

70 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

71 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

73 
	`as£¹
(
	`±h»ad_¥š_uÆock
(&
lock
) == 0);

75 
	`as£¹
(
	`±h»ad_¥š_de¡roy
(&
lock
) == 0);

77 
	`as£¹
(
wash”e
 == 1);

80 
	}
}

	@tests/spin3.c

47 
	~"‹¡.h
"

49 
	gwasH”e
 = 0;

51 
±h»ad_¥šlock_t
 
	g¥š
;

53 * 
	$uÆock”
(* 
¬g
)

55 
ex³ùedResuÉ
 = (è
¬g
;

57 
wasH”e
++;

58 
	`as£¹
(
	`±h»ad_¥š_uÆock
(&
¥š
è=ğ
ex³ùedResuÉ
);

59 
wasH”e
++;

60  
NULL
;

61 
	}
}

63 
	$±h»ad_‹¡_¥š3
()

65 
±h»ad_t
 
t
;

67 
wasH”e
 = 0;

68 
	`as£¹
(
	`±h»ad_¥š_š™
(&
¥š
, 
PTHREAD_PROCESS_PRIVATE
) == 0);

69 
	`as£¹
(
	`±h»ad_¥š_lock
(&
¥š
) == 0);

70 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
uÆock”
, (*) 0) == 0);

71 
	`as£¹
(
	`±h»ad_još
(
t
, 
NULL
) == 0);

72 
	`as£¹
(
	`±h»ad_¥š_uÆock
(&
¥š
è=ğ
EPERM
);

73 
	`as£¹
(
	`±h»ad_¥š_de¡roy
(&
¥š
) == 0);

74 
	`as£¹
(
wasH”e
 == 2);

77 
	}
}

	@tests/spin4.c

46 
	~"‹¡.h
"

48 
±h»ad_¥šlock_t
 
	glock
 = 
PTHREAD_SPINLOCK_INITIALIZER
;

49 
_timeb
 
	gcu¼SysTimeS¹
;

50 
_timeb
 
	gcu¼SysTimeStİ
;

52 
	#G‘Du¿tiÚMliSecs
(
_TS¹
, 
_TStİ
è((_TStİ.
time
*1000+_TStİ.
ml™m
) \

53 - (
_TS¹
.
time
*1000+_TS¹.
ml™m
))

	)

55 
	gwash”e
 = 0;

57 * 
	$func
(* 
¬g
)

59 
	`_áime
(&
cu¼SysTimeS¹
);

60 
wash”e
 = 1;

61 
	`as£¹
(
	`±h»ad_¥š_lock
(&
lock
) == 0);

62 
	`as£¹
(
	`±h»ad_¥š_uÆock
(&
lock
) == 0);

63 
	`_áime
(&
cu¼SysTimeStİ
);

65  (*è
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
cu¼SysTimeStİ
);

66 
	}
}

68 
	$±h»ad_‹¡_¥š4
()

70 
»suÉ
 = 0;

71 
±h»ad_t
 
t
;

72 
_timeb
 
sysTime
;

74 ià(
	`±h»ad_num_´oûssÜs_Å
() == 1)

76 
	`´štf
("spinest #4‚ot„un - it„equires multiple CPUs.\n");

80 
	`as£¹
(
	`±h»ad_¥š_lock
(&
lock
) == 0);

82 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

84 
wash”e
 == 0)

86 
	`sched_y›ld
();

91 
	`sched_y›ld
();

92 
	`_áime
(&
sysTime
);

94 
	`G‘Du¿tiÚMliSecs
(
cu¼SysTimeS¹
, 
sysTime
) <= 1000);

96 
	`as£¹
(
	`±h»ad_¥š_uÆock
(&
lock
) == 0);

98 
	`as£¹
(
	`±h»ad_još
(
t
, (**è&
»suÉ
) == 0);

99 
	`as£¹
(
»suÉ
 > 1000);

101 
	`as£¹
(
	`±h»ad_¥š_de¡roy
(&
lock
) == 0);

103 
	`as£¹
(
wash”e
 == 1);

106 
	}
}

	@tests/stress1.c

86 
	~"‹¡.h
"

88 
	tšt64_t
;

90 cÚ¡ 
	gITERATIONS
 = 1000;

92 
±h»ad_t
 
	gma¡”
, 
	g¦ave
;

95 
	mv®ue
;

96 
±h»ad_cÚd_t
 
	mcv
;

97 
±h»ad_mu‹x_t
 
	mmx
;

98 } 
	tmysig_t
;

100 
	g®lEx™
;

101 
mysig_t
 
	gcÚŒŞ
 = {0, 
PTHREAD_COND_INITIALIZER
, 
PTHREAD_MUTEX_INITIALIZER
};

102 
±h»ad_b¬r›r_t
 
	g¡¬tB¬r›r
, 
	g»adyB¬r›r
, 
	ghŞdB¬r›r
;

103 
	gtimeoutCouÁ
 = 0;

104 
	gsigÇlsTak’CouÁ
 = 0;

105 
	gsigÇlsS’t
 = 0;

106 
	gbŸs
 = 0;

107 
	gtimeout
 = 10;

112 
	mCTL_STOP
 = -1

120 
time¥ec
 *

121 
	$mli£cÚdsFromNow
 (
time¥ec
 * 
time
, 
mli£cs
)

123 
_timeb
 
cu¼SysTime
;

124 
št64_t
 
Çno£cs
, 
£cs
;

125 cÚ¡ 
št64_t
 
NANOSEC_PER_MILLISEC
 = 1000000;

126 cÚ¡ 
št64_t
 
NANOSEC_PER_SEC
 = 1000000000;

129 
	`_áime
(&
cu¼SysTime
);

131 
£cs
 = (
št64_t
)(
cu¼SysTime
.
time
è+ (
mli£cs
 / 1000);

132 
Çno£cs
 = ((
št64_t
è(
mli£cs
%1000 + 
cu¼SysTime
.
ml™m
)è* 
NANOSEC_PER_MILLISEC
;

133 ià(
Çno£cs
 >ğ
NANOSEC_PER_SEC
)

135 
£cs
++;

136 
Çno£cs
 -ğ
NANOSEC_PER_SEC
;

138 ià(
Çno£cs
 < 0)

140 
£cs
--;

141 
Çno£cs
 +ğ
NANOSEC_PER_SEC
;

144 
time
->
tv_n£c
 = ()
Çno£cs
;

145 
time
->
tv_£c
 = ()
£cs
;

147  
time
;

148 
	}
}

151 
	$ma¡”Th»ad
 (* 
¬g
)

153 
d™h”
 = (è
¬g
;

155 
timeout
 = (è
¬g
;

157 
	`±h»ad_b¬r›r_wa™
(&
¡¬tB¬r›r
);

161 
¦“pTime
;

163 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cÚŒŞ
.
mx
) == 0);

164 
cÚŒŞ
.
v®ue
 = 
timeout
;

165 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cÚŒŞ
.
mx
) == 0);

183 ià(
sigÇlsS’t
 % 
timeout
 == 0)

185 ià(
timeoutCouÁ
 > 
sigÇlsTak’CouÁ
)

187 
bŸs
++;

189 ià(
timeoutCouÁ
 < 
sigÇlsTak’CouÁ
)

191 
bŸs
--;

193 ià(
bŸs
 < -
timeout
 || bias >imeout)

195 
timeout
++;

198 
d™h”
 = (d™h” + 1 ) % (
timeout
 * 2);

199 
¦“pTime
 = (
timeout
 - 
bŸs
 + 
d™h”
) / 2;

200 
	`±e_osTh»adSË•
(
¦“pTime
);

201 
	`as£¹
(
	`±h»ad_cÚd_sigÇl
(&
cÚŒŞ
.
cv
) == 0);

202 
sigÇlsS’t
++;

204 
	`±h»ad_b¬r›r_wa™
(&
hŞdB¬r›r
);

205 
	`±h»ad_b¬r›r_wa™
(&
»adyB¬r›r
);

207 !
®lEx™
);

209  
NULL
;

210 
	}
}

213 
	$¦aveTh»ad
 (* 
¬g
)

215 
time¥ec
 
time
;

217 
	`±h»ad_b¬r›r_wa™
(&
¡¬tB¬r›r
);

221 
	`as£¹
(
	`±h»ad_mu‹x_lock
(&
cÚŒŞ
.
mx
) == 0);

222 ià(
	`±h»ad_cÚd_timedwa™
(&
cÚŒŞ
.
cv
,

223 &
cÚŒŞ
.
mx
,

224 
	`mli£cÚdsFromNow
(&
time
, 
cÚŒŞ
.
v®ue
)è=ğ
ETIMEDOUT
)

226 
timeoutCouÁ
++;

230 
sigÇlsTak’CouÁ
++;

232 
	`as£¹
(
	`±h»ad_mu‹x_uÆock
(&
cÚŒŞ
.
mx
) == 0);

234 
	`±h»ad_b¬r›r_wa™
(&
hŞdB¬r›r
);

235 
	`±h»ad_b¬r›r_wa™
(&
»adyB¬r›r
);

237 !
®lEx™
);

239  
NULL
;

240 
	}
}

242 
	$±h»ad_‹¡_¡»ss1
()

244 
i
;

246 
cÚŒŞ
.
v®ue
 = 0;

247 
cÚŒŞ
.
cv
 = 
PTHREAD_COND_INITIALIZER
;

248 
cÚŒŞ
.
mx
 = 
PTHREAD_MUTEX_INITIALIZER
;

250 
timeoutCouÁ
 = 0;

251 
sigÇlsTak’CouÁ
 = 0;

252 
sigÇlsS’t
 = 0;

253 
bŸs
 = 0;

254 
timeout
 = 10;

255 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
¡¬tB¬r›r
, 
NULL
, 3) == 0);

256 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
»adyB¬r›r
, 
NULL
, 3) == 0);

257 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
hŞdB¬r›r
, 
NULL
, 3) == 0);

259 
	`as£¹
(
	`±h»ad_ü—‹
(&
ma¡”
, 
NULL
, 
ma¡”Th»ad
, (*è
timeout
) == 0);

260 
	`as£¹
(
	`±h»ad_ü—‹
(&
¦ave
, 
NULL
, 
¦aveTh»ad
, NULL) == 0);

262 
®lEx™
 = 0;

264 
	`±h»ad_b¬r›r_wa™
(&
¡¬tB¬r›r
);

266 
i
 = 1; !
®lEx™
; i++)

268 
	`±h»ad_b¬r›r_wa™
(&
hŞdB¬r›r
);

269 ià(
i
 >ğ
ITERATIONS
)

271 
®lEx™
 = 1;

273 
	`±h»ad_b¬r›r_wa™
(&
»adyB¬r›r
);

276 
	`as£¹
(
	`±h»ad_još
(
¦ave
, 
NULL
) == 0);

277 
	`as£¹
(
	`±h»ad_još
(
ma¡”
, 
NULL
) == 0);

280 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
hŞdB¬r›r
) == 0);

281 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
»adyB¬r›r
) == 0);

282 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
¡¬tB¬r›r
) == 0);

283 
	`as£¹
(
	`±h»ad_cÚd_de¡roy
(&
cÚŒŞ
.
cv
) == 0);

284 
	`as£¹
(
	`±h»ad_mu‹x_de¡roy
(&
cÚŒŞ
.
mx
) == 0);

288 
	}
}

	@tests/test.h

44 #iâdeà
_PTHREAD_TEST_H_


45 
	#_PTHREAD_TEST_H_


	)

50 
	~<Çutus/Çutus.h
>

51 
	~"../nk/±e_o§l.h
"

53 
	~"../±h»ad.h
"

54 
	~"../sched.h
"

55 
	~"../£m­hÜe.h
"

56 
	~"../im¶em’t.h
"

60 
	#PTW32_THREAD_NULL_ID
 {
NULL
,0}

	)

62 #ià
defšed
(
__MINGW32__
)

63 
	~<¡dšt.h
>

64 #–ià
defšed
(
__BORLANDC__
)

65 
	#št64_t
 
ULONGLONG


	)

67 
	#št64_t
 
_št64


	)

70 cÚ¡ * 
”rÜ_¡ršg
;

78 #ifdeà
as£¹


79 #undeà
as£¹


82 #iâdeà
ASSERT_TRACE


83 
	#ASSERT_TRACE
 0

	)

85 #undeà
ASSERT_TRACE


86 
	#ASSERT_TRACE
 1

	)

89 
	#as£¹
(
e
) \

90 ((
e
è? ((
ASSERT_TRACE
è? 
	`årštf
(
¡dout
, \

92 #e, 
__FILE__
, (è
__LINE__
), \

93 
	`fæush
(
¡dout
) : \

95 (
	`årštf
(
¡d”r
, "Assertion failed: (%s), file %s,†ine %d\n", \

96 #e, 
__FILE__
, (è
__LINE__
), 
	`ex™
(1), 0))

	)

98 
as£¹E
;

99 
	#as£¹_e
(
e
, 
o
, 
r
) \

100 (((
as£¹E
 = 
e
è
	`o
 (
r
)è? ((
ASSERT_TRACE
è? 
	`årštf
(
¡dout
, \

102 #e, 
__FILE__
, (è
__LINE__
), \

103 
	`fæush
(
¡dout
) : \

105 (
	`årštf
(
¡d”r
, "Assertion failed: (%s %s %s), file %s,†ine %d,ƒrror %s\n", \

106 #e,#o,#r, 
__FILE__
, (è
__LINE__
, 
”rÜ_¡ršg
[
as£¹E
]), 
	`ex™
(1), 0))

	)

110 #ifdeà
__ılu¥lus


115 
±h»ad_‹¡_mu‹x1
();

116 
±h»ad_‹¡_mu‹x1e
();

117 
±h»ad_‹¡_mu‹x1n
();

118 
±h»ad_‹¡_mu‹x1r
();

120 
±h»ad_‹¡_mu‹x2
();

121 
±h»ad_‹¡_mu‹x2e
();

122 
±h»ad_‹¡_mu‹x2r
();

124 
±h»ad_‹¡_mu‹x3
();

125 
±h»ad_‹¡_mu‹x3e
();

126 
±h»ad_‹¡_mu‹x3r
();

128 
±h»ad_‹¡_mu‹x4
();

130 
±h»ad_‹¡_mu‹x5
();

132 
±h»ad_‹¡_mu‹x6
();

133 
±h»ad_‹¡_mu‹x6e
();

134 
±h»ad_‹¡_mu‹x6es
();

135 
±h»ad_‹¡_mu‹x6n
();

136 
±h»ad_‹¡_mu‹x6r
();

137 
±h»ad_‹¡_mu‹x6rs
();

138 
±h»ad_‹¡_mu‹x6s
();

140 
±h»ad_‹¡_mu‹x7
();

141 
±h»ad_‹¡_mu‹x7e
();

142 
±h»ad_‹¡_mu‹x7n
();

143 
±h»ad_‹¡_mu‹x7r
();

145 
±h»ad_‹¡_mu‹x8
();

146 
±h»ad_‹¡_mu‹x8e
();

147 
±h»ad_‹¡_mu‹x8n
();

148 
±h»ad_‹¡_mu‹x8r
();

150 
±h»ad_‹¡_v®id1
();

151 
±h»ad_‹¡_v®id2
();

153 
±h»ad_‹¡_£lf1
();

154 
±h»ad_‹¡_£lf2
();

156 
±h»ad_‹¡_equ®1
();

158 
±h»ad_‹¡_ü—‹1
();

159 
±h»ad_‹¡_ü—‹2
();

160 
±h»ad_‹¡_ü—‹3
();

162 
±h»ad_‹¡_£m­hÜe1
();

163 
±h»ad_‹¡_£m­hÜe2
();

164 
±h»ad_‹¡_£m­hÜe3
();

165 
±h»ad_‹¡_£m­hÜe4
();

166 
±h»ad_‹¡_£m­hÜe4t
();

167 
±h»ad_‹¡_£m­hÜe5
();

168 
±h»ad_‹¡_£m­hÜe6
();

170 
±h»ad_‹¡_b¬r›r1
();

171 
±h»ad_‹¡_b¬r›r2
();

172 
±h»ad_‹¡_b¬r›r3
();

173 
±h»ad_‹¡_b¬r›r4
();

174 
±h»ad_‹¡_b¬r›r5
();

176 
±h»ad_‹¡_couÁ1
();

178 
±h»ad_‹¡_ü—‹1
();

179 
±h»ad_‹¡_ü—‹2
();

180 
±h»ad_‹¡_ü—‹3
();

182 
±h»ad_‹¡_d–ay1
();

183 
±h»ad_‹¡_d–ay2
();

185 
±h»ad_‹¡_”ºo1
();

187 
±h»ad_‹¡_još0
();

188 
±h»ad_‹¡_još1
();

189 
±h»ad_‹¡_još2
();

190 
±h»ad_‹¡_još3
();

191 
±h»ad_‹¡_još4
();

193 
±h»ad_‹¡_kl1
();

195 
±h»ad_‹¡_Úû1
();

196 
±h»ad_‹¡_Úû2
();

197 
±h»ad_‹¡_Úû3
();

198 
±h»ad_‹¡_Úû4
();

200 
±h»ad_‹¡_¥š1
();

201 
±h»ad_‹¡_¥š2
();

202 
±h»ad_‹¡_¥š3
();

203 
±h»ad_‹¡_¥š4
();

205 
±h»ad_‹¡_tsd1
();

206 
±h»ad_‹¡_tsd2
();

208 
±h»ad_‹¡_cÚdv¬1_1
();

209 
±h»ad_‹¡_cÚdv¬1_2
();

210 
±h»ad_‹¡_cÚdv¬1
();

211 
±h»ad_‹¡_cÚdv¬2_1
();

212 
±h»ad_‹¡_cÚdv¬2
();

213 
±h»ad_‹¡_cÚdv¬3
();

214 
±h»ad_‹¡_cÚdv¬3_1
();

215 
±h»ad_‹¡_cÚdv¬3_2
();

216 
±h»ad_‹¡_cÚdv¬3_3
();

217 
±h»ad_‹¡_cÚdv¬4
();

218 
±h»ad_‹¡_cÚdv¬5
();

219 
±h»ad_‹¡_cÚdv¬6
();

220 
±h»ad_‹¡_cÚdv¬7
();

221 
±h»ad_‹¡_cÚdv¬8
();

222 
±h»ad_‹¡_cÚdv¬9
();

224 
±h»ad_‹¡_¡»ss1
();

226 
±h»ad_‹¡_d‘ach1
();

228 
±h»ad_‹¡_ex™1
();

229 
±h»ad_‹¡_ex™2
();

230 
±h»ad_‹¡_ex™3
();

231 
±h»ad_‹¡_ex™4
();

232 
±h»ad_‹¡_ex™5
();

234 
±h»ad_‹¡_»u£1
();

235 
±h»ad_‹¡_»u£2
();

237 
±h»ad_‹¡_rwlock1
();

238 
±h»ad_‹¡_rwlock2
();

239 
±h»ad_‹¡_rwlock2t
();

240 
±h»ad_‹¡_rwlock3
();

241 
±h»ad_‹¡_rwlock3t
();

242 
±h»ad_‹¡_rwlock4
();

243 
±h»ad_‹¡_rwlock4t
();

244 
±h»ad_‹¡_rwlock5
();

245 
±h»ad_‹¡_rwlock5t
();

246 
±h»ad_‹¡_rwlock6
();

247 
±h»ad_‹¡_rwlock6t
();

248 
±h»ad_‹¡_rwlock6t2
();

249 
±h»ad_‹¡_rwlock7
();

250 
±h»ad_‹¡_rwlock8
();

252 
±h»ad_‹¡_´iÜ™y1
();

253 
±h»ad_‹¡_´iÜ™y2
();

255 
±h»ad_‹¡_šh”™1
();

257 
±h»ad_‹¡_ÿnûl1
();

258 
±h»ad_‹¡_ÿnûl2
();

259 
±h»ad_‹¡_ÿnûl3
();

260 
±h»ad_‹¡_ÿnûl4
();

261 
±h»ad_‹¡_ÿnûl5
();

262 
±h»ad_‹¡_ÿnûl6a
();

263 
±h»ad_‹¡_ÿnûl6d
();

264 
±h»ad_‹¡_ÿnûl7
();

265 
±h»ad_‹¡_ÿnûl8
();

266 
±h»ad_‹¡_ÿnûl9
();

268 
±h»ad_‹¡_ş—nup0
();

269 
±h»ad_‹¡_ş—nup1
();

270 
±h»ad_‹¡_ş—nup2
();

271 
±h»ad_‹¡_ş—nup3
();

273 
±h»ad_‹¡_b’ch1
();

274 
±h»ad_‹¡_b’ch2
();

275 
±h»ad_‹¡_b’ch3
();

276 
±h»ad_‹¡_b’ch4
();

278 
±h»ad_‹¡_exû±iÚ1
();

279 
±h»ad_‹¡_exû±iÚ2
();

280 
±h»ad_‹¡_exû±iÚ3
();

282 #ifdeà
__ılu¥lus


	@tests/test_main.c

2 
	~"‹¡.h
"

3 
	~<Çutus/sh–l.h
>

4 cÚ¡ * 
	g”rÜ_¡ršg
;

6 
	gas£¹E
;

12 
	$runB¬r›rTe¡s
()

14 
	`´štf
("Barrierest #1\n");

15 
	`±h»ad_‹¡_b¬r›r1
();

17 
	`´štf
("Barrierest #2\n");

18 
	`±h»ad_‹¡_b¬r›r2
();

20 
	`´štf
("Barrierest #3\n");

21 
	`±h»ad_‹¡_b¬r›r3
();

23 
	`´štf
("Barrierest #4\n");

24 
	`±h»ad_‹¡_b¬r›r4
();

26 
	`´štf
("Barrierest #5\n");

27 
	`±h»ad_‹¡_b¬r›r5
();

28 
	}
}

30 
	$runSemTe¡s
()

33 
	`´štf
("Semaphoreest #1\n");

34 
	`±h»ad_‹¡_£m­hÜe1
();

36 
	`´štf
("Semaphoreest #2\n");

37 
	`±h»ad_‹¡_£m­hÜe2
();

39 
	`´štf
("Semaphoreest #3\n");

40 
	`±h»ad_‹¡_£m­hÜe3
();

43 
	`´štf
("Semaphoreest #4\n");

44 
	`±h»ad_‹¡_£m­hÜe4
();

46 
	`´štf
("Semaphoreest #4t\n");

47 
	`±h»ad_‹¡_£m­hÜe4t
();

49 
	`´štf
("Semaphoreest #5\n");

50 
	`±h»ad_‹¡_£m­hÜe5
();

52 
	`´štf
("Semaphoreest #6\n");

53 
	`±h»ad_‹¡_£m­hÜe6
();

55 
	}
}

57 
	$runTh»adTe¡s
()

60 
	`´štf
("Createest #1\n");

61 
	`±h»ad_‹¡_ü—‹1
();

63 
	`´štf
("Createest #2\n");

64 
	`±h»ad_‹¡_ü—‹2
();

66 
	`´štf
("Createest #3\n");

67 
	`±h»ad_‹¡_ü—‹3
();

69 
	`´štf
("Joinest #0\n");

70 
	`±h»ad_‹¡_još0
();

72 
	`´štf
("Joinest #1\n");

73 
	`±h»ad_‹¡_još1
();

75 
	`´štf
("Joinest #2\n");

76 
	`±h»ad_‹¡_još2
();

78 
	`´štf
("Joinest #3\n");

79 
	`±h»ad_‹¡_još3
();

84 
	`´štf
("Killest #1\n");

85 
	`±h»ad_‹¡_kl1
();

87 
	`´štf
("Exitest #1\n");

88 
	`±h»ad_‹¡_ex™1
();

90 
	`´štf
("Exitest #2\n");

91 
	`±h»ad_‹¡_ex™2
();

93 
	`´štf
("Exitest #3\n");

94 
	`±h»ad_‹¡_ex™3
();

122 
	}
}

124 
	$runMiscTe¡s
()

127 
	`´štf
("Validest #1\n");

128 
	`±h»ad_‹¡_v®id1
();

130 
	`´štf
("Validest #2\n");

131 
	`±h»ad_‹¡_v®id2
();

133 
	`´štf
("Selfest #1\n");

134 
	`±h»ad_‹¡_£lf1
();

136 
	`´štf
("Selfest #2\n");

137 
	`±h»ad_‹¡_£lf2
();

139 
	`´štf
("Equalest #1\n");

140 
	`±h»ad_‹¡_equ®1
();

142 
	`´štf
("Countest #1\n");

143 
	`±h»ad_‹¡_couÁ1
();

145 
	`´štf
("Delayest #1\n");

146 
	`±h»ad_‹¡_d–ay1
();

148 
	`´štf
("Delayest #2\n");

149 
	`±h»ad_‹¡_d–ay2
();

151 
	`´štf
("Onceest #1\n");

152 
	`±h»ad_‹¡_Úû1
();

154 
	`´štf
("Onceest #2\n");

155 
	`±h»ad_‹¡_Úû2
();

157 
	`´štf
("Onceest #3\n");

158 
	`±h»ad_‹¡_Úû3
();

160 
	`´štf
("Onceest #4\n");

161 
	`±h»ad_‹¡_Úû4
();

163 
	`´štf
("TSDest #1\n");

164 
	`±h»ad_‹¡_tsd1
();

166 
	`´štf
("TSDest #2\n");

167 
	`±h»ad_‹¡_tsd2
();

169 #ifdeà
THREAD_SAFE_ERRNO


170 
	`´štf
("Errnoest #1\n");

171 
	`±h»ad_‹¡_”ºo1
();

174 
	`´štf
("Detachest #1\n");

175 
	`±h»ad_‹¡_d‘ach1
();

177 
	}
}

179 
	$runMu‹xTe¡s
()

182 
	`´štf
("Mutexest #1\n");

183 
	`±h»ad_‹¡_mu‹x1
();

185 
	`´štf
("Mutexest #1(e)\n");

186 
	`±h»ad_‹¡_mu‹x1e
();

188 
	`´štf
("Mutexest #1(n)\n");

189 
	`±h»ad_‹¡_mu‹x1n
();

191 
	`´štf
("Mutexest #1(r)\n");

192 
	`±h»ad_‹¡_mu‹x1e
();

194 
	`´štf
("Mutexest #2\n");

195 
	`±h»ad_‹¡_mu‹x2
();

197 
	`´štf
("Mutexest #2(e)\n");

198 
	`±h»ad_‹¡_mu‹x2e
();

200 
	`´štf
("Mutexest #2(r)\n");

201 
	`±h»ad_‹¡_mu‹x2r
();

203 
	`´štf
("Mutexest #3\n");

204 
	`±h»ad_‹¡_mu‹x3
();

206 
	`´štf
("Mutexest #3(e)\n");

207 
	`±h»ad_‹¡_mu‹x3e
();

209 
	`´štf
("Mutexest #3(r)\n");

210 
	`±h»ad_‹¡_mu‹x3r
();

212 
	`´štf
("Mutexest #4\n");

213 
	`±h»ad_‹¡_mu‹x4
();

215 
	`´štf
("Mutexest #5\n");

216 
	`±h»ad_‹¡_mu‹x5
();

218 
	`´štf
("Mutexest #6\n");

219 
	`±h»ad_‹¡_mu‹x6
();

221 
	`´štf
("Mutexest #6e\n");

222 
	`±h»ad_‹¡_mu‹x6e
();

224 
	`´štf
("Mutexest #6es\n");

225 
	`±h»ad_‹¡_mu‹x6es
();

227 
	`´štf
("Mutexest #6n\n");

228 
	`±h»ad_‹¡_mu‹x6n
();

230 
	`´štf
("Mutexest #6r\n");

231 
	`±h»ad_‹¡_mu‹x6r
();

233 
	`´štf
("Mutexest #6rs\n");

234 
	`±h»ad_‹¡_mu‹x6rs
();

236 
	`´štf
("Mutexest #6s\n");

237 
	`±h»ad_‹¡_mu‹x6s
();

239 
	`´štf
("Mutexest #7\n");

240 
	`±h»ad_‹¡_mu‹x7
();

242 
	`´štf
("Mutexest #7e\n");

243 
	`±h»ad_‹¡_mu‹x7e
();

245 
	`´štf
("Mutexest #7n\n");

246 
	`±h»ad_‹¡_mu‹x7n
();

248 
	`´štf
("Mutexest #7r\n");

249 
	`±h»ad_‹¡_mu‹x7r
();

251 
	`´štf
("Mutexest #8\n");

252 
	`±h»ad_‹¡_mu‹x8
();

254 
	`´štf
("Mutexest #8e\n");

255 
	`±h»ad_‹¡_mu‹x8e
();

257 
	`´štf
("Mutexest #8n\n");

258 
	`±h»ad_‹¡_mu‹x8n
();

260 
	`´štf
("Mutexest #8r\n");

261 
	`±h»ad_‹¡_mu‹x8r
();

263 
	}
}

265 
	$runSpšTe¡s
()

267 
	`´štf
("Spinest #1\n");

268 
	`±h»ad_‹¡_¥š1
();

270 
	`´štf
("Spinest #2\n");

271 
	`±h»ad_‹¡_¥š2
();

273 
	`´štf
("Spinest #3\n");

274 
	`±h»ad_‹¡_¥š3
();

276 
	`´štf
("Spinest #4\n");

277 
	`±h»ad_‹¡_¥š4
();

279 
	}
}

281 
	$runCÚdv¬Te¡s
()

284 
	`´štf
("Condvarest #1\n");

285 
	`±h»ad_‹¡_cÚdv¬1
();

293 
	`´štf
("Condvarest #2\n");

294 
	`±h»ad_‹¡_cÚdv¬2
();

296 
	`´štf
("Condvarest #2-1\n");

297 
	`±h»ad_‹¡_cÚdv¬2_1
();

299 
	`´štf
("Condvarest #3\n");

300 
	`±h»ad_‹¡_cÚdv¬3
();

302 
	`´štf
("Condvarest #3-1\n");

303 
	`±h»ad_‹¡_cÚdv¬3_1
();

305 
	`´štf
("Condvarest #3-2\n");

306 
	`±h»ad_‹¡_cÚdv¬3_2
();

308 
	`´štf
("Condvarest #3-3\n");

309 
	`±h»ad_‹¡_cÚdv¬3_3
();

317 
	`´štf
("Condvarest #6\n");

318 
	`±h»ad_‹¡_cÚdv¬6
();

323 
	`´štf
("Condvarest #8\n");

324 
	`±h»ad_‹¡_cÚdv¬8
();

329 
	}
}

331 
	$runSŒessTe¡s
()

333 
	`´štf
("Stressest #1\n");

334 
	`±h»ad_‹¡_¡»ss1
();

335 
	}
}

337 
	$runRwlockTe¡s
()

339 
	`´štf
("Rwlockest #1\n");

340 
	`±h»ad_‹¡_rwlock1
();

342 
	`´štf
("Rwlockest #2\n");

343 
	`±h»ad_‹¡_rwlock2
();

345 
	`´štf
("Rwlockest #2t\n");

346 
	`±h»ad_‹¡_rwlock2t
();

348 
	`´štf
("Rwlockest #3\n");

349 
	`±h»ad_‹¡_rwlock3
();

351 
	`´štf
("Rwlockest #3t\n");

352 
	`±h»ad_‹¡_rwlock3t
();

354 
	`´štf
("Rwlockest #4\n");

355 
	`±h»ad_‹¡_rwlock4
();

357 
	`´štf
("Rwlockest #4t\n");

358 
	`±h»ad_‹¡_rwlock4t
();

360 
	`´štf
("Rwlockest #5\n");

361 
	`±h»ad_‹¡_rwlock5
();

363 
	`´štf
("Rwlockest #5t\n");

364 
	`±h»ad_‹¡_rwlock5t
();

366 
	`´štf
("Rwlockest #6\n");

367 
	`±h»ad_‹¡_rwlock6
();

369 
	`´štf
("Rwlockest #6t\n");

370 
	`±h»ad_‹¡_rwlock6t
();

372 
	`´štf
("Rwlockest #6t2\n");

373 
	`±h»ad_‹¡_rwlock6t2
();

375 
	`´štf
("Rwlockest #7\n");

376 
	`±h»ad_‹¡_rwlock7
();

378 
	`´štf
("Rwlockest #8\n");

379 
	`±h»ad_‹¡_rwlock8
();

381 
	}
}

383 
	$runCªûlTe¡s
()

386 
	`´štf
("Cancelest #1\n");

387 
	`±h»ad_‹¡_ÿnûl1
();

389 
	`´štf
("Cancelest #2\n");

390 
	`±h»ad_‹¡_ÿnûl2
();

392 
	`´štf
("Cancelest #3\n");

393 
	`±h»ad_‹¡_ÿnûl3
();

395 
	`´štf
("Cancelest #4\n");

396 
	`±h»ad_‹¡_ÿnûl4
();

398 
	`´štf
("Cancelest #5\n");

399 
	`±h»ad_‹¡_ÿnûl5
();

401 
	`´štf
("Cancelest #6a\n");

402 
	`±h»ad_‹¡_ÿnûl6a
();

404 
	`´štf
("Cancelest #6d\n");

405 
	`±h»ad_‹¡_ÿnûl6d
();

410 
	`´štf
("Cleanupest #0\n");

411 
	`±h»ad_‹¡_ş—nup0
();

413 
	`´štf
("Cleanupest #1\n");

414 
	`±h»ad_‹¡_ş—nup1
();

416 
	`´štf
("Cleanupest #2\n");

417 
	`±h»ad_‹¡_ş—nup2
();

419 
	`´štf
("Cleanupest #3\n");

420 
	`±h»ad_‹¡_ş—nup3
();

421 
	}
}

423 
	$runB’chTe¡s
()

426 
	`´štf
("Benchmarkest #1\n");

427 
	`±h»ad_‹¡_b’ch1
();

429 
	`´štf
("Benchmarkest #2\n");

430 
	`±h»ad_‹¡_b’ch2
();

432 
	`´štf
("Benchmarkest #3\n");

433 
	`±h»ad_‹¡_b’ch3
();

435 
	`´štf
("Benchmarkest #4\n");

436 
	`±h»ad_‹¡_b’ch4
();

437 
	}
}

439 
	$runExû±iÚTe¡s
()

441 
	`´štf
("Exceptionest #1\n");

442 
	`±h»ad_‹¡_exû±iÚ1
();

450 
	`´štf
("Exceptionest #3\n");

451 
	`±h»ad_‹¡_exû±iÚ3
();

452 
	}
}

454 
±e_‹¡_maš
();

456 
sh–l_cmd_im¶
 
	g±e_‹¡_im¶
 = {

457 .
cmd
 = "pte-test",

458 .
	gh–p_¡r
 = "PTE Test:…te-test",

459 .
	ghªdËr
 = 
±e_‹¡_maš
,

462 
nk_»gi¡”_sh–l_cmd
(
±e_‹¡_im¶
);

463 
	$±e_‹¡_maš
()

465 
i
;

467 ià(!
	`±h»ad_š™
())

469 
	`´štf
("Failedo initialize…threads†ibrary.\n");

473 
	`´štf
("Runningests...\n");

474 
i
=0;i<2;i++)

476 
	`´štf
("=========================\n");

477 
	`´štf
(" Te¡ i‹¿tiÚ #%d\n\n",
i
);

478 
	`´štf
("=========================\n");

483 
	`runB¬r›rTe¡s
();

496 
	`´štf
("Tests complete!\n");

498 
	}
}

	@tests/tsd1.c

85 
	~"‹¡.h
"

92 
	mNUM_THREADS
 = 
OS_MAX_SIMUL_THREADS


95 
±h»ad_key_t
 
	gkey
 = 
NULL
;

96 
	gacûsscouÁ
[
NUM_THREADS
];

97 
	gth»ad_£t
[
NUM_THREADS
];

98 
	gth»ad_de¡royed
[
NUM_THREADS
];

99 
±h»ad_b¬r›r_t
 
	g¡¬tB¬r›r
;

102 
	$de¡roy_key
(* 
¬g
)

104 * 
j
 = (*è
¬g
;

106 (*
j
)++;

108 
	`as£¹
(*
j
 == 2);

110 
th»ad_de¡royed
[
j
 - 
acûsscouÁ
] = 1;

111 
	}
}

114 
	$£tkey
(* 
¬g
)

116 * 
j
 = (*è
¬g
;

118 
th»ad_£t
[
j
 - 
acûsscouÁ
] = 1;

120 
	`as£¹
(*
j
 == 0);

122 
	`as£¹
(
	`±h»ad_£t¥ecific
(
key
, 
¬g
) == 0);

123 
	`as£¹
(
	`±h»ad_£t¥ecific
(
key
, 
¬g
) == 0);

124 
	`as£¹
(
	`±h»ad_£t¥ecific
(
key
, 
¬g
) == 0);

126 
	`as£¹
(
	`±h»ad_g‘¥ecific
(
key
è=ğ
¬g
);

128 (*
j
)++;

130 
	`as£¹
(*
j
 == 1);

131 
	}
}

134 
	$myth»ad
(* 
¬g
)

136 (è
	`±h»ad_b¬r›r_wa™
(&
¡¬tB¬r›r
);

143 
	`as£¹
(
	`±h»ad_g‘¥ecific
(
key
è=ğ
NULL
);

145 
	`£tkey
(
¬g
);

150 
	}
}

152 
	$±h»ad_‹¡_tsd1
()

154 
i
;

155 
ç
 = 0;

156 
±h»ad_t
 
th»ad
[
NUM_THREADS
];

159 
th»ad_£t
[0] =hread_set[0];

160 
th»ad_de¡royed
[0] =hread_destroyed[0];

162 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
¡¬tB¬r›r
, 
NULL
, 
NUM_THREADS
/2) == 0);

164 
i
 = 1; i < 
NUM_THREADS
/2; i++)

166 
acûsscouÁ
[
i
] = 
th»ad_£t
[i] = 
th»ad_de¡royed
[i] = 0;

167 
	`as£¹
(
	`±h»ad_ü—‹
(&
th»ad
[
i
], 
NULL
, 
myth»ad
, (*)&
acûsscouÁ
[i]) == 0);

174 
	`as£¹
(
	`±h»ad_key_ü—‹
(&
key
, 
de¡roy_key
) == 0);

176 (è
	`±h»ad_b¬r›r_wa™
(&
¡¬tB¬r›r
);

181 
acûsscouÁ
[0] = 0;

182 
	`£tkey
((*è&
acûsscouÁ
[0]);

188 
i
 = 
NUM_THREADS
/2; i < NUM_THREADS; i++)

190 
acûsscouÁ
[
i
] = 
th»ad_£t
[i] = 
th»ad_de¡royed
[i] = 0;

192 
	`as£¹
(
	`±h»ad_ü—‹
(&
th»ad
[
i
], 
NULL
, 
myth»ad
, (*)&
acûsscouÁ
[i]) == 0);

198 
i
 = 1; i < 
NUM_THREADS
; i++)

200 
»suÉ
 = 0;

202 
	`as£¹
(
	`±h»ad_još
(
th»ad
[
i
], (**è&
»suÉ
) == 0);

207 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
¡¬tB¬r›r
) == 0);

209 
i
 = 1; i < 
NUM_THREADS
; i++)

218 ià(
acûsscouÁ
[
i
] != 2)

220 
ç
++;

224 
	`as£¹
(
ç
 == 0);

226  (
ç
);

227 
	}
}

	@tests/tsd2.c

85 
	~"‹¡.h
"

92 
	mNUM_THREADS
 = 20

95 
±h»ad_key_t
 
	gkey
 = 
NULL
;

96 
	gacûsscouÁ
[
NUM_THREADS
];

97 
	gth»ad_£t
[
NUM_THREADS
];

98 
	gth»ad_de¡royed
[
NUM_THREADS
];

99 
±h»ad_b¬r›r_t
 
	g¡¬tB¬r›r
;

102 
	$de¡roy_key
(* 
¬g
)

104 * 
j
 = (*è
¬g
;

106 (*
j
)++;

109 ià(*
j
 == 2)

110 
	`as£¹
(
	`±h»ad_£t¥ecific
(
key
, 
¬g
) == 0);

112 
	`as£¹
(*
j
 == 3);

114 
th»ad_de¡royed
[
j
 - 
acûsscouÁ
] = 1;

115 
	}
}

118 
	$£tkey
(* 
¬g
)

120 * 
j
 = (*è
¬g
;

122 
th»ad_£t
[
j
 - 
acûsscouÁ
] = 1;

124 
	`as£¹
(*
j
 == 0);

126 
	`as£¹
(
	`±h»ad_g‘¥ecific
(
key
è=ğ
NULL
);

128 
	`as£¹
(
	`±h»ad_£t¥ecific
(
key
, 
¬g
) == 0);

129 
	`as£¹
(
	`±h»ad_£t¥ecific
(
key
, 
¬g
) == 0);

130 
	`as£¹
(
	`±h»ad_£t¥ecific
(
key
, 
¬g
) == 0);

132 
	`as£¹
(
	`±h»ad_g‘¥ecific
(
key
è=ğ
¬g
);

134 (*
j
)++;

136 
	`as£¹
(*
j
 == 1);

137 
	}
}

140 
	$myth»ad
(* 
¬g
)

142 (è
	`±h»ad_b¬r›r_wa™
(&
¡¬tB¬r›r
);

144 
	`£tkey
(
¬g
);

149 
	}
}

151 
	$±h»ad_‹¡_tsd2
()

153 
i
;

154 
ç
 = 0;

155 
±h»ad_t
 
th»ad
[
NUM_THREADS
];

158 
th»ad_£t
[0] =hread_set[0];

159 
th»ad_de¡royed
[0] =hread_destroyed[0];

161 
	`as£¹
(
	`±h»ad_b¬r›r_š™
(&
¡¬tB¬r›r
, 
NULL
, 
NUM_THREADS
/2) == 0);

163 
i
 = 1; i < 
NUM_THREADS
/2; i++)

165 
acûsscouÁ
[
i
] = 
th»ad_£t
[i] = 
th»ad_de¡royed
[i] = 0;

166 
	`as£¹
(
	`±h»ad_ü—‹
(&
th»ad
[
i
], 
NULL
, 
myth»ad
, (*)&
acûsscouÁ
[i]) == 0);

173 
	`as£¹
(
	`±h»ad_key_ü—‹
(&
key
, 
de¡roy_key
) == 0);

175 (è
	`±h»ad_b¬r›r_wa™
(&
¡¬tB¬r›r
);

180 
acûsscouÁ
[0] = 0;

181 
	`£tkey
((*è&
acûsscouÁ
[0]);

187 
i
 = 
NUM_THREADS
/2; i < NUM_THREADS; i++)

189 
acûsscouÁ
[
i
] = 
th»ad_£t
[i] = 
th»ad_de¡royed
[i] = 0;

190 
	`as£¹
(
	`±h»ad_ü—‹
(&
th»ad
[
i
], 
NULL
, 
myth»ad
, (*)&
acûsscouÁ
[i]) == 0);

196 
i
 = 1; i < 
NUM_THREADS
; i++)

198 
»suÉ
 = 0;

200 
	`as£¹
(
	`±h»ad_još
(
th»ad
[
i
], (**è&
»suÉ
) == 0);

203 
	`as£¹
(
	`±h»ad_key_d–‘e
(
key
) == 0);

205 
	`as£¹
(
	`±h»ad_b¬r›r_de¡roy
(&
¡¬tB¬r›r
) == 0);

207 
i
 = 1; i < 
NUM_THREADS
; i++)

216 ià(
acûsscouÁ
[
i
] != 3)

218 
ç
++;

222 
	`fæush
(
¡d”r
);

224  (
ç
);

225 
	}
}

	@tests/valid1.c

80 
	~"‹¡.h
"

84 
	mNUMTHREADS
 = 1

87 
	gwash”e
 = 0;

89 * 
	$func
(* 
¬g
)

91 
wash”e
 = 1;

93 
	}
}

95 
	$±h»ad_‹¡_v®id1
()

97 
±h»ad_t
 
t
;

98 * 
»suÉ
 = 
NULL
;

100 
wash”e
 = 0;

101 
	`as£¹
(
	`±h»ad_ü—‹
(&
t
, 
NULL
, 
func
, NULL) == 0);

102 
	`as£¹
(
	`±h»ad_još
(
t
, &
»suÉ
) == 0);

103 
	`as£¹
(
»suÉ
 == 0);

104 
	`as£¹
(
wash”e
 == 1);

105 
	`sched_y›ld
();

106 
	`as£¹
(
	`±h»ad_kl
(
t
, 0è=ğ
ESRCH
);

109 
	}
}

	@tests/valid2.c

80 
	~"‹¡.h
"

82 
	$±h»ad_‹¡_v®id2
()

84 
±h»ad_t
 
NuÎTh»ad
 = 
PTW32_THREAD_NULL_ID
;

86 
	`as£¹
(
	`±h»ad_kl
(
NuÎTh»ad
, 0è=ğ
ESRCH
);

89 
	}
}

	@tls-helper.c

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

32 
	~"s-h–³r.h
"

34 *
	gkeysU£d
;

37 
	gmaxTlsV®ues
;

39 
±e_osMu‹xHªdË
 
	gglob®TlsLock
;

41 
±e_osResuÉ
 
	$±eTlsGlob®In™
(
maxEÁr›s
)

43 
i
;

44 
±e_osResuÉ
 
»suÉ
;

46 
	`±e_osMu‹xC»©e
(&
glob®TlsLock
);

48 
keysU£d
 = (*è
	`m®loc
(
maxEÁr›s
 * ());

50 ià(
keysU£d
 !ğ
NULL
)

52 
i
=0;i<
maxEÁr›s
;i++)

54 
keysU£d
[
i
] = 0;

57 
maxTlsV®ues
 = 
maxEÁr›s
;

59 
»suÉ
 = 
PTE_OS_OK
;

63 
»suÉ
 = 
PTE_OS_NO_RESOURCES
;

66  
»suÉ
;

67 
	}
}

70 * 
	$±eTlsTh»adIn™
()

72 ** 
pTlsSŒuù
;

73 
i
;

75 
pTlsSŒuù
 = (**è
	`m®loc
(
maxTlsV®ues
 * (*));

78 
i
=0; i<
maxTlsV®ues
;i++)

80 
pTlsSŒuù
[
i
] = 0;

83  (*è
pTlsSŒuù
;

84 
	}
}

87 
±e_osResuÉ
 
	$±eTlsAÎoc
(*
pKey
)

89 
i
;

90 
±e_osResuÉ
 
»suÉ
 = 
PTE_OS_NO_RESOURCES
;

93 
	`±e_osMu‹xLock
(
glob®TlsLock
);

95 
i
=0;i<
maxTlsV®ues
;i++)

97 ià(
keysU£d
[
i
] == 0)

99 
keysU£d
[
i
] = 1;

101 *
pKey
 = 
i
+1;

102 
»suÉ
 = 
PTE_OS_OK
;

107 
	`±e_osMu‹xUÆock
(
glob®TlsLock
);

109  
»suÉ
;

110 
	}
}

113 * 
	$±eTlsG‘V®ue
(*
pTlsTh»adSŒuù
, 
šdex
)

115 **
pTls
 = (**è
pTlsTh»adSŒuù
;

117 ià(
keysU£d
[
šdex
-1])

119 ià(
pTls
 !ğ
NULL
)

121  
pTls
[
šdex
-1];

125  
NULL
;

130  
NULL
;

132 
	}
}

135 
±e_osResuÉ
 
	$±eTlsS‘V®ue
(*
pTlsTh»adSŒuù
, 
šdex
, * 
v®ue
)

137 
±e_osResuÉ
 
»suÉ
;

138 ** 
pTls
 = (**è
pTlsTh»adSŒuù
;

140 ià(
pTls
 !ğ
NULL
)

142 
pTls
[
šdex
-1] = 
v®ue
;

143 
»suÉ
 = 
PTE_OS_OK
;

147 
»suÉ
 = 
PTE_OS_INVALID_PARAM
;

150  
»suÉ
;

152 
	}
}

154 
±e_osResuÉ
 
	$±eTlsF»e
(
šdex
)

156 
±e_osResuÉ
 
»suÉ
;

158 ià(
keysU£d
 !ğ
NULL
)

160 
	`±e_osMu‹xLock
(
glob®TlsLock
);

162 
keysU£d
[
šdex
-1] = 0;

164 
	`±e_osMu‹xUÆock
(
glob®TlsLock
);

166 
»suÉ
 = 
PTE_OS_OK
;

170 
»suÉ
 = 
PTE_OS_GENERAL_FAILURE
;

173  
»suÉ
;

174 
	}
}

176 
	$±eTlsTh»adDe¡roy
(* 
pTlsTh»adSŒuù
)

178 
	`ä“
(
pTlsTh»adSŒuù
);

179 
	}
}

181 
	$±eTlsGlob®De¡roy
()

183 
	`±e_osMu‹xD–‘e
(
glob®TlsLock
);

184 
	`ä“
(
keysU£d
);

185 
	}
}

	@tls-helper.h

29 #iâdeà
_TLS_HELPER_H_


30 
	#_TLS_HELPER_H_


	)

32 
	~"±e_o§l.h
"

36 
±e_osResuÉ
 
±eTlsGlob®In™
(
maxEÁr›s
);

37 * 
±eTlsTh»adIn™
();

39 
±e_osResuÉ
 
±eTlsAÎoc
(*
pKey
);

40 * 
±eTlsG‘V®ue
(*
pTlsTh»adSŒuù
, 
šdex
);

41 
±e_osResuÉ
 
±eTlsS‘V®ue
(*
pTlsTh»adSŒuù
, 
šdex
, * 
v®ue
);

42 
±e_osResuÉ
 
±eTlsF»e
(
šdex
);

44 
±eTlsTh»adDe¡roy
(* 
pTlsTh»adSŒuù
);

45 
±eTlsGlob®De¡roy
();

	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


23 
	#_ERRNO_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/”ºo.h
>

32 #iâdeà
__ASSEMBLER__


34 
__BEGIN_DECLS


37 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
__©Œibu‹_cÚ¡__
;

38 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

40 #ifdeà
__USE_GNU


45 *
´og¿m_švoÿtiÚ_Çme
;

46 *
´og¿m_švoÿtiÚ_shÜt_Çme
;

50 #iâdeà
__”rÜ_t_defšed


51 
	#__”rÜ_t_defšed
 1

	)

52 
	t”rÜ_t
;

57 
__END_DECLS


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

42 #iâdeà
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<b™s/wÜdsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifdeà
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #ià
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #ià
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifdeà
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


124 #šşude_Ãxˆ<
lim™s
.
h
>

130 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


131 #iâdeà
LLONG_MIN


132 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

134 #iâdeà
LLONG_MAX


135 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

137 #iâdeà
ULLONG_MAX


138 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

145 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

146 #iâdeà
CHAR_WIDTH


147 
	#CHAR_WIDTH
 8

	)

149 #iâdeà
SCHAR_WIDTH


150 
	#SCHAR_WIDTH
 8

	)

152 #iâdeà
UCHAR_WIDTH


153 
	#UCHAR_WIDTH
 8

	)

155 #iâdeà
SHRT_WIDTH


156 
	#SHRT_WIDTH
 16

	)

158 #iâdeà
USHRT_WIDTH


159 
	#USHRT_WIDTH
 16

	)

161 #iâdeà
INT_WIDTH


162 
	#INT_WIDTH
 32

	)

164 #iâdeà
UINT_WIDTH


165 
	#UINT_WIDTH
 32

	)

167 #iâdeà
LONG_WIDTH


168 
	#LONG_WIDTH
 
__WORDSIZE


	)

170 #iâdeà
ULONG_WIDTH


171 
	#ULONG_WIDTH
 
__WORDSIZE


	)

173 #iâdeà
LLONG_WIDTH


174 
	#LLONG_WIDTH
 64

	)

176 #iâdeà
ULLONG_WIDTH


177 
	#ULLONG_WIDTH
 64

	)

181 #ifdef 
__USE_POSIX


183 
	~<b™s/posix1_lim.h
>

186 #ifdef 
__USE_POSIX2


187 
	~<b™s/posix2_lim.h
>

190 #ifdef 
__USE_XOPEN


191 
	~<b™s/xİ’_lim.h
>

	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

27 
	~<b™s/ty³s.h
>

28 
	~<b™s/wch¬.h
>

29 
	~<b™s/wÜdsize.h
>

34 
	~<b™s/¡dšt-šŠ.h
>

37 
	~<b™s/¡dšt-ušŠ.h
>

43 sigÃd 
	tšt_Ëa¡8_t
;

44 
	tšt_Ëa¡16_t
;

45 
	tšt_Ëa¡32_t
;

46 #ià
__WORDSIZE
 == 64

47 
	tšt_Ëa¡64_t
;

49 
__ex‹nsiÚ__


50 
	tšt_Ëa¡64_t
;

54 
	tušt_Ëa¡8_t
;

55 
	tušt_Ëa¡16_t
;

56 
	tušt_Ëa¡32_t
;

57 #ià
__WORDSIZE
 == 64

58 
	tušt_Ëa¡64_t
;

60 
__ex‹nsiÚ__


61 
	tušt_Ëa¡64_t
;

68 sigÃd 
	tšt_ç¡8_t
;

69 #ià
__WORDSIZE
 == 64

70 
	tšt_ç¡16_t
;

71 
	tšt_ç¡32_t
;

72 
	tšt_ç¡64_t
;

74 
	tšt_ç¡16_t
;

75 
	tšt_ç¡32_t
;

76 
__ex‹nsiÚ__


77 
	tšt_ç¡64_t
;

81 
	tušt_ç¡8_t
;

82 #ià
__WORDSIZE
 == 64

83 
	tušt_ç¡16_t
;

84 
	tušt_ç¡32_t
;

85 
	tušt_ç¡64_t
;

87 
	tušt_ç¡16_t
;

88 
	tušt_ç¡32_t
;

89 
__ex‹nsiÚ__


90 
	tušt_ç¡64_t
;

95 #ià
__WORDSIZE
 == 64

96 #iâdeà
__šŒ_t_defšed


97 
	tšŒ_t
;

98 
	#__šŒ_t_defšed


	)

100 
	tušŒ_t
;

102 #iâdeà
__šŒ_t_defšed


103 
	tšŒ_t
;

104 
	#__šŒ_t_defšed


	)

106 
	tušŒ_t
;

111 
__štmax_t
 
	tštmax_t
;

112 
__uštmax_t
 
	tuštmax_t
;

115 #ià
__WORDSIZE
 == 64

116 
	#__INT64_C
(
c
èø## 
L


	)

117 
	#__UINT64_C
(
c
èø## 
UL


	)

119 
	#__INT64_C
(
c
èø## 
LL


	)

120 
	#__UINT64_C
(
c
èø## 
ULL


	)

126 
	#INT8_MIN
 (-128)

	)

127 
	#INT16_MIN
 (-32767-1)

	)

128 
	#INT32_MIN
 (-2147483647-1)

	)

129 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

131 
	#INT8_MAX
 (127)

	)

132 
	#INT16_MAX
 (32767)

	)

133 
	#INT32_MAX
 (2147483647)

	)

134 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

137 
	#UINT8_MAX
 (255)

	)

138 
	#UINT16_MAX
 (65535)

	)

139 
	#UINT32_MAX
 (4294967295U)

	)

140 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

144 
	#INT_LEAST8_MIN
 (-128)

	)

145 
	#INT_LEAST16_MIN
 (-32767-1)

	)

146 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

147 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

149 
	#INT_LEAST8_MAX
 (127)

	)

150 
	#INT_LEAST16_MAX
 (32767)

	)

151 
	#INT_LEAST32_MAX
 (2147483647)

	)

152 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

155 
	#UINT_LEAST8_MAX
 (255)

	)

156 
	#UINT_LEAST16_MAX
 (65535)

	)

157 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

158 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

162 
	#INT_FAST8_MIN
 (-128)

	)

163 #ià
__WORDSIZE
 == 64

164 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

165 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

167 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

168 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

170 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

172 
	#INT_FAST8_MAX
 (127)

	)

173 #ià
__WORDSIZE
 == 64

174 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

175 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

177 
	#INT_FAST16_MAX
 (2147483647)

	)

178 
	#INT_FAST32_MAX
 (2147483647)

	)

180 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

183 
	#UINT_FAST8_MAX
 (255)

	)

184 #ià
__WORDSIZE
 == 64

185 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

186 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

188 
	#UINT_FAST16_MAX
 (4294967295U)

	)

189 
	#UINT_FAST32_MAX
 (4294967295U)

	)

191 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

195 #ià
__WORDSIZE
 == 64

196 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

197 
	#INTPTR_MAX
 (9223372036854775807L)

	)

198 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

200 
	#INTPTR_MIN
 (-2147483647-1)

	)

201 
	#INTPTR_MAX
 (2147483647)

	)

202 
	#UINTPTR_MAX
 (4294967295U)

	)

207 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

209 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

218 #ià
__WORDSIZE
 == 64

219 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

220 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

222 #ià
__WORDSIZE32_PTRDIFF_LONG


223 
	#PTRDIFF_MIN
 (-2147483647L-1)

	)

224 
	#PTRDIFF_MAX
 (2147483647L)

	)

226 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

227 
	#PTRDIFF_MAX
 (2147483647)

	)

232 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

233 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

236 #ià
__WORDSIZE
 == 64

237 
	#SIZE_MAX
 (18446744073709551615UL)

	)

239 #ià
__WORDSIZE32_SIZE_ULONG


240 
	#SIZE_MAX
 (4294967295UL)

	)

242 
	#SIZE_MAX
 (4294967295U)

	)

247 #iâdeà
WCHAR_MIN


249 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

250 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

254 
	#WINT_MIN
 (0u)

	)

255 
	#WINT_MAX
 (4294967295u)

	)

258 
	#INT8_C
(
c
è
	)
c

259 
	#INT16_C
(
c
è
	)
c

260 
	#INT32_C
(
c
è
	)
c

261 #ià
__WORDSIZE
 == 64

262 
	#INT64_C
(
c
èø## 
L


	)

264 
	#INT64_C
(
c
èø## 
LL


	)

268 
	#UINT8_C
(
c
è
	)
c

269 
	#UINT16_C
(
c
è
	)
c

270 
	#UINT32_C
(
c
èø## 
U


	)

271 #ià
__WORDSIZE
 == 64

272 
	#UINT64_C
(
c
èø## 
UL


	)

274 
	#UINT64_C
(
c
èø## 
ULL


	)

278 #ià
__WORDSIZE
 == 64

279 
	#INTMAX_C
(
c
èø## 
L


	)

280 
	#UINTMAX_C
(
c
èø## 
UL


	)

282 
	#INTMAX_C
(
c
èø## 
LL


	)

283 
	#UINTMAX_C
(
c
èø## 
ULL


	)

286 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

288 
	#INT8_WIDTH
 8

	)

289 
	#UINT8_WIDTH
 8

	)

290 
	#INT16_WIDTH
 16

	)

291 
	#UINT16_WIDTH
 16

	)

292 
	#INT32_WIDTH
 32

	)

293 
	#UINT32_WIDTH
 32

	)

294 
	#INT64_WIDTH
 64

	)

295 
	#UINT64_WIDTH
 64

	)

297 
	#INT_LEAST8_WIDTH
 8

	)

298 
	#UINT_LEAST8_WIDTH
 8

	)

299 
	#INT_LEAST16_WIDTH
 16

	)

300 
	#UINT_LEAST16_WIDTH
 16

	)

301 
	#INT_LEAST32_WIDTH
 32

	)

302 
	#UINT_LEAST32_WIDTH
 32

	)

303 
	#INT_LEAST64_WIDTH
 64

	)

304 
	#UINT_LEAST64_WIDTH
 64

	)

306 
	#INT_FAST8_WIDTH
 8

	)

307 
	#UINT_FAST8_WIDTH
 8

	)

308 
	#INT_FAST16_WIDTH
 
__WORDSIZE


	)

309 
	#UINT_FAST16_WIDTH
 
__WORDSIZE


	)

310 
	#INT_FAST32_WIDTH
 
__WORDSIZE


	)

311 
	#UINT_FAST32_WIDTH
 
__WORDSIZE


	)

312 
	#INT_FAST64_WIDTH
 64

	)

313 
	#UINT_FAST64_WIDTH
 64

	)

315 
	#INTPTR_WIDTH
 
__WORDSIZE


	)

316 
	#UINTPTR_WIDTH
 
__WORDSIZE


	)

318 
	#INTMAX_WIDTH
 64

	)

319 
	#UINTMAX_WIDTH
 64

	)

321 
	#PTRDIFF_WIDTH
 
__WORDSIZE


	)

322 
	#SIG_ATOMIC_WIDTH
 32

	)

323 
	#SIZE_WIDTH
 
__WORDSIZE


	)

324 
	#WCHAR_WIDTH
 32

	)

325 
	#WINT_WIDTH
 32

	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	~<b™s/ty³s/__FILE.h
>

37 
	~<b™s/ty³s/FILE.h
>

39 
	#_STDIO_USES_IOSTREAM


	)

41 
	~<b™s/libio.h
>

43 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


44 #ifdeà
__GNUC__


45 #iâdeà
_VA_LIST_DEFINED


46 
_G_va_li¡
 
	tva_li¡
;

47 
	#_VA_LIST_DEFINED


	)

50 
	~<¡d¬g.h
>

54 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


55 #iâdeà
__off_t_defšed


56 #iâdeà
__USE_FILE_OFFSET64


57 
__off_t
 
	toff_t
;

59 
__off64_t
 
	toff_t
;

61 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

69 #ifdeà
__USE_XOPEN2K8


70 #iâdeà
__ssize_t_defšed


71 
__ssize_t
 
	tssize_t
;

72 
	#__ssize_t_defšed


	)

77 #iâdeà
__USE_FILE_OFFSET64


78 
_G_åos_t
 
	tåos_t
;

80 
_G_åos64_t
 
	tåos_t
;

82 #ifdeà
__USE_LARGEFILE64


83 
_G_åos64_t
 
	tåos64_t
;

87 
	#_IOFBF
 0

	)

88 
	#_IOLBF
 1

	)

89 
	#_IONBF
 2

	)

93 #iâdeà
BUFSIZ


94 
	#BUFSIZ
 
_IO_BUFSIZ


	)

100 #iâdeà
EOF


101 
	#EOF
 (-1)

	)

107 
	#SEEK_SET
 0

	)

108 
	#SEEK_CUR
 1

	)

109 
	#SEEK_END
 2

	)

110 #ifdeà
__USE_GNU


111 
	#SEEK_DATA
 3

	)

112 
	#SEEK_HOLE
 4

	)

116 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


118 
	#P_tmpdœ
 "/tmp"

	)

131 
	~<b™s/¡dio_lim.h
>

135 
_IO_FILE
 *
¡dš
;

136 
_IO_FILE
 *
¡dout
;

137 
_IO_FILE
 *
¡d”r
;

139 
	#¡dš
 
¡dš


	)

140 
	#¡dout
 
¡dout


	)

141 
	#¡d”r
 
¡d”r


	)

144 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

146 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

148 #ifdeà
__USE_ATFILE


150 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

151 cÚ¡ *
__Ãw
è
__THROW
;

158 #iâdeà
__USE_FILE_OFFSET64


159 
FILE
 *
	$tmpfe
 (è
__wur
;

161 #ifdeà
__REDIRECT


162 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

164 
	#tmpfe
 
tmpfe64


	)

168 #ifdeà
__USE_LARGEFILE64


169 
FILE
 *
	$tmpfe64
 (è
__wur
;

173 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

175 #ifdeà
__USE_MISC


178 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

182 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


190 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

191 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

199 
	`fşo£
 (
FILE
 *
__¡»am
);

204 
	`fæush
 (
FILE
 *
__¡»am
);

206 #ifdeà
__USE_MISC


213 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

216 #ifdeà
__USE_GNU


223 
	`fşo£®l
 ();

227 #iâdeà
__USE_FILE_OFFSET64


232 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

233 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

238 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

239 cÚ¡ *
__»¡riù
 
__modes
,

240 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

242 #ifdeà
__REDIRECT


243 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

244 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

245 
__wur
;

246 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

247 cÚ¡ *
__»¡riù
 
__modes
,

248 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

249 
__wur
;

251 
	#fİ’
 
fİ’64


	)

252 
	#äeİ’
 
äeİ’64


	)

255 #ifdeà
__USE_LARGEFILE64


256 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

257 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

258 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

259 cÚ¡ *
__»¡riù
 
__modes
,

260 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

263 #ifdef 
__USE_POSIX


265 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

268 #ifdef 
__USE_GNU


271 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

272 cÚ¡ *
__»¡riù
 
__modes
,

273 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

276 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

278 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

279 
__THROW
 
__wur
;

284 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

290 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

294 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

295 
__modes
, 
size_t
 
__n
è
__THROW
;

297 #ifdef 
__USE_MISC


300 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

301 
size_t
 
__size
è
__THROW
;

304 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

312 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

313 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

318 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

320 
	$¥rštf
 (*
__»¡riù
 
__s
,

321 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

327 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

328 
_G_va_li¡
 
__¬g
);

333 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

335 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

336 
_G_va_li¡
 
__¬g
è
__THROWNL
;

338 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


340 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

341 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

342 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

344 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

345 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

346 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

349 #ià
	`__GLIBC_USE
 (
LIB_EXT2
)

352 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

353 
_G_va_li¡
 
__¬g
)

354 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

355 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

356 cÚ¡ *
__»¡riù
 
__fmt
, ...)

357 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

358 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

359 cÚ¡ *
__»¡riù
 
__fmt
, ...)

360 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

363 #ifdeà
__USE_XOPEN2K8


365 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

366 
_G_va_li¡
 
__¬g
)

367 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

368 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

369 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

377 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

378 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

383 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

385 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

386 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

388 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

389 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

390 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

391 #ifdeà
__REDIRECT


395 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

396 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

397 
__isoc99_fsÿnf
è
__wur
;

398 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

399 
__isoc99_sÿnf
è
__wur
;

400 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

401 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

402 
__isoc99_ssÿnf
);

404 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

405 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

406 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

407 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

408 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

409 
	#fsÿnf
 
__isoc99_fsÿnf


	)

410 
	#sÿnf
 
__isoc99_sÿnf


	)

411 
	#ssÿnf
 
__isoc99_ssÿnf


	)

415 #ifdef 
__USE_ISOC99


420 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

421 
_G_va_li¡
 
__¬g
)

422 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

428 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

429 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

432 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

433 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

434 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

436 #ià!
defšed
 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
vfsÿnf
,

444 (
FILE
 *
__»¡riù
 
__s
,

445 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

446 
__isoc99_vfsÿnf
)

447 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

448 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

449 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

450 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

451 
	`__REDIRECT_NTH
 (
vssÿnf
,

452 (cÚ¡ *
__»¡riù
 
__s
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
,

454 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

455 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

457 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

458 cÚ¡ *
__»¡riù
 
__fÜm©
,

459 
_G_va_li¡
 
__¬g
è
__wur
;

460 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

461 
_G_va_li¡
 
__¬g
è
__wur
;

462 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

463 cÚ¡ *
__»¡riù
 
__fÜm©
,

464 
_G_va_li¡
 
__¬g
è
__THROW
;

465 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

466 
	#vsÿnf
 
__isoc99_vsÿnf


	)

467 
	#vssÿnf
 
__isoc99_vssÿnf


	)

477 
	`fg‘c
 (
FILE
 *
__¡»am
);

478 
	`g‘c
 (
FILE
 *
__¡»am
);

484 
	`g‘ch¬
 ();

488 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

490 #ifdeà
__USE_POSIX199506


495 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

496 
	`g‘ch¬_uÆocked
 ();

499 #ifdeà
__USE_MISC


506 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

517 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

518 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

524 
	`putch¬
 (
__c
);

528 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

530 #ifdeà
__USE_MISC


537 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

540 #ifdeà
__USE_POSIX199506


545 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

546 
	`putch¬_uÆocked
 (
__c
);

550 #ià
defšed
 
__USE_MISC
 \

551 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

553 
	`g‘w
 (
FILE
 *
__¡»am
);

556 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

564 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

565 
__wur
;

567 #ià
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

577 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

580 #ifdeà
__USE_GNU


587 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

588 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

592 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

603 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

604 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

605 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

606 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

607 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

608 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

616 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

617 
size_t
 *
__»¡riù
 
__n
,

618 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

626 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

632 
	`puts
 (cÚ¡ *
__s
);

639 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

646 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

647 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

652 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

653 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

655 #ifdeà
__USE_GNU


662 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

663 
FILE
 *
__»¡riù
 
__¡»am
);

666 #ifdeà
__USE_MISC


673 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

674 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

675 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

676 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

684 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

689 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

694 
	`»wšd
 (
FILE
 *
__¡»am
);

701 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


702 #iâdeà
__USE_FILE_OFFSET64


707 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

712 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

714 #ifdeà
__REDIRECT


715 
	`__REDIRECT
 (
f£eko
,

716 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

717 
f£eko64
);

718 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

720 
	#f£eko
 
f£eko64


	)

721 
	#á–lo
 
á–lo64


	)

726 #iâdeà
__USE_FILE_OFFSET64


731 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

736 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

738 #ifdeà
__REDIRECT


739 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

740 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

741 
	`__REDIRECT
 (
f£os
,

742 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

744 
	#fg‘pos
 
fg‘pos64


	)

745 
	#f£os
 
f£os64


	)

749 #ifdeà
__USE_LARGEFILE64


750 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

751 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

752 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

753 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

757 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

759 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

761 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

763 #ifdeà
__USE_MISC


765 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

766 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

767 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

775 
	`³¼Ü
 (cÚ¡ *
__s
);

781 
	~<b™s/sys_”¾i¡.h
>

784 #ifdef 
__USE_POSIX


786 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

789 #ifdeà
__USE_MISC


791 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

795 #ifdeà
__USE_POSIX2


800 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

806 
	`pşo£
 (
FILE
 *
__¡»am
);

810 #ifdef 
__USE_POSIX


812 *
	$ù”mid
 (*
__s
è
__THROW
;

816 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
è|| defšed 
__USE_GNU


818 *
	`cu£rid
 (*
__s
);

822 #ifdef 
__USE_GNU


823 
ob¡ack
;

826 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

827 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

828 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

829 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

830 cÚ¡ *
__»¡riù
 
__fÜm©
,

831 
_G_va_li¡
 
__¬gs
)

832 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

836 #ifdeà
__USE_POSIX199506


840 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

844 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

847 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

850 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


853 
	~<b™s/g‘İt_posix.h
>

858 #ifdeà
__USE_EXTERN_INLINES


859 
	~<b™s/¡dio.h
>

861 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


862 
	~<b™s/¡dio2.h
>

864 #ifdeà
__LDBL_COMPAT


865 
	~<b™s/¡dio-ldbl.h
>

868 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

25 
	~<b™s/libc-h—d”-¡¬t.h
>

28 
	#__Ãed_size_t


	)

29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

31 
	~<¡ddef.h
>

33 
	g__BEGIN_DECLS


35 
	#_STDLIB_H
 1

	)

37 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


39 
	~<b™s/wa™æags.h
>

40 
	~<b™s/wa™¡©us.h
>

43 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (¡©us)

	)

44 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (¡©us)

	)

45 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (¡©us)

	)

46 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (¡©us)

	)

47 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (¡©us)

	)

48 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (¡©us)

	)

49 #ifdeà
__WIFCONTINUED


50 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (¡©us)

	)

55 
	~<b™s/æßŠ.h
>

60 
	mquÙ
;

61 
	m»m
;

62 } 
	tdiv_t
;

65 #iâdeà
__ldiv_t_defšed


68 
	mquÙ
;

69 
	m»m
;

70 } 
	tldiv_t
;

71 
	#__ldiv_t_defšed
 1

	)

74 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


76 
__ex‹nsiÚ__
 struct

78 
	mquÙ
;

79 
	m»m
;

80 } 
	tÎdiv_t
;

81 
	#__Îdiv_t_defšed
 1

	)

86 
	#RAND_MAX
 2147483647

	)

91 
	#EXIT_FAILURE
 1

	)

92 
	#EXIT_SUCCESS
 0

	)

96 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

97 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

101 
	$©of
 (cÚ¡ *
__ÅŒ
)

102 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

104 
	$©oi
 (cÚ¡ *
__ÅŒ
)

105 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

107 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

108 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

110 #ifdeà
__USE_ISOC99


112 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

113 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

117 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

118 **
__»¡riù
 
__’d±r
)

119 
__THROW
 
	`__nÚnuÎ
 ((1));

121 #ifdef 
__USE_ISOC99


123 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

124 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

126 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

127 **
__»¡riù
 
__’d±r
)

128 
__THROW
 
	`__nÚnuÎ
 ((1));

133 #ià
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
_Flßt16
 
	$¡¹of16
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

135 **
__»¡riù
 
__’d±r
)

136 
__THROW
 
	`__nÚnuÎ
 ((1));

139 #ià
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

140 
_Flßt32
 
	$¡¹of32
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

141 **
__»¡riù
 
__’d±r
)

142 
__THROW
 
	`__nÚnuÎ
 ((1));

145 #ià
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

146 
_Flßt64
 
	$¡¹of64
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

147 **
__»¡riù
 
__’d±r
)

148 
__THROW
 
	`__nÚnuÎ
 ((1));

151 #ià
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

152 
_Flßt128
 
	$¡¹of128
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

153 **
__»¡riù
 
__’d±r
)

154 
__THROW
 
	`__nÚnuÎ
 ((1));

157 #ià
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

158 
_Flßt32x
 
	$¡¹of32x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

159 **
__»¡riù
 
__’d±r
)

160 
__THROW
 
	`__nÚnuÎ
 ((1));

163 #ià
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

164 
_Flßt64x
 
	$¡¹of64x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

169 #ià
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

170 
_Flßt128x
 
	$¡¹of128x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

171 **
__»¡riù
 
__’d±r
)

172 
__THROW
 
	`__nÚnuÎ
 ((1));

176 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

177 **
__»¡riù
 
__’d±r
, 
__ba£
)

178 
__THROW
 
	`__nÚnuÎ
 ((1));

180 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

181 **
__»¡riù
 
__’d±r
, 
__ba£
)

182 
__THROW
 
	`__nÚnuÎ
 ((1));

184 #ifdeà
__USE_MISC


186 
__ex‹nsiÚ__


187 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

191 
__ex‹nsiÚ__


192 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

193 **
__»¡riù
 
__’d±r
, 
__ba£
)

194 
__THROW
 
	`__nÚnuÎ
 ((1));

197 #ifdeà
__USE_ISOC99


199 
__ex‹nsiÚ__


200 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

204 
__ex‹nsiÚ__


205 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

206 **
__»¡riù
 
__’d±r
, 
__ba£
)

207 
__THROW
 
	`__nÚnuÎ
 ((1));

211 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

212 
	$¡räomd
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

213 
__f
)

214 
__THROW
 
	`__nÚnuÎ
 ((3));

216 
	$¡räomf
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

217 
__f
)

218 
__THROW
 
	`__nÚnuÎ
 ((3));

220 
	$¡räoml
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

221 
__f
)

222 
__THROW
 
	`__nÚnuÎ
 ((3));

225 #ià
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

226 
	$¡räomf16
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

227 
_Flßt16
 
__f
)

228 
__THROW
 
	`__nÚnuÎ
 ((3));

231 #ià
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

232 
	$¡räomf32
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

233 
_Flßt32
 
__f
)

234 
__THROW
 
	`__nÚnuÎ
 ((3));

237 #ià
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

238 
	$¡räomf64
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

239 
_Flßt64
 
__f
)

240 
__THROW
 
	`__nÚnuÎ
 ((3));

243 #ià
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

244 
	$¡räomf128
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

245 
_Flßt128
 
__f
)

246 
__THROW
 
	`__nÚnuÎ
 ((3));

249 #ià
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

250 
	$¡räomf32x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

251 
_Flßt32x
 
__f
)

252 
__THROW
 
	`__nÚnuÎ
 ((3));

255 #ià
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

256 
	$¡räomf64x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

257 
_Flßt64x
 
__f
)

258 
__THROW
 
	`__nÚnuÎ
 ((3));

261 #ià
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

262 
	$¡räomf128x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

263 
_Flßt128x
 
__f
)

264 
__THROW
 
	`__nÚnuÎ
 ((3));

268 #ifdeà
__USE_GNU


272 
	~<b™s/ty³s/loÿË_t.h
>

274 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

275 **
__»¡riù
 
__’d±r
, 
__ba£
,

276 
loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

278 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

279 **
__»¡riù
 
__’d±r
,

280 
__ba£
, 
loÿË_t
 
__loc
)

281 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

283 
__ex‹nsiÚ__


284 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

285 **
__»¡riù
 
__’d±r
, 
__ba£
,

286 
loÿË_t
 
__loc
)

287 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

289 
__ex‹nsiÚ__


290 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

291 **
__»¡riù
 
__’d±r
,

292 
__ba£
, 
loÿË_t
 
__loc
)

293 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

295 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

296 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

297 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

299 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

300 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

301 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

303 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

304 **
__»¡riù
 
__’d±r
,

305 
loÿË_t
 
__loc
)

306 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

308 #ià
__HAVE_FLOAT16


309 
_Flßt16
 
	$¡¹of16_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

310 **
__»¡riù
 
__’d±r
,

311 
loÿË_t
 
__loc
)

312 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

315 #ià
__HAVE_FLOAT32


316 
_Flßt32
 
	$¡¹of32_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

317 **
__»¡riù
 
__’d±r
,

318 
loÿË_t
 
__loc
)

319 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

322 #ià
__HAVE_FLOAT64


323 
_Flßt64
 
	$¡¹of64_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

324 **
__»¡riù
 
__’d±r
,

325 
loÿË_t
 
__loc
)

326 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

329 #ià
__HAVE_FLOAT128


330 
_Flßt128
 
	$¡¹of128_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 **
__»¡riù
 
__’d±r
,

332 
loÿË_t
 
__loc
)

333 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

336 #ià
__HAVE_FLOAT32X


337 
_Flßt32x
 
	$¡¹of32x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

338 **
__»¡riù
 
__’d±r
,

339 
loÿË_t
 
__loc
)

340 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

343 #ià
__HAVE_FLOAT64X


344 
_Flßt64x
 
	$¡¹of64x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

345 **
__»¡riù
 
__’d±r
,

346 
loÿË_t
 
__loc
)

347 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

350 #ià
__HAVE_FLOAT128X


351 
_Flßt128x
 
	$¡¹of128x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

352 **
__»¡riù
 
__’d±r
,

353 
loÿË_t
 
__loc
)

354 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

359 #ifdeà
__USE_EXTERN_INLINES


360 
__ex‹º_šlše
 

361 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

363  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

364 
	}
}

365 
__ex‹º_šlše
 

366 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

368  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

369 
	}
}

371 #ifdeà
__USE_ISOC99


372 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

373 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

375  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

376 
	}
}

381 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


385 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

388 
	$a64l
 (cÚ¡ *
__s
)

389 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

393 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


394 
	~<sys/ty³s.h
>

401 
	$¿ndom
 (è
__THROW
;

404 
	$¤ªdom
 (
__£ed
è
__THROW
;

410 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

411 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

415 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

418 #ifdeà
__USE_MISC


423 
	s¿ndom_d©a


425 
št32_t
 *
åŒ
;

426 
št32_t
 *
½Œ
;

427 
št32_t
 *
¡©e
;

428 
¿nd_ty³
;

429 
¿nd_deg
;

430 
¿nd_£p
;

431 
št32_t
 *
’d_±r
;

434 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

435 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

437 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

438 
__THROW
 
	`__nÚnuÎ
 ((2));

440 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

441 
size_t
 
__¡©–’
,

442 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

443 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

445 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

446 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

447 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

453 
	$¿nd
 (è
__THROW
;

455 
	$¤ªd
 (
__£ed
è
__THROW
;

457 #ifdeà
__USE_POSIX199506


459 
	$¿nd_r
 (*
__£ed
è
__THROW
;

463 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


467 
	$d¿nd48
 (è
__THROW
;

468 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

471 
	$Ìªd48
 (è
__THROW
;

472 
	$Äªd48
 (
__xsubi
[3])

473 
__THROW
 
	`__nÚnuÎ
 ((1));

476 
	$m¿nd48
 (è
__THROW
;

477 
	$j¿nd48
 (
__xsubi
[3])

478 
__THROW
 
	`__nÚnuÎ
 ((1));

481 
	$¤ªd48
 (
__£edv®
è
__THROW
;

482 *
	$£ed48
 (
__£ed16v
[3])

483 
__THROW
 
	`__nÚnuÎ
 ((1));

484 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

486 #ifdeà
__USE_MISC


490 
	sd¿nd48_d©a


492 
__x
[3];

493 
__Şd_x
[3];

494 
__c
;

495 
__š™
;

496 
__ex‹nsiÚ__
 
__a
;

501 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

502 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

503 
	$”ªd48_r
 (
__xsubi
[3],

504 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

505 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

508 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

509 *
__»¡riù
 
__»suÉ
)

510 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

511 
	$Äªd48_r
 (
__xsubi
[3],

512 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

513 *
__»¡riù
 
__»suÉ
)

514 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

517 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

518 *
__»¡riù
 
__»suÉ
)

519 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

520 
	$j¿nd48_r
 (
__xsubi
[3],

521 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

522 *
__»¡riù
 
__»suÉ
)

523 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

526 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

527 
__THROW
 
	`__nÚnuÎ
 ((2));

529 
	$£ed48_r
 (
__£ed16v
[3],

530 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

532 
	$lcÚg48_r
 (
__·¿m
[7],

533 
d¿nd48_d©a
 *
__bufãr
)

534 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

539 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

541 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

542 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

549 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

550 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

552 #ifdeà
__USE_GNU


558 *
	$»®loÿ¼ay
 (*
__±r
, 
size_t
 
__nmemb
, size_ˆ
__size
)

559 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

563 
	$ä“
 (*
__±r
è
__THROW
;

565 #ifdeà
__USE_MISC


566 
	~<®loÿ.h
>

569 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

570 || 
defšed
 
__USE_MISC


572 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

575 #ifdeà
__USE_XOPEN2K


577 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

578 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

581 #ifdeà
__USE_ISOC11


583 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

584 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

588 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

592 
	$©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

594 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


596 #ifdeà
__ılu¥lus


597 "C++" 
	$©_quick_ex™
 ((*
__func
) ())

598 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

600 
	$©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

604 #ifdef 
__USE_MISC


607 
	$Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

608 
__THROW
 
	`__nÚnuÎ
 ((1));

614 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

616 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


620 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

623 #ifdeà
__USE_ISOC99


626 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

631 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

633 #ifdeà
__USE_GNU


636 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

637 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

640 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


644 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

647 #ifdeà
__USE_XOPEN2K


650 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

651 
__THROW
 
	`__nÚnuÎ
 ((2));

654 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

657 #ifdef 
__USE_MISC


661 
	$ş—»nv
 (è
__THROW
;

665 #ià
defšed
 
__USE_MISC
 \

666 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

672 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

675 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


684 #iâdeà
__USE_FILE_OFFSET64


685 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

687 #ifdeà
__REDIRECT


688 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

689 
	`__nÚnuÎ
 ((1)è
__wur
;

691 
	#mk¡emp
 
mk¡emp64


	)

694 #ifdeà
__USE_LARGEFILE64


695 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

699 #ifdeà
__USE_MISC


706 #iâdeà
__USE_FILE_OFFSET64


707 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

711 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

713 
	#mk¡emps
 
mk¡emps64


	)

716 #ifdeà
__USE_LARGEFILE64


717 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

718 
	`__nÚnuÎ
 ((1)è
__wur
;

722 #ifdeà
__USE_XOPEN2K8


728 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

731 #ifdeà
__USE_GNU


738 #iâdeà
__USE_FILE_OFFSET64


739 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

741 #ifdeà
__REDIRECT


742 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

743 
	`__nÚnuÎ
 ((1)è
__wur
;

745 
	#mko¡emp
 
mko¡emp64


	)

748 #ifdeà
__USE_LARGEFILE64


749 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

758 #iâdeà
__USE_FILE_OFFSET64


759 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

760 
	`__nÚnuÎ
 ((1)è
__wur
;

762 #ifdeà
__REDIRECT


763 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

764 
__æags
), 
mko¡emps64
)

765 
	`__nÚnuÎ
 ((1)è
__wur
;

767 
	#mko¡emps
 
mko¡emps64


	)

770 #ifdeà
__USE_LARGEFILE64


771 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

772 
	`__nÚnuÎ
 ((1)è
__wur
;

781 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

784 #ifdef 
__USE_GNU


787 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

788 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

791 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


797 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

798 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

803 #iâdeà
__COMPAR_FN_T


804 
	#__COMPAR_FN_T


	)

805 (*
	t__com·r_â_t
) (const *, const *);

807 #ifdef 
__USE_GNU


808 
__com·r_â_t
 
	tcom·risÚ_â_t
;

811 #ifdeà
__USE_GNU


812 (*
	t__com·r_d_â_t
) (const *, const *, *);

817 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

818 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

819 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

821 #ifdeà
__USE_EXTERN_INLINES


822 
	~<b™s/¡dlib-b£¬ch.h
>

827 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

828 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

829 #ifdeà
__USE_GNU


830 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

831 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

832 
	`__nÚnuÎ
 ((1, 4));

837 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

838 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

840 #ifdeà
__USE_ISOC99


841 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

842 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

849 
div_t
 
	$div
 (
__num”
, 
__d’om
)

850 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

851 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

852 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

854 #ifdeà
__USE_ISOC99


855 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

856 
__d’om
)

857 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

861 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

862 || 
defšed
 
__USE_MISC


869 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

870 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

875 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

876 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

881 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

882 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

885 #ifdeà
__USE_MISC


887 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

888 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

889 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

890 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

891 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

892 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

893 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

894 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

899 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

900 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

901 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

902 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

903 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

904 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

906 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

907 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

908 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

909 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

910 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

911 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

912 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

913 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

919 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

922 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

923 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

926 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

930 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

931 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

933 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

934 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

935 
__THROW
;

938 #ifdeà
__USE_MISC


943 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

947 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


954 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

955 *cÚ¡ *
__»¡riù
 
__tok’s
,

956 **
__»¡riù
 
__v®u•
)

957 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

961 #ifdeà
__USE_XOPEN


963 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

969 #ifdeà
__USE_XOPEN2KXSI


971 
	$posix_İ’±
 (
__oæag
è
__wur
;

974 #ifdeà
__USE_XOPEN_EXTENDED


979 
	$g¿Á±
 (
__fd
è
__THROW
;

983 
	$uÆock±
 (
__fd
è
__THROW
;

988 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

991 #ifdeà
__USE_GNU


995 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

996 
__THROW
 
	`__nÚnuÎ
 ((2));

999 
	`g‘±
 ();

1002 #ifdeà
__USE_MISC


1006 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

1007 
__THROW
 
	`__nÚnuÎ
 ((1));

1010 #ià
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K


1013 
	$‰y¦Ù
 (è
__THROW
;

1016 
	~<b™s/¡dlib-æßt.h
>

1019 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1020 
	~<b™s/¡dlib.h
>

1022 #ifdeà
__LDBL_COMPAT


1023 
	~<b™s/¡dlib-ldbl.h
>

1026 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


23 
	#_TIME_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

33 
	~<b™s/time.h
>

37 
	~<b™s/ty³s/şock_t.h
>

38 
	~<b™s/ty³s/time_t.h
>

39 
	~<b™s/ty³s/¡ruù_tm.h
>

41 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_ISOC11


42 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

45 #ifdeà
__USE_POSIX199309


46 
	~<b™s/ty³s/şockid_t.h
>

47 
	~<b™s/ty³s/tim”_t.h
>

48 
	~<b™s/ty³s/¡ruù_™im”¥ec.h
>

49 
	gsigev’t
;

52 #ifdeà
__USE_XOPEN2K


53 #iâdeà
__pid_t_defšed


54 
__pid_t
 
	tpid_t
;

55 
	#__pid_t_defšed


	)

59 #ifdeà
__USE_XOPEN2K8


60 
	~<b™s/ty³s/loÿË_t.h
>

63 #ifdeà
__USE_ISOC11


65 
	#TIME_UTC
 1

	)

68 
__BEGIN_DECLS


72 
şock_t
 
	$şock
 (è
__THROW
;

75 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

78 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

79 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

82 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

88 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

89 cÚ¡ *
__»¡riù
 
__fÜm©
,

90 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

92 #ifdeà
__USE_XOPEN


95 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

96 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

97 
__THROW
;

100 #ifdeà
__USE_XOPEN2K8


104 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

105 cÚ¡ *
__»¡riù
 
__fÜm©
,

106 cÚ¡ 
tm
 *
__»¡riù
 
__
,

107 
loÿË_t
 
__loc
è
__THROW
;

110 #ifdeà
__USE_GNU


111 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

112 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

113 
loÿË_t
 
__loc
è
__THROW
;

119 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

123 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

125 #ifdeà
__USE_POSIX


128 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

129 
tm
 *
__»¡riù
 
__
è
__THROW
;

133 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

134 
tm
 *
__»¡riù
 
__
è
__THROW
;

139 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

142 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

144 #ifdeà
__USE_POSIX


149 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

150 *
__»¡riù
 
__buf
è
__THROW
;

153 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

154 *
__»¡riù
 
__buf
è
__THROW
;

159 *
__tzÇme
[2];

160 
__daylight
;

161 
__timezÚe
;

164 #ifdef 
__USE_POSIX


166 *
tzÇme
[2];

170 
	$tz£t
 (è
__THROW
;

173 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


174 
daylight
;

175 
timezÚe
;

178 #ifdeà
__USE_MISC


181 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

187 
	#__i¦—p
(
y—r
) \

188 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

191 #ifdeà
__USE_MISC


196 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

199 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

202 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

206 #ifdeà
__USE_POSIX199309


211 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

212 
time¥ec
 *
__»maššg
);

216 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

219 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

222 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

223 
__THROW
;

225 #ifdeà
__USE_XOPEN2K


230 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

231 cÚ¡ 
time¥ec
 *
__»q
,

232 
time¥ec
 *
__»m
);

235 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

240 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

241 
sigev’t
 *
__»¡riù
 
__evp
,

242 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

245 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

248 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

249 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

250 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

253 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

254 
__THROW
;

257 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

261 #ifdeà
__USE_ISOC11


263 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

264 
__THROW
 
	`__nÚnuÎ
 ((1));

268 #ifdeà
__USE_XOPEN_EXTENDED


280 
g‘d©e_”r
;

289 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

292 #ifdeà
__USE_GNU


303 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

304 
tm
 *
__»¡riù
 
__»sbuå
);

307 
__END_DECLS


	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

119 #undeà
__USE_ISOC11


120 #undeà
__USE_ISOC99


121 #undeà
__USE_ISOC95


122 #undeà
__USE_ISOCXX11


123 #undeà
__USE_POSIX


124 #undeà
__USE_POSIX2


125 #undeà
__USE_POSIX199309


126 #undeà
__USE_POSIX199506


127 #undeà
__USE_XOPEN


128 #undeà
__USE_XOPEN_EXTENDED


129 #undeà
__USE_UNIX98


130 #undeà
__USE_XOPEN2K


131 #undeà
__USE_XOPEN2KXSI


132 #undeà
__USE_XOPEN2K8


133 #undeà
__USE_XOPEN2K8XSI


134 #undeà
__USE_LARGEFILE


135 #undeà
__USE_LARGEFILE64


136 #undeà
__USE_FILE_OFFSET64


137 #undeà
__USE_MISC


138 #undeà
__USE_ATFILE


139 #undeà
__USE_GNU


140 #undeà
__USE_FORTIFY_LEVEL


141 #undeà
__KERNEL_STRICT_NAMES


142 #undeà
__GLIBC_USE_DEPRECATED_GETS


146 #iâdeà
_LOOSE_KERNEL_NAMES


147 
	#__KERNEL_STRICT_NAMES


	)

157 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


158 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

159 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

161 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

168 #ià
defšed
 
__şªg_majÜ__
 && defšed 
__şªg_mšÜ__


169 
	#__glibc_şªg_´”eq
(
maj
, 
mš
) \

170 ((
__şªg_majÜ__
 << 16è+ 
__şªg_mšÜ__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

172 
	#__glibc_şªg_´”eq
(
maj
, 
mš
è0

	)

176 
	#__GLIBC_USE
(
F
è
__GLIBC_USE_
 ## 
	)
F

182 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

183 && !
defšed
 
	g_DEFAULT_SOURCE


185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

190 #ifdeà
_GNU_SOURCE


191 #undeà
_ISOC95_SOURCE


192 
	#_ISOC95_SOURCE
 1

	)

193 #undeà
_ISOC99_SOURCE


194 
	#_ISOC99_SOURCE
 1

	)

195 #undeà
_ISOC11_SOURCE


196 
	#_ISOC11_SOURCE
 1

	)

197 #undeà
_POSIX_SOURCE


198 
	#_POSIX_SOURCE
 1

	)

199 #undeà
_POSIX_C_SOURCE


200 
	#_POSIX_C_SOURCE
 200809L

	)

201 #undeà
_XOPEN_SOURCE


202 
	#_XOPEN_SOURCE
 700

	)

203 #undeà
_XOPEN_SOURCE_EXTENDED


204 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

205 #undeà
_LARGEFILE64_SOURCE


206 
	#_LARGEFILE64_SOURCE
 1

	)

207 #undeà
_DEFAULT_SOURCE


208 
	#_DEFAULT_SOURCE
 1

	)

209 #undeà
_ATFILE_SOURCE


210 
	#_ATFILE_SOURCE
 1

	)

215 #ià(
defšed
 
_DEFAULT_SOURCE
 \

216 || (!
defšed
 
	g__STRICT_ANSI__
 \

217 && !
defšed
 
	g_ISOC99_SOURCE
 \

218 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

219 && !
defšed
 
	g_XOPEN_SOURCE
))

220 #undeà
_DEFAULT_SOURCE


221 
	#_DEFAULT_SOURCE
 1

	)

225 #ià(
defšed
 
_ISOC11_SOURCE
 \

226 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

227 
	#__USE_ISOC11
 1

	)

231 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

232 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

233 
	#__USE_ISOC99
 1

	)

237 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

238 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

239 
	#__USE_ISOC95
 1

	)

242 #ifdeà
__ılu¥lus


244 #ià
__ılu¥lus
 >= 201703L

245 
	#__USE_ISOC11
 1

	)

249 #ià
__ılu¥lus
 >ğ201103L || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__


250 
	#__USE_ISOCXX11
 1

	)

251 
	#__USE_ISOC99
 1

	)

258 #ifdeà
_DEFAULT_SOURCE


259 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


260 
	#__USE_POSIX_IMPLICITLY
 1

	)

262 #undeà
_POSIX_SOURCE


263 
	#_POSIX_SOURCE
 1

	)

264 #undeà
_POSIX_C_SOURCE


265 
	#_POSIX_C_SOURCE
 200809L

	)

268 #ià((!
defšed
 
__STRICT_ANSI__
 \

269 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

270 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

271 
	#_POSIX_SOURCE
 1

	)

272 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

273 
	#_POSIX_C_SOURCE
 2

	)

274 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

275 
	#_POSIX_C_SOURCE
 199506L

	)

276 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

277 
	#_POSIX_C_SOURCE
 200112L

	)

279 
	#_POSIX_C_SOURCE
 200809L

	)

281 
	#__USE_POSIX_IMPLICITLY
 1

	)

290 #ià((!
defšed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

291 && (
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE
))

292 
	#_POSIX_SOURCE
 1

	)

293 #undeà
_POSIX_C_SOURCE


294 
	#_POSIX_C_SOURCE
 199506L

	)

297 #ià(
defšed
 
_POSIX_SOURCE
 \

298 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

299 || 
defšed
 
_XOPEN_SOURCE
)

300 
	#__USE_POSIX
 1

	)

303 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


304 
	#__USE_POSIX2
 1

	)

307 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

308 
	#__USE_POSIX199309
 1

	)

311 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

312 
	#__USE_POSIX199506
 1

	)

315 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

316 
	#__USE_XOPEN2K
 1

	)

317 #undeà
__USE_ISOC95


318 
	#__USE_ISOC95
 1

	)

319 #undeà
__USE_ISOC99


320 
	#__USE_ISOC99
 1

	)

323 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

324 
	#__USE_XOPEN2K8
 1

	)

325 #undeà
_ATFILE_SOURCE


326 
	#_ATFILE_SOURCE
 1

	)

329 #ifdef 
_XOPEN_SOURCE


330 
	#__USE_XOPEN
 1

	)

331 #ià(
_XOPEN_SOURCE
 - 0) >= 500

332 
	#__USE_XOPEN_EXTENDED
 1

	)

333 
	#__USE_UNIX98
 1

	)

334 #undeà
_LARGEFILE_SOURCE


335 
	#_LARGEFILE_SOURCE
 1

	)

336 #ià(
_XOPEN_SOURCE
 - 0) >= 600

337 #ià(
_XOPEN_SOURCE
 - 0) >= 700

338 
	#__USE_XOPEN2K8
 1

	)

339 
	#__USE_XOPEN2K8XSI
 1

	)

341 
	#__USE_XOPEN2K
 1

	)

342 
	#__USE_XOPEN2KXSI
 1

	)

343 #undeà
__USE_ISOC95


344 
	#__USE_ISOC95
 1

	)

345 #undeà
__USE_ISOC99


346 
	#__USE_ISOC99
 1

	)

349 #ifdeà
_XOPEN_SOURCE_EXTENDED


350 
	#__USE_XOPEN_EXTENDED
 1

	)

355 #ifdeà
_LARGEFILE_SOURCE


356 
	#__USE_LARGEFILE
 1

	)

359 #ifdeà
_LARGEFILE64_SOURCE


360 
	#__USE_LARGEFILE64
 1

	)

363 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

364 
	#__USE_FILE_OFFSET64
 1

	)

367 #ià
defšed
 
_DEFAULT_SOURCE


368 
	#__USE_MISC
 1

	)

371 #ifdef 
_ATFILE_SOURCE


372 
	#__USE_ATFILE
 1

	)

375 #ifdef 
_GNU_SOURCE


376 
	#__USE_GNU
 1

	)

379 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

380 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

381 #ià
_FORTIFY_SOURCE
 > 1

382 
	#__USE_FORTIFY_LEVEL
 2

	)

384 
	#__USE_FORTIFY_LEVEL
 1

	)

387 
	#__USE_FORTIFY_LEVEL
 0

	)

394 #ià
defšed
 
__ılu¥lus
 ? __ılu¥lu >ğ201402L : defšed 
__USE_ISOC11


395 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

397 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

402 
	~<¡dc-´edef.h
>

410 #undeà
__GNU_LIBRARY__


411 
	#__GNU_LIBRARY__
 6

	)

415 
	#__GLIBC__
 2

	)

416 
	#__GLIBC_MINOR__
 27

	)

418 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

419 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

422 #iâdeà
__ASSEMBLER__


423 #iâdeà
_SYS_CDEFS_H


424 
	~<sys/cdefs.h
>

429 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


430 
	#__USE_LARGEFILE
 1

	)

431 
	#__USE_LARGEFILE64
 1

	)

437 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

438 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

439 && 
defšed
 
	g__ex‹º_šlše


440 
	#__USE_EXTERN_INLINES
 1

	)

448 
	~<gnu/¡ubs.h
>

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

61 
	#__STDC_NO_THREADS__
 1

	)

	@
1
.
1
/usr/include
310
6128
cleanup.c
create.c
debug.h
global.c
implement.h
nautilus_osal.c
nautilus_osal.h
need_errno.h
nk/nk_compatibility.h
nk/nk_osal.c
nk/pte_generic_osal.h
nk/pte_osal.h
nk/pte_types.h
nk_get_pte_thread_t.c
platform/dspbios/dspbios-config.h
platform/dspbios/dspbios-osal.c
platform/dspbios/dspbios-osal.h
platform/dspbios/main.c
platform/dspbios/pte_osal.h
platform/dspbios/pte_types.h
platform/helper/tls-helper.c
platform/helper/tls-helper.h
platform/nautilus/main.c
platform/nautilus/nautilus_osal.c
platform/nautilus/nautilus_osal.h
platform/nautilus/psp_osal.c
platform/nautilus/psp_osal.h
platform/nautilus/pte_osal.h
platform/nautilus/pte_types.h
platform/psp/main.c
platform/psp/psp_osal.c
platform/psp/psp_osal.h
platform/psp/pte_osal.h
platform/psp/pte_types.h
pte_callUserDestroyRoutines.c
pte_cancellable_wait.c
pte_cond_check_need_init.c
pte_detach.c
pte_generic_osal.h
pte_getprocessors.c
pte_is_attr.c
pte_mutex_check_need_init.c
pte_new.c
pte_osal.h
pte_relmillisecs.c
pte_reuse.c
pte_rwlock_cancelwrwait.c
pte_rwlock_check_need_init.c
pte_spinlock_check_need_init.c
pte_threadDestroy.c
pte_threadStart.c
pte_throw.c
pte_tkAssocCreate.c
pte_tkAssocDestroy.c
pte_types.h
pthread.h
pthread_attr_destroy.c
pthread_attr_getdetachstate.c
pthread_attr_getinheritsched.c
pthread_attr_getschedparam.c
pthread_attr_getschedpolicy.c
pthread_attr_getscope.c
pthread_attr_getstack.c
pthread_attr_getstackaddr.c
pthread_attr_getstacksize.c
pthread_attr_init.c
pthread_attr_setdetachstate.c
pthread_attr_setinheritsched.c
pthread_attr_setschedparam.c
pthread_attr_setschedpolicy.c
pthread_attr_setscope.c
pthread_attr_setstackaddr.c
pthread_attr_setstacksize.c
pthread_barrier_common.h
pthread_barrier_destroy.c
pthread_barrier_init.c
pthread_barrier_wait.c
pthread_barrierattr_destroy.c
pthread_barrierattr_getpshared.c
pthread_barrierattr_init.c
pthread_barrierattr_setpshared.c
pthread_cancel.c
pthread_cond_common.h
pthread_cond_destroy.c
pthread_cond_init.c
pthread_cond_signal.c
pthread_cond_wait.c
pthread_condattr_destroy.c
pthread_condattr_getpshared.c
pthread_condattr_init.c
pthread_condattr_setpshared.c
pthread_delay_np.c
pthread_detach.c
pthread_equal.c
pthread_exit.c
pthread_getattr_np.c
pthread_getconcurrency.c
pthread_getschedparam.c
pthread_getspecific.c
pthread_init.c
pthread_join.c
pthread_key_create.c
pthread_key_delete.c
pthread_kill.c
pthread_mutex_destroy.c
pthread_mutex_init.c
pthread_mutex_lock.c
pthread_mutex_timedlock.c
pthread_mutex_trylock.c
pthread_mutex_unlock.c
pthread_mutexattr_destroy.c
pthread_mutexattr_getkind_np.c
pthread_mutexattr_getpshared.c
pthread_mutexattr_gettype.c
pthread_mutexattr_init.c
pthread_mutexattr_setkind_np.c
pthread_mutexattr_setpshared.c
pthread_mutexattr_settype.c
pthread_num_processors_np.c
pthread_once.c
pthread_rwlock_destroy.c
pthread_rwlock_init.c
pthread_rwlock_rdlock.c
pthread_rwlock_timedrdlock.c
pthread_rwlock_timedwrlock.c
pthread_rwlock_tryrdlock.c
pthread_rwlock_trywrlock.c
pthread_rwlock_unlock.c
pthread_rwlock_wrlock.c
pthread_rwlockattr_destroy.c
pthread_rwlockattr_getpshared.c
pthread_rwlockattr_init.c
pthread_rwlockattr_setpshared.c
pthread_self.c
pthread_setcancelstate.c
pthread_setcanceltype.c
pthread_setconcurrency.c
pthread_setschedparam.c
pthread_setspecific.c
pthread_spin_destroy.c
pthread_spin_init.c
pthread_spin_lock.c
pthread_spin_trylock.c
pthread_spin_unlock.c
pthread_terminate.c
pthread_testcancel.c
pthread_timechange_handler_np.c
sched.h
sched_get_priority_max.c
sched_get_priority_min.c
sched_setscheduler.c
sched_yield.c
sem_close.c
sem_common.h
sem_destroy.c
sem_getvalue.c
sem_init.c
sem_open.c
sem_post.c
sem_post_multiple.c
sem_timedwait.c
sem_trywait.c
sem_unlink.c
sem_wait.c
semaphore.h
simple_sem/ssem.c
simple_sem/ssem.h
simple_sem/ssem_init.c
tests/barrier1.c
tests/barrier2.c
tests/barrier3.c
tests/barrier4.c
tests/barrier5.c
tests/benchlib.c
tests/benchtest.h
tests/benchtest1.c
tests/benchtest2.c
tests/benchtest3.c
tests/benchtest4.c
tests/benchtest5.c
tests/cancel1.c
tests/cancel2.c
tests/cancel3.c
tests/cancel4.c
tests/cancel5.c
tests/cancel6a.c
tests/cancel6d.c
tests/cleanup0.c
tests/cleanup1.c
tests/cleanup2.c
tests/cleanup3.c
tests/condvar1.c
tests/condvar1_1.c
tests/condvar1_2.c
tests/condvar2.c
tests/condvar2_1.c
tests/condvar3.c
tests/condvar3_1.c
tests/condvar3_2.c
tests/condvar3_3.c
tests/condvar4.c
tests/condvar5.c
tests/condvar6.c
tests/condvar7.c
tests/condvar8.c
tests/condvar9.c
tests/count1.c
tests/create1.c
tests/create2.c
tests/create3.c
tests/delay1.c
tests/delay2.c
tests/detach1.c
tests/equal1.c
tests/errno1.c
tests/exception1.c
tests/exception2.c
tests/exception3.c
tests/exit1.c
tests/exit2.c
tests/exit3.c
tests/exit4.c
tests/exit5.c
tests/inherit1.c
tests/join0.c
tests/join1.c
tests/join2.c
tests/join3.c
tests/join4.c
tests/kill1.c
tests/mutex1.c
tests/mutex1e.c
tests/mutex1n.c
tests/mutex1r.c
tests/mutex2.c
tests/mutex2e.c
tests/mutex2r.c
tests/mutex3.c
tests/mutex3e.c
tests/mutex3r.c
tests/mutex4.c
tests/mutex5.c
tests/mutex6.c
tests/mutex6e.c
tests/mutex6es.c
tests/mutex6n.c
tests/mutex6r.c
tests/mutex6rs.c
tests/mutex6s.c
tests/mutex7.c
tests/mutex7e.c
tests/mutex7n.c
tests/mutex7r.c
tests/mutex8.c
tests/mutex8e.c
tests/mutex8n.c
tests/mutex8r.c
tests/once1.c
tests/once2.c
tests/once3.c
tests/once4.c
tests/priority1.c
tests/priority2.c
tests/reuse1.c
tests/reuse2.c
tests/rwlock1.c
tests/rwlock2.c
tests/rwlock2_t.c
tests/rwlock3.c
tests/rwlock3_t.c
tests/rwlock4.c
tests/rwlock4_t.c
tests/rwlock5.c
tests/rwlock5_t.c
tests/rwlock6.c
tests/rwlock6_t.c
tests/rwlock6_t2.c
tests/rwlock7.c
tests/rwlock8.c
tests/self1.c
tests/self2.c
tests/semaphore1.c
tests/semaphore2.c
tests/semaphore3.c
tests/semaphore4.c
tests/semaphore4t.c
tests/semaphore5.c
tests/semaphore6.c
tests/spin1.c
tests/spin2.c
tests/spin3.c
tests/spin4.c
tests/stress1.c
tests/test.h
tests/test_main.c
tests/tsd1.c
tests/tsd2.c
tests/valid1.c
tests/valid2.c
tls-helper.c
tls-helper.h
/usr/include/errno.h
/usr/include/limits.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/time.h
/usr/include/alloca.h
/usr/include/features.h
/usr/include/stdc-predef.h
