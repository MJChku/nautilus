cscope 15 $HOME/Projects/2020summer/nautiluses/nautilus-wwy/nautilus/src/test/openmp/NPB-NAS/MG               0000025905
	@globals.h

11 
	~"≈b∑øms.h
"

15 
	#NM
 (2+(2<<(
LM
-1)))

	)

17 
	#NV
 (2+(2<<(
NDIM1
-1))*(2+(2<<(
NDIM2
-1)))*(2+(2<<(
NDIM3
-1))))

	)

19 
	#NR
 ((8*(
NV
+(
NM
*NM)+5*NM+7*
LM
))/7)

	)

21 
	#NM2
 (2*
NM
*NM)

	)

23 
	#MAXLEVEL
 11

	)

27 
	gnx
[
MAXLEVEL
+1], 
	gny
[MAXLEVEL+1], 
	gnz
[MAXLEVEL+1];

29 
	gCœss
;

31 
	gdebug_vec
[8];

34 
	gm1
[
MAXLEVEL
+1], 
	gm2
[MAXLEVEL+1], 
	gm3
[MAXLEVEL+1];

35 
	g…
, 
	glb
;

40 
	#M
 1037

	)

	@mg.c

36 
	~"../comm⁄/≈b-C.h
"

37 
	~"globÆs.h
"

38 
	~"../m©h/«s_m©h.h
"

40 
	~<«utûus/«utûus.h
>

41 
	~<«utûus/shñl.h
>

43 
	#T_BENCH
 1

	)

44 
	#T_INIT
 2

	)

48 
	gis1
, 
	gis2
, 
	gis3
, 
	gõ1
, 
	gõ2
, 
	gõ3
;

51 
£tup
(*
n1
, *
n2
, *
n3
, 
…
);

52 
mg3P
(****
u
, ***
v
, ****
r
, 
a
[4],

53 
c
[4], 
n1
, 
n2
, 
n3
, 
k
);

54 
psöv
–***
r
, ***
u
, 
n1
, 
n2
, 
n3
,

55 
c
[4], 
k
);

56 
ªsid
–***
u
, ***
v
, ***
r
,

57 
n1
, 
n2
, 
n3
, 
a
[4], 
k
 );

58 
Ωrj3
–***
r
, 
m1k
, 
m2k
, 
m3k
,

59 ***
s
, 
m1j
, 
m2j
, 
m3j
, 
k
 );

60 
öãΩ
–***
z
, 
mm1
, 
mm2
, 
mm3
,

61 ***
u
, 
n1
, 
n2
, 
n3
, 
k
 );

62 
n‹m2u3
(***
r
, 
n1
, 
n2
, 
n3
,

63 *
∫m2
, *
∫mu
, 
nx
, 
ny
, 
nz
);

64 
ªp_ƒm
(***
u
, 
n1
, 
n2
, 
n3
,

65 *
tôÀ
, 
kk
);

66 
comm3
(***
u
, 
n1
, 
n2
, 
n3
, 
kk
);

67 
zøn3
(***
z
, 
n1
, 
n2
, 
n3
, 
nx
, 
ny
, 
k
);

68 
showÆl
(***
z
, 
n1
, 
n2
, 
n3
);

69 
powî
–
a
, 
n
 );

70 
bubbÀ
–
ãn
[
M
][2], 
j1
[M][2], 
j2
[M][2],

71 
j3
[
M
][2], 
m
, 
öd
 );

72 
zîo3
(***
z
, 
n1
, 
n2
, 
n3
);

73 
n⁄zîo
(***
z
, 
n1
, 
n2
, 
n3
);

78 
¥ogøm_MG
(*
_buf
, * 
_¥iv
);

79 
¥ogøm_MG_¥ofûe
(*
_
, *
__
);

81 
shñl_cmd_im∂
 
	g«s_mg_im∂
 = {

82 .
cmd
 = "nas-mg",

83 .
	ghñp_°r
 = "NASÖarallel benchmark MG",

84 .
	gh™dÀr
 = 
¥ogøm_MG_¥ofûe
,

86 
nk_ªgi°î_shñl_cmd
(
«s_mg_im∂
);

88 
	$¥ogøm_MG_¥ofûe
(*
_
, *
__
){

90 #ifde‡
NAUT_CONFIG_PROFILE


91 
	`nk_ö°rumít_˛ór
();

92 
	`nk_ö°rumít_°¨t
();

94 
	`¥ogøm_MG
(
_
,
__
);

95 #ifde‡
NAUT_CONFIG_PROFILE


96 
	`nk_ö°rumít_íd
();

97 
	`nk_ö°rumít_quîy
();

100 
	}
}

103 
	$¥ogøm_MG
(* 
_buf
, *
_¥iv
) {

110 
k
, 
ô
;

111 
t
, 
töô
, 
mÊ›s
;

112 
¡hªads
 = 1;

120 ****
u
, ***
v
, ****
r
;

121 
a
[4], 
c
[4];

123 
∫m2
, 
∫mu
;

124 
ïsû⁄
 = 1.0e-8;

125 
n1
, 
n2
, 
n3
, 
nô
;

126 
vîify_vÆue
;

127 
boﬁón
 
vîifõd
;

129 
i
, 
j
, 
l
;

132 
	`timî_˛ór
(
T_BENCH
);

133 
	`timî_˛ór
(
T_INIT
);

135 
	`timî_°¨t
(
T_INIT
);

141 
	`¥ötf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

160 
…
 = 
LT_DEFAULT
;

161 
nô
 = 
NIT_DEFAULT
;

162 
nx
[
…
] = 
NX_DEFAULT
;

163 
ny
[
…
] = 
NY_DEFAULT
;

164 
nz
[
…
] = 
NZ_DEFAULT
;

166 
i
 = 0; i <= 7; i++) {

167 
debug_vec
[
i
] = 
DEBUG_DEFAULT
;

171 i‡–(
nx
[
…
] !
ny
[…]Ë|| (nx[…] !
nz
[lt]) ) {

172 
Cœss
 = 'U';

173 } if–
nx
[
…
] =32 && 
nô
 == 4 ) {

174 
Cœss
 = 'S';

175 } if–
nx
[
…
] =64 && 
nô
 == 40 ) {

176 
Cœss
 = 'W';

177 } if–
nx
[
…
] =256 && 
nô
 == 20 ) {

178 
Cœss
 = 'B';

179 } if–
nx
[
…
] =512 && 
nô
 == 20 ) {

180 
Cœss
 = 'C';

181 } if–
nx
[
…
] =256 && 
nô
 == 4 ) {

182 
Cœss
 = 'A';

184 
Cœss
 = 'U';

201 
a
[0] = -8.0/3.0;

202 
a
[1] = 0.0;

203 
a
[2] = 1.0/6.0;

204 
a
[3] = 1.0/12.0;

206 i‡(
Cœss
 == 'A' || Class == 'S' || Class =='W') {

210 
c
[0] = -3.0/8.0;

211 
c
[1] = 1.0/32.0;

212 
c
[2] = -1.0/64.0;

213 
c
[3] = 0.0;

218 
c
[0] = -3.0/17.0;

219 
c
[1] = 1.0/33.0;

220 
c
[2] = -1.0/61.0;

221 
c
[3] = 0.0;

224 
lb
 = 1;

226 
	`£tup
(&
n1
,&
n2
,&
n3
,
…
);

228 
u
 = (****)
	`mÆloc
((
…
+1)*(***));

229 
l
 = 
…
;Ü >=1;Ü--) {

230 
u
[
l
] = (***)
	`mÆloc
(
m3
[l]*(**));

231 
k
 = 0; k < 
m3
[
l
]; k++) {

232 
u
[
l
][
k
] = (**)
	`mÆloc
(
m2
[l]*(*));

233 
j
 = 0; j < 
m2
[
l
]; j++) {

234 
u
[
l
][
k
][
j
] = (*)
	`mÆloc
(
m1
[l]*());

238 
v
 = (***)
	`mÆloc
(
m3
[
…
]*(**));

239 
k
 = 0; k < 
m3
[
…
]; k++) {

240 
v
[
k
] = (**)
	`mÆloc
(
m2
[
…
]*(*));

241 
j
 = 0; j < 
m2
[
…
]; j++) {

242 
v
[
k
][
j
] = (*)
	`mÆloc
(
m1
[
…
]*());

245 
r
 = (****)
	`mÆloc
((
…
+1)*(***));

246 
l
 = 
…
;Ü >=1;Ü--) {

247 
r
[
l
] = (***)
	`mÆloc
(
m3
[l]*(**));

248 
k
 = 0; k < 
m3
[
l
]; k++) {

249 
r
[
l
][
k
] = (**)
	`mÆloc
(
m2
[l]*(*));

250 
j
 = 0; j < 
m2
[
l
]; j++) {

251 
r
[
l
][
k
][
j
] = (*)
	`mÆloc
(
m1
[l]*());

256 
	`zîo3
(
u
[
…
],
n1
,
n2
,
n3
);

257 
	`zøn3
(
v
,
n1
,
n2
,
n3
,
nx
[
…
],
ny
[lt],lt);

259 
	`n‹m2u3
(
v
,
n1
,
n2
,
n3
,&
∫m2
,&
∫mu
,
nx
[
…
],
ny
[…],
nz
[lt]);

265 
	`¥ötf
(" Size: %3dx%3dx%3d (class %1c)\n",

266 
nx
[
…
], 
ny
[…], 
nz
[…], 
Cœss
);

267 
	`¥ötf
(" Iãøti⁄s: %3d\n", 
nô
);

269 
	`ªsid
(
u
[
…
],
v
,
r
[…],
n1
,
n2
,
n3
,
a
,lt);

270 
	`n‹m2u3
(
r
[
…
],
n1
,
n2
,
n3
,&
∫m2
,&
∫mu
,
nx
[…],
ny
[…],
nz
[lt]);

275 
	`mg3P
(
u
,
v
,
r
,
a
,
c
,
n1
,
n2
,
n3
,
…
);

276 
	`ªsid
(
u
[
…
],
v
,
r
[…],
n1
,
n2
,
n3
,
a
,lt);

278 
	`£tup
(&
n1
,&
n2
,&
n3
,
…
);

280 
	`zîo3
(
u
[
…
],
n1
,
n2
,
n3
);

282 
	`zøn3
(
v
,
n1
,
n2
,
n3
,
nx
[
…
],
ny
[lt],lt);

285 
	`timî_°›
(
T_INIT
);

286 
	`timî_°¨t
(
T_BENCH
);

288 
	`ªsid
(
u
[
…
],
v
,
r
[…],
n1
,
n2
,
n3
,
a
,lt);

289 
	`n‹m2u3
(
r
[
…
],
n1
,
n2
,
n3
,&
∫m2
,&
∫mu
,
nx
[…],
ny
[…],
nz
[lt]);

291  
ô
 = 1; ià<
nô
; it++) {

292 
	`mg3P
(
u
,
v
,
r
,
a
,
c
,
n1
,
n2
,
n3
,
…
);

293 
	`ªsid
(
u
[
…
],
v
,
r
[…],
n1
,
n2
,
n3
,
a
,lt);

295 
	`n‹m2u3
(
r
[
…
],
n1
,
n2
,
n3
,&
∫m2
,&
∫mu
,
nx
[…],
ny
[…],
nz
[lt]);

297 #¥agm®
omp
 
∑øŒñ


299 #i‡
	`deföed
(
_OPENMP
)

300 #¥agm®
omp
 
ma°î


301 
¡hªads
 = 
	`omp_gë_num_thªads
();

305 
	`timî_°›
(
T_BENCH
);

306 
t
 = 
	`timî_ªad
(
T_BENCH
);

307 
töô
 = 
	`timî_ªad
(
T_INIT
);

309 
vîifõd
 = 
FALSE
;

310 
vîify_vÆue
 = 0.0;

312 
	`¥ötf
(" Inôüliz©i⁄Åime: %15.3‡£c⁄ds\n", 
töô
);

313 
	`¥ötf
(" Benchmark completed\n");

315 i‡(
Cœss
 != 'U') {

316 i‡(
Cœss
 == 'S') {

317 
vîify_vÆue
 = 0.530770700573e-04;

318 } i‡(
Cœss
 == 'W') {

319 
vîify_vÆue
 = 0.250391406439e-17;

321 } i‡(
Cœss
 == 'A') {

322 
vîify_vÆue
 = 0.2433365309e-5;

323 } i‡(
Cœss
 == 'B') {

324 
vîify_vÆue
 = 0.180056440132e-5;

325 } i‡(
Cœss
 == 'C') {

326 
vîify_vÆue
 = 0.570674826298e-06;

329 i‡–
	`Ábs
–
∫m2
 - 
vîify_vÆue
 ) <
ïsû⁄
 ) {

330 
vîifõd
 = 
TRUE
;

331 
	`¥ötf
(" VERIFICATION SUCCESSFUL\n");

332 
	`¥ötf
(" L2 N‹m i†%20.12e\n", 
∫m2
);

333 
	`¥ötf
(" Eº‹ i† %20.12e\n", 
∫m2
 - 
vîify_vÆue
);

335 
vîifõd
 = 
FALSE
;

336 
	`¥ötf
(" VERIFICATION FAILED\n");

337 
	`¥ötf
(" L2 N‹m i† %20.12e\n", 
∫m2
);

338 
	`¥ötf
(" Thêc‹ª˘ L2 N‹m i†%20.12e\n", 
vîify_vÆue
);

341 
vîifõd
 = 
FALSE
;

342 
	`¥ötf
(" Problem size unknown\n");

343 
	`¥ötf
(" NO VERIFICATION PERFORMED\n");

346 i‡–
t
 != 0.0 ) {

347 
¬
 = 
nx
[
…
]*
ny
[…]*
nz
[lt];

348 
mÊ›s
 = 58.*
nô
*
¬
*1.0e-6 / 
t
;

350 
mÊ›s
 = 0.0;

353 
	`c_¥öt_ªsu…s
("MG", 
Cœss
, 
nx
[
…
], 
ny
[…], 
nz
[lt],

354 
nô
, 
¡hªads
, 
t
, 
mÊ›s
, " floatingÖoint",

355 
vîifõd
, 
NPBVERSION
, 
COMPILETIME
,

356 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

357 
	}
}

362 
	$£tup
(*
n1
, *
n2
, *
n3
, 
…
) {

367 
k
;

369  
k
 = 
…
-1; k >= 1; k--) {

370 
nx
[
k
] =Çx[k+1]/2;

371 
ny
[
k
] =Çy[k+1]/2;

372 
nz
[
k
] =Çz[k+1]/2;

375 
k
 = 1; k <
…
; k++) {

376 
m1
[
k
] = 
nx
[k]+2;

377 
m2
[
k
] = 
nz
[k]+2;

378 
m3
[
k
] = 
ny
[k]+2;

381 
is1
 = 1;

382 
õ1
 = 
nx
[
…
];

383 *
n1
 = 
nx
[
…
]+2;

384 
is2
 = 1;

385 
õ2
 = 
ny
[
…
];

386 *
n2
 = 
ny
[
…
]+2;

387 
is3
 = 1;

388 
õ3
 = 
nz
[
…
];

389 *
n3
 = 
nz
[
…
]+2;

391 i‡(
debug_vec
[1] >= 1 ) {

392 
	`¥ötf
(" in setup, \n");

393 
	`¥ötf
("ÜtÇxÇyÇzÇ1Ç2Ç3 is1 is2 is3 ie1 ie2 ie3\n");

394 
	`¥ötf
("%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d\n",

395 
…
,
nx
[…],
ny
[…],
nz
[…],*
n1
,*
n2
,*
n3
,
is1
,
is2
,
is3
,
õ1
,
õ2
,
õ3
);

397 
	}
}

402 
	$mg3P
(****
u
, ***
v
, ****
r
, 
a
[4],

403 
c
[4], 
n1
, 
n2
, 
n3
, 
k
) {

412 
j
;

419 
k
 = 
…
; k >
lb
+1; k--) {

420 
j
 = 
k
-1;

421 
	`Ωrj3
(
r
[
k
], 
m1
[k], 
m2
[k], 
m3
[k],

422 
r
[
j
], 
m1
[j], 
m2
[j], 
m3
[j], 
k
);

425 
k
 = 
lb
;

429 
	`zîo3
(
u
[
k
], 
m1
[k], 
m2
[k], 
m3
[k]);

430 
	`psöv
(
r
[
k
], 
u
[k], 
m1
[k], 
m2
[k], 
m3
[k], 
c
, k);

432 
k
 = 
lb
+1; k <
…
-1; k++) {

433 
j
 = 
k
-1;

437 
	`zîo3
(
u
[
k
], 
m1
[k], 
m2
[k], 
m3
[k]);

438 
	`öãΩ
(
u
[
j
], 
m1
[j], 
m2
[j], 
m3
[j],

439 
u
[
k
], 
m1
[k], 
m2
[k], 
m3
[k], k);

443 
	`ªsid
(
u
[
k
], 
r
[k],Ñ[k], 
m1
[k], 
m2
[k], 
m3
[k], 
a
, k);

447 
	`psöv
(
r
[
k
], 
u
[k], 
m1
[k], 
m2
[k], 
m3
[k], 
c
, k);

450 
j
 = 
…
 - 1;

451 
k
 = 
…
;

452 
	`öãΩ
(
u
[
j
], 
m1
[j], 
m2
[j], 
m3
[j], u[
…
], 
n1
, 
n2
, 
n3
, 
k
);

453 
	`ªsid
(
u
[
…
], 
v
, 
r
[…], 
n1
, 
n2
, 
n3
, 
a
, 
k
);

454 
	`psöv
(
r
[
…
], 
u
[…], 
n1
, 
n2
, 
n3
, 
c
, 
k
);

455 
	}
}

460 
	$psöv
–***
r
, ***
u
, 
n1
, 
n2
, 
n3
,

461 
c
[4], 
k
) {

478 
i3
, 
i2
, 
i1
;

479 
r1
[
M
], 
r2
[M];

480 #¥agm®
omp
 
∑øŒñ
 (
sh¨ed
Ë
	`¥iv©e
(
i1
,
i2
,
i3
,
r1
,
r2
)

481 
i3
 = 1; i3 < 
n3
-1; i3++) {

482 
i2
 = 1; i2 < 
n2
-1; i2++) {

483 
i1
 = 0; i1 < 
n1
; i1++) {

484 
r1
[
i1
] = 
r
[
i3
][
i2
-1][i1] +Ñ[i3][i2+1][i1]

485 + 
r
[
i3
-1][
i2
][
i1
] +Ñ[i3+1][i2][i1];

486 
r2
[
i1
] = 
r
[
i3
-1][
i2
-1][i1] +Ñ[i3-1][i2+1][i1]

487 + 
r
[
i3
+1][
i2
-1][
i1
] +Ñ[i3+1][i2+1][i1];

489 
i1
 = 1; i1 < 
n1
-1; i1++) {

490 
u
[
i3
][
i2
][
i1
] = u[i3][i2][i1]

491 + 
c
[0] * 
r
[
i3
][
i2
][
i1
]

492 + 
c
[1] * ( 
r
[
i3
][
i2
][
i1
-1] +Ñ[i3][i2][i1+1]

493 + 
r1
[
i1
] )

494 + 
c
[2] * ( 
r2
[
i1
] + 
r1
[i1-1] +Ñ1[i1+1] );

507 
	`comm3
(
u
,
n1
,
n2
,
n3
,
k
);

509 i‡(
debug_vec
[0] >= 1 ) {

510 
	`ªp_ƒm
(
u
,
n1
,
n2
,
n3
,"Ösöv",
k
);

513 i‡–
debug_vec
[3] >
k
 ) {

514 
	`showÆl
(
u
,
n1
,
n2
,
n3
);

516 
	}
}

521 
	$ªsid
–***
u
, ***
v
, ***
r
,

522 
n1
, 
n2
, 
n3
, 
a
[4], 
k
 ) {

540 
i3
, 
i2
, 
i1
;

541 
u1
[
M
], 
u2
[M];

542 #¥agm®
omp
 
∑øŒñ
 (
sh¨ed
Ë
	`¥iv©e
(
i1
,
i2
,
i3
,
u1
,
u2
)

543 
i3
 = 1; i3 < 
n3
-1; i3++) {

544 
i2
 = 1; i2 < 
n2
-1; i2++) {

545 
i1
 = 0; i1 < 
n1
; i1++) {

546 
u1
[
i1
] = 
u
[
i3
][
i2
-1][i1] + u[i3][i2+1][i1]

547 + 
u
[
i3
-1][
i2
][
i1
] + u[i3+1][i2][i1];

548 
u2
[
i1
] = 
u
[
i3
-1][
i2
-1][i1] + u[i3-1][i2+1][i1]

549 + 
u
[
i3
+1][
i2
-1][
i1
] + u[i3+1][i2+1][i1];

551 
i1
 = 1; i1 < 
n1
-1; i1++) {

552 
r
[
i3
][
i2
][
i1
] = 
v
[i3][i2][i1]

553 - 
a
[0] * 
u
[
i3
][
i2
][
i1
]

560 - 
a
[2] * ( 
u2
[
i1
] + 
u1
[i1-1] + u1[i1+1] )

561 - 
a
[3] * ( 
u2
[
i1
-1] + u2[i1+1] );

569 
	`comm3
(
r
,
n1
,
n2
,
n3
,
k
);

571 i‡(
debug_vec
[0] >= 1 ) {

572 
	`ªp_ƒm
(
r
,
n1
,
n2
,
n3
,"Ñesid",
k
);

575 i‡–
debug_vec
[2] >
k
 ) {

576 
	`showÆl
(
r
,
n1
,
n2
,
n3
);

578 
	}
}

583 
	$Ωrj3
–***
r
, 
m1k
, 
m2k
, 
m3k
,

584 ***
s
, 
m1j
, 
m2j
, 
m3j
, 
k
 ) {

599 
j3
, 
j2
, 
j1
, 
i3
, 
i2
, 
i1
, 
d1
, 
d2
, 
d3
;

601 
x1
[
M
], 
y1
[M], 
x2
, 
y2
;

604 i‡(
m1k
 == 3) {

605 
d1
 = 2;

607 
d1
 = 1;

610 i‡(
m2k
 == 3) {

611 
d2
 = 2;

613 
d2
 = 1;

616 i‡(
m3k
 == 3) {

617 
d3
 = 2;

619 
d3
 = 1;

621 #¥agm®
omp
 
∑øŒñ
 (
sh¨ed
Ë
	`¥iv©e
(
j1
,
j2
,
j3
,
i1
,
i2
,
i3
,
x1
,
y1
,
x2
,
y2
)

622 
j3
 = 1; j3 < 
m3j
-1; j3++) {

623 
i3
 = 2*
j3
-
d3
;

625 
j2
 = 1; j2 < 
m2j
-1; j2++) {

626 
i2
 = 2*
j2
-
d2
;

629 
j1
 = 1; j1 < 
m1j
; j1++) {

630 
i1
 = 2*
j1
-
d1
;

632 
x1
[
i1
] = 
r
[
i3
+1][
i2
][i1] +Ñ[i3+1][i2+2][i1]

633 + 
r
[
i3
][
i2
+1][
i1
] +Ñ[i3+2][i2+1][i1];

634 
y1
[
i1
] = 
r
[
i3
][
i2
][i1] +Ñ[i3+2][i2][i1]

635 + 
r
[
i3
][
i2
+2][
i1
] +Ñ[i3+2][i2+2][i1];

638 
j1
 = 1; j1 < 
m1j
-1; j1++) {

639 
i1
 = 2*
j1
-
d1
;

641 
y2
 = 
r
[
i3
][
i2
][
i1
+1] +Ñ[i3+2][i2][i1+1]

642 + 
r
[
i3
][
i2
+2][
i1
+1] +Ñ[i3+2][i2+2][i1+1];

643 
x2
 = 
r
[
i3
+1][
i2
][
i1
+1] +Ñ[i3+1][i2+2][i1+1]

644 + 
r
[
i3
][
i2
+1][
i1
+1] +Ñ[i3+2][i2+1][i1+1];

645 
s
[
j3
][
j2
][
j1
] =

646 0.5 * 
r
[
i3
+1][
i2
+1][
i1
+1]

647 + 0.25 * ( 
r
[
i3
+1][
i2
+1][
i1
] +Ñ[i3+1][i2+1][i1+2] + 
x2
)

648 + 0.125 * ( 
x1
[
i1
] + x1[i1+2] + 
y2
)

649 + 0.0625 * ( 
y1
[
i1
] + y1[i1+2] );

653 
	`comm3
(
s
,
m1j
,
m2j
,
m3j
,
k
-1);

655 i‡(
debug_vec
[0] >= 1 ) {

656 
	`ªp_ƒm
(
s
,
m1j
,
m2j
,
m3j
,"Ñ¥j3",
k
-1);

659 i‡(
debug_vec
[4] >
k
 ) {

660 
	`showÆl
(
s
,
m1j
,
m2j
,
m3j
);

662 
	}
}

667 
	$öãΩ
–***
z
, 
mm1
, 
mm2
, 
mm3
,

668 ***
u
, 
n1
, 
n2
, 
n3
, 
k
 ) {

684 
i3
, 
i2
, 
i1
, 
d1
, 
d2
, 
d3
, 
t1
, 
t2
, 
t3
;

692 
z1
[
M
], 
z2
[M], 
z3
[M];

694 i‡–
n1
 !3 && 
n2
 !3 && 
n3
 != 3 ) {

695 #¥agm®
omp
 
∑øŒñ
 (
sh¨ed
Ë
	`¥iv©e
(
i1
,
i2
,
i3
,
z1
,
z2
,
z3
)

696 
i3
 = 0; i3 < 
mm3
-1; i3++) {

697 
i2
 = 0; i2 < 
mm2
-1; i2++) {

698 
i1
 = 0; i1 < 
mm1
; i1++) {

699 
z1
[
i1
] = 
z
[
i3
][
i2
+1][i1] + z[i3][i2][i1];

700 
z2
[
i1
] = 
z
[
i3
+1][
i2
][i1] + z[i3][i2][i1];

701 
z3
[
i1
] = 
z
[
i3
+1][
i2
+1][i1] + z[i3+1][i2][i1] + 
z1
[i1];

703 
i1
 = 0; i1 < 
mm1
-1; i1++) {

704 
u
[2*
i3
][2*
i2
][2*
i1
] = u[2*i3][2*i2][2*i1]

705 +
z
[
i3
][
i2
][
i1
];

706 
u
[2*
i3
][2*
i2
][2*
i1
+1] = u[2*i3][2*i2][2*i1+1]

707 +0.5*(
z
[
i3
][
i2
][
i1
+1]+z[i3][i2][i1]);

709 
i1
 = 0; i1 < 
mm1
-1; i1++) {

710 
u
[2*
i3
][2*
i2
+1][2*
i1
] = u[2*i3][2*i2+1][2*i1]

711 +0.5 * 
z1
[
i1
];

712 
u
[2*
i3
][2*
i2
+1][2*
i1
+1] = u[2*i3][2*i2+1][2*i1+1]

713 +0.25*–
z1
[
i1
] + z1[i1+1] );

715 
i1
 = 0; i1 < 
mm1
-1; i1++) {

716 
u
[2*
i3
+1][2*
i2
][2*
i1
] = u[2*i3+1][2*i2][2*i1]

717 +0.5 * 
z2
[
i1
];

718 
u
[2*
i3
+1][2*
i2
][2*
i1
+1] = u[2*i3+1][2*i2][2*i1+1]

719 +0.25*–
z2
[
i1
] + z2[i1+1] );

721 
i1
 = 0; i1 < 
mm1
-1; i1++) {

722 
u
[2*
i3
+1][2*
i2
+1][2*
i1
] = u[2*i3+1][2*i2+1][2*i1]

723 +0.25* 
z3
[
i1
];

724 
u
[2*
i3
+1][2*
i2
+1][2*
i1
+1] = u[2*i3+1][2*i2+1][2*i1+1]

725 +0.125*–
z3
[
i1
] + z3[i1+1] );

730 i‡(
n1
 == 3) {

731 
d1
 = 2;

732 
t1
 = 1;

734 
d1
 = 1;

735 
t1
 = 0;

738 i‡(
n2
 == 3) {

739 
d2
 = 2;

740 
t2
 = 1;

742 
d2
 = 1;

743 
t2
 = 0;

746 i‡(
n3
 == 3) {

747 
d3
 = 2;

748 
t3
 = 1;

750 
d3
 = 1;

751 
t3
 = 0;

754 #¥agm®
omp
 
∑øŒñ
 (
sh¨ed
Ë
	`¥iv©e
(
i1
,
i2
,
i3
)

756 #¥agm®
omp
 

757  
i3
 = 
d3
; i3 <
mm3
-1; i3++) {

758  
i2
 = 
d2
; i2 <
mm2
-1; i2++) {

759  
i1
 = 
d1
; i1 <
mm1
-1; i1++) {

760 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1] =

761 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1]

762 +
z
[
i3
-1][
i2
-1][
i1
-1];

764  
i1
 = 1; i1 <
mm1
-1; i1++) {

765 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1] =

766 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1]

767 +0.5*(
z
[
i3
-1][
i2
-1][
i1
]+z[i3-1][i2-1][i1-1]);

770  
i2
 = 1; i2 <
mm2
-1; i2++) {

771  
i1
 = 
d1
; i1 <
mm1
-1; i1++) {

772 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1] =

773 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1]

774 +0.5*(
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

776  
i1
 = 1; i1 <
mm1
-1; i1++) {

777 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1] =

778 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1]

779 +0.25*(
z
[
i3
-1][
i2
][
i1
]+z[i3-1][i2-1][i1]

780 +
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

784 #¥agm®
omp
 
nowaô


785  
i3
 = 1; i3 <
mm3
-1; i3++) {

786  
i2
 = 
d2
; i2 <
mm2
-1; i2++) {

787  
i1
 = 
d1
; i1 <
mm1
-1; i1++) {

788 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1] =

789 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1]

790 +0.5*(
z
[
i3
][
i2
-1][
i1
-1]+z[i3-1][i2-1][i1-1]);

792  
i1
 = 1; i1 <
mm1
-1; i1++) {

793 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1] =

794 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1]

795 +0.25*(
z
[
i3
][
i2
-1][
i1
]+z[i3][i2-1][i1-1]

796 +
z
[
i3
-1][
i2
-1][
i1
]+z[i3-1][i2-1][i1-1]);

799  
i2
 = 1; i2 <
mm2
-1; i2++) {

800  
i1
 = 
d1
; i1 <
mm1
-1; i1++) {

801 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1] =

802 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1]

803 +0.25*(
z
[
i3
][
i2
][
i1
-1]+z[i3][i2-1][i1-1]

804 +
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

806  
i1
 = 1; i1 <
mm1
-1; i1++) {

807 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1] =

808 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1]

809 +0.125*(
z
[
i3
][
i2
][
i1
]+z[i3][i2-1][i1]

810 +
z
[
i3
][
i2
][
i1
-1]+z[i3][i2-1][i1-1]

811 +
z
[
i3
-1][
i2
][
i1
]+z[i3-1][i2-1][i1]

812 +
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

818 i‡(
debug_vec
[0] >= 1 ) {

819 
	`ªp_ƒm
(
z
,
mm1
,
mm2
,
mm3
,"z: i¡î",
k
-1);

820 
	`ªp_ƒm
(
u
,
n1
,
n2
,
n3
,"u: i¡î",
k
);

823 i‡–
debug_vec
[5] >
k
 ) {

824 
	`showÆl
(
z
,
mm1
,
mm2
,
mm3
);

825 
	`showÆl
(
u
,
n1
,
n2
,
n3
);

827 
	}
}

832 
	$n‹m2u3
(***
r
, 
n1
, 
n2
, 
n3
,

833 *
∫m2
, *
∫mu
, 
nx
, 
ny
, 
nz
) {

846 
s
 = 0.0;

847 
i3
, 
i2
, 
i1
, 
n
;

848 
a
 = 0.0, 
tmp
 = 0.0;

850 
n
 = 
nx
*
ny
*
nz
;

852 #¥agm®
omp
 
∑øŒñ
 (
sh¨ed
Ë
	`¥iv©e
(
i1
,
i2
,
i3
,
a
Ë
	`ªdu˘i⁄
(+:
s
Ëªdu˘i⁄(
max
:
tmp
)

853 
i3
 = 1; i3 < 
n3
-1; i3++) {

854 
i2
 = 1; i2 < 
n2
-1; i2++) {

855 
i1
 = 1; i1 < 
n1
-1; i1++) {

856 
s
 = s + 
r
[
i3
][
i2
][
i1
] *Ñ[i3][i2][i1];

857 
a
 = 
	`Ábs
(
r
[
i3
][
i2
][
i1
]);

858 i‡(
a
 > 
tmp
)Åmp =á;

862 *
∫mu
 = 
tmp
;

863 *
∫m2
 = 
	`sqπ
(
s
/()
n
);

864 
	}
}

869 
	$ªp_ƒm
(***
u
, 
n1
, 
n2
, 
n3
,

870 *
tôÀ
, 
kk
) {

879 
∫m2
, 
∫mu
;

882 
	`n‹m2u3
(
u
,
n1
,
n2
,
n3
,&
∫m2
,&
∫mu
,
nx
[
kk
],
ny
[kk],
nz
[kk]);

883 
	`¥ötf
(" Level%2d in %8s:Çorms =%21.14e%21.14e\n",

884 
kk
, 
tôÀ
, 
∫m2
, 
∫mu
);

885 
	}
}

890 
	$comm3
(***
u
, 
n1
, 
n2
, 
n3
, 
kk
) {

899 
i1
, 
i2
, 
i3
;

902 #¥agm®
omp
 
∑øŒñ
 (
sh¨ed
Ë
	`¥iv©e
(
i1
,
i2
,
i3
)

904 #¥agm®
omp
 

905  
i3
 = 1; i3 < 
n3
-1; i3++) {

906  
i2
 = 1; i2 < 
n2
-1; i2++) {

907 
u
[
i3
][
i2
][
n1
-1] = u[i3][i2][1];

908 
u
[
i3
][
i2
][0] = u[i3][i2][
n1
-2];

915  
i1
 = 0; i1 < 
n1
; i1++) {

916 
u
[
i3
][
n2
-1][
i1
] = u[i3][1][i1];

917 
u
[
i3
][0][
i1
] = u[i3][
n2
-2][i1];

922 #¥agm®
omp
 
nowaô


923  
i2
 = 0; i2 < 
n2
; i2++) {

924  
i1
 = 0; i1 < 
n1
; i1++) {

925 
u
[
n3
-1][
i2
][
i1
] = u[1][i2][i1];

926 
u
[0][
i2
][
i1
] = u[
n3
-2][i2][i1];

930 
	}
}

935 
	$zøn3
(***
z
, 
n1
, 
n2
, 
n3
, 
nx
, 
ny
, 
k
) {

946 
	#MM
 10

	)

947 
__A
=1220703125.e0;

948 
	#A
 
__A


	)

949 
	#X
 314159265.e0

	)

951 
i0
, 
m0
, 
m1
;

952 
i1
, 
i2
, 
i3
, 
d1
, 
e1
, 
e2
, 
e3
;

953 
xx
, 
x0
, 
x1
, 
a1
, 
a2
, 
ai
;

955 
ãn
[
MM
][2], 
be°
;

956 
i
, 
j1
[
MM
][2], 
j2
[MM][2], 
j3
[MM][2];

957 
jg
[4][
MM
][2];

959 
rdummy
;

961 
a1
 = 
	`powî
–
A
, 
nx
 );

962 
a2
 = 
	`powî
–
A
, 
nx
*
ny
 );

964 
	`zîo3
(
z
,
n1
,
n2
,
n3
);

966 
i
 = 
is1
-1+
nx
*(
is2
-1+
ny
*(
is3
-1));

968 
ai
 = 
	`powî
–
A
, 
i
 );

969 
d1
 = 
õ1
 - 
is1
 + 1;

970 
e1
 = 
õ1
 - 
is1
 + 2;

971 
e2
 = 
õ2
 - 
is2
 + 2;

972 
e3
 = 
õ3
 - 
is3
 + 2;

973 
x0
 = 
X
;

974 
rdummy
 = 
	`øndlc
–&
x0
, 
ai
 );

976 
i3
 = 1; i3 < 
e3
; i3++) {

977 
x1
 = 
x0
;

978 
i2
 = 1; i2 < 
e2
; i2++) {

979 
xx
 = 
x1
;

980 
	`vø∆c
–
d1
, &
xx
, 
A
, &(
z
[
i3
][
i2
][0]));

981 
rdummy
 = 
	`øndlc
–&
x1
, 
a1
 );

983 
rdummy
 = 
	`øndlc
–&
x0
, 
a2
 );

994 
i
 = 0; i < 
MM
; i++) {

995 
ãn
[
i
][1] = 0.0;

996 
j1
[
i
][1] = 0;

997 
j2
[
i
][1] = 0;

998 
j3
[
i
][1] = 0;

999 
ãn
[
i
][0] = 1.0;

1000 
j1
[
i
][0] = 0;

1001 
j2
[
i
][0] = 0;

1002 
j3
[
i
][0] = 0;

1004 
i3
 = 1; i3 < 
n3
-1; i3++) {

1005 
i2
 = 1; i2 < 
n2
-1; i2++) {

1006 
i1
 = 1; i1 < 
n1
-1; i1++) {

1007 i‡–
z
[
i3
][
i2
][
i1
] > 
ãn
[0][1] ) {

1008 
ãn
[0][1] = 
z
[
i3
][
i2
][
i1
];

1009 
j1
[0][1] = 
i1
;

1010 
j2
[0][1] = 
i2
;

1011 
j3
[0][1] = 
i3
;

1012 
	`bubbÀ
–
ãn
, 
j1
, 
j2
, 
j3
, 
MM
, 1 );

1014 i‡–
z
[
i3
][
i2
][
i1
] < 
ãn
[0][0] ) {

1015 
ãn
[0][0] = 
z
[
i3
][
i2
][
i1
];

1016 
j1
[0][0] = 
i1
;

1017 
j2
[0][0] = 
i2
;

1018 
j3
[0][0] = 
i3
;

1019 
	`bubbÀ
–
ãn
, 
j1
, 
j2
, 
j3
, 
MM
, 0 );

1028 
i1
 = 
MM
 - 1;

1029 
i0
 = 
MM
 - 1;

1030 
i
 = 
MM
 - 1 ; i >= 0; i--) {

1031 
be°
 = 
z
[
j3
[
i1
][1]][
j2
[i1][1]][
j1
[i1][1]];

1032 i‡(
be°
 =
z
[
j3
[
i1
][1]][
j2
[i1][1]][
j1
[i1][1]]) {

1033 
jg
[0][
i
][1] = 0;

1034 
jg
[1][
i
][1] = 
is1
 - 1 + 
j1
[
i1
][1];

1035 
jg
[2][
i
][1] = 
is2
 - 1 + 
j2
[
i1
][1];

1036 
jg
[3][
i
][1] = 
is3
 - 1 + 
j3
[
i1
][1];

1037 
i1
 = i1-1;

1039 
jg
[0][
i
][1] = 0;

1040 
jg
[1][
i
][1] = 0;

1041 
jg
[2][
i
][1] = 0;

1042 
jg
[3][
i
][1] = 0;

1044 
ãn
[
i
][1] = 
be°
;

1045 
be°
 = 
z
[
j3
[
i0
][0]][
j2
[i0][0]][
j1
[i0][0]];

1046 i‡(
be°
 =
z
[
j3
[
i0
][0]][
j2
[i0][0]][
j1
[i0][0]]) {

1047 
jg
[0][
i
][0] = 0;

1048 
jg
[1][
i
][0] = 
is1
 - 1 + 
j1
[
i0
][0];

1049 
jg
[2][
i
][0] = 
is2
 - 1 + 
j2
[
i0
][0];

1050 
jg
[3][
i
][0] = 
is3
 - 1 + 
j3
[
i0
][0];

1051 
i0
 = i0-1;

1053 
jg
[0][
i
][0] = 0;

1054 
jg
[1][
i
][0] = 0;

1055 
jg
[2][
i
][0] = 0;

1056 
jg
[3][
i
][0] = 0;

1058 
ãn
[
i
][0] = 
be°
;

1060 
m1
 = 
i1
+1;

1061 
m0
 = 
i0
+1;

1091 #¥agm®
omp
 
∑øŒñ
 
	`¥iv©e
(
i2
, 
i1
)

1092 
i3
 = 0; i3 < 
n3
; i3++) {

1093 
i2
 = 0; i2 < 
n2
; i2++) {

1094 
i1
 = 0; i1 < 
n1
; i1++) {

1095 
z
[
i3
][
i2
][
i1
] = 0.0;

1099 
i
 = 
MM
-1; i >
m0
; i--) {

1100 
z
[
j3
[
i
][0]][
j2
[i][0]][
j1
[i][0]] = -1.0;

1102 
i
 = 
MM
-1; i >
m1
; i--) {

1103 
z
[
j3
[
i
][1]][
j2
[i][1]][
j1
[i][1]] = 1.0;

1105 
	`comm3
(
z
,
n1
,
n2
,
n3
,
k
);

1110 
	}
}

1115 
	$showÆl
(***
z
, 
n1
, 
n2
, 
n3
) {

1120 
i1
,
i2
,
i3
;

1121 
m1
, 
m2
, 
m3
;

1123 
m1
 = 
	`mö
(
n1
,18);

1124 
m2
 = 
	`mö
(
n2
,14);

1125 
m3
 = 
	`mö
(
n3
,18);

1127 
	`¥ötf
("\n");

1128 
i3
 = 0; i3 < 
m3
; i3++) {

1129 
i1
 = 0; i1 < 
m1
; i1++) {

1130 
i2
 = 0; i2 < 
m2
; i2++) {

1131 
	`¥ötf
("%6.3f", 
z
[
i3
][
i2
][
i1
]);

1133 
	`¥ötf
("\n");

1135 
	`¥ötf
(" - - - - - - - \n");

1137 
	`¥ötf
("\n");

1138 
	}
}

1143 
	$powî
–
a
, 
n
 ) {

1152 
aj
;

1153 
nj
;

1154 
rdummy
;

1155 
powî
;

1157 
powî
 = 1.0;

1158 
nj
 = 
n
;

1159 
aj
 = 
a
;

1161 
nj
 != 0) {

1162 if–(
nj
%2Ë=1 ) 
rdummy
 = 
	`øndlc
–&
powî
, 
aj
 );

1163 
rdummy
 = 
	`øndlc
–&
aj
,áj );

1164 
nj
 =Çj/2;

1167  (
powî
);

1168 
	}
}

1173 
	$bubbÀ
–
ãn
[
M
][2], 
j1
[M][2], 
j2
[M][2],

1174 
j3
[
M
][2], 
m
, 
öd
 ) {

1183 
ãmp
;

1184 
i
, 
j_ãmp
;

1186 i‡–
öd
 == 1 ) {

1187 
i
 = 0; i < 
m
-1; i++) {

1188 i‡–
ãn
[
i
][
öd
] >Åen[i+1][ind] ) {

1190 
ãmp
 = 
ãn
[
i
+1][
öd
];

1191 
ãn
[
i
+1][
öd
] =Åen[i][ind];

1192 
ãn
[
i
][
öd
] = 
ãmp
;

1194 
j_ãmp
 = 
j1
[
i
+1][
öd
];

1195 
j1
[
i
+1][
öd
] = j1[i][ind];

1196 
j1
[
i
][
öd
] = 
j_ãmp
;

1198 
j_ãmp
 = 
j2
[
i
+1][
öd
];

1199 
j2
[
i
+1][
öd
] = j2[i][ind];

1200 
j2
[
i
][
öd
] = 
j_ãmp
;

1202 
j_ãmp
 = 
j3
[
i
+1][
öd
];

1203 
j3
[
i
+1][
öd
] = j3[i][ind];

1204 
j3
[
i
][
öd
] = 
j_ãmp
;

1210 
i
 = 0; i < 
m
-1; i++) {

1211 i‡–
ãn
[
i
][
öd
] <Åen[i+1][ind] ) {

1213 
ãmp
 = 
ãn
[
i
+1][
öd
];

1214 
ãn
[
i
+1][
öd
] =Åen[i][ind];

1215 
ãn
[
i
][
öd
] = 
ãmp
;

1217 
j_ãmp
 = 
j1
[
i
+1][
öd
];

1218 
j1
[
i
+1][
öd
] = j1[i][ind];

1219 
j1
[
i
][
öd
] = 
j_ãmp
;

1221 
j_ãmp
 = 
j2
[
i
+1][
öd
];

1222 
j2
[
i
+1][
öd
] = j2[i][ind];

1223 
j2
[
i
][
öd
] = 
j_ãmp
;

1225 
j_ãmp
 = 
j3
[
i
+1][
öd
];

1226 
j3
[
i
+1][
öd
] = j3[i][ind];

1227 
j3
[
i
][
öd
] = 
j_ãmp
;

1233 
	}
}

1238 
	$zîo3
(***
z
, 
n1
, 
n2
, 
n3
) {

1243 
i1
, 
i2
, 
i3
;

1244 #¥agm®
omp
 
∑øŒñ
 
	`¥iv©e
(
i1
,
i2
,
i3
)

1245 
i3
 = 0;i3 < 
n3
; i3++) {

1246 
i2
 = 0; i2 < 
n2
; i2++) {

1247 
i1
 = 0; i1 < 
n1
; i1++) {

1248 
z
[
i3
][
i2
][
i1
] = 0.0;

1252 
	}
}

	@npbparams.h

7 
	#NX_DEFAULT
 32

	)

8 
	#NY_DEFAULT
 32

	)

9 
	#NZ_DEFAULT
 32

	)

10 
	#NIT_DEFAULT
 4

	)

11 
	#LM
 5

	)

12 
	#LT_DEFAULT
 5

	)

13 
	#DEBUG_DEFAULT
 0

	)

14 
	#NDIM1
 5

	)

15 
	#NDIM2
 5

	)

16 
	#NDIM3
 5

	)

17 
	#CONVERTDOUBLE
 
FALSE


	)

18 
	#COMPILETIME
 "02 De¯2020"

	)

19 
	#NPBVERSION
 "3.0 såu˘uªd"

	)

20 
	#CS1
 "“⁄e)"

	)

21 
	#CS2
 "“⁄e)"

	)

22 
	#CS3
 "“⁄e)"

	)

23 
	#CS4
 "“⁄e)"

	)

24 
	#CS5
 "-o3 $(C_IN)"

	)

25 
	#CS6
 "“⁄e)"

	)

26 
	#CS7
 "“⁄e)"

	)

	@../common/npb-C.h

4 #i‚de‡
_NPB_C_H_


5 
	#_NPB_C_H_


	)

9 
	~<«utûus/«utûus.h
>

18 
	tboﬁón
;

19 °ru˘ { 
	mªÆ
; 
	mimag
; } 
	tdcom∂ex
;

21 
	#TRUE
 1

	)

22 
	#FALSE
 0

	)

24 
	#max
(
a
,
b
Ë((◊Ë> (b)Ë? (aË: (b))

	)

25 
	#mö
(
a
,
b
Ë((◊Ë< (b)Ë? (aË: (b))

	)

26 
	#pow2
(
a
Ë(◊)*◊))

	)

28 
	#gë_ªÆ
(
c
Ëc.
ªÆ


	)

29 
	#gë_imag
(
c
Ëc.
imag


	)

30 
	#ˇdd
(
c
,
a
,
b
Ë(c.
ªÆ
 =á.ªÆ + b.ªÆ, c.
imag
 =á.imag + b.imag)

	)

31 
	#csub
(
c
,
a
,
b
Ë(c.
ªÆ
 =á.ªÆ - b.ªÆ, c.
imag
 =á.imag - b.imag)

	)

32 
	#cmul
(
c
,
a
,
b
Ë(c.
ªÆ
 =á.ªÆ * b.ªÆ -á.
imag
 * b.imag, \

33 
c
.
imag
 = 
a
.
ªÆ
 * 
b
.imag +á.imag * b.ªÆ)

	)

34 
	#¸mul
(
c
,
a
,
b
Ë(c.
ªÆ
 =á.ªÆ * b, c.
imag
 =á.imag * b)

	)

36 
øndlc
(*, );

37 
vø∆c
(, *, , *);

38 
timî_˛ór
();

39 
timî_°¨t
();

40 
timî_°›
();

41 
timî_ªad
();

43 
c_¥öt_ªsu…s
(*
«me
, 
˛ass
, 
n1
, 
n2
,

44 
n3
, 
nôî
, 
¡hªads
, 
t
,

45 
m›s
, *
›ty≥
, 
∑s£d_vîifiˇti⁄
,

46 *
≈bvîsi⁄
, *
compûëime
, *
cc
,

47 *
˛ök
, *
c_lib
, *
c_öc
,

48 *
cÊags
, *
˛ökÊags
, *
ønd
);

	@../math/nas_math.h

2 #i‚de‡
_NAS_MATH_H_


3 
	#_NAS_MATH_H_


	)

5 
	~<«utûus/«utûus.h
>

6 
	~"log/«s_log.h
"

7 
	~"pow/«s_pow.h
"

8 
	~"exp/«s_exp.h
"

9 
	~"söcos/«s_söcos.h
"

13 
ölöe
 
	$sqπ
(
x
)

15 
ªt
;

16 
asm
 volatile(

20 : "Ù"(
ªt
)

21 : "g"(
x
)

24  
ªt
;

25 
	}
}

27 
	#Ábs
(
x
Ë
	`__buûtö_Ábs
(x)

	)

	@
1
.
1
/usr/include
5
64
globals.h
mg.c
npbparams.h
../common/npb-C.h
../math/nas_math.h
