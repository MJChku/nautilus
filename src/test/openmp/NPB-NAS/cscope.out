cscope 15 $HOME/Projects/2020summer/nautiluses/nautilus-wwy/nautilus/src/test/openmp/NPB-NAS               0000406276
	@BT/bt.c

35 
	~"../commÚ/Åb-C.h
"

36 
	~<Çutus/sh–l.h
>

39 
	~"h—d”.h
"

42 
	#ÿÎoc
(
n
,
s
è({ *
_p
=
	`m®loc
Ò*s);
	`mem£t
(_p,0,n*s); _p;})

	)

45 
add
();

46 
adi
();

47 
”rÜ_nÜm
(
rms
[5]);

48 
rhs_nÜm
(
rms
[5]);

49 
exaù_rhs
();

50 
exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

51 
d‹mp
[5]);

52 
š™Ÿlize
();

53 
lhsš™
();

54 
lhsx
();

55 
lhsy
();

56 
lhsz
();

57 
compu‹_rhs
();

58 
£t_cÚ¡ªts
();

59 
v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
);

60 
x_sŞve
();

61 
x_backsub¡™u‹
();

62 
x_sŞve_ûÎ
();

63 
m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]);

64 
m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

65 
cblock
[5][5]);

66 
bšvühs
(
Îhs
[5][5], 
c
[5][5], 
r
[5]);

67 
bšvrhs
(
Îhs
[5][5], 
r
[5]);

68 
y_sŞve
();

69 
y_backsub¡™u‹
();

70 
y_sŞve_ûÎ
();

71 
z_sŞve
();

72 
z_backsub¡™u‹
();

73 
z_sŞve_ûÎ
();

77 
´og¿m_BT
(*
__buf
, * 
__´iv
);

78 
´og¿m_BT_´ofe
(*
_
, * 
__
);

80 
sh–l_cmd_im¶
 
	gÇs_bt_im¶
 = {

81 .
cmd
 = "nas-bt",

82 .
	gh–p_¡r
 = "NAS…arallel benchmark BT",

83 .
	ghªdËr
 = 
´og¿m_BT_´ofe
,

85 
nk_»gi¡”_sh–l_cmd
(
Çs_bt_im¶
);

88 
	$´og¿m_BT_´ofe
(*
_
, *
__
){

90 #ifdeà
NAUT_CONFIG_PROFILE


91 
	`nk_š¡rum’t_ş—r
();

92 
	`nk_š¡rum’t_¡¬t
();

94 
	`´og¿m_BT
(
_
,
__
);

95 #ifdeà
NAUT_CONFIG_PROFILE


96 
	`nk_š¡rum’t_’d
();

97 
	`nk_š¡rum’t_qu”y
();

100 
	}
}

104 * 
	g__m
=0;

105 
	#ALIGN
(
x
,
a
è(((x)+×)-1)&~(×)-1))

	)

107 
	#_m®loc
(
n
è({ ià(!
__m
è{ __m = 
	`m®loc
(1UL<<33); if(!__m){
	`´štf
("nØ__m\n"); }} *
__r
 = __m; 
__n
 = 
	`ALIGN
Ò, 16); __m+=__n; __r; })

	)

110 
	$¬r_š™_ÿÎoc
(){

111 
us_±r
 = 
	`ÿÎoc
((
s_m©rix_t
), 1);

112 
vs_±r
 = 
	`ÿÎoc
((
s_m©rix_t
), 1);

113 
ws_±r
 = 
	`ÿÎoc
((
s_m©rix_t
), 1);

114 
qs_±r
 = 
	`ÿÎoc
((
s_m©rix_t
), 1);

115 
rho_i_±r
 = 
	`ÿÎoc
((
s_m©rix_t
), 1);

116 
squ¬e_±r
 = 
	`ÿÎoc
((
s_m©rix_t
), 1);

119 
fÜcšg_±r
 = 
	`ÿÎoc
((
f_m©rix_t
), 1);

120 
u_±r
 = 
	`ÿÎoc
((
u_m©rix_t
), 1);

121 
rhs_±r
 = 
	`ÿÎoc
((
rhs_m©rix_t
), 1);

122 
lhs_±r
 = 
	`ÿÎoc
((
lhs_m©rix_t
), 1);

125 
fjac_±r
 = 
	`ÿÎoc
((
jac_m©rix_t
), 1);

126 
njac_±r
 = 
	`ÿÎoc
((
jac_m©rix_t
), 1);

127 
	}
}

129 
	$ä“_¬r
(){

130 
	`ä“
(
us_±r
);

131 
	`ä“
(
vs_±r
);

132 
	`ä“
(
ws_±r
);

133 
	`ä“
(
qs_±r
);

134 
	`ä“
(
rho_i_±r
);

135 
	`ä“
(
squ¬e_±r
);

136 
	`ä“
(
fÜcšg_±r
);

137 
	`ä“
(
u_±r
);

138 
	`ä“
(
rhs_±r
);

139 
	`ä“
(
lhs_±r
);

140 
	`ä“
(
fjac_±r
);

141 
	`ä“
(
njac_±r
);

142 
	}
}

147 
	$´og¿m_BT
(*
__buf
, * 
__´iv
) {

151 
n™”
, 
¡•
, 
n3
;

152 
Áh»ads
 = 1;

153 
Çvg
, 
mæİs
;

155 
tmax
;

156 
boŞ—n
 
v”if›d
;

157 
şass
;

161 
	`¬r_š™_ÿÎoc
();

167 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

183 
n™”
 = 
NITER_DEFAULT
;

184 
dt
 = 
DT_DEFAULT
;

185 
grid_pošts
[0] = 
PROBLEM_SIZE
;

186 
grid_pošts
[1] = 
PROBLEM_SIZE
;

187 
grid_pošts
[2] = 
PROBLEM_SIZE
;

190 
	`´štf
(" Size: %3dx%3dx%3d\n",

191 
grid_pošts
[0], grid_points[1], grid_points[2]);

192 
	`´štf
(" I‹¿tiÚs: %3d dt: %10.6f\n", 
n™”
, 
dt
);

194 ià(
grid_pošts
[0] > 
IMAX
 ||

195 
grid_pošts
[1] > 
JMAX
 ||

196 
grid_pošts
[2] > 
KMAX
) {

197 
	`´štf
(" %dx%dx%d\n", 
grid_pošts
[0], grid_points[1], grid_points[2]);

198 
	`´štf
(" Problem sizeoo big for compiled‡rray sizes\n");

199 
	`ex™
(1);

202 
	`£t_cÚ¡ªts
();

204 
	`š™Ÿlize
();

205 
	`lhsš™
();

206 
	`exaù_rhs
();

212 
	`adi
();

214 
	`š™Ÿlize
();

216 
	`tim”_ş—r
(1);

217 
	`tim”_¡¬t
(1);

219 
¡•
 = 1; s‹°<ğ
n™”
; step++) {

221 ià(
¡•
%20 == 0 || step == 1) {

222 
	`´štf
(" Tim¡• %4d\n", 
¡•
);

224 
	`adi
();

227 #´agm¨
omp
 
·¿Î–


229 #ià
	`defšed
(
_OPENMP
)

230 #´agm¨
omp
 
ma¡”


231 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

233 
	`´štf
("Áh»ad %d\n",
Áh»ads
);

237 
	`tim”_¡İ
(1);

238 
tmax
 = 
	`tim”_»ad
(1);

240 
	`v”ify
(
n™”
, &
şass
, &
v”if›d
);

242 
n3
 = 
grid_pošts
[0]*grid_points[1]*grid_points[2];

243 
Çvg
 = (
grid_pošts
[0]+grid_points[1]+grid_points[2])/3.0;

244 iàĞ
tmax
 != 0.0 ) {

245 
mæİs
 = 1.0e-6*()
n™”
*

246 (3478.8*()
n3
-17655.7*
	`pow2
(
Çvg
)+28023.7*Çvgè/ 
tmax
;

248 
mæİs
 = 0.0;

250 
	`c_´št_»suÉs
("BT", 
şass
, 
grid_pošts
[0],

251 
grid_pošts
[1], grid_pošts[2], 
n™”
, 
Áh»ads
,

252 
tmax
, 
mæİs
, " floating…oint",

253 
v”if›d
, 
NPBVERSION
,
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
,

254 
CS6
, "(none)");

255 
	`ä“_¬r
();

256 
	}
}

261 
	$add
() {

267 
i
, 
j
, 
k
, 
m
;

269 #´agm¨
omp
 

270 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

271 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

272 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

273 
m
 = 0; m < 5; m++) {

274 
u
[
i
][
j
][
k
][
m
] = u[i][j][k][m] + 
rhs
[i][j][k][m];

279 
	}
}

284 
	$adi
() {

285 #´agm¨
omp
 
·¿Î–


286 
	`compu‹_rhs
();

288 #´agm¨
omp
 
·¿Î–


289 
	`x_sŞve
();

291 #´agm¨
omp
 
·¿Î–


292 
	`y_sŞve
();

294 #´agm¨
omp
 
·¿Î–


295 
	`z_sŞve
();

297 #´agm¨
omp
 
·¿Î–


298 
	`add
();

299 
	}
}

304 
	$”rÜ_nÜm
(
rms
[5]) {

311 
i
, 
j
, 
k
, 
m
, 
d
;

312 
xi
, 
‘a
, 
z‘a
, 
u_exaù
[5], 
add
;

314 
m
 = 0; m < 5; m++) {

315 
rms
[
m
] = 0.0;

318 
i
 = 0; i < 
grid_pošts
[0]; i++) {

319 
xi
 = ()
i
 * 
dnxm1
;

320 
j
 = 0; j < 
grid_pošts
[1]; j++) {

321 
‘a
 = ()
j
 * 
dnym1
;

322 
k
 = 0; k < 
grid_pošts
[2]; k++) {

323 
z‘a
 = ()
k
 * 
dnzm1
;

324 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
u_exaù
);

326 
m
 = 0; m < 5; m++) {

327 
add
 = 
u
[
i
][
j
][
k
][
m
] - 
u_exaù
[m];

328 
rms
[
m
] =„ms[m] + 
add
*add;

334 
m
 = 0; m < 5; m++) {

335 
d
 = 0; d <= 2; d++) {

336 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

338 
rms
[
m
] = 
	`sq¹
(rms[m]);

340 
	}
}

345 
	$rhs_nÜm
(
rms
[5]) {

350 
i
, 
j
, 
k
, 
d
, 
m
;

351 
add
;

353 
m
 = 0; m < 5; m++) {

354 
rms
[
m
] = 0.0;

357 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

358 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

359 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

360 
m
 = 0; m < 5; m++) {

361 
add
 = 
rhs
[
i
][
j
][
k
][
m
];

362 
rms
[
m
] =„ms[m] + 
add
*add;

368 
m
 = 0; m < 5; m++) {

369 
d
 = 0; d <= 2; d++) {

370 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

372 
rms
[
m
] = 
	`sq¹
(rms[m]);

374 
	}
}

380 
	$exaù_rhs
() {

382 #´agm¨
omp
 
·¿Î–


391 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

392 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

397 #´agm¨
omp
 

398 
i
 = 0; i < 
grid_pošts
[0]; i++) {

399 
j
 = 0; j < 
grid_pošts
[1]; j++) {

400 
k
 = 0; k < 
grid_pošts
[2]; k++) {

401 
m
 = 0; m < 5; m++) {

402 
fÜcšg
[
i
][
j
][
k
][
m
] = 0.0;

411 #´agm¨
omp
 

412 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

413 
‘a
 = ()
j
 * 
dnym1
;

415 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

416 
z‘a
 = ()
k
 * 
dnzm1
;

418 
i
 = 0; i < 
grid_pošts
[0]; i++) {

419 
xi
 = ()
i
 * 
dnxm1
;

421 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

422 
m
 = 0; m < 5; m++) {

423 
ue
[
i
][
m
] = 
d‹mp
[m];

426 
dp
 = 1.0 / 
d‹mp
[0];

428 
m
 = 1; m <= 4; m++) {

429 
buf
[
i
][
m
] = 
dp
 * 
d‹mp
[m];

432 
cuf
[
i
] = 
buf
[i][1] * buf[i][1];

433 
buf
[
i
][0] = 
cuf
[i] + buf[i][2] * buf[i][2] +

434 
buf
[
i
][3] * buf[i][3];

435 
q
[
i
] = 0.5*(
buf
[i][1]*
ue
[i][1] + buf[i][2]*ue[i][2] +

436 
buf
[
i
][3]*
ue
[i][3]);

439 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

440 
im1
 = 
i
-1;

441 
1
 = 
i
+1;

443 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

444 
tx2
*(
ue
[
1
][1]-ue[
im1
][1])+

445 
dx1tx1
*(
ue
[
1
][0]-2.0*ue[
i
][0]+ue[
im1
][0]);

447 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

448 
tx2
 * ((
ue
[
1
][1]*
buf
[1][1]+
c2
*(ue[1][4]-
q
[ip1]))-

449 (
ue
[
im1
][1]*
buf
[im1][1]+
c2
*(ue[im1][4]-
q
[im1])))+

450 
xxcÚ1
*(
buf
[
1
][1]-2.0*buf[
i
][1]+buf[
im1
][1])+

451 
dx2tx1
*Ğ
ue
[
1
][1]-2.0* ue[
i
][1]+ ue[
im1
][1]);

453 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

454 
tx2
 * (
ue
[
1
][2]*
buf
[1][1]-ue[
im1
][2]*buf[im1][1])+

455 
xxcÚ2
*(
buf
[
1
][2]-2.0*buf[
i
][2]+buf[
im1
][2])+

456 
dx3tx1
*Ğ
ue
[
1
][2]-2.0* ue[
i
][2]+ ue[
im1
][2]);

458 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

459 
tx2
*(
ue
[
1
][3]*
buf
[1][1]-ue[
im1
][3]*buf[im1][1])+

460 
xxcÚ2
*(
buf
[
1
][3]-2.0*buf[
i
][3]+buf[
im1
][3])+

461 
dx4tx1
*Ğ
ue
[
1
][3]-2.0* ue[
i
][3]+ ue[
im1
][3]);

463 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

464 
tx2
*(
buf
[
1
][1]*(
c1
*
ue
[1][4]-
c2
*
q
[ip1])-

465 
buf
[
im1
][1]*(
c1
*
ue
[im1][4]-
c2
*
q
[im1]))+

466 0.5*
xxcÚ3
*(
buf
[
1
][0]-2.0*buf[
i
][0]+buf[
im1
][0])+

467 
xxcÚ4
*(
cuf
[
1
]-2.0*cuf[
i
]+cuf[
im1
])+

468 
xxcÚ5
*(
buf
[
1
][4]-2.0*buf[
i
][4]+buf[
im1
][4])+

469 
dx5tx1
*Ğ
ue
[
1
][4]-2.0* ue[
i
][4]+ ue[
im1
][4]);

476 
m
 = 0; m < 5; m++) {

477 
i
 = 1;

478 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

479 (5.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m] +ue[i+2][m]);

480 
i
 = 2;

481 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

482 (-4.0*
ue
[
i
-1][
m
] + 6.0*ue[i][m] -

483 4.0*
ue
[
i
+1][
m
] + ue[i+2][m]);

486 
m
 = 0; m < 5; m++) {

487 
i
 = 1*3; i <ğ
grid_pošts
[0]-3*1-1; i++) {

488 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

489 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] +

490 6.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m] + ue[i+2][m]);

494 
m
 = 0; m < 5; m++) {

495 
i
 = 
grid_pošts
[0]-3;

496 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

497 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] +

498 6.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m]);

499 
i
 = 
grid_pošts
[0]-2;

500 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

501 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] + 5.0*ue[i][m]);

510 #´agm¨
omp
 

511 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

512 
xi
 = ()
i
 * 
dnxm1
;

514 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

515 
z‘a
 = ()
k
 * 
dnzm1
;

517 
j
 = 0; j < 
grid_pošts
[1]; j++) {

518 
‘a
 = ()
j
 * 
dnym1
;

520 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

521 
m
 = 0; m < 5; m++) {

522 
ue
[
j
][
m
] = 
d‹mp
[m];

525 
dp
 = 1.0/
d‹mp
[0];

527 
m
 = 1; m <= 4; m++) {

528 
buf
[
j
][
m
] = 
dp
 * 
d‹mp
[m];

531 
cuf
[
j
] = 
buf
[j][2] * buf[j][2];

532 
buf
[
j
][0] = 
cuf
[j] + buf[j][1] * buf[j][1] +

533 
buf
[
j
][3] * buf[j][3];

534 
q
[
j
] = 0.5*(
buf
[j][1]*
ue
[j][1] + buf[j][2]*ue[j][2] +

535 
buf
[
j
][3]*
ue
[j][3]);

538 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

539 
jm1
 = 
j
-1;

540 
jp1
 = 
j
+1;

542 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

543 
ty2
*Ğ
ue
[
jp1
][2]-ue[
jm1
][2] )+

544 
dy1ty1
*(
ue
[
jp1
][0]-2.0*ue[
j
][0]+ue[
jm1
][0]);

546 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

547 
ty2
*(
ue
[
jp1
][1]*
buf
[jp1][2]-ue[
jm1
][1]*buf[jm1][2])+

548 
yycÚ2
*(
buf
[
jp1
][1]-2.0*buf[
j
][1]+buf[
jm1
][1])+

549 
dy2ty1
*Ğ
ue
[
jp1
][1]-2.0* ue[
j
][1]+ ue[
jm1
][1]);

551 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

552 
ty2
*((
ue
[
jp1
][2]*
buf
[jp1][2]+
c2
*(ue[jp1][4]-
q
[jp1]))-

553 (
ue
[
jm1
][2]*
buf
[jm1][2]+
c2
*(ue[jm1][4]-
q
[jm1])))+

554 
yycÚ1
*(
buf
[
jp1
][2]-2.0*buf[
j
][2]+buf[
jm1
][2])+

555 
dy3ty1
*Ğ
ue
[
jp1
][2]-2.0*ue[
j
][2] +ue[
jm1
][2]);

557 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

558 
ty2
*(
ue
[
jp1
][3]*
buf
[jp1][2]-ue[
jm1
][3]*buf[jm1][2])+

559 
yycÚ2
*(
buf
[
jp1
][3]-2.0*buf[
j
][3]+buf[
jm1
][3])+

560 
dy4ty1
*Ğ
ue
[
jp1
][3]-2.0*ue[
j
][3]+ ue[
jm1
][3]);

562 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

563 
ty2
*(
buf
[
jp1
][2]*(
c1
*
ue
[jp1][4]-
c2
*
q
[jp1])-

564 
buf
[
jm1
][2]*(
c1
*
ue
[jm1][4]-
c2
*
q
[jm1]))+

565 0.5*
yycÚ3
*(
buf
[
jp1
][0]-2.0*buf[
j
][0]+

566 
buf
[
jm1
][0])+

567 
yycÚ4
*(
cuf
[
jp1
]-2.0*cuf[
j
]+cuf[
jm1
])+

568 
yycÚ5
*(
buf
[
jp1
][4]-2.0*buf[
j
][4]+buf[
jm1
][4])+

569 
dy5ty1
*(
ue
[
jp1
][4]-2.0*ue[
j
][4]+ue[
jm1
][4]);

575 
m
 = 0; m < 5; m++) {

576 
j
 = 1;

577 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

578 (5.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m] +ue[j+2][m]);

579 
j
 = 2;

580 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

581 (-4.0*
ue
[
j
-1][
m
] + 6.0*ue[j][m] -

582 4.0*
ue
[
j
+1][
m
] + ue[j+2][m]);

585 
m
 = 0; m < 5; m++) {

586 
j
 = 1*3; j <ğ
grid_pošts
[1]-3*1-1; j++) {

587 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

588 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] +

589 6.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m] + ue[j+2][m]);

593 
m
 = 0; m < 5; m++) {

594 
j
 = 
grid_pošts
[1]-3;

595 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

596 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] +

597 6.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m]);

598 
j
 = 
grid_pošts
[1]-2;

599 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

600 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] + 5.0*ue[j][m]);

610 #´agm¨
omp
 

611 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

612 
xi
 = ()
i
 * 
dnxm1
;

614 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

615 
‘a
 = ()
j
 * 
dnym1
;

617 
k
 = 0; k < 
grid_pošts
[2]; k++) {

618 
z‘a
 = ()
k
 * 
dnzm1
;

620 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

621 
m
 = 0; m < 5; m++) {

622 
ue
[
k
][
m
] = 
d‹mp
[m];

625 
dp
 = 1.0/
d‹mp
[0];

627 
m
 = 1; m <= 4; m++) {

628 
buf
[
k
][
m
] = 
dp
 * 
d‹mp
[m];

631 
cuf
[
k
] = 
buf
[k][3] * buf[k][3];

632 
buf
[
k
][0] = 
cuf
[k] + buf[k][1] * buf[k][1] +

633 
buf
[
k
][2] * buf[k][2];

634 
q
[
k
] = 0.5*(
buf
[k][1]*
ue
[k][1] + buf[k][2]*ue[k][2] +

635 
buf
[
k
][3]*
ue
[k][3]);

638 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

639 
km1
 = 
k
-1;

640 
kp1
 = 
k
+1;

642 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

643 
tz2
*Ğ
ue
[
kp1
][3]-ue[
km1
][3] )+

644 
dz1tz1
*(
ue
[
kp1
][0]-2.0*ue[
k
][0]+ue[
km1
][0]);

646 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

647 
tz2
 * (
ue
[
kp1
][1]*
buf
[kp1][3]-ue[
km1
][1]*buf[km1][3])+

648 
zzcÚ2
*(
buf
[
kp1
][1]-2.0*buf[
k
][1]+buf[
km1
][1])+

649 
dz2tz1
*Ğ
ue
[
kp1
][1]-2.0* ue[
k
][1]+ ue[
km1
][1]);

651 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

652 
tz2
 * (
ue
[
kp1
][2]*
buf
[kp1][3]-ue[
km1
][2]*buf[km1][3])+

653 
zzcÚ2
*(
buf
[
kp1
][2]-2.0*buf[
k
][2]+buf[
km1
][2])+

654 
dz3tz1
*(
ue
[
kp1
][2]-2.0*ue[
k
][2]+ue[
km1
][2]);

656 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

657 
tz2
 * ((
ue
[
kp1
][3]*
buf
[kp1][3]+
c2
*(ue[kp1][4]-
q
[kp1]))-

658 (
ue
[
km1
][3]*
buf
[km1][3]+
c2
*(ue[km1][4]-
q
[km1])))+

659 
zzcÚ1
*(
buf
[
kp1
][3]-2.0*buf[
k
][3]+buf[
km1
][3])+

660 
dz4tz1
*Ğ
ue
[
kp1
][3]-2.0*ue[
k
][3] +ue[
km1
][3]);

662 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

663 
tz2
 * (
buf
[
kp1
][3]*(
c1
*
ue
[kp1][4]-
c2
*
q
[kp1])-

664 
buf
[
km1
][3]*(
c1
*
ue
[km1][4]-
c2
*
q
[km1]))+

665 0.5*
zzcÚ3
*(
buf
[
kp1
][0]-2.0*buf[
k
][0]

666 +
buf
[
km1
][0])+

667 
zzcÚ4
*(
cuf
[
kp1
]-2.0*cuf[
k
]+cuf[
km1
])+

668 
zzcÚ5
*(
buf
[
kp1
][4]-2.0*buf[
k
][4]+buf[
km1
][4])+

669 
dz5tz1
*Ğ
ue
[
kp1
][4]-2.0*ue[
k
][4]+ ue[
km1
][4]);

675 
m
 = 0; m < 5; m++) {

676 
k
 = 1;

677 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

678 (5.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m] +ue[k+2][m]);

679 
k
 = 2;

680 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

681 (-4.0*
ue
[
k
-1][
m
] + 6.0*ue[k][m] -

682 4.0*
ue
[
k
+1][
m
] + ue[k+2][m]);

685 
m
 = 0; m < 5; m++) {

686 
k
 = 1*3; k <ğ
grid_pošts
[2]-3*1-1; k++) {

687 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

688 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] +

689 6.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m] + ue[k+2][m]);

693 
m
 = 0; m < 5; m++) {

694 
k
 = 
grid_pošts
[2]-3;

695 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

696 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] +

697 6.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m]);

698 
k
 = 
grid_pošts
[2]-2;

699 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

700 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] + 5.0*ue[k][m]);

709 #´agm¨
omp
 

710 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

711 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

712 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

713 
m
 = 0; m < 5; m++) {

714 
fÜcšg
[
i
][
j
][
k
][
m
] = -1.0 * forcing[i][j][k][m];

721 
	}
}

725 
	$exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

726 
d‹mp
[5]) {

735 
m
;

737 
m
 = 0; m < 5; m++) {

738 
d‹mp
[
m
] = 
û
[m][0] +

739 
xi
*(
û
[
m
][1] + xi*(ce[m][4] + xi*(ce[m][7]

740 + 
xi
*
û
[
m
][10]))) +

741 
‘a
*(
û
[
m
][2] +ƒta*(ce[m][5] +ƒta*(ce[m][8]

742 + 
‘a
*
û
[
m
][11])))+

743 
z‘a
*(
û
[
m
][3] + zeta*(ce[m][6] + zeta*(ce[m][9] +

744 
z‘a
*
û
[
m
][12])));

746 
	}
}

751 
	$š™Ÿlize
() {

753 #´agm¨
omp
 
·¿Î–


763 
i
, 
j
, 
k
, 
m
, 
ix
, 
iy
, 
iz
;

764 
xi
, 
‘a
, 
z‘a
, 
Pçû
[2][3][5], 
Pxi
, 
P‘a
, 
Pz‘a
, 
‹mp
[5];

772 #´agm¨
omp
 

773 
i
 = 0; i < 
IMAX
; i++) {

774 
j
 = 0; j < 
IMAX
; j++) {

775 
k
 = 0; k < 
IMAX
; k++) {

776 
m
 = 0; m < 5; m++) {

777 
u
[
i
][
j
][
k
][
m
] = 1.0;

787 #´agm¨
omp
 

788 
i
 = 0; i < 
grid_pošts
[0]; i++) {

789 
xi
 = ()
i
 * 
dnxm1
;

791 
j
 = 0; j < 
grid_pošts
[1]; j++) {

792 
‘a
 = ()
j
 * 
dnym1
;

794 
k
 = 0; k < 
grid_pošts
[2]; k++) {

795 
z‘a
 = ()
k
 * 
dnzm1
;

797 
ix
 = 0; ix < 2; ix++) {

798 
	`exaù_sŞutiÚ
(()
ix
, 
‘a
, 
z‘a
,

799 &(
Pçû
[
ix
][0][0]));

802 
iy
 = 0; iy < 2; iy++) {

803 
	`exaù_sŞutiÚ
(
xi
, ()
iy
 , 
z‘a
,

804 &
Pçû
[
iy
][1][0]);

807 
iz
 = 0; iz < 2; iz++) {

808 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, ()
iz
,

809 &
Pçû
[
iz
][2][0]);

812 
m
 = 0; m < 5; m++) {

813 
Pxi
 = 
xi
 * 
Pçû
[1][0][
m
] +

814 (1.0-
xi
è* 
Pçû
[0][0][
m
];

815 
P‘a
 = 
‘a
 * 
Pçû
[1][1][
m
] +

816 (1.0-
‘a
è* 
Pçû
[0][1][
m
];

817 
Pz‘a
 = 
z‘a
 * 
Pçû
[1][2][
m
] +

818 (1.0-
z‘a
è* 
Pçû
[0][2][
m
];

820 
u
[
i
][
j
][
k
][
m
] = 
Pxi
 + 
P‘a
 + 
Pz‘a
 -

821 
Pxi
*
P‘a
 - Pxi*
Pz‘a
 - Peta*Pzeta +

822 
Pxi
*
P‘a
*
Pz‘a
;

835 
i
 = 0;

836 
xi
 = 0.0;

837 #´agm¨
omp
 
nowa™


838 
j
 = 0; j < 
grid_pošts
[1]; j++) {

839 
‘a
 = ()
j
 * 
dnym1
;

840 
k
 = 0; k < 
grid_pošts
[2]; k++) {

841 
z‘a
 = ()
k
 * 
dnzm1
;

842 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

843 
m
 = 0; m < 5; m++) {

844 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

853 
i
 = 
grid_pošts
[0]-1;

854 
xi
 = 1.0;

855 #´agm¨
omp
 

856 
j
 = 0; j < 
grid_pošts
[1]; j++) {

857 
‘a
 = ()
j
 * 
dnym1
;

858 
k
 = 0; k < 
grid_pošts
[2]; k++) {

859 
z‘a
 = ()
k
 * 
dnzm1
;

860 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

861 
m
 = 0; m < 5; m++) {

862 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

870 
j
 = 0;

871 
‘a
 = 0.0;

872 #´agm¨
omp
 
nowa™


873 
i
 = 0; i < 
grid_pošts
[0]; i++) {

874 
xi
 = ()
i
 * 
dnxm1
;

875 
k
 = 0; k < 
grid_pošts
[2]; k++) {

876 
z‘a
 = ()
k
 * 
dnzm1
;

877 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

878 
m
 = 0; m < 5; m++) {

879 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

887 
j
 = 
grid_pošts
[1]-1;

888 
‘a
 = 1.0;

889 #´agm¨
omp
 

890 
i
 = 0; i < 
grid_pošts
[0]; i++) {

891 
xi
 = ()
i
 * 
dnxm1
;

892 
k
 = 0; k < 
grid_pošts
[2]; k++) {

893 
z‘a
 = ()
k
 * 
dnzm1
;

894 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

895 
m
 = 0; m < 5; m++) {

896 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

904 
k
 = 0;

905 
z‘a
 = 0.0;

906 #´agm¨
omp
 
nowa™


907 
i
 = 0; i < 
grid_pošts
[0]; i++) {

908 
xi
 = ()
i
 *
dnxm1
;

909 
j
 = 0; j < 
grid_pošts
[1]; j++) {

910 
‘a
 = ()
j
 * 
dnym1
;

911 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

912 
m
 = 0; m < 5; m++) {

913 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

921 
k
 = 
grid_pošts
[2]-1;

922 
z‘a
 = 1.0;

923 #´agm¨
omp
 

924 
i
 = 0; i < 
grid_pošts
[0]; i++) {

925 
xi
 = ()
i
 * 
dnxm1
;

926 
j
 = 0; j < 
grid_pošts
[1]; j++) {

927 
‘a
 = ()
j
 * 
dnym1
;

928 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

929 
m
 = 0; m < 5; m++) {

930 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

936 
	}
}

940 
	$lhsš™
() {

942 #´agm¨
omp
 
·¿Î–


944 
i
, 
j
, 
k
, 
m
, 
n
;

952 #´agm¨
omp
 

953 
i
 = 0; i < 
grid_pošts
[0]; i++) {

954 
j
 = 0; j < 
grid_pošts
[1]; j++) {

955 
k
 = 0; k < 
grid_pošts
[2]; k++) {

956 
m
 = 0; m < 5; m++) {

957 
n
 = 0;‚ < 5;‚++) {

958 
lhs
[
i
][
j
][
k
][0][
m
][
n
] = 0.0;

959 
lhs
[
i
][
j
][
k
][1][
m
][
n
] = 0.0;

960 
lhs
[
i
][
j
][
k
][2][
m
][
n
] = 0.0;

970 #´agm¨
omp
 

971 
i
 = 0; i < 
grid_pošts
[0]; i++) {

972 
j
 = 0; j < 
grid_pošts
[1]; j++) {

973 
k
 = 0; k < 
grid_pošts
[2]; k++) {

974 
m
 = 0; m < 5; m++) {

975 
lhs
[
i
][
j
][
k
][1][
m
][m] = 1.0;

982 
	}
}

986 
	$lhsx
() {

995 
i
, 
j
, 
k
;

1000 #´agm¨
omp
 

1001 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1002 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1003 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1005 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1006 
tmp2
 = 
tmp1
 *mp1;

1007 
tmp3
 = 
tmp1
 * 
tmp2
;

1011 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

1012 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 1.0;

1013 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 0.0;

1014 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

1015 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

1017 
fjac
[ 
i
][ 
j
][ 
k
][1][0] = -(
u
[i][j][k][1] * 
tmp2
 *

1018 
u
[
i
][
j
][
k
][1])

1019 + 
c2
 * 0.50 * (
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1020 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1021 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
;

1022 
fjac
[
i
][
j
][
k
][1][1] = ( 2.0 - 
c2
 )

1023 * ( 
u
[
i
][
j
][
k
][1] / u[i][j][k][0] );

1024 
fjac
[
i
][
j
][
k
][1][2] = - 
c2
 * ( 
u
[i][j][k][2] * 
tmp1
 );

1025 
fjac
[
i
][
j
][
k
][1][3] = - 
c2
 * ( 
u
[i][j][k][3] * 
tmp1
 );

1026 
fjac
[
i
][
j
][
k
][1][4] = 
c2
;

1028 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] ) * 
tmp2
;

1029 
fjac
[
i
][
j
][
k
][2][1] = 
u
[i][j][k][2] * 
tmp1
;

1030 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][1] * 
tmp1
;

1031 
fjac
[
i
][
j
][
k
][2][3] = 0.0;

1032 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1034 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] ) * 
tmp2
;

1035 
fjac
[
i
][
j
][
k
][3][1] = 
u
[i][j][k][3] * 
tmp1
;

1036 
fjac
[
i
][
j
][
k
][3][2] = 0.0;

1037 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][1] * 
tmp1
;

1038 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1040 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1041 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1042 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2


1043 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1044 * ( 
u
[
i
][
j
][
k
][1] * 
tmp1
 );

1045 
fjac
[
i
][
j
][
k
][4][1] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1046 - 0.50 * 
c2


1047 * ( 3.0*
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1048 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1049 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
tmp2
;

1050 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][1] )

1051 * 
tmp2
;

1052 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][3]*u[i][j][k][1] )

1053 * 
tmp2
;

1054 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * ( 
u
[i][j][k][1] * 
tmp1
 );

1056 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1057 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1058 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1059 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1060 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1062 
njac
[
i
][
j
][
k
][1][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1063 
njac
[
i
][
j
][
k
][1][1] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1064 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1065 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1066 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1068 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1069 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1070 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1071 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1072 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1074 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1075 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1076 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1077 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1078 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1080 
njac
[
i
][
j
][
k
][4][0] = - ( 
cÚ43
 * 
c3c4


1081 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1082 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1083 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1084 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1086 
njac
[
i
][
j
][
k
][4][1] = ( 
cÚ43
 * 
c3c4


1087 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1];

1088 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1089 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1090 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1096 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1098 
tmp1
 = 
dt
 * 
tx1
;

1099 
tmp2
 = 
dt
 * 
tx2
;

1101 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i-1][j][k][0][0]

1102 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][0]

1103 - 
tmp1
 * 
dx1
;

1104 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i-1][j][k][0][1]

1105 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][1];

1106 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i-1][j][k][0][2]

1107 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][2];

1108 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i-1][j][k][0][3]

1109 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][3];

1110 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i-1][j][k][0][4]

1111 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][4];

1113 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i-1][j][k][1][0]

1114 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][0];

1115 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i-1][j][k][1][1]

1116 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][1]

1117 - 
tmp1
 * 
dx2
;

1118 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i-1][j][k][1][2]

1119 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][2];

1120 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i-1][j][k][1][3]

1121 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][3];

1122 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i-1][j][k][1][4]

1123 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][4];

1125 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i-1][j][k][2][0]

1126 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][0];

1127 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i-1][j][k][2][1]

1128 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][1];

1129 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i-1][j][k][2][2]

1130 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][2]

1131 - 
tmp1
 * 
dx3
;

1132 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i-1][j][k][2][3]

1133 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][3];

1134 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i-1][j][k][2][4]

1135 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][4];

1137 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i-1][j][k][3][0]

1138 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][0];

1139 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i-1][j][k][3][1]

1140 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][1];

1141 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i-1][j][k][3][2]

1142 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][2];

1143 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i-1][j][k][3][3]

1144 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][3]

1145 - 
tmp1
 * 
dx4
;

1146 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i-1][j][k][3][4]

1147 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][4];

1149 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i-1][j][k][4][0]

1150 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][0];

1151 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i-1][j][k][4][1]

1152 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][1];

1153 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i-1][j][k][4][2]

1154 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][2];

1155 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i-1][j][k][4][3]

1156 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][3];

1157 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i-1][j][k][4][4]

1158 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][4]

1159 - 
tmp1
 * 
dx5
;

1161 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1162 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1163 + 
tmp1
 * 2.0 * 
dx1
;

1164 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1165 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1166 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1167 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1169 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1170 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1171 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1172 + 
tmp1
 * 2.0 * 
dx2
;

1173 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1174 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1175 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1177 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1178 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1179 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1180 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1181 + 
tmp1
 * 2.0 * 
dx3
;

1182 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1183 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1185 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1186 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1187 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1188 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1189 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1190 + 
tmp1
 * 2.0 * 
dx4
;

1191 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1193 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1194 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1195 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1196 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1197 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1198 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1199 + 
tmp1
 * 2.0 * 
dx5
;

1201 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i+1][j][k][0][0]

1202 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][0]

1203 - 
tmp1
 * 
dx1
;

1204 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i+1][j][k][0][1]

1205 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][1];

1206 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i+1][j][k][0][2]

1207 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][2];

1208 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i+1][j][k][0][3]

1209 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][3];

1210 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i+1][j][k][0][4]

1211 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][4];

1213 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i+1][j][k][1][0]

1214 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][0];

1215 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i+1][j][k][1][1]

1216 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][1]

1217 - 
tmp1
 * 
dx2
;

1218 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i+1][j][k][1][2]

1219 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][2];

1220 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i+1][j][k][1][3]

1221 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][3];

1222 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i+1][j][k][1][4]

1223 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][4];

1225 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i+1][j][k][2][0]

1226 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][0];

1227 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i+1][j][k][2][1]

1228 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][1];

1229 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i+1][j][k][2][2]

1230 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][2]

1231 - 
tmp1
 * 
dx3
;

1232 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i+1][j][k][2][3]

1233 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][3];

1234 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i+1][j][k][2][4]

1235 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][4];

1237 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i+1][j][k][3][0]

1238 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][0];

1239 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i+1][j][k][3][1]

1240 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][1];

1241 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i+1][j][k][3][2]

1242 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][2];

1243 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i+1][j][k][3][3]

1244 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][3]

1245 - 
tmp1
 * 
dx4
;

1246 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i+1][j][k][3][4]

1247 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][4];

1249 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i+1][j][k][4][0]

1250 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][0];

1251 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i+1][j][k][4][1]

1252 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][1];

1253 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i+1][j][k][4][2]

1254 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][2];

1255 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i+1][j][k][4][3]

1256 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][3];

1257 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i+1][j][k][4][4]

1258 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][4]

1259 - 
tmp1
 * 
dx5
;

1264 
	}
}

1269 
	$lhsy
() {

1278 
i
, 
j
, 
k
;

1284 #´agm¨
omp
 

1285 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1286 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1287 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1289 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1290 
tmp2
 = 
tmp1
 *mp1;

1291 
tmp3
 = 
tmp1
 * 
tmp2
;

1293 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

1294 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 0.0;

1295 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 1.0;

1296 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

1297 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

1299 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] )

1300 * 
tmp2
;

1301 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][2] * 
tmp1
;

1302 
fjac
[
i
][
j
][
k
][1][2] = 
u
[i][j][k][1] * 
tmp1
;

1303 
fjac
[
i
][
j
][
k
][1][3] = 0.0;

1304 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1306 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][2]*
tmp2
)

1307 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1308 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1309 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1310 * 
tmp2
 );

1311 
fjac
[
i
][
j
][
k
][2][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1312 
fjac
[
i
][
j
][
k
][2][2] = ( 2.0 - 
c2
 )

1313 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1314 
fjac
[
i
][
j
][
k
][2][3] = - 
c2
 * 
u
[i][j][k][3] * 
tmp1
;

1315 
fjac
[
i
][
j
][
k
][2][4] = 
c2
;

1317 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1318 * 
tmp2
;

1319 
fjac
[
i
][
j
][
k
][3][1] = 0.0;

1320 
fjac
[
i
][
j
][
k
][3][2] = 
u
[i][j][k][3] * 
tmp1
;

1321 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][2] * 
tmp1
;

1322 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1324 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1325 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1326 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1327 * 
tmp2


1328 - 
c1
 * 
u
[
i
][
j
][
k
][4] * 
tmp1
 )

1329 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1330 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * 
u
[i][j][k][1]*u[i][j][k][2]

1331 * 
tmp2
;

1332 
fjac
[
i
][
j
][
k
][4][2] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1333 - 0.50 * 
c2


1334 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1335 + 3.0 * 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1336 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1337 * 
tmp2
 );

1338 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1339 * 
tmp2
;

1340 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][2] * 
tmp1
;

1342 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1343 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1344 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1345 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1346 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1348 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1349 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1350 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1351 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1352 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1354 
njac
[
i
][
j
][
k
][2][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1355 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1356 
njac
[
i
][
j
][
k
][2][2] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1357 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1358 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1360 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1361 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1362 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1363 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1364 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1366 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1367 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1368 - ( 
cÚ43
 * 
c3c4


1369 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1370 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1371 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1373 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1374 
njac
[
i
][
j
][
k
][4][2] = ( 
cÚ43
 * 
c3c4


1375 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2];

1376 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1377 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1386 #´agm¨
omp
 

1387 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1388 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1389 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1391 
tmp1
 = 
dt
 * 
ty1
;

1392 
tmp2
 = 
dt
 * 
ty2
;

1394 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j-1][k][0][0]

1395 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][0]

1396 - 
tmp1
 * 
dy1
;

1397 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j-1][k][0][1]

1398 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][1];

1399 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j-1][k][0][2]

1400 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][2];

1401 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j-1][k][0][3]

1402 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][3];

1403 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j-1][k][0][4]

1404 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][4];

1406 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j-1][k][1][0]

1407 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][0];

1408 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j-1][k][1][1]

1409 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][1]

1410 - 
tmp1
 * 
dy2
;

1411 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j-1][k][1][2]

1412 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][2];

1413 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j-1][k][1][3]

1414 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][3];

1415 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j-1][k][1][4]

1416 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][4];

1418 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j-1][k][2][0]

1419 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][0];

1420 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j-1][k][2][1]

1421 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][1];

1422 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j-1][k][2][2]

1423 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][2]

1424 - 
tmp1
 * 
dy3
;

1425 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j-1][k][2][3]

1426 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][3];

1427 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j-1][k][2][4]

1428 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][4];

1430 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j-1][k][3][0]

1431 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][0];

1432 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j-1][k][3][1]

1433 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][1];

1434 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j-1][k][3][2]

1435 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][2];

1436 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j-1][k][3][3]

1437 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][3]

1438 - 
tmp1
 * 
dy4
;

1439 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j-1][k][3][4]

1440 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][4];

1442 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j-1][k][4][0]

1443 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][0];

1444 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j-1][k][4][1]

1445 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][1];

1446 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j-1][k][4][2]

1447 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][2];

1448 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j-1][k][4][3]

1449 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][3];

1450 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j-1][k][4][4]

1451 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][4]

1452 - 
tmp1
 * 
dy5
;

1454 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1455 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1456 + 
tmp1
 * 2.0 * 
dy1
;

1457 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1458 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1459 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1460 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1462 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1463 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1464 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1465 + 
tmp1
 * 2.0 * 
dy2
;

1466 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1467 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1468 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1470 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1471 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1472 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1473 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1474 + 
tmp1
 * 2.0 * 
dy3
;

1475 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1476 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1478 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1479 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1480 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1481 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1482 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1483 + 
tmp1
 * 2.0 * 
dy4
;

1484 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1486 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1487 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1488 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1489 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1490 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1491 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1492 + 
tmp1
 * 2.0 * 
dy5
;

1494 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j+1][k][0][0]

1495 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][0]

1496 - 
tmp1
 * 
dy1
;

1497 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j+1][k][0][1]

1498 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][1];

1499 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j+1][k][0][2]

1500 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][2];

1501 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j+1][k][0][3]

1502 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][3];

1503 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j+1][k][0][4]

1504 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][4];

1506 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j+1][k][1][0]

1507 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][0];

1508 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j+1][k][1][1]

1509 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][1]

1510 - 
tmp1
 * 
dy2
;

1511 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j+1][k][1][2]

1512 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][2];

1513 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j+1][k][1][3]

1514 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][3];

1515 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j+1][k][1][4]

1516 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][4];

1518 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j+1][k][2][0]

1519 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][0];

1520 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j+1][k][2][1]

1521 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][1];

1522 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j+1][k][2][2]

1523 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][2]

1524 - 
tmp1
 * 
dy3
;

1525 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j+1][k][2][3]

1526 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][3];

1527 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j+1][k][2][4]

1528 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][4];

1530 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j+1][k][3][0]

1531 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][0];

1532 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j+1][k][3][1]

1533 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][1];

1534 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j+1][k][3][2]

1535 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][2];

1536 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j+1][k][3][3]

1537 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][3]

1538 - 
tmp1
 * 
dy4
;

1539 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j+1][k][3][4]

1540 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][4];

1542 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j+1][k][4][0]

1543 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][0];

1544 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j+1][k][4][1]

1545 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][1];

1546 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j+1][k][4][2]

1547 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][2];

1548 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j+1][k][4][3]

1549 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][3];

1550 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j+1][k][4][4]

1551 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][4]

1552 - 
tmp1
 * 
dy5
;

1557 
	}
}

1563 
	$lhsz
() {

1572 
i
, 
j
, 
k
;

1578 #´agm¨
omp
 

1579 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1580 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1581 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1583 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1584 
tmp2
 = 
tmp1
 *mp1;

1585 
tmp3
 = 
tmp1
 * 
tmp2
;

1587 
fjac
[
i
][
j
][
k
][0][0] = 0.0;

1588 
fjac
[
i
][
j
][
k
][0][1] = 0.0;

1589 
fjac
[
i
][
j
][
k
][0][2] = 0.0;

1590 
fjac
[
i
][
j
][
k
][0][3] = 1.0;

1591 
fjac
[
i
][
j
][
k
][0][4] = 0.0;

1593 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] )

1594 * 
tmp2
;

1595 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][3] * 
tmp1
;

1596 
fjac
[
i
][
j
][
k
][1][2] = 0.0;

1597 
fjac
[
i
][
j
][
k
][1][3] = 
u
[i][j][k][1] * 
tmp1
;

1598 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1600 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1601 * 
tmp2
;

1602 
fjac
[
i
][
j
][
k
][2][1] = 0.0;

1603 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][3] * 
tmp1
;

1604 
fjac
[
i
][
j
][
k
][2][3] = 
u
[i][j][k][2] * 
tmp1
;

1605 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1607 
fjac
[
i
][
j
][
k
][3][0] = - (
u
[i][j][k][3]*u[i][j][k][3] * 
tmp2
 )

1608 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1609 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1610 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
 );

1611 
fjac
[
i
][
j
][
k
][3][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1612 
fjac
[
i
][
j
][
k
][3][2] = - 
c2
 * 
u
[i][j][k][2] * 
tmp1
;

1613 
fjac
[
i
][
j
][
k
][3][3] = ( 2.0 - 
c2
 )

1614 * 
u
[
i
][
j
][
k
][3] * 
tmp1
;

1615 
fjac
[
i
][
j
][
k
][3][4] = 
c2
;

1617 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1618 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1619 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1620 * 
tmp2


1621 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1622 * ( 
u
[
i
][
j
][
k
][3] * 
tmp1
 );

1623 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * ( 
u
[i][j][k][1]*u[i][j][k][3] )

1624 * 
tmp2
;

1625 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1626 * 
tmp2
;

1627 
fjac
[
i
][
j
][
k
][4][3] = 
c1
 * ( 
u
[i][j][k][4] * 
tmp1
 )

1628 - 0.50 * 
c2


1629 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1630 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1631 + 3.0*
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1632 * 
tmp2
 );

1633 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][3] * 
tmp1
;

1635 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1636 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1637 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1638 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1639 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1641 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1642 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1643 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1644 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1645 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1647 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1648 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1649 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1650 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1651 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1653 
njac
[
i
][
j
][
k
][3][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1654 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1655 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1656 
njac
[
i
][
j
][
k
][3][3] = 
cÚ43
 * 
c3
 * 
c4
 * 
tmp1
;

1657 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1659 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1660 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1661 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1662 - ( 
cÚ43
 * 
c3c4


1663 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1664 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1666 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1667 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1668 
njac
[
i
][
j
][
k
][4][3] = ( 
cÚ43
 * 
c3c4


1669 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3];

1670 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 )* 
tmp1
;

1679 #´agm¨
omp
 

1680 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1681 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1682 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1684 
tmp1
 = 
dt
 * 
tz1
;

1685 
tmp2
 = 
dt
 * 
tz2
;

1687 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j][k-1][0][0]

1688 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][0]

1689 - 
tmp1
 * 
dz1
;

1690 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j][k-1][0][1]

1691 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][1];

1692 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j][k-1][0][2]

1693 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][2];

1694 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j][k-1][0][3]

1695 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][3];

1696 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j][k-1][0][4]

1697 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][4];

1699 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j][k-1][1][0]

1700 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][0];

1701 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j][k-1][1][1]

1702 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][1]

1703 - 
tmp1
 * 
dz2
;

1704 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j][k-1][1][2]

1705 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][2];

1706 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j][k-1][1][3]

1707 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][3];

1708 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j][k-1][1][4]

1709 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][4];

1711 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j][k-1][2][0]

1712 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][0];

1713 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j][k-1][2][1]

1714 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][1];

1715 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j][k-1][2][2]

1716 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][2]

1717 - 
tmp1
 * 
dz3
;

1718 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j][k-1][2][3]

1719 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][3];

1720 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j][k-1][2][4]

1721 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][4];

1723 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j][k-1][3][0]

1724 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][0];

1725 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j][k-1][3][1]

1726 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][1];

1727 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j][k-1][3][2]

1728 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][2];

1729 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j][k-1][3][3]

1730 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][3]

1731 - 
tmp1
 * 
dz4
;

1732 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j][k-1][3][4]

1733 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][4];

1735 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j][k-1][4][0]

1736 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][0];

1737 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j][k-1][4][1]

1738 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][1];

1739 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j][k-1][4][2]

1740 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][2];

1741 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j][k-1][4][3]

1742 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][3];

1743 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j][k-1][4][4]

1744 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][4]

1745 - 
tmp1
 * 
dz5
;

1747 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1748 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1749 + 
tmp1
 * 2.0 * 
dz1
;

1750 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1751 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1752 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1753 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1755 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1756 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1757 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1758 + 
tmp1
 * 2.0 * 
dz2
;

1759 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1760 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1761 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1763 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1764 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1765 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1766 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1767 + 
tmp1
 * 2.0 * 
dz3
;

1768 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1769 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1771 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1772 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1773 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1774 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1775 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1776 + 
tmp1
 * 2.0 * 
dz4
;

1777 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1779 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1780 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1781 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1782 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1783 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1784 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1785 + 
tmp1
 * 2.0 * 
dz5
;

1787 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j][k+1][0][0]

1788 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][0]

1789 - 
tmp1
 * 
dz1
;

1790 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j][k+1][0][1]

1791 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][1];

1792 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j][k+1][0][2]

1793 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][2];

1794 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j][k+1][0][3]

1795 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][3];

1796 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j][k+1][0][4]

1797 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][4];

1799 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j][k+1][1][0]

1800 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][0];

1801 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j][k+1][1][1]

1802 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][1]

1803 - 
tmp1
 * 
dz2
;

1804 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j][k+1][1][2]

1805 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][2];

1806 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j][k+1][1][3]

1807 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][3];

1808 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j][k+1][1][4]

1809 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][4];

1811 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j][k+1][2][0]

1812 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][0];

1813 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j][k+1][2][1]

1814 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][1];

1815 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j][k+1][2][2]

1816 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][2]

1817 - 
tmp1
 * 
dz3
;

1818 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j][k+1][2][3]

1819 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][3];

1820 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j][k+1][2][4]

1821 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][4];

1823 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j][k+1][3][0]

1824 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][0];

1825 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j][k+1][3][1]

1826 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][1];

1827 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j][k+1][3][2]

1828 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][2];

1829 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j][k+1][3][3]

1830 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][3]

1831 - 
tmp1
 * 
dz4
;

1832 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j][k+1][3][4]

1833 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][4];

1835 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j][k+1][4][0]

1836 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][0];

1837 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j][k+1][4][1]

1838 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][1];

1839 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j][k+1][4][2]

1840 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][2];

1841 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j][k+1][4][3]

1842 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][3];

1843 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j][k+1][4][4]

1844 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][4]

1845 - 
tmp1
 * 
dz5
;

1850 
	}
}

1855 
	$compu‹_rhs
() {

1857 
i
, 
j
, 
k
, 
m
;

1858 
rho_šv
, 
uijk
, 
up1
, 
um1
, 
vijk
, 
vp1
, 
vm1
, 
wijk
, 
wp1
, 
wm1
;

1864 #´agm¨
omp
 
nowa™


1865 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1866 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1867 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1868 
rho_šv
 = 1.0/
u
[
i
][
j
][
k
][0];

1869 
rho_i
[
i
][
j
][
k
] = 
rho_šv
;

1870 
us
[
i
][
j
][
k
] = 
u
[i][j][k][1] * 
rho_šv
;

1871 
vs
[
i
][
j
][
k
] = 
u
[i][j][k][2] * 
rho_šv
;

1872 
ws
[
i
][
j
][
k
] = 
u
[i][j][k][3] * 
rho_šv
;

1873 
squ¬e
[
i
][
j
][
k
] = 0.5 * (
u
[i][j][k][1]*u[i][j][k][1] +

1874 
u
[
i
][
j
][
k
][2]*u[i][j][k][2] +

1875 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
rho_šv
;

1876 
qs
[
i
][
j
][
k
] = 
squ¬e
[i][j][k] * 
rho_šv
;

1887 #´agm¨
omp
 

1888 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1889 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1890 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1891 
m
 = 0; m < 5; m++) {

1892 
rhs
[
i
][
j
][
k
][
m
] = 
fÜcšg
[i][j][k][m];

1901 #´agm¨
omp
 

1902 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1903 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1904 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1905 
uijk
 = 
us
[
i
][
j
][
k
];

1906 
up1
 = 
us
[
i
+1][
j
][
k
];

1907 
um1
 = 
us
[
i
-1][
j
][
k
];

1909 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dx1tx1
 *

1910 (
u
[
i
+1][
j
][
k
][0] - 2.0*u[i][j][k][0] +

1911 
u
[
i
-1][
j
][
k
][0]) -

1912 
tx2
 * (
u
[
i
+1][
j
][
k
][1] - u[i-1][j][k][1]);

1914 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dx2tx1
 *

1915 (
u
[
i
+1][
j
][
k
][1] - 2.0*u[i][j][k][1] +

1916 
u
[
i
-1][
j
][
k
][1]) +

1917 
xxcÚ2
*
cÚ43
 * (
up1
 - 2.0*
uijk
 + 
um1
) -

1918 
tx2
 * (
u
[
i
+1][
j
][
k
][1]*
up1
 -

1919 
u
[
i
-1][
j
][
k
][1]*
um1
 +

1920 (
u
[
i
+1][
j
][
k
][4]- 
squ¬e
[i+1][j][k]-

1921 
u
[
i
-1][
j
][
k
][4]+ 
squ¬e
[i-1][j][k])*

1922 
c2
);

1924 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dx3tx1
 *

1925 (
u
[
i
+1][
j
][
k
][2] - 2.0*u[i][j][k][2] +

1926 
u
[
i
-1][
j
][
k
][2]) +

1927 
xxcÚ2
 * (
vs
[
i
+1][
j
][
k
] - 2.0*vs[i][j][k] +

1928 
vs
[
i
-1][
j
][
k
]) -

1929 
tx2
 * (
u
[
i
+1][
j
][
k
][2]*
up1
 -

1930 
u
[
i
-1][
j
][
k
][2]*
um1
);

1932 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dx4tx1
 *

1933 (
u
[
i
+1][
j
][
k
][3] - 2.0*u[i][j][k][3] +

1934 
u
[
i
-1][
j
][
k
][3]) +

1935 
xxcÚ2
 * (
ws
[
i
+1][
j
][
k
] - 2.0*ws[i][j][k] +

1936 
ws
[
i
-1][
j
][
k
]) -

1937 
tx2
 * (
u
[
i
+1][
j
][
k
][3]*
up1
 -

1938 
u
[
i
-1][
j
][
k
][3]*
um1
);

1940 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dx5tx1
 *

1941 (
u
[
i
+1][
j
][
k
][4] - 2.0*u[i][j][k][4] +

1942 
u
[
i
-1][
j
][
k
][4]) +

1943 
xxcÚ3
 * (
qs
[
i
+1][
j
][
k
] - 2.0*qs[i][j][k] +

1944 
qs
[
i
-1][
j
][
k
]) +

1945 
xxcÚ4
 * (
up1
*up1 - 2.0*
uijk
*uijk +

1946 
um1
*um1) +

1947 
xxcÚ5
 * (
u
[
i
+1][
j
][
k
][4]*
rho_i
[i+1][j][k] -

1948 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

1949 
u
[
i
-1][
j
][
k
][4]*
rho_i
[i-1][j][k]) -

1950 
tx2
 * ( (
c1
*
u
[
i
+1][
j
][
k
][4] -

1951 
c2
*
squ¬e
[
i
+1][
j
][
k
])*
up1
 -

1952 (
c1
*
u
[
i
-1][
j
][
k
][4] -

1953 
c2
*
squ¬e
[
i
-1][
j
][
k
])*
um1
 );

1961 
i
 = 1;

1962 #´agm¨
omp
 
nowa™


1963 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1964 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1965 
m
 = 0; m < 5; m++) {

1966 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

1967 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1968 
u
[
i
+2][
j
][
k
][
m
]);

1973 
i
 = 2;

1974 #´agm¨
omp
 
nowa™


1975 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1976 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1977 
m
 = 0; m < 5; m++) {

1978 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1979 (-4.0*
u
[
i
-1][
j
][
k
][
m
] + 6.0*u[i][j][k][m] -

1980 4.0*
u
[
i
+1][
j
][
k
][
m
] + u[i+2][j][k][m]);

1985 #´agm¨
omp
 
nowa™


1986 
i
 = 3; i < 
grid_pošts
[0]-3; i++) {

1987 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1988 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1989 
m
 = 0; m < 5; m++) {

1990 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1991 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1992 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1993 
u
[
i
+2][
j
][
k
][
m
] );

1999 
i
 = 
grid_pošts
[0]-3;

2000 #´agm¨
omp
 
nowa™


2001 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2002 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2003 
m
 = 0; m < 5; m++) {

2004 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2005 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

2006 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] );

2011 
i
 = 
grid_pošts
[0]-2;

2012 #´agm¨
omp
 

2013 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2014 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2015 
m
 = 0; m < 5; m++) {

2016 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2017 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.*u[i-1][j][k][m] +

2018 5.0*
u
[
i
][
j
][
k
][
m
] );

2026 #´agm¨
omp
 

2027 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2028 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2029 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2030 
vijk
 = 
vs
[
i
][
j
][
k
];

2031 
vp1
 = 
vs
[
i
][
j
+1][
k
];

2032 
vm1
 = 
vs
[
i
][
j
-1][
k
];

2033 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dy1ty1
 *

2034 (
u
[
i
][
j
+1][
k
][0] - 2.0*u[i][j][k][0] +

2035 
u
[
i
][
j
-1][
k
][0]) -

2036 
ty2
 * (
u
[
i
][
j
+1][
k
][2] - u[i][j-1][k][2]);

2037 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dy2ty1
 *

2038 (
u
[
i
][
j
+1][
k
][1] - 2.0*u[i][j][k][1] +

2039 
u
[
i
][
j
-1][
k
][1]) +

2040 
yycÚ2
 * (
us
[
i
][
j
+1][
k
] - 2.0*us[i][j][k] +

2041 
us
[
i
][
j
-1][
k
]) -

2042 
ty2
 * (
u
[
i
][
j
+1][
k
][1]*
vp1
 -

2043 
u
[
i
][
j
-1][
k
][1]*
vm1
);

2044 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dy3ty1
 *

2045 (
u
[
i
][
j
+1][
k
][2] - 2.0*u[i][j][k][2] +

2046 
u
[
i
][
j
-1][
k
][2]) +

2047 
yycÚ2
*
cÚ43
 * (
vp1
 - 2.0*
vijk
 + 
vm1
) -

2048 
ty2
 * (
u
[
i
][
j
+1][
k
][2]*
vp1
 -

2049 
u
[
i
][
j
-1][
k
][2]*
vm1
 +

2050 (
u
[
i
][
j
+1][
k
][4] - 
squ¬e
[i][j+1][k] -

2051 
u
[
i
][
j
-1][
k
][4] + 
squ¬e
[i][j-1][k])

2052 *
c2
);

2053 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dy4ty1
 *

2054 (
u
[
i
][
j
+1][
k
][3] - 2.0*u[i][j][k][3] +

2055 
u
[
i
][
j
-1][
k
][3]) +

2056 
yycÚ2
 * (
ws
[
i
][
j
+1][
k
] - 2.0*ws[i][j][k] +

2057 
ws
[
i
][
j
-1][
k
]) -

2058 
ty2
 * (
u
[
i
][
j
+1][
k
][3]*
vp1
 -

2059 
u
[
i
][
j
-1][
k
][3]*
vm1
);

2060 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dy5ty1
 *

2061 (
u
[
i
][
j
+1][
k
][4] - 2.0*u[i][j][k][4] +

2062 
u
[
i
][
j
-1][
k
][4]) +

2063 
yycÚ3
 * (
qs
[
i
][
j
+1][
k
] - 2.0*qs[i][j][k] +

2064 
qs
[
i
][
j
-1][
k
]) +

2065 
yycÚ4
 * (
vp1
*vp1 - 2.0*
vijk
*vijk +

2066 
vm1
*vm1) +

2067 
yycÚ5
 * (
u
[
i
][
j
+1][
k
][4]*
rho_i
[i][j+1][k] -

2068 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2069 
u
[
i
][
j
-1][
k
][4]*
rho_i
[i][j-1][k]) -

2070 
ty2
 * ((
c1
*
u
[
i
][
j
+1][
k
][4] -

2071 
c2
*
squ¬e
[
i
][
j
+1][
k
]è* 
vp1
 -

2072 (
c1
*
u
[
i
][
j
-1][
k
][4] -

2073 
c2
*
squ¬e
[
i
][
j
-1][
k
]è* 
vm1
);

2081 
j
 = 1;

2082 #´agm¨
omp
 
nowa™


2083 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2084 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2085 
m
 = 0; m < 5; m++) {

2086 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2087 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2088 
u
[
i
][
j
+2][
k
][
m
]);

2093 
j
 = 2;

2094 #´agm¨
omp
 
nowa™


2095 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2096 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2097 
m
 = 0; m < 5; m++) {

2098 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2099 (-4.0*
u
[
i
][
j
-1][
k
][
m
] + 6.0*u[i][j][k][m] -

2100 4.0*
u
[
i
][
j
+1][
k
][
m
] + u[i][j+2][k][m]);

2105 #´agm¨
omp
 
nowa™


2106 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2107 
j
 = 3; j < 
grid_pošts
[1]-3; j++) {

2108 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2109 
m
 = 0; m < 5; m++) {

2110 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2111 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2112 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2113 
u
[
i
][
j
+2][
k
][
m
] );

2119 
j
 = 
grid_pošts
[1]-3;

2120 #´agm¨
omp
 
nowa™


2121 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2122 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2123 
m
 = 0; m < 5; m++) {

2124 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2125 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2126 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] );

2131 
j
 = 
grid_pošts
[1]-2;

2132 #´agm¨
omp
 

2133 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2134 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2135 
m
 = 0; m < 5; m++) {

2136 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2137 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.*u[i][j-1][k][m] +

2138 5.*
u
[
i
][
j
][
k
][
m
] );

2146 #´agm¨
omp
 

2147 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2148 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2149 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2150 
wijk
 = 
ws
[
i
][
j
][
k
];

2151 
wp1
 = 
ws
[
i
][
j
][
k
+1];

2152 
wm1
 = 
ws
[
i
][
j
][
k
-1];

2154 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dz1tz1
 *

2155 (
u
[
i
][
j
][
k
+1][0] - 2.0*u[i][j][k][0] +

2156 
u
[
i
][
j
][
k
-1][0]) -

2157 
tz2
 * (
u
[
i
][
j
][
k
+1][3] - u[i][j][k-1][3]);

2158 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dz2tz1
 *

2159 (
u
[
i
][
j
][
k
+1][1] - 2.0*u[i][j][k][1] +

2160 
u
[
i
][
j
][
k
-1][1]) +

2161 
zzcÚ2
 * (
us
[
i
][
j
][
k
+1] - 2.0*us[i][j][k] +

2162 
us
[
i
][
j
][
k
-1]) -

2163 
tz2
 * (
u
[
i
][
j
][
k
+1][1]*
wp1
 -

2164 
u
[
i
][
j
][
k
-1][1]*
wm1
);

2165 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dz3tz1
 *

2166 (
u
[
i
][
j
][
k
+1][2] - 2.0*u[i][j][k][2] +

2167 
u
[
i
][
j
][
k
-1][2]) +

2168 
zzcÚ2
 * (
vs
[
i
][
j
][
k
+1] - 2.0*vs[i][j][k] +

2169 
vs
[
i
][
j
][
k
-1]) -

2170 
tz2
 * (
u
[
i
][
j
][
k
+1][2]*
wp1
 -

2171 
u
[
i
][
j
][
k
-1][2]*
wm1
);

2172 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dz4tz1
 *

2173 (
u
[
i
][
j
][
k
+1][3] - 2.0*u[i][j][k][3] +

2174 
u
[
i
][
j
][
k
-1][3]) +

2175 
zzcÚ2
*
cÚ43
 * (
wp1
 - 2.0*
wijk
 + 
wm1
) -

2176 
tz2
 * (
u
[
i
][
j
][
k
+1][3]*
wp1
 -

2177 
u
[
i
][
j
][
k
-1][3]*
wm1
 +

2178 (
u
[
i
][
j
][
k
+1][4] - 
squ¬e
[i][j][k+1] -

2179 
u
[
i
][
j
][
k
-1][4] + 
squ¬e
[i][j][k-1])

2180 *
c2
);

2181 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dz5tz1
 *

2182 (
u
[
i
][
j
][
k
+1][4] - 2.0*u[i][j][k][4] +

2183 
u
[
i
][
j
][
k
-1][4]) +

2184 
zzcÚ3
 * (
qs
[
i
][
j
][
k
+1] - 2.0*qs[i][j][k] +

2185 
qs
[
i
][
j
][
k
-1]) +

2186 
zzcÚ4
 * (
wp1
*wp1 - 2.0*
wijk
*wijk +

2187 
wm1
*wm1) +

2188 
zzcÚ5
 * (
u
[
i
][
j
][
k
+1][4]*
rho_i
[i][j][k+1] -

2189 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2190 
u
[
i
][
j
][
k
-1][4]*
rho_i
[i][j][k-1]) -

2191 
tz2
 * ( (
c1
*
u
[
i
][
j
][
k
+1][4] -

2192 
c2
*
squ¬e
[
i
][
j
][
k
+1])*
wp1
 -

2193 (
c1
*
u
[
i
][
j
][
k
-1][4] -

2194 
c2
*
squ¬e
[
i
][
j
][
k
-1])*
wm1
);

2202 
k
 = 1;

2203 #´agm¨
omp
 
nowa™


2204 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2205 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2206 
m
 = 0; m < 5; m++) {

2207 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2208 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2209 
u
[
i
][
j
][
k
+2][
m
]);

2214 
k
 = 2;

2215 #´agm¨
omp
 
nowa™


2216 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2217 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2218 
m
 = 0; m < 5; m++) {

2219 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2220 (-4.0*
u
[
i
][
j
][
k
-1][
m
] + 6.0*u[i][j][k][m] -

2221 4.0*
u
[
i
][
j
][
k
+1][
m
] + u[i][j][k+2][m]);

2226 #´agm¨
omp
 
nowa™


2227 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2228 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2229 
k
 = 3; k < 
grid_pošts
[2]-3; k++) {

2230 
m
 = 0; m < 5; m++) {

2231 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2232 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2233 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2234 
u
[
i
][
j
][
k
+2][
m
] );

2240 
k
 = 
grid_pošts
[2]-3;

2241 #´agm¨
omp
 
nowa™


2242 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2243 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2244 
m
 = 0; m < 5; m++) {

2245 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2246 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2247 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] );

2252 
k
 = 
grid_pošts
[2]-2;

2253 #´agm¨
omp
 

2254 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2255 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2256 
m
 = 0; m < 5; m++) {

2257 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2258 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2259 5.0*
u
[
i
][
j
][
k
][
m
] );

2264 #´agm¨
omp
 

2265 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2266 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2267 
m
 = 0; m < 5; m++) {

2268 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2269 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] * 
dt
;

2274 
	}
}

2279 
	$£t_cÚ¡ªts
() {

2284 
û
[0][0] = 2.0;

2285 
û
[0][1] = 0.0;

2286 
û
[0][2] = 0.0;

2287 
û
[0][3] = 4.0;

2288 
û
[0][4] = 5.0;

2289 
û
[0][5] = 3.0;

2290 
û
[0][6] = 0.5;

2291 
û
[0][7] = 0.02;

2292 
û
[0][8] = 0.01;

2293 
û
[0][9] = 0.03;

2294 
û
[0][10] = 0.5;

2295 
û
[0][11] = 0.4;

2296 
û
[0][12] = 0.3;

2298 
û
[1][0] = 1.0;

2299 
û
[1][1] = 0.0;

2300 
û
[1][2] = 0.0;

2301 
û
[1][3] = 0.0;

2302 
û
[1][4] = 1.0;

2303 
û
[1][5] = 2.0;

2304 
û
[1][6] = 3.0;

2305 
û
[1][7] = 0.01;

2306 
û
[1][8] = 0.03;

2307 
û
[1][9] = 0.02;

2308 
û
[1][10] = 0.4;

2309 
û
[1][11] = 0.3;

2310 
û
[1][12] = 0.5;

2312 
û
[2][0] = 2.0;

2313 
û
[2][1] = 2.0;

2314 
û
[2][2] = 0.0;

2315 
û
[2][3] = 0.0;

2316 
û
[2][4] = 0.0;

2317 
û
[2][5] = 2.0;

2318 
û
[2][6] = 3.0;

2319 
û
[2][7] = 0.04;

2320 
û
[2][8] = 0.03;

2321 
û
[2][9] = 0.05;

2322 
û
[2][10] = 0.3;

2323 
û
[2][11] = 0.5;

2324 
û
[2][12] = 0.4;

2326 
û
[3][0] = 2.0;

2327 
û
[3][1] = 2.0;

2328 
û
[3][2] = 0.0;

2329 
û
[3][3] = 0.0;

2330 
û
[3][4] = 0.0;

2331 
û
[3][5] = 2.0;

2332 
û
[3][6] = 3.0;

2333 
û
[3][7] = 0.03;

2334 
û
[3][8] = 0.05;

2335 
û
[3][9] = 0.04;

2336 
û
[3][10] = 0.2;

2337 
û
[3][11] = 0.1;

2338 
û
[3][12] = 0.3;

2340 
û
[4][0] = 5.0;

2341 
û
[4][1] = 4.0;

2342 
û
[4][2] = 3.0;

2343 
û
[4][3] = 2.0;

2344 
û
[4][4] = 0.1;

2345 
û
[4][5] = 0.4;

2346 
û
[4][6] = 0.3;

2347 
û
[4][7] = 0.05;

2348 
û
[4][8] = 0.04;

2349 
û
[4][9] = 0.03;

2350 
û
[4][10] = 0.1;

2351 
û
[4][11] = 0.3;

2352 
û
[4][12] = 0.2;

2354 
c1
 = 1.4;

2355 
c2
 = 0.4;

2356 
c3
 = 0.1;

2357 
c4
 = 1.0;

2358 
c5
 = 1.4;

2360 
dnxm1
 = 1.0 / ()(
grid_pošts
[0]-1);

2361 
dnym1
 = 1.0 / ()(
grid_pošts
[1]-1);

2362 
dnzm1
 = 1.0 / ()(
grid_pošts
[2]-1);

2364 
c1c2
 = 
c1
 * 
c2
;

2365 
c1c5
 = 
c1
 * 
c5
;

2366 
c3c4
 = 
c3
 * 
c4
;

2367 
c1345
 = 
c1c5
 * 
c3c4
;

2369 
cÚz1
 = (1.0-
c1c5
);

2371 
tx1
 = 1.0 / (
dnxm1
 * dnxm1);

2372 
tx2
 = 1.0 / (2.0 * 
dnxm1
);

2373 
tx3
 = 1.0 / 
dnxm1
;

2375 
ty1
 = 1.0 / (
dnym1
 * dnym1);

2376 
ty2
 = 1.0 / (2.0 * 
dnym1
);

2377 
ty3
 = 1.0 / 
dnym1
;

2379 
tz1
 = 1.0 / (
dnzm1
 * dnzm1);

2380 
tz2
 = 1.0 / (2.0 * 
dnzm1
);

2381 
tz3
 = 1.0 / 
dnzm1
;

2383 
dx1
 = 0.75;

2384 
dx2
 = 0.75;

2385 
dx3
 = 0.75;

2386 
dx4
 = 0.75;

2387 
dx5
 = 0.75;

2389 
dy1
 = 0.75;

2390 
dy2
 = 0.75;

2391 
dy3
 = 0.75;

2392 
dy4
 = 0.75;

2393 
dy5
 = 0.75;

2395 
dz1
 = 1.0;

2396 
dz2
 = 1.0;

2397 
dz3
 = 1.0;

2398 
dz4
 = 1.0;

2399 
dz5
 = 1.0;

2401 
dxmax
 = 
	`max
(
dx3
, 
dx4
);

2402 
dymax
 = 
	`max
(
dy2
, 
dy4
);

2403 
dzmax
 = 
	`max
(
dz2
, 
dz3
);

2405 
ds¥
 = 0.25 * 
	`max
(
dx1
, max(
dy1
, 
dz1
) );

2407 
c4ds¥
 = 4.0 * 
ds¥
;

2408 
c5ds¥
 = 5.0 * 
ds¥
;

2410 
d‰x1
 = 
dt
*
tx1
;

2411 
d‰x2
 = 
dt
*
tx2
;

2412 
d‰y1
 = 
dt
*
ty1
;

2413 
d‰y2
 = 
dt
*
ty2
;

2414 
d‰z1
 = 
dt
*
tz1
;

2415 
d‰z2
 = 
dt
*
tz2
;

2417 
c2d‰x1
 = 2.0*
d‰x1
;

2418 
c2d‰y1
 = 2.0*
d‰y1
;

2419 
c2d‰z1
 = 2.0*
d‰z1
;

2421 
dtds¥
 = 
dt
*
ds¥
;

2423 
comz1
 = 
dtds¥
;

2424 
comz4
 = 4.0*
dtds¥
;

2425 
comz5
 = 5.0*
dtds¥
;

2426 
comz6
 = 6.0*
dtds¥
;

2428 
c3c4tx3
 = 
c3c4
*
tx3
;

2429 
c3c4ty3
 = 
c3c4
*
ty3
;

2430 
c3c4tz3
 = 
c3c4
*
tz3
;

2432 
dx1tx1
 = 
dx1
*
tx1
;

2433 
dx2tx1
 = 
dx2
*
tx1
;

2434 
dx3tx1
 = 
dx3
*
tx1
;

2435 
dx4tx1
 = 
dx4
*
tx1
;

2436 
dx5tx1
 = 
dx5
*
tx1
;

2438 
dy1ty1
 = 
dy1
*
ty1
;

2439 
dy2ty1
 = 
dy2
*
ty1
;

2440 
dy3ty1
 = 
dy3
*
ty1
;

2441 
dy4ty1
 = 
dy4
*
ty1
;

2442 
dy5ty1
 = 
dy5
*
ty1
;

2444 
dz1tz1
 = 
dz1
*
tz1
;

2445 
dz2tz1
 = 
dz2
*
tz1
;

2446 
dz3tz1
 = 
dz3
*
tz1
;

2447 
dz4tz1
 = 
dz4
*
tz1
;

2448 
dz5tz1
 = 
dz5
*
tz1
;

2450 
c2iv
 = 2.5;

2451 
cÚ43
 = 4.0/3.0;

2452 
cÚ16
 = 1.0/6.0;

2454 
xxcÚ1
 = 
c3c4tx3
*
cÚ43
*
tx3
;

2455 
xxcÚ2
 = 
c3c4tx3
*
tx3
;

2456 
xxcÚ3
 = 
c3c4tx3
*
cÚz1
*
tx3
;

2457 
xxcÚ4
 = 
c3c4tx3
*
cÚ16
*
tx3
;

2458 
xxcÚ5
 = 
c3c4tx3
*
c1c5
*
tx3
;

2460 
yycÚ1
 = 
c3c4ty3
*
cÚ43
*
ty3
;

2461 
yycÚ2
 = 
c3c4ty3
*
ty3
;

2462 
yycÚ3
 = 
c3c4ty3
*
cÚz1
*
ty3
;

2463 
yycÚ4
 = 
c3c4ty3
*
cÚ16
*
ty3
;

2464 
yycÚ5
 = 
c3c4ty3
*
c1c5
*
ty3
;

2466 
zzcÚ1
 = 
c3c4tz3
*
cÚ43
*
tz3
;

2467 
zzcÚ2
 = 
c3c4tz3
*
tz3
;

2468 
zzcÚ3
 = 
c3c4tz3
*
cÚz1
*
tz3
;

2469 
zzcÚ4
 = 
c3c4tz3
*
cÚ16
*
tz3
;

2470 
zzcÚ5
 = 
c3c4tz3
*
c1c5
*
tz3
;

2471 
	}
}

2476 
	$v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
) {

2485 
xü»f
[5],
xû»f
[5],
xüdif
[5],
xûdif
[5],

2486 
•sÚ
, 
xû
[5], 
xü
[5], 
dŒef
;

2487 
m
;

2492 
•sÚ
 = 1.0e-08;

2498 
	`”rÜ_nÜm
(
xû
);

2499 
	`compu‹_rhs
();

2501 
	`rhs_nÜm
(
xü
);

2503 
m
 = 0; m < 5; m++) {

2504 
xü
[
m
] = xü[m] / 
dt
;

2507 *
şass
 = 'U';

2508 *
v”if›d
 = 
TRUE
;

2510 
m
 = 0; m < 5; m++) {

2511 
xü»f
[
m
] = 1.0;

2512 
xû»f
[
m
] = 1.0;

2518 ià(
grid_pošts
[0] == 12 &&

2519 
grid_pošts
[1] == 12 &&

2520 
grid_pošts
[2] == 12 &&

2521 
no_time_¡•s
 == 60) {

2523 *
şass
 = 'S';

2524 
dŒef
 = 1.0e-2;

2529 
xü»f
[0] = 1.7034283709541311e-01;

2530 
xü»f
[1] = 1.2975252070034097e-02;

2531 
xü»f
[2] = 3.2527926989486055e-02;

2532 
xü»f
[3] = 2.6436421275166801e-02;

2533 
xü»f
[4] = 1.9211784131744430e-01;

2538 
xû»f
[0] = 4.9976913345811579e-04;

2539 
xû»f
[1] = 4.5195666782961927e-05;

2540 
xû»f
[2] = 7.3973765172921357e-05;

2541 
xû»f
[3] = 7.3821238632439731e-05;

2542 
xû»f
[4] = 8.9269630987491446e-04;

2547 } ià(
grid_pošts
[0] == 24 &&

2548 
grid_pošts
[1] == 24 &&

2549 
grid_pošts
[2] == 24 &&

2550 
no_time_¡•s
 == 200) {

2552 *
şass
 = 'W';

2553 
dŒef
 = 0.8e-3;

2557 
xü»f
[0] = 0.1125590409344e+03;

2558 
xü»f
[1] = 0.1180007595731e+02;

2559 
xü»f
[2] = 0.2710329767846e+02;

2560 
xü»f
[3] = 0.2469174937669e+02;

2561 
xü»f
[4] = 0.2638427874317e+03;

2566 
xû»f
[0] = 0.4419655736008e+01;

2567 
xû»f
[1] = 0.4638531260002e+00;

2568 
xû»f
[2] = 0.1011551749967e+01;

2569 
xû»f
[3] = 0.9235878729944e+00;

2570 
xû»f
[4] = 0.1018045837718e+02;

2576 } ià(
grid_pošts
[0] == 64 &&

2577 
grid_pošts
[1] == 64 &&

2578 
grid_pošts
[2] == 64 &&

2579 
no_time_¡•s
 == 200) {

2581 *
şass
 = 'A';

2582 
dŒef
 = 0.8e-3;

2586 
xü»f
[0] = 1.0806346714637264e+02;

2587 
xü»f
[1] = 1.1319730901220813e+01;

2588 
xü»f
[2] = 2.5974354511582465e+01;

2589 
xü»f
[3] = 2.3665622544678910e+01;

2590 
xü»f
[4] = 2.5278963211748344e+02;

2595 
xû»f
[0] = 4.2348416040525025e+00;

2596 
xû»f
[1] = 4.4390282496995698e-01;

2597 
xû»f
[2] = 9.6692480136345650e-01;

2598 
xû»f
[3] = 8.8302063039765474e-01;

2599 
xû»f
[4] = 9.7379901770829278e+00;

2605 } ià(
grid_pošts
[0] == 102 &&

2606 
grid_pošts
[1] == 102 &&

2607 
grid_pošts
[2] == 102 &&

2608 
no_time_¡•s
 == 200) {

2610 *
şass
 = 'B';

2611 
dŒef
 = 3.0e-4;

2616 
xü»f
[0] = 1.4233597229287254e+03;

2617 
xü»f
[1] = 9.9330522590150238e+01;

2618 
xü»f
[2] = 3.5646025644535285e+02;

2619 
xü»f
[3] = 3.2485447959084092e+02;

2620 
xü»f
[4] = 3.2707541254659363e+03;

2625 
xû»f
[0] = 5.2969847140936856e+01;

2626 
xû»f
[1] = 4.4632896115670668e+00;

2627 
xû»f
[2] = 1.3122573342210174e+01;

2628 
xû»f
[3] = 1.2006925323559144e+01;

2629 
xû»f
[4] = 1.2459576151035986e+02;

2635 } ià(
grid_pošts
[0] == 162 &&

2636 
grid_pošts
[1] == 162 &&

2637 
grid_pošts
[2] == 162 &&

2638 
no_time_¡•s
 == 200) {

2640 *
şass
 = 'C';

2641 
dŒef
 = 1.0e-4;

2646 
xü»f
[0] = 0.62398116551764615e+04;

2647 
xü»f
[1] = 0.50793239190423964e+03;

2648 
xü»f
[2] = 0.15423530093013596e+04;

2649 
xü»f
[3] = 0.13302387929291190e+04;

2650 
xü»f
[4] = 0.11604087428436455e+05;

2655 
xû»f
[0] = 0.16462008369091265e+03;

2656 
xû»f
[1] = 0.11497107903824313e+02;

2657 
xû»f
[2] = 0.41207446207461508e+02;

2658 
xû»f
[3] = 0.37087651059694167e+02;

2659 
xû»f
[4] = 0.36211053051841265e+03;

2662 *
v”if›d
 = 
FALSE
;

2673 
m
 = 0; m < 5; m++) {

2675 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]);

2676 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

2684 ià(*
şass
 != 'U') {

2685 
	`´štf
(" V”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

2686 
	`´štf
("‡ccu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

2687 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

2688 *
v”if›d
 = 
FALSE
;

2689 *
şass
 = 'U';

2690 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

2693 
	`´štf
(" Unknown class\n");

2696 ià(*
şass
 != 'U') {

2697 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

2699 
	`´štf
(" RMS-norms of„esidual\n");

2701 
m
 = 0; m < 5; m++) {

2702 ià(*
şass
 == 'U') {

2703 
	`´štf
(" %2d%20.13e\n", 
m
, 
xü
[m]);

2704 } ià(
xüdif
[
m
] > 
•sÚ
) {

2705 *
v”if›d
 = 
FALSE
;

2706 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2707 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2709 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2710 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2714 ià(*
şass
 != 'U') {

2715 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

2717 
	`´štf
(" RMS-norms of solutionƒrror\n");

2720 
m
 = 0; m < 5; m++) {

2721 ià(*
şass
 == 'U') {

2722 
	`´štf
(" %2d%20.13e\n", 
m
, 
xû
[m]);

2723 } ià(
xûdif
[
m
] > 
•sÚ
) {

2724 *
v”if›d
 = 
FALSE
;

2725 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2726 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2728 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2729 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2733 ià(*
şass
 == 'U') {

2734 
	`´štf
(" No„eference values…rovided\n");

2735 
	`´štf
(" No verification…erformed\n");

2736 } ià(*
v”if›d
 =ğ
TRUE
) {

2737 
	`´štf
(" Verification Successful\n");

2739 
	`´štf
(" Verification failed\n");

2741 
	}
}

2746 
	$x_sŞve
() {

2763 
	`lhsx
();

2764 
	`x_sŞve_ûÎ
();

2765 
	`x_backsub¡™u‹
();

2766 
	}
}

2772 
	$x_backsub¡™u‹
() {

2784 
i
, 
j
, 
k
, 
m
, 
n
;

2786 
i
 = 
grid_pošts
[0]-2; i >= 0; i--) {

2787 #´agm¨
omp
 

2788 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2789 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2790 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

2791 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

2792 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

2793 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i+1][j][k][n];

2799 
	}
}

2804 
	$x_sŞve_ûÎ
() {

2816 
i
,
j
,
k
,
isize
;

2818 
isize
 = 
grid_pošts
[0]-1;

2823 #´agm¨
omp
 

2824 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2825 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2831 
	`bšvühs
Ğ
lhs
[0][
j
][
k
][
BB
],

2832 
lhs
[0][
j
][
k
][
CC
],

2833 
rhs
[0][
j
][
k
] );

2841 
i
 = 1; i < 
isize
; i++) {

2842 #´agm¨
omp
 

2843 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2844 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2849 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2850 
rhs
[
i
-1][
j
][
k
],„hs[i][j][k]);

2855 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2856 
lhs
[
i
-1][
j
][
k
][
CC
],

2857 
lhs
[
i
][
j
][
k
][
BB
]);

2864 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2865 
lhs
[
i
][
j
][
k
][
CC
],

2866 
rhs
[
i
][
j
][
k
] );

2872 #´agm¨
omp
 

2873 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2874 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2879 
	`m©vec_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2880 
rhs
[
isize
-1][
j
][
k
],„hs[isize][j][k]);

2885 
	`m©mul_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2886 
lhs
[
isize
-1][
j
][
k
][
CC
],

2887 
lhs
[
isize
][
j
][
k
][
BB
]);

2892 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2893 
rhs
[
i
][
j
][
k
] );

2897 
	}
}

2902 
	$m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]) {

2911 
i
;

2913 
i
 = 0; i < 5; i++) {

2918 
bvec
[
i
] = bvec[i] - 
ablock
[i][0]*
avec
[0]

2919 - 
ablock
[
i
][1]*
avec
[1]

2920 - 
ablock
[
i
][2]*
avec
[2]

2921 - 
ablock
[
i
][3]*
avec
[3]

2922 - 
ablock
[
i
][4]*
avec
[4];

2924 
	}
}

2929 
	$m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

2930 
cblock
[5][5]) {

2939 
j
;

2941 
j
 = 0; j < 5; j++) {

2942 
cblock
[0][
j
] = cblock[0][j] - 
ablock
[0][0]*
bblock
[0][j]

2943 - 
ablock
[0][1]*
bblock
[1][
j
]

2944 - 
ablock
[0][2]*
bblock
[2][
j
]

2945 - 
ablock
[0][3]*
bblock
[3][
j
]

2946 - 
ablock
[0][4]*
bblock
[4][
j
];

2947 
cblock
[1][
j
] = cblock[1][j] - 
ablock
[1][0]*
bblock
[0][j]

2948 - 
ablock
[1][1]*
bblock
[1][
j
]

2949 - 
ablock
[1][2]*
bblock
[2][
j
]

2950 - 
ablock
[1][3]*
bblock
[3][
j
]

2951 - 
ablock
[1][4]*
bblock
[4][
j
];

2952 
cblock
[2][
j
] = cblock[2][j] - 
ablock
[2][0]*
bblock
[0][j]

2953 - 
ablock
[2][1]*
bblock
[1][
j
]

2954 - 
ablock
[2][2]*
bblock
[2][
j
]

2955 - 
ablock
[2][3]*
bblock
[3][
j
]

2956 - 
ablock
[2][4]*
bblock
[4][
j
];

2957 
cblock
[3][
j
] = cblock[3][j] - 
ablock
[3][0]*
bblock
[0][j]

2958 - 
ablock
[3][1]*
bblock
[1][
j
]

2959 - 
ablock
[3][2]*
bblock
[2][
j
]

2960 - 
ablock
[3][3]*
bblock
[3][
j
]

2961 - 
ablock
[3][4]*
bblock
[4][
j
];

2962 
cblock
[4][
j
] = cblock[4][j] - 
ablock
[4][0]*
bblock
[0][j]

2963 - 
ablock
[4][1]*
bblock
[1][
j
]

2964 - 
ablock
[4][2]*
bblock
[2][
j
]

2965 - 
ablock
[4][3]*
bblock
[3][
j
]

2966 - 
ablock
[4][4]*
bblock
[4][
j
];

2968 
	}
}

2973 
	$bšvühs
(
Îhs
[5][5], 
c
[5][5], 
r
[5]) {

2978 
pivÙ
, 
cÛff
;

2984 
pivÙ
 = 1.00/
Îhs
[0][0];

2985 
Îhs
[0][1] =†lhs[0][1]*
pivÙ
;

2986 
Îhs
[0][2] =†lhs[0][2]*
pivÙ
;

2987 
Îhs
[0][3] =†lhs[0][3]*
pivÙ
;

2988 
Îhs
[0][4] =†lhs[0][4]*
pivÙ
;

2989 
c
[0][0] = c[0][0]*
pivÙ
;

2990 
c
[0][1] = c[0][1]*
pivÙ
;

2991 
c
[0][2] = c[0][2]*
pivÙ
;

2992 
c
[0][3] = c[0][3]*
pivÙ
;

2993 
c
[0][4] = c[0][4]*
pivÙ
;

2994 
r
[0] =„[0] *
pivÙ
;

2996 
cÛff
 = 
Îhs
[1][0];

2997 
Îhs
[1][1]ğÎhs[1][1] - 
cÛff
*llhs[0][1];

2998 
Îhs
[1][2]ğÎhs[1][2] - 
cÛff
*llhs[0][2];

2999 
Îhs
[1][3]ğÎhs[1][3] - 
cÛff
*llhs[0][3];

3000 
Îhs
[1][4]ğÎhs[1][4] - 
cÛff
*llhs[0][4];

3001 
c
[1][0] = c[1][0] - 
cÛff
*c[0][0];

3002 
c
[1][1] = c[1][1] - 
cÛff
*c[0][1];

3003 
c
[1][2] = c[1][2] - 
cÛff
*c[0][2];

3004 
c
[1][3] = c[1][3] - 
cÛff
*c[0][3];

3005 
c
[1][4] = c[1][4] - 
cÛff
*c[0][4];

3006 
r
[1] =„[1] - 
cÛff
*r[0];

3008 
cÛff
 = 
Îhs
[2][0];

3009 
Îhs
[2][1]ğÎhs[2][1] - 
cÛff
*llhs[0][1];

3010 
Îhs
[2][2]ğÎhs[2][2] - 
cÛff
*llhs[0][2];

3011 
Îhs
[2][3]ğÎhs[2][3] - 
cÛff
*llhs[0][3];

3012 
Îhs
[2][4]ğÎhs[2][4] - 
cÛff
*llhs[0][4];

3013 
c
[2][0] = c[2][0] - 
cÛff
*c[0][0];

3014 
c
[2][1] = c[2][1] - 
cÛff
*c[0][1];

3015 
c
[2][2] = c[2][2] - 
cÛff
*c[0][2];

3016 
c
[2][3] = c[2][3] - 
cÛff
*c[0][3];

3017 
c
[2][4] = c[2][4] - 
cÛff
*c[0][4];

3018 
r
[2] =„[2] - 
cÛff
*r[0];

3020 
cÛff
 = 
Îhs
[3][0];

3021 
Îhs
[3][1]ğÎhs[3][1] - 
cÛff
*llhs[0][1];

3022 
Îhs
[3][2]ğÎhs[3][2] - 
cÛff
*llhs[0][2];

3023 
Îhs
[3][3]ğÎhs[3][3] - 
cÛff
*llhs[0][3];

3024 
Îhs
[3][4]ğÎhs[3][4] - 
cÛff
*llhs[0][4];

3025 
c
[3][0] = c[3][0] - 
cÛff
*c[0][0];

3026 
c
[3][1] = c[3][1] - 
cÛff
*c[0][1];

3027 
c
[3][2] = c[3][2] - 
cÛff
*c[0][2];

3028 
c
[3][3] = c[3][3] - 
cÛff
*c[0][3];

3029 
c
[3][4] = c[3][4] - 
cÛff
*c[0][4];

3030 
r
[3] =„[3] - 
cÛff
*r[0];

3032 
cÛff
 = 
Îhs
[4][0];

3033 
Îhs
[4][1]ğÎhs[4][1] - 
cÛff
*llhs[0][1];

3034 
Îhs
[4][2]ğÎhs[4][2] - 
cÛff
*llhs[0][2];

3035 
Îhs
[4][3]ğÎhs[4][3] - 
cÛff
*llhs[0][3];

3036 
Îhs
[4][4]ğÎhs[4][4] - 
cÛff
*llhs[0][4];

3037 
c
[4][0] = c[4][0] - 
cÛff
*c[0][0];

3038 
c
[4][1] = c[4][1] - 
cÛff
*c[0][1];

3039 
c
[4][2] = c[4][2] - 
cÛff
*c[0][2];

3040 
c
[4][3] = c[4][3] - 
cÛff
*c[0][3];

3041 
c
[4][4] = c[4][4] - 
cÛff
*c[0][4];

3042 
r
[4] =„[4] - 
cÛff
*r[0];

3045 
pivÙ
 = 1.00/
Îhs
[1][1];

3046 
Îhs
[1][2] =†lhs[1][2]*
pivÙ
;

3047 
Îhs
[1][3] =†lhs[1][3]*
pivÙ
;

3048 
Îhs
[1][4] =†lhs[1][4]*
pivÙ
;

3049 
c
[1][0] = c[1][0]*
pivÙ
;

3050 
c
[1][1] = c[1][1]*
pivÙ
;

3051 
c
[1][2] = c[1][2]*
pivÙ
;

3052 
c
[1][3] = c[1][3]*
pivÙ
;

3053 
c
[1][4] = c[1][4]*
pivÙ
;

3054 
r
[1] =„[1] *
pivÙ
;

3056 
cÛff
 = 
Îhs
[0][1];

3057 
Îhs
[0][2]ğÎhs[0][2] - 
cÛff
*llhs[1][2];

3058 
Îhs
[0][3]ğÎhs[0][3] - 
cÛff
*llhs[1][3];

3059 
Îhs
[0][4]ğÎhs[0][4] - 
cÛff
*llhs[1][4];

3060 
c
[0][0] = c[0][0] - 
cÛff
*c[1][0];

3061 
c
[0][1] = c[0][1] - 
cÛff
*c[1][1];

3062 
c
[0][2] = c[0][2] - 
cÛff
*c[1][2];

3063 
c
[0][3] = c[0][3] - 
cÛff
*c[1][3];

3064 
c
[0][4] = c[0][4] - 
cÛff
*c[1][4];

3065 
r
[0] =„[0] - 
cÛff
*r[1];

3067 
cÛff
 = 
Îhs
[2][1];

3068 
Îhs
[2][2]ğÎhs[2][2] - 
cÛff
*llhs[1][2];

3069 
Îhs
[2][3]ğÎhs[2][3] - 
cÛff
*llhs[1][3];

3070 
Îhs
[2][4]ğÎhs[2][4] - 
cÛff
*llhs[1][4];

3071 
c
[2][0] = c[2][0] - 
cÛff
*c[1][0];

3072 
c
[2][1] = c[2][1] - 
cÛff
*c[1][1];

3073 
c
[2][2] = c[2][2] - 
cÛff
*c[1][2];

3074 
c
[2][3] = c[2][3] - 
cÛff
*c[1][3];

3075 
c
[2][4] = c[2][4] - 
cÛff
*c[1][4];

3076 
r
[2] =„[2] - 
cÛff
*r[1];

3078 
cÛff
 = 
Îhs
[3][1];

3079 
Îhs
[3][2]ğÎhs[3][2] - 
cÛff
*llhs[1][2];

3080 
Îhs
[3][3]ğÎhs[3][3] - 
cÛff
*llhs[1][3];

3081 
Îhs
[3][4]ğÎhs[3][4] - 
cÛff
*llhs[1][4];

3082 
c
[3][0] = c[3][0] - 
cÛff
*c[1][0];

3083 
c
[3][1] = c[3][1] - 
cÛff
*c[1][1];

3084 
c
[3][2] = c[3][2] - 
cÛff
*c[1][2];

3085 
c
[3][3] = c[3][3] - 
cÛff
*c[1][3];

3086 
c
[3][4] = c[3][4] - 
cÛff
*c[1][4];

3087 
r
[3] =„[3] - 
cÛff
*r[1];

3089 
cÛff
 = 
Îhs
[4][1];

3090 
Îhs
[4][2]ğÎhs[4][2] - 
cÛff
*llhs[1][2];

3091 
Îhs
[4][3]ğÎhs[4][3] - 
cÛff
*llhs[1][3];

3092 
Îhs
[4][4]ğÎhs[4][4] - 
cÛff
*llhs[1][4];

3093 
c
[4][0] = c[4][0] - 
cÛff
*c[1][0];

3094 
c
[4][1] = c[4][1] - 
cÛff
*c[1][1];

3095 
c
[4][2] = c[4][2] - 
cÛff
*c[1][2];

3096 
c
[4][3] = c[4][3] - 
cÛff
*c[1][3];

3097 
c
[4][4] = c[4][4] - 
cÛff
*c[1][4];

3098 
r
[4] =„[4] - 
cÛff
*r[1];

3101 
pivÙ
 = 1.00/
Îhs
[2][2];

3102 
Îhs
[2][3] =†lhs[2][3]*
pivÙ
;

3103 
Îhs
[2][4] =†lhs[2][4]*
pivÙ
;

3104 
c
[2][0] = c[2][0]*
pivÙ
;

3105 
c
[2][1] = c[2][1]*
pivÙ
;

3106 
c
[2][2] = c[2][2]*
pivÙ
;

3107 
c
[2][3] = c[2][3]*
pivÙ
;

3108 
c
[2][4] = c[2][4]*
pivÙ
;

3109 
r
[2] =„[2] *
pivÙ
;

3111 
cÛff
 = 
Îhs
[0][2];

3112 
Îhs
[0][3]ğÎhs[0][3] - 
cÛff
*llhs[2][3];

3113 
Îhs
[0][4]ğÎhs[0][4] - 
cÛff
*llhs[2][4];

3114 
c
[0][0] = c[0][0] - 
cÛff
*c[2][0];

3115 
c
[0][1] = c[0][1] - 
cÛff
*c[2][1];

3116 
c
[0][2] = c[0][2] - 
cÛff
*c[2][2];

3117 
c
[0][3] = c[0][3] - 
cÛff
*c[2][3];

3118 
c
[0][4] = c[0][4] - 
cÛff
*c[2][4];

3119 
r
[0] =„[0] - 
cÛff
*r[2];

3121 
cÛff
 = 
Îhs
[1][2];

3122 
Îhs
[1][3]ğÎhs[1][3] - 
cÛff
*llhs[2][3];

3123 
Îhs
[1][4]ğÎhs[1][4] - 
cÛff
*llhs[2][4];

3124 
c
[1][0] = c[1][0] - 
cÛff
*c[2][0];

3125 
c
[1][1] = c[1][1] - 
cÛff
*c[2][1];

3126 
c
[1][2] = c[1][2] - 
cÛff
*c[2][2];

3127 
c
[1][3] = c[1][3] - 
cÛff
*c[2][3];

3128 
c
[1][4] = c[1][4] - 
cÛff
*c[2][4];

3129 
r
[1] =„[1] - 
cÛff
*r[2];

3131 
cÛff
 = 
Îhs
[3][2];

3132 
Îhs
[3][3]ğÎhs[3][3] - 
cÛff
*llhs[2][3];

3133 
Îhs
[3][4]ğÎhs[3][4] - 
cÛff
*llhs[2][4];

3134 
c
[3][0] = c[3][0] - 
cÛff
*c[2][0];

3135 
c
[3][1] = c[3][1] - 
cÛff
*c[2][1];

3136 
c
[3][2] = c[3][2] - 
cÛff
*c[2][2];

3137 
c
[3][3] = c[3][3] - 
cÛff
*c[2][3];

3138 
c
[3][4] = c[3][4] - 
cÛff
*c[2][4];

3139 
r
[3] =„[3] - 
cÛff
*r[2];

3141 
cÛff
 = 
Îhs
[4][2];

3142 
Îhs
[4][3]ğÎhs[4][3] - 
cÛff
*llhs[2][3];

3143 
Îhs
[4][4]ğÎhs[4][4] - 
cÛff
*llhs[2][4];

3144 
c
[4][0] = c[4][0] - 
cÛff
*c[2][0];

3145 
c
[4][1] = c[4][1] - 
cÛff
*c[2][1];

3146 
c
[4][2] = c[4][2] - 
cÛff
*c[2][2];

3147 
c
[4][3] = c[4][3] - 
cÛff
*c[2][3];

3148 
c
[4][4] = c[4][4] - 
cÛff
*c[2][4];

3149 
r
[4] =„[4] - 
cÛff
*r[2];

3152 
pivÙ
 = 1.00/
Îhs
[3][3];

3153 
Îhs
[3][4] =†lhs[3][4]*
pivÙ
;

3154 
c
[3][0] = c[3][0]*
pivÙ
;

3155 
c
[3][1] = c[3][1]*
pivÙ
;

3156 
c
[3][2] = c[3][2]*
pivÙ
;

3157 
c
[3][3] = c[3][3]*
pivÙ
;

3158 
c
[3][4] = c[3][4]*
pivÙ
;

3159 
r
[3] =„[3] *
pivÙ
;

3161 
cÛff
 = 
Îhs
[0][3];

3162 
Îhs
[0][4]ğÎhs[0][4] - 
cÛff
*llhs[3][4];

3163 
c
[0][0] = c[0][0] - 
cÛff
*c[3][0];

3164 
c
[0][1] = c[0][1] - 
cÛff
*c[3][1];

3165 
c
[0][2] = c[0][2] - 
cÛff
*c[3][2];

3166 
c
[0][3] = c[0][3] - 
cÛff
*c[3][3];

3167 
c
[0][4] = c[0][4] - 
cÛff
*c[3][4];

3168 
r
[0] =„[0] - 
cÛff
*r[3];

3170 
cÛff
 = 
Îhs
[1][3];

3171 
Îhs
[1][4]ğÎhs[1][4] - 
cÛff
*llhs[3][4];

3172 
c
[1][0] = c[1][0] - 
cÛff
*c[3][0];

3173 
c
[1][1] = c[1][1] - 
cÛff
*c[3][1];

3174 
c
[1][2] = c[1][2] - 
cÛff
*c[3][2];

3175 
c
[1][3] = c[1][3] - 
cÛff
*c[3][3];

3176 
c
[1][4] = c[1][4] - 
cÛff
*c[3][4];

3177 
r
[1] =„[1] - 
cÛff
*r[3];

3179 
cÛff
 = 
Îhs
[2][3];

3180 
Îhs
[2][4]ğÎhs[2][4] - 
cÛff
*llhs[3][4];

3181 
c
[2][0] = c[2][0] - 
cÛff
*c[3][0];

3182 
c
[2][1] = c[2][1] - 
cÛff
*c[3][1];

3183 
c
[2][2] = c[2][2] - 
cÛff
*c[3][2];

3184 
c
[2][3] = c[2][3] - 
cÛff
*c[3][3];

3185 
c
[2][4] = c[2][4] - 
cÛff
*c[3][4];

3186 
r
[2] =„[2] - 
cÛff
*r[3];

3188 
cÛff
 = 
Îhs
[4][3];

3189 
Îhs
[4][4]ğÎhs[4][4] - 
cÛff
*llhs[3][4];

3190 
c
[4][0] = c[4][0] - 
cÛff
*c[3][0];

3191 
c
[4][1] = c[4][1] - 
cÛff
*c[3][1];

3192 
c
[4][2] = c[4][2] - 
cÛff
*c[3][2];

3193 
c
[4][3] = c[4][3] - 
cÛff
*c[3][3];

3194 
c
[4][4] = c[4][4] - 
cÛff
*c[3][4];

3195 
r
[4] =„[4] - 
cÛff
*r[3];

3198 
pivÙ
 = 1.00/
Îhs
[4][4];

3199 
c
[4][0] = c[4][0]*
pivÙ
;

3200 
c
[4][1] = c[4][1]*
pivÙ
;

3201 
c
[4][2] = c[4][2]*
pivÙ
;

3202 
c
[4][3] = c[4][3]*
pivÙ
;

3203 
c
[4][4] = c[4][4]*
pivÙ
;

3204 
r
[4] =„[4] *
pivÙ
;

3206 
cÛff
 = 
Îhs
[0][4];

3207 
c
[0][0] = c[0][0] - 
cÛff
*c[4][0];

3208 
c
[0][1] = c[0][1] - 
cÛff
*c[4][1];

3209 
c
[0][2] = c[0][2] - 
cÛff
*c[4][2];

3210 
c
[0][3] = c[0][3] - 
cÛff
*c[4][3];

3211 
c
[0][4] = c[0][4] - 
cÛff
*c[4][4];

3212 
r
[0] =„[0] - 
cÛff
*r[4];

3214 
cÛff
 = 
Îhs
[1][4];

3215 
c
[1][0] = c[1][0] - 
cÛff
*c[4][0];

3216 
c
[1][1] = c[1][1] - 
cÛff
*c[4][1];

3217 
c
[1][2] = c[1][2] - 
cÛff
*c[4][2];

3218 
c
[1][3] = c[1][3] - 
cÛff
*c[4][3];

3219 
c
[1][4] = c[1][4] - 
cÛff
*c[4][4];

3220 
r
[1] =„[1] - 
cÛff
*r[4];

3222 
cÛff
 = 
Îhs
[2][4];

3223 
c
[2][0] = c[2][0] - 
cÛff
*c[4][0];

3224 
c
[2][1] = c[2][1] - 
cÛff
*c[4][1];

3225 
c
[2][2] = c[2][2] - 
cÛff
*c[4][2];

3226 
c
[2][3] = c[2][3] - 
cÛff
*c[4][3];

3227 
c
[2][4] = c[2][4] - 
cÛff
*c[4][4];

3228 
r
[2] =„[2] - 
cÛff
*r[4];

3230 
cÛff
 = 
Îhs
[3][4];

3231 
c
[3][0] = c[3][0] - 
cÛff
*c[4][0];

3232 
c
[3][1] = c[3][1] - 
cÛff
*c[4][1];

3233 
c
[3][2] = c[3][2] - 
cÛff
*c[4][2];

3234 
c
[3][3] = c[3][3] - 
cÛff
*c[4][3];

3235 
c
[3][4] = c[3][4] - 
cÛff
*c[4][4];

3236 
r
[3] =„[3] - 
cÛff
*r[4];

3237 
	}
}

3242 
	$bšvrhs
Ğ
Îhs
[5][5], 
r
[5] ) {

3247 
pivÙ
, 
cÛff
;

3253 
pivÙ
 = 1.00/
Îhs
[0][0];

3254 
Îhs
[0][1] =†lhs[0][1]*
pivÙ
;

3255 
Îhs
[0][2] =†lhs[0][2]*
pivÙ
;

3256 
Îhs
[0][3] =†lhs[0][3]*
pivÙ
;

3257 
Îhs
[0][4] =†lhs[0][4]*
pivÙ
;

3258 
r
[0] =„[0] *
pivÙ
;

3260 
cÛff
 = 
Îhs
[1][0];

3261 
Îhs
[1][1]ğÎhs[1][1] - 
cÛff
*llhs[0][1];

3262 
Îhs
[1][2]ğÎhs[1][2] - 
cÛff
*llhs[0][2];

3263 
Îhs
[1][3]ğÎhs[1][3] - 
cÛff
*llhs[0][3];

3264 
Îhs
[1][4]ğÎhs[1][4] - 
cÛff
*llhs[0][4];

3265 
r
[1] =„[1] - 
cÛff
*r[0];

3267 
cÛff
 = 
Îhs
[2][0];

3268 
Îhs
[2][1]ğÎhs[2][1] - 
cÛff
*llhs[0][1];

3269 
Îhs
[2][2]ğÎhs[2][2] - 
cÛff
*llhs[0][2];

3270 
Îhs
[2][3]ğÎhs[2][3] - 
cÛff
*llhs[0][3];

3271 
Îhs
[2][4]ğÎhs[2][4] - 
cÛff
*llhs[0][4];

3272 
r
[2] =„[2] - 
cÛff
*r[0];

3274 
cÛff
 = 
Îhs
[3][0];

3275 
Îhs
[3][1]ğÎhs[3][1] - 
cÛff
*llhs[0][1];

3276 
Îhs
[3][2]ğÎhs[3][2] - 
cÛff
*llhs[0][2];

3277 
Îhs
[3][3]ğÎhs[3][3] - 
cÛff
*llhs[0][3];

3278 
Îhs
[3][4]ğÎhs[3][4] - 
cÛff
*llhs[0][4];

3279 
r
[3] =„[3] - 
cÛff
*r[0];

3281 
cÛff
 = 
Îhs
[4][0];

3282 
Îhs
[4][1]ğÎhs[4][1] - 
cÛff
*llhs[0][1];

3283 
Îhs
[4][2]ğÎhs[4][2] - 
cÛff
*llhs[0][2];

3284 
Îhs
[4][3]ğÎhs[4][3] - 
cÛff
*llhs[0][3];

3285 
Îhs
[4][4]ğÎhs[4][4] - 
cÛff
*llhs[0][4];

3286 
r
[4] =„[4] - 
cÛff
*r[0];

3289 
pivÙ
 = 1.00/
Îhs
[1][1];

3290 
Îhs
[1][2] =†lhs[1][2]*
pivÙ
;

3291 
Îhs
[1][3] =†lhs[1][3]*
pivÙ
;

3292 
Îhs
[1][4] =†lhs[1][4]*
pivÙ
;

3293 
r
[1] =„[1] *
pivÙ
;

3295 
cÛff
 = 
Îhs
[0][1];

3296 
Îhs
[0][2]ğÎhs[0][2] - 
cÛff
*llhs[1][2];

3297 
Îhs
[0][3]ğÎhs[0][3] - 
cÛff
*llhs[1][3];

3298 
Îhs
[0][4]ğÎhs[0][4] - 
cÛff
*llhs[1][4];

3299 
r
[0] =„[0] - 
cÛff
*r[1];

3301 
cÛff
 = 
Îhs
[2][1];

3302 
Îhs
[2][2]ğÎhs[2][2] - 
cÛff
*llhs[1][2];

3303 
Îhs
[2][3]ğÎhs[2][3] - 
cÛff
*llhs[1][3];

3304 
Îhs
[2][4]ğÎhs[2][4] - 
cÛff
*llhs[1][4];

3305 
r
[2] =„[2] - 
cÛff
*r[1];

3307 
cÛff
 = 
Îhs
[3][1];

3308 
Îhs
[3][2]ğÎhs[3][2] - 
cÛff
*llhs[1][2];

3309 
Îhs
[3][3]ğÎhs[3][3] - 
cÛff
*llhs[1][3];

3310 
Îhs
[3][4]ğÎhs[3][4] - 
cÛff
*llhs[1][4];

3311 
r
[3] =„[3] - 
cÛff
*r[1];

3313 
cÛff
 = 
Îhs
[4][1];

3314 
Îhs
[4][2]ğÎhs[4][2] - 
cÛff
*llhs[1][2];

3315 
Îhs
[4][3]ğÎhs[4][3] - 
cÛff
*llhs[1][3];

3316 
Îhs
[4][4]ğÎhs[4][4] - 
cÛff
*llhs[1][4];

3317 
r
[4] =„[4] - 
cÛff
*r[1];

3320 
pivÙ
 = 1.00/
Îhs
[2][2];

3321 
Îhs
[2][3] =†lhs[2][3]*
pivÙ
;

3322 
Îhs
[2][4] =†lhs[2][4]*
pivÙ
;

3323 
r
[2] =„[2] *
pivÙ
;

3325 
cÛff
 = 
Îhs
[0][2];

3326 
Îhs
[0][3]ğÎhs[0][3] - 
cÛff
*llhs[2][3];

3327 
Îhs
[0][4]ğÎhs[0][4] - 
cÛff
*llhs[2][4];

3328 
r
[0] =„[0] - 
cÛff
*r[2];

3330 
cÛff
 = 
Îhs
[1][2];

3331 
Îhs
[1][3]ğÎhs[1][3] - 
cÛff
*llhs[2][3];

3332 
Îhs
[1][4]ğÎhs[1][4] - 
cÛff
*llhs[2][4];

3333 
r
[1] =„[1] - 
cÛff
*r[2];

3335 
cÛff
 = 
Îhs
[3][2];

3336 
Îhs
[3][3]ğÎhs[3][3] - 
cÛff
*llhs[2][3];

3337 
Îhs
[3][4]ğÎhs[3][4] - 
cÛff
*llhs[2][4];

3338 
r
[3] =„[3] - 
cÛff
*r[2];

3340 
cÛff
 = 
Îhs
[4][2];

3341 
Îhs
[4][3]ğÎhs[4][3] - 
cÛff
*llhs[2][3];

3342 
Îhs
[4][4]ğÎhs[4][4] - 
cÛff
*llhs[2][4];

3343 
r
[4] =„[4] - 
cÛff
*r[2];

3346 
pivÙ
 = 1.00/
Îhs
[3][3];

3347 
Îhs
[3][4] =†lhs[3][4]*
pivÙ
;

3348 
r
[3] =„[3] *
pivÙ
;

3350 
cÛff
 = 
Îhs
[0][3];

3351 
Îhs
[0][4]ğÎhs[0][4] - 
cÛff
*llhs[3][4];

3352 
r
[0] =„[0] - 
cÛff
*r[3];

3354 
cÛff
 = 
Îhs
[1][3];

3355 
Îhs
[1][4]ğÎhs[1][4] - 
cÛff
*llhs[3][4];

3356 
r
[1] =„[1] - 
cÛff
*r[3];

3358 
cÛff
 = 
Îhs
[2][3];

3359 
Îhs
[2][4]ğÎhs[2][4] - 
cÛff
*llhs[3][4];

3360 
r
[2] =„[2] - 
cÛff
*r[3];

3362 
cÛff
 = 
Îhs
[4][3];

3363 
Îhs
[4][4]ğÎhs[4][4] - 
cÛff
*llhs[3][4];

3364 
r
[4] =„[4] - 
cÛff
*r[3];

3367 
pivÙ
 = 1.00/
Îhs
[4][4];

3368 
r
[4] =„[4] *
pivÙ
;

3370 
cÛff
 = 
Îhs
[0][4];

3371 
r
[0] =„[0] - 
cÛff
*r[4];

3373 
cÛff
 = 
Îhs
[1][4];

3374 
r
[1] =„[1] - 
cÛff
*r[4];

3376 
cÛff
 = 
Îhs
[2][4];

3377 
r
[2] =„[2] - 
cÛff
*r[4];

3379 
cÛff
 = 
Îhs
[3][4];

3380 
r
[3] =„[3] - 
cÛff
*r[4];

3382 
	}
}

3387 
	$y_sŞve
() {

3402 
	`lhsy
();

3403 
	`y_sŞve_ûÎ
();

3404 
	`y_backsub¡™u‹
();

3405 
	}
}

3411 
	$y_backsub¡™u‹
() {

3423 
i
, 
j
, 
k
, 
m
, 
n
;

3425 
j
 = 
grid_pošts
[1]-2; j >= 0; j--) {

3426 #´agm¨
omp
 

3427 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3428 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3429 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3430 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3431 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3432 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j+1][k][n];

3438 
	}
}

3443 
	$y_sŞve_ûÎ
() {

3458 
i
, 
j
, 
k
, 
jsize
;

3460 
jsize
 = 
grid_pošts
[1]-1;

3462 #´agm¨
omp
 

3463 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3464 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3470 
	`bšvühs
Ğ
lhs
[
i
][0][
k
][
BB
],

3471 
lhs
[
i
][0][
k
][
CC
],

3472 
rhs
[
i
][0][
k
] );

3480 
j
 = 1; j < 
jsize
; j++) {

3481 #´agm¨
omp
 

3482 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3483 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3490 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3491 
rhs
[
i
][
j
-1][
k
],„hs[i][j][k]);

3496 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3497 
lhs
[
i
][
j
-1][
k
][
CC
],

3498 
lhs
[
i
][
j
][
k
][
BB
]);

3504 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3505 
lhs
[
i
][
j
][
k
][
CC
],

3506 
rhs
[
i
][
j
][
k
] );

3512 #´agm¨
omp
 

3513 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3514 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3519 
	`m©vec_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3520 
rhs
[
i
][
jsize
-1][
k
],„hs[i][jsize][k]);

3527 
	`m©mul_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3528 
lhs
[
i
][
jsize
-1][
k
][
CC
],

3529 
lhs
[
i
][
jsize
][
k
][
BB
]);

3534 
	`bšvrhs
Ğ
lhs
[
i
][
jsize
][
k
][
BB
],

3535 
rhs
[
i
][
jsize
][
k
] );

3539 
	}
}

3545 
	$z_sŞve
() {

3560 
	`lhsz
();

3561 
	`z_sŞve_ûÎ
();

3562 
	`z_backsub¡™u‹
();

3563 
	}
}

3568 
	$z_backsub¡™u‹
() {

3580 
i
, 
j
, 
k
, 
m
, 
n
;

3582 #´agm¨
omp
 

3583 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3584 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3585 
k
 = 
grid_pošts
[2]-2; k >= 0; k--) {

3586 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3587 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3588 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3589 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j][k+1][n];

3595 
	}
}

3600 
	$z_sŞve_ûÎ
() {

3615 
i
,
j
,
k
,
ksize
;

3617 
ksize
 = 
grid_pošts
[2]-1;

3622 #´agm¨
omp
 

3623 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3624 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3630 
	`bšvühs
Ğ
lhs
[
i
][
j
][0][
BB
],

3631 
lhs
[
i
][
j
][0][
CC
],

3632 
rhs
[
i
][
j
][0] );

3641 
k
 = 1; k < 
ksize
; k++) {

3642 #´agm¨
omp
 

3643 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3644 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3651 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3652 
rhs
[
i
][
j
][
k
-1],„hs[i][j][k]);

3658 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3659 
lhs
[
i
][
j
][
k
-1][
CC
],

3660 
lhs
[
i
][
j
][
k
][
BB
]);

3666 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3667 
lhs
[
i
][
j
][
k
][
CC
],

3668 
rhs
[
i
][
j
][
k
] );

3677 #´agm¨
omp
 

3678 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3679 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3684 
	`m©vec_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3685 
rhs
[
i
][
j
][
ksize
-1],„hs[i][j][ksize]);

3692 
	`m©mul_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3693 
lhs
[
i
][
j
][
ksize
-1][
CC
],

3694 
lhs
[
i
][
j
][
ksize
][
BB
]);

3699 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
ksize
][
BB
],

3700 
rhs
[
i
][
j
][
ksize
] );

3704 
	}
}

	@BT/header.h

19 #iâdeà
_HEADER_H_


20 
	#_HEADER_H_


	)

22 
	~"Åb·¿ms.h
"

23 
	~"../m©h/Çs_m©h.h
"

24 
	#AA
 0

	)

25 
	#BB
 1

	)

26 
	#CC
 2

	)

27 
	#BLOCK_SIZE
 5

	)

30 
	ggrid_pošts
[3];

33 
	gtx1
, 
	gtx2
, 
	gtx3
, 
	gty1
, 
	gty2
, 
	gty3
, 
	gtz1
, 
	gtz2
, 
	gtz3
;

34 
	gdx1
, 
	gdx2
, 
	gdx3
, 
	gdx4
, 
	gdx5
;

35 
	gdy1
, 
	gdy2
, 
	gdy3
, 
	gdy4
, 
	gdy5
;

36 
	gdz1
, 
	gdz2
, 
	gdz3
, 
	gdz4
, 
	gdz5
;

37 
	gds¥
, 
	gdt
;

38 
	gû
[5][13];

39 
	gdxmax
, 
	gdymax
, 
	gdzmax
;

40 
	gxxcÚ1
, 
	gxxcÚ2
, 
	gxxcÚ3
, 
	gxxcÚ4
, 
	gxxcÚ5
;

41 
	gdx1tx1
, 
	gdx2tx1
, 
	gdx3tx1
, 
	gdx4tx1
, 
	gdx5tx1
;

42 
	gyycÚ1
, 
	gyycÚ2
, 
	gyycÚ3
, 
	gyycÚ4
, 
	gyycÚ5
;

43 
	gdy1ty1
, 
	gdy2ty1
, 
	gdy3ty1
, 
	gdy4ty1
, 
	gdy5ty1
;

44 
	gzzcÚ1
, 
	gzzcÚ2
, 
	gzzcÚ3
, 
	gzzcÚ4
, 
	gzzcÚ5
;

45 
	gdz1tz1
, 
	gdz2tz1
, 
	gdz3tz1
, 
	gdz4tz1
, 
	gdz5tz1
;

46 
	gdnxm1
, 
	gdnym1
, 
	gdnzm1
, 
	gc1c2
, 
	gc1c5
, 
	gc3c4
, 
	gc1345
;

47 
	gcÚz1
, 
	gc1
, 
	gc2
, 
	gc3
, 
	gc4
, 
	gc5
, 
	gc4ds¥
, 
	gc5ds¥
, 
	gdtds¥
;

48 
	gd‰x1
, 
	gd‰x2
, 
	gd‰y1
, 
	gd‰y2
, 
	gd‰z1
, 
	gd‰z2
;

49 
	gc2d‰x1
, 
	gc2d‰y1
, 
	gc2d‰z1
, 
	gcomz1
, 
	gcomz4
, 
	gcomz5
, 
	gcomz6
;

50 
	gc3c4tx3
, 
	gc3c4ty3
, 
	gc3c4tz3
, 
	gc2iv
, 
	gcÚ43
, 
	gcÚ16
;

52 
	#IMAX
 
PROBLEM_SIZE


	)

53 
	#JMAX
 
PROBLEM_SIZE


	)

54 
	#KMAX
 
PROBLEM_SIZE


	)

63 *
	gus_±r
;

64 *
	gvs_±r
;

65 *
	gws_±r
;

66 *
	gqs_±r
;

67 *
	grho_i_±r
;

68 *
	gsqu¬e_±r
;

69 *
	gfÜcšg_±r
;

70 *
	gu_±r
;

71 *
	grhs_±r
;

72 *
	glhs_±r
;

74 *
	gfjac_±r
;

75 *
	gnjac_±r
;

77 
	ts_m©rix_t
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1];

78 
	tf_m©rix_t
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1][5+1];

79 
	tu_m©rix_t
[(
IMAX
+1)/2*2+1][(
JMAX
+1)/2*2+1][(
KMAX
+1)/2*2+1][5];

80 
	trhs_m©rix_t
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1][5];

81 
	tlhs_m©rix_t
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1][3][5][5];

82 
	tjac_m©rix_t
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
-1+1][5][5];

84 
	#ACAST
(
T
, 
±r
è(*(T*íŒ)

	)

86 
	#us
 
	`ACAST
(
s_m©rix_t
, 
us_±r
)

	)

87 
	#vs
 
	`ACAST
(
s_m©rix_t
, 
vs_±r
)

	)

88 
	#ws
 
	`ACAST
(
s_m©rix_t
, 
ws_±r
)

	)

89 
	#qs
 
	`ACAST
(
s_m©rix_t
, 
qs_±r
)

	)

90 
	#rho_i
 
	`ACAST
(
s_m©rix_t
, 
rho_i_±r
)

	)

91 
	#squ¬e
 
	`ACAST
(
s_m©rix_t
, 
squ¬e_±r
)

	)

92 
	#fÜcšg
 
	`ACAST
(
f_m©rix_t
, 
fÜcšg_±r
)

	)

93 
	#u
 
	`ACAST
(
u_m©rix_t
, 
u_±r
)

	)

94 
	#rhs
 
	`ACAST
(
rhs_m©rix_t
, 
rhs_±r
)

	)

95 
	#lhs
 
	`ACAST
(
lhs_m©rix_t
, 
lhs_±r
)

	)

96 
	#fjac
 
	`ACAST
(
jac_m©rix_t
, 
fjac_±r
)

	)

97 
	#njac
 
	`ACAST
(
jac_m©rix_t
, 
njac_±r
)

	)

112 
	gcuf
[
PROBLEM_SIZE
];

113 
	gq
[
PROBLEM_SIZE
];

114 
	gue
[
PROBLEM_SIZE
][5];

115 
	gbuf
[
PROBLEM_SIZE
][5];

116 #´agm¨
omp
 
th»ad´iv©e
(
cuf
, 
q
, 
ue
, 
buf
)

128 
	gtmp1
, 
	gtmp2
, 
	gtmp3
;

	@BT/npbparams.h

7 
	#PROBLEM_SIZE
 162

	)

8 
	#NITER_DEFAULT
 200

	)

9 
	#DT_DEFAULT
 0.0001

	)

10 
	#CONVERTDOUBLE
 
FALSE


	)

11 
	#COMPILETIME
 "01 Feb 2021"

	)

12 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

13 
	#CS1
 "ÒÚe)"

	)

14 
	#CS2
 "ÒÚe)"

	)

15 
	#CS3
 "ÒÚe)"

	)

16 
	#CS4
 "ÒÚe)"

	)

17 
	#CS5
 "-o3 $(C_IN)"

	)

18 
	#CS6
 "ÒÚe)"

	)

19 
	#CS7
 "ÒÚe)"

	)

	@CG/cg.c

47 
	~"../commÚ/Åb-C.h
"

48 
	~"Åb·¿ms.h
"

50 
	~<Çutus/Çutus.h
>

51 
	~<Çutus/sh–l.h
>

52 
	~"../m©h/Çs_m©h.h
"

54 
	#NZ
 
NA
*(
NONZER
+1)*(NONZER+1)+NA*(NONZER+2)

	)

59 
	gÇa
;

60 
	gnzz
;

61 
	gfœ¡row
;

62 
	gÏ¡row
;

63 
	gfœ¡cŞ
;

64 
	gÏ¡cŞ
;

67 
	gcŞidx
[
NZ
+1];

68 
	grow¡r
[
NA
+1+1];

69 
	giv
[2*
NA
+1+1];

70 
	g¬ow
[
NZ
+1];

71 
	gacŞ
[
NZ
+1];

74 
	gv
[
NA
+1+1];

75 
	g«É
[
NZ
+1];

76 
	ga
[
NZ
+1];

77 
	gx
[
NA
+2+1];

78 
	gz
[
NA
+2+1];

79 
	gp
[
NA
+2+1];

80 
	gq
[
NA
+2+1];

81 
	gr
[
NA
+2+1];

85 
	gamuÉ
;

86 
	gŒª
;

89 
cÚj_g¿d
 (
cŞidx
[], 
row¡r
[], 
x
[], 
z
[],

90 
a
[], 
p
[], 
q
[], 
r
[],

92 *
ºÜm
);

93 
mak—
(
n
, 
nz
, 
a
[], 
cŞidx
[], 
row¡r
[],

94 
nÚz”
, 
fœ¡row
, 
Ï¡row
, 
fœ¡cŞ
,

95 
Ï¡cŞ
, 
rcÚd
, 
¬ow
[], 
acŞ
[],

96 
«É
[], 
v
[], 
iv
[], 
shiá
 );

97 
¥¬£
(
a
[], 
cŞidx
[], 
row¡r
[], 
n
,

98 
¬ow
[], 
acŞ
[], 
«É
[],

99 
fœ¡row
, 
Ï¡row
,

100 
x
[], 
boŞ—n
 
m¬k
[], 
nzloc
[], 
Âza
);

101 
¥ºvc
(
n
, 
nz
, 
v
[], 
iv
[], 
nzloc
[],

102 
m¬k
[]);

103 
iúv¹
(
x
, 
wr2
);

104 
vec£t
(
n
, 
v
[], 
iv
[], *
nzv
, 
i
, 
v®
);

109 
´og¿m_CG
(*
__buf
, * 
__´iv
);

110 
´og¿m_CG_´ofe
(*
_
, *
__
);

112 
sh–l_cmd_im¶
 
	gÇs_cg_im¶
 = {

113 .
cmd
 = "nas-cg",

114 .
	gh–p_¡r
 = "NAS…arallel benchmark CG",

115 .
	ghªdËr
 = 
´og¿m_CG_´ofe
,

117 
nk_»gi¡”_sh–l_cmd
(
Çs_cg_im¶
);

122 
	$´og¿m_CG_´ofe
(*
_
, *
__
){

124 #ifdeà
NAUT_CONFIG_PROFILE


125 
	`nk_š¡rum’t_ş—r
();

126 
	`nk_š¡rum’t_¡¬t
();

128 
	`´og¿m_CG
(
_
,
__
);

129 #ifdeà
NAUT_CONFIG_PROFILE


130 
	`nk_š¡rum’t_’d
();

131 
	`nk_š¡rum’t_qu”y
();

134 
	}
}

138 
	$´og¿m_CG
(*
__buf
, * 
__´iv
) {

141 
i
, 
j
, 
k
, 
™
;

142 
Áh»ads
 = 1;

143 
z‘a
;

144 
ºÜm
;

145 
nÜm_‹mp11
;

146 
nÜm_‹mp12
;

147 
t
, 
mæİs
;

148 
şass
;

149 
boŞ—n
 
v”if›d
;

150 
z‘a_v”ify_v®ue
, 
•sÚ
;

152 
fœ¡row
 = 1;

153 
Ï¡row
 = 
NA
;

154 
fœ¡cŞ
 = 1;

155 
Ï¡cŞ
 = 
NA
;

157 ià(
NA
 =ğ1400 && 
NONZER
 =ğ7 && 
NITER
 =ğ15 && 
SHIFT
 == 10.0) {

158 
şass
 = 'S';

159 
z‘a_v”ify_v®ue
 = 8.5971775078648;

160 } ià(
NA
 =ğ7000 && 
NONZER
 =ğ8 && 
NITER
 =ğ15 && 
SHIFT
 == 12.0) {

161 
şass
 = 'W';

162 
z‘a_v”ify_v®ue
 = 10.362595087124;

163 } ià(
NA
 =ğ14000 && 
NONZER
 =ğ11 && 
NITER
 =ğ15 && 
SHIFT
 == 20.0) {

164 
şass
 = 'A';

165 
z‘a_v”ify_v®ue
 = 17.130235054029;

166 } ià(
NA
 =ğ75000 && 
NONZER
 =ğ13 && 
NITER
 =ğ75 && 
SHIFT
 == 60.0) {

167 
şass
 = 'B';

168 
z‘a_v”ify_v®ue
 = 22.712745482631;

169 } ià(
NA
 =ğ150000 && 
NONZER
 =ğ15 && 
NITER
 =ğ75 && 
SHIFT
 == 110.0) {

170 
şass
 = 'C';

171 
z‘a_v”ify_v®ue
 = 28.973605592845;

173 
şass
 = 'U';

176 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

178 
	`´štf
(" Size: %10d\n", 
NA
);

179 
	`´štf
(" I‹¿tiÚs: %5d\n", 
NITER
);

181 
Ça
 = 
NA
;

182 
nzz
 = 
NZ
;

187 
Œª
 = 314159265.0;

188 
amuÉ
 = 1220703125.0;

189 
z‘a
 = 
	`¿ndlc
Ğ&
Œª
, 
amuÉ
 );

194 
	`mak—
(
Ça
, 
nzz
, 
a
, 
cŞidx
, 
row¡r
, 
NONZER
,

195 
fœ¡row
, 
Ï¡row
, 
fœ¡cŞ
, 
Ï¡cŞ
,

196 
RCOND
, 
¬ow
, 
acŞ
, 
«É
, 
v
, 
iv
, 
SHIFT
);

206 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
)

208 #´agm¨
omp
 
nowa™


209 
j
 = 1; j <ğ
Ï¡row
 - 
fœ¡row
 + 1; j++) {

210 
k
 = 
row¡r
[
j
]; k <„owstr[j+1]; k++) {

211 
cŞidx
[
k
] = cŞidx[k] - 
fœ¡cŞ
 + 1;

218 #´agm¨
omp
 
nowa™


219 
i
 = 1; i <ğ
NA
+1; i++) {

220 
x
[
i
] = 1.0;

222 #´agm¨
omp
 
nowa™


223 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

224 
q
[
j
] = 0.0;

225 
z
[
j
] = 0.0;

226 
r
[
j
] = 0.0;

227 
p
[
j
] = 0.0;

230 
z‘a
 = 0.0;

238 
™
 = 1; it <= 1; it++) {

243 
	`cÚj_g¿d
 (
cŞidx
, 
row¡r
, 
x
, 
z
, 
a
, 
p
, 
q
, 
r
, &
ºÜm
);

251 
nÜm_‹mp11
 = 0.0;

252 
nÜm_‹mp12
 = 0.0;

253 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
è
	`»duùiÚ
(+:
nÜm_‹mp11
,
nÜm_‹mp12
)

254 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

255 
nÜm_‹mp11
 =‚Üm_‹mp11 + 
x
[
j
]*
z
[j];

256 
nÜm_‹mp12
 =‚Üm_‹mp12 + 
z
[
j
]*z[j];

258 
nÜm_‹mp12
 = 1.0 / 
	`sq¹
(‚orm_temp12 );

263 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
)

264 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

265 
x
[
j
] = 
nÜm_‹mp12
*
z
[j];

273 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
)

274 
i
 = 1; i <ğ
NA
+1; i++) {

275 
x
[
i
] = 1.0;

277 
z‘a
 = 0.0;

280 
	`tim”_ş—r
( 1 );

281 
	`tim”_¡¬t
( 1 );

289 
™
 = 1; iˆ<ğ
NITER
; it++) {

294 
	`cÚj_g¿d
(
cŞidx
, 
row¡r
, 
x
, 
z
, 
a
, 
p
, 
q
, 
r
 , &
ºÜm
);

302 
nÜm_‹mp11
 = 0.0;

303 
nÜm_‹mp12
 = 0.0;

305 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
è
	`»duùiÚ
(+:
nÜm_‹mp11
,
nÜm_‹mp12
)

306 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

307 
nÜm_‹mp11
 =‚Üm_‹mp11 + 
x
[
j
]*
z
[j];

308 
nÜm_‹mp12
 =‚Üm_‹mp12 + 
z
[
j
]*z[j];

311 
nÜm_‹mp12
 = 1.0 / 
	`sq¹
(‚orm_temp12 );

313 
z‘a
 = 
SHIFT
 + 1.0 / 
nÜm_‹mp11
;

315 ifĞ
™
 == 1 ) {

316 
	`´štf
(" iteration ||r|| zeta\n");

318 
	`´štf
(" %5d %20.14e%20.13e\n", 
™
, 
ºÜm
, 
z‘a
);

323 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
)

324 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

325 
x
[
j
] = 
nÜm_‹mp12
*
z
[j];

328 #´agm¨
omp
 
·¿Î–


330 #ià
	`defšed
(
_OPENMP
)

331 #´agm¨
omp
 
ma¡”


332 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

336 
	`tim”_¡İ
( 1 );

342 
t
 = 
	`tim”_»ad
( 1 );

344 
	`´štf
(" Benchmark completed\n");

346 
•sÚ
 = 1.0e-10;

347 ià(
şass
 != 'U') {

348 ià(
	`çbs
(
z‘a
 - 
z‘a_v”ify_v®ue
è<ğ
•sÚ
) {

349 
v”if›d
 = 
TRUE
;

350 
	`´štf
(" VERIFICATION SUCCESSFUL\n");

351 
	`´štf
(" Z‘¨i  %20.12e\n", 
z‘a
);

352 
	`´štf
(" E¼Ü i  %20.12e\n", 
z‘a
 - 
z‘a_v”ify_v®ue
);

354 
v”if›d
 = 
FALSE
;

355 
	`´štf
(" VERIFICATION FAILED\n");

356 
	`´štf
(" Z‘¨ %20.12e\n", 
z‘a
);

357 
	`´štf
(" ThcÜ»ù z‘¨i %20.12e\n", 
z‘a_v”ify_v®ue
);

360 
v”if›d
 = 
FALSE
;

361 
	`´štf
(" Problem size unknown\n");

362 
	`´štf
(" NO VERIFICATION PERFORMED\n");

365 iàĞ
t
 != 0.0 ) {

366 
mæİs
 = (2.0*
NITER
*
NA
)

367 * (3.0+(
NONZER
*(NONZER+1)) + 25.0*(5.0+(NONZER*(NONZER+1))) + 3.0 )

368 / 
t
 / 1000000.0;

370 
mæİs
 = 0.0;

373 
	`c_´št_»suÉs
("CG", 
şass
, 
NA
, 0, 0, 
NITER
, 
Áh»ads
, 
t
,

374 
mæİs
, " floating…oint",

375 
v”if›d
, 
NPBVERSION
, 
COMPILETIME
,

376 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

377 
	}
}

381 
	$cÚj_g¿d
 (

382 
cŞidx
[],

383 
row¡r
[],

384 
x
[],

385 
z
[],

386 
a
[],

387 
p
[],

388 
q
[],

389 
r
[],

391 *
ºÜm
 )

400 
ÿÎcouÁ
 = 0;

401 
d
, 
sum
, 
rho
, 
rho0
, 
®pha
, 
b‘a
;

402 
i
, 
j
, 
k
;

403 
cg™
, 
cg™max
 = 25;

405 
rho
 = 0.0;

406 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
,
sum
è
	`sh¬ed
(
rho
,
Ça
)

412 #´agm¨
omp
 

413 
j
 = 1; j <ğ
Ça
+1; j++) {

414 
q
[
j
] = 0.0;

415 
z
[
j
] = 0.0;

416 
r
[
j
] = 
x
[j];

417 
p
[
j
] = 
r
[j];

425 #´agm¨
omp
 
	`»duùiÚ
(+:
rho
)

426 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

427 
rho
 =„hØ+ 
r
[
j
]*r[j];

435 
cg™
 = 1; cg™ <ğ
cg™max
; cgit++) {

436 
rho0
 = 
rho
;

437 
d
 = 0.0;

438 
rho
 = 0.0;

439 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
,
k
,
sum
,
®pha
,
b‘a
è
	`sh¬ed
(
d
,
rho0
,
rho
)

456 #´agm¨
omp
 

457 
j
 = 1; j <ğ
Ï¡row
-
fœ¡row
+1; j++) {

458 
sum
 = 0.0;

459 
k
 = 
row¡r
[
j
]; k <„owstr[j+1]; k++) {

460 
sum
 = sum + 
a
[
k
]*
p
[
cŞidx
[k]];

463 
q
[
j
] = 
sum
;

524 #´agm¨
omp
 
	`»duùiÚ
(+:
d
)

525 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

526 
d
 = d + 
p
[
j
]*
q
[j];

528 #´agm¨
omp
 
b¬r›r


533 
®pha
 = 
rho0
 / 
d
;

544 #´agm¨
omp
 
	`»duùiÚ
(+:
rho
)

545 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

546 
z
[
j
] = z[j] + 
®pha
*
p
[j];

547 
r
[
j
] =„[j] - 
®pha
*
q
[j];

557 
rho
 =„hØ+ 
r
[
j
]*r[j];

565 
b‘a
 = 
rho
 / 
rho0
;

570 #´agm¨
omp
 
nowa™


571 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

572 
p
[
j
] = 
r
[j] + 
b‘a
*p[j];

574 
ÿÎcouÁ
++;

583 
sum
 = 0.0;

585 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
,
d
è
	`sh¬ed
(
sum
)

587 #´agm¨
omp
 

588 
j
 = 1; j <ğ
Ï¡row
-
fœ¡row
+1; j++) {

589 
d
 = 0.0;

590 
k
 = 
row¡r
[
j
]; k <=„owstr[j+1]-1; k++) {

591 
d
 = d + 
a
[
k
]*
z
[
cŞidx
[k]];

593 
r
[
j
] = 
d
;

599 #´agm¨
omp
 
	`»duùiÚ
(+:
sum
)

600 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

601 
d
 = 
x
[
j
] - 
r
[j];

602 
sum
 = sum + 
d
*d;

605 (*
ºÜm
èğ
	`sq¹
(
sum
);

606 
	}
}

633 
	$mak—
(

634 
n
,

635 
nz
,

636 
a
[],

637 
cŞidx
[],

638 
row¡r
[],

639 
nÚz”
,

640 
fœ¡row
,

641 
Ï¡row
,

642 
fœ¡cŞ
,

643 
Ï¡cŞ
,

644 
rcÚd
,

645 
¬ow
[],

646 
acŞ
[],

647 
«É
[],

648 
v
[],

649 
iv
[],

650 
shiá
 )

652 
i
, 
Âza
, 
iou‹r
, 
iv–t
, 
iv–t1
, 
œow
, 
nzv
;

658 
size
, 
¿tio
, 
sÿË
;

659 
jcŞ
;

661 
size
 = 1.0;

662 
¿tio
 = 
	`pow
(
rcÚd
, (1.0 / ()
n
));

663 
Âza
 = 0;

669 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
)

670 
i
 = 1; i <ğ
n
; i++) {

671 
cŞidx
[
n
+
i
] = 0;

673 
iou‹r
 = 1; iou‹¸<ğ
n
; iouter++) {

674 
nzv
 = 
nÚz”
;

675 
	`¥ºvc
(
n
, 
nzv
, 
v
, 
iv
, &(
cŞidx
[0]), &(colidx[n]));

676 
	`vec£t
(
n
, 
v
, 
iv
, &
nzv
, 
iou‹r
, 0.5);

677 
iv–t
 = 1; iv–ˆ<ğ
nzv
; ivelt++) {

678 
jcŞ
 = 
iv
[
iv–t
];

679 ià(
jcŞ
 >ğ
fœ¡cŞ
 && jcŞ <ğ
Ï¡cŞ
) {

680 
sÿË
 = 
size
 * 
v
[
iv–t
];

681 
iv–t1
 = 1; iv–t1 <ğ
nzv
; ivelt1++) {

682 
œow
 = 
iv
[
iv–t1
];

683 ià(
œow
 >ğ
fœ¡row
 && irow <ğ
Ï¡row
) {

684 
Âza
 =‚nza + 1;

685 ià(
Âza
 > 
nz
) {

686 
	`´štf
("Space for matrixƒlementsƒxceeded in"

688 
	`´štf
("Âza,‚zmax = %d, %d\n", 
Âza
, 
nz
);

689 
	`´štf
("iou‹¸ğ%d\n", 
iou‹r
);

690 
	`ex™
(1);

692 
acŞ
[
Âza
] = 
jcŞ
;

693 
¬ow
[
Âza
] = 
œow
;

694 
«É
[
Âza
] = 
v
[
iv–t1
] * 
sÿË
;

699 
size
 = siz* 
¿tio
;

706 
i
 = 
fœ¡row
; i <ğ
Ï¡row
; i++) {

707 ià(
i
 >ğ
fœ¡cŞ
 && i <ğ
Ï¡cŞ
) {

708 
iou‹r
 = 
n
 + 
i
;

709 
Âza
 =‚nza + 1;

710 ià(
Âza
 > 
nz
) {

711 
	`´štf
("Space for matrixƒlementsƒxceeded in makea\n");

712 
	`´štf
("Âza,‚zmax = %d, %d\n", 
Âza
, 
nz
);

713 
	`´štf
("iou‹¸ğ%d\n", 
iou‹r
);

714 
	`ex™
(1);

716 
acŞ
[
Âza
] = 
i
;

717 
¬ow
[
Âza
] = 
i
;

718 
«É
[
Âza
] = 
rcÚd
 - 
shiá
;

726 
	`¥¬£
(
a
, 
cŞidx
, 
row¡r
, 
n
, 
¬ow
, 
acŞ
, 
«É
,

727 
fœ¡row
, 
Ï¡row
, 
v
, &(
iv
[0]), &(iv[
n
]), 
Âza
);

728 
	}
}

734 
	$¥¬£
(

735 
a
[],

736 
cŞidx
[],

737 
row¡r
[],

738 
n
,

739 
¬ow
[],

740 
acŞ
[],

741 
«É
[],

742 
fœ¡row
,

743 
Ï¡row
,

744 
x
[],

745 
boŞ—n
 
m¬k
[],

746 
nzloc
[],

747 
Âza
)

753 
Äows
;

754 
i
, 
j
, 
jajp1
, 
nza
, 
k
, 
nzrow
;

755 
xi
;

760 
Äows
 = 
Ï¡row
 - 
fœ¡row
 + 1;

765 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
)

766 
j
 = 1; j <ğ
n
; j++) {

767 
row¡r
[
j
] = 0;

768 
m¬k
[
j
] = 
FALSE
;

770 
row¡r
[
n
+1] = 0;

772 
nza
 = 1;‚z¨<ğ
Âza
;‚za++) {

773 
j
 = (
¬ow
[
nza
] - 
fœ¡row
 + 1) + 1;

774 
row¡r
[
j
] =„owstr[j] + 1;

777 
row¡r
[1] = 1;

778 
j
 = 2; j <ğ
Äows
+1; j++) {

779 
row¡r
[
j
] =„owstr[j] +„owstr[j-1];

790 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
k
,
j
)

791 
j
 = 0;j <ğ
Äows
-1;j++) {

792 
k
 = 
row¡r
[
j
];k <=„owstr[j+1]-1;k++)

793 
a
[
k
] = 0.0;

798 
nza
 = 1;‚z¨<ğ
Âza
;‚za++) {

799 
j
 = 
¬ow
[
nza
] - 
fœ¡row
 + 1;

800 
k
 = 
row¡r
[
j
];

801 
a
[
k
] = 
«É
[
nza
];

802 
cŞidx
[
k
] = 
acŞ
[
nza
];

803 
row¡r
[
j
] =„owstr[j] + 1;

809 
j
 = 
Äows
; j >= 1; j--) {

810 
row¡r
[
j
+1] =„owstr[j];

812 
row¡r
[1] = 1;

817 
nza
 = 0;

818 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
)

819 
i
 = 1; i <ğ
n
; i++) {

820 
x
[
i
] = 0.0;

821 
m¬k
[
i
] = 
FALSE
;

824 
jajp1
 = 
row¡r
[1];

825 
j
 = 1; j <ğ
Äows
; j++) {

826 
nzrow
 = 0;

831 
k
 = 
jajp1
; k < 
row¡r
[
j
+1]; k++) {

832 
i
 = 
cŞidx
[
k
];

833 
x
[
i
] = x[i] + 
a
[
k
];

834 iàĞ
m¬k
[
i
] =ğ
FALSE
 && 
x
[i] != 0.0) {

835 
m¬k
[
i
] = 
TRUE
;

836 
nzrow
 =‚zrow + 1;

837 
nzloc
[
nzrow
] = 
i
;

844 
k
 = 1; k <ğ
nzrow
; k++) {

845 
i
 = 
nzloc
[
k
];

846 
m¬k
[
i
] = 
FALSE
;

847 
xi
 = 
x
[
i
];

848 
x
[
i
] = 0.0;

849 ià(
xi
 != 0.0) {

850 
nza
 =‚za + 1;

851 
a
[
nza
] = 
xi
;

852 
cŞidx
[
nza
] = 
i
;

855 
jajp1
 = 
row¡r
[
j
+1];

856 
row¡r
[
j
+1] = 
nza
 +„owstr[1];

858 
	}
}

869 
	$¥ºvc
(

870 
n
,

871 
nz
,

872 
v
[],

873 
iv
[],

874 
nzloc
[],

875 
m¬k
[] )

877 
Â1
;

878 
nzrow
, 
nzv
, 
ii
, 
i
;

879 
veûÉ
, 
veşoc
;

881 
nzv
 = 0;

882 
nzrow
 = 0;

883 
Â1
 = 1;

885 
Â1
 = 2 *‚n1;

886 } 
Â1
 < 
n
);

892 
nzv
 < 
nz
) {

893 
veûÉ
 = 
	`¿ndlc
(&
Œª
, 
amuÉ
);

898 
veşoc
 = 
	`¿ndlc
(&
Œª
, 
amuÉ
);

899 
i
 = 
	`iúv¹
(
veşoc
, 
Â1
) + 1;

900 ià(
i
 > 
n
) ;

905 ià(
m¬k
[
i
] == 0) {

906 
m¬k
[
i
] = 1;

907 
nzrow
 =‚zrow + 1;

908 
nzloc
[
nzrow
] = 
i
;

909 
nzv
 =‚zv + 1;

910 
v
[
nzv
] = 
veûÉ
;

911 
iv
[
nzv
] = 
i
;

915 
ii
 = 1; i˜<ğ
nzrow
; ii++) {

916 
i
 = 
nzloc
[
ii
];

917 
m¬k
[
i
] = 0;

919 
	}
}

924 
	$iúv¹
(
x
, 
wr2
) {

925  (()(
wr2
 * 
x
));

926 
	}
}

932 
	$vec£t
(

933 
n
,

934 
v
[],

935 
iv
[],

936 *
nzv
,

937 
i
,

938 
v®
)

940 
k
;

941 
boŞ—n
 
£t
;

943 
£t
 = 
FALSE
;

944 
k
 = 1; k <ğ*
nzv
; k++) {

945 ià(
iv
[
k
] =ğ
i
) {

946 
v
[
k
] = 
v®
;

947 
£t
 = 
TRUE
;

950 ià(
£t
 =ğ
FALSE
) {

951 *
nzv
 = *nzv + 1;

952 
v
[*
nzv
] = 
v®
;

953 
iv
[*
nzv
] = 
i
;

955 
	}
}

	@CG/npbparams.h

7 
	#NA
 150000

	)

8 
	#NONZER
 15

	)

9 
	#NITER
 75

	)

10 
	#SHIFT
 110.0

	)

11 
	#RCOND
 1.0e-1

	)

12 
	#CONVERTDOUBLE
 
FALSE


	)

13 
	#COMPILETIME
 "01 Feb 2021"

	)

14 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

15 
	#CS1
 "ÒÚe)"

	)

16 
	#CS2
 "ÒÚe)"

	)

17 
	#CS3
 "ÒÚe)"

	)

18 
	#CS4
 "ÒÚe)"

	)

19 
	#CS5
 "-o3 $(C_IN)"

	)

20 
	#CS6
 "ÒÚe)"

	)

21 
	#CS7
 "ÒÚe)"

	)

	@EP/ep.c

35 
	~"../commÚ/Åb-C.h
"

36 
	~"Åb·¿ms.h
"

37 
	~"../m©h/Çs_m©h.h
"

39 
	~<Çutus/Çutus.h
>

40 
	~<Çutus/sh–l.h
>

41 
	~<Çutus/libccom·t.h
>

43 
	#MK
 16

	)

44 
	#MM
 (
M
 - 
MK
)

	)

45 
	#NN
 (1 << 
MM
)

	)

46 
	#NK
 (1 << 
MK
)

	)

47 
	#NQ
 10

	)

48 
	#EPSILON
 1.0e-8

	)

49 
	#A
 1220703125.0

	)

50 
	#S
 271828183.0

	)

51 
	#TIMERS_ENABLED
 
FALSE


	)

55 
	gx
[2*
NK
];

56 #´agm¨
omp
 
th»ad´iv©e
(
x
)

57 
	gq
[
NQ
];

72 
´og¿m_EP
(*
buf
, * 
´iv
);

73 
´og¿m_EP_´ofe
(*
_
, *
__
);

75 
sh–l_cmd_im¶
 
	gÇs_•_im¶
 = {

76 .
cmd
 = "nas-ep",

77 .
	gh–p_¡r
 = "NAS…arallel benchmark EP",

78 .
	ghªdËr
 = 
´og¿m_EP_´ofe
,

80 
nk_»gi¡”_sh–l_cmd
(
Çs_•_im¶
);

83 
	$´og¿m_EP_´ofe
(*
_
, *
__
){

85 #ifdeà
NAUT_CONFIG_PROFILE


86 
	`nk_š¡rum’t_ş—r
();

87 
	`nk_š¡rum’t_¡¬t
();

89 
	`´og¿m_EP
(
_
,
__
);

90 #ifdeà
NAUT_CONFIG_PROFILE


91 
	`nk_š¡rum’t_’d
();

92 
	`nk_š¡rum’t_qu”y
();

95 
	}
}

97 
	$´og¿m_EP
(*
buf
, * 
´iv
) {

100 
Mİs
, 
t1
, 
t2
, 
t3
, 
t4
, 
x1
, 
x2
, 
sx
, 
sy
, 
tm
, 
ª
, 
‰
, 
gc
;

101 
dum
[3] = { 1.0, 1.0, 1.0 };

102 
Å
, 
›¼
, 
node
, 
no_nodes
, 
i
, 
ik
, 
kk
, 
l
, 
k
, 
n™
, 
›¼code
,

103 
no_Ïrge_nodes
, 
Å_add
, 
k_off£t
, 
j
;

104 
Áh»ads
 = 1;

105 
boŞ—n
 
v”if›d
;

106 
size
[13+1];

115 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

117 
	`¥rštf
(
size
, "%12.0f", 
	`pow
(2.0, 
M
+1));

118 
j
 = 13; j >= 1; j--) {

119 ià(
size
[
j
] == '.') size[j] = ' ';

121 
	`´štf
(" Numb” oà¿ndom‚umb” g’”©ed: %13s\n", 
size
);

123 
v”if›d
 = 
FALSE
;

130 
Å
 = 
NN
;

138 
	`v¿Æc
(0, &(
dum
[0]), dum[1], &(dum[2]));

139 
dum
[0] = 
	`¿ndlc
(&(dum[1]), dum[2]);

142 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
)

143 
i
 = 0; i < 2*
NK
; i++è
x
[i] = -1.0e99;

145 
Mİs
 = 
	`log
(
	`sq¹
(
	`çbs
(
	`max
(1.0, 1.0))));

147 
	`tim”_ş—r
(1);

148 
	`tim”_ş—r
(2);

149 
	`tim”_ş—r
(3);

150 
	`tim”_¡¬t
(1);

151 
	`v¿Æc
(0, &
t1
, 
A
, 
x
);

157 
t1
 = 
A
;

159  
i
 = 1; i <ğ
MK
+1; i++) {

160 
t2
 = 
	`¿ndlc
(&
t1
,1);

163 
ª
 = 
t1
;

164 
‰
 = 
S
;

165 
gc
 = 0.0;

166 
sx
 = 0.0;

167 
sy
 = 0.0;

169  
i
 = 0; i <ğ
NQ
 - 1; i++) {

170 
q
[
i
] = 0.0;

178 
k_off£t
 = -1;

180 #´agm¨
omp
 
·¿Î–
 
	`cİyš
(
x
)

183 
t1
, 
t2
, 
t3
, 
t4
, 
x1
, 
x2
;

184 
kk
, 
i
, 
ik
, 
l
;

185 
qq
[
NQ
];

187 
i
 = 0; i < 
NQ
; i++è
qq
[i] = 0.0;

189 #´agm¨
omp
 
	`»duùiÚ
(+:
sx
,
sy
è
	`scheduË
()

190 
k
 = 1; k <ğ
Å
; k++) {

191 
kk
 = 
k_off£t
 + 
k
;

192 
t1
 = 
S
;

193 
t2
 = 
ª
;

197 
i
 = 1; i <= 100; i++) {

198 
ik
 = 
kk
 / 2;

199 ià(2 * 
ik
 !ğ
kk
è
t3
 = 
	`¿ndlc
(&
t1
, 
t2
);

200 ià(
ik
 == 0) ;

201 
t3
 = 
	`¿ndlc
(&
t2
,2);

202 
kk
 = 
ik
;

207 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡¬t
(3);

208 
	`v¿Æc
(2*
NK
, &
t1
, 
A
, 
x
-1);

209 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡İ
(3);

216 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡¬t
(2);

218  
i
 = 0; i < 
NK
; i++) {

219 
x1
 = 2.0 * 
x
[2*
i
] - 1.0;

220 
x2
 = 2.0 * 
x
[2*
i
+1] - 1.0;

221 
t1
 = 
	`pow2
(
x1
è+…ow2(
x2
);

222 ià(
t1
 <= 1.0) {

223 
t2
 = 
	`sq¹
(-2.0 * 
	`log
(
t1
) /1);

224 
t3
 = (
x1
 * 
t2
);

225 
t4
 = (
x2
 * 
t2
);

226 
l
 = 
	`max
(
	`çbs
(
t3
), fabs(
t4
));

227 
qq
[
l
] += 1.0;

228 
sx
 = sx + 
t3
;

229 
sy
 = sy + 
t4
;

232 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡İ
(2);

234 #´agm¨
omp
 
	`ü™iÿl
(
•
)

236 
i
 = 0; i <ğ
NQ
 - 1; i++è
q
[i] +ğ
qq
[i];

238 #ià
	`defšed
(
_OPENMP
)

239 #´agm¨
omp
 
ma¡”


240 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

247 
i
 = 0; i <ğ
NQ
-1; i++) {

248 
gc
 = gø+ 
q
[
i
];

251 
	`tim”_¡İ
(1);

252 
tm
 = 
	`tim”_»ad
(1);

254 
n™
 = 0;

255 ià(
M
 == 24) {

256 if((
	`çbs
((
sx
- (-3.247834652034740e3))/sxè<ğ
EPSILON
) &&

257 (
	`çbs
((
sy
- (-6.958407078382297e3))/syè<ğ
EPSILON
)) {

258 
v”if›d
 = 
TRUE
;

260 } ià(
M
 == 25) {

261 ià((
	`çbs
((
sx
- (-2.863319731645753e3))/sxè<ğ
EPSILON
) &&

262 (
	`çbs
((
sy
- (-6.320053679109499e3))/syè<ğ
EPSILON
)) {

263 
v”if›d
 = 
TRUE
;

265 } ià(
M
 == 28) {

266 ià((
	`çbs
((
sx
- (-4.295875165629892e3))/sxè<ğ
EPSILON
) &&

267 (
	`çbs
((
sy
- (-1.580732573678431e4))/syè<ğ
EPSILON
)) {

268 
v”if›d
 = 
TRUE
;

270 } ià(
M
 == 30) {

271 ià((
	`çbs
((
sx
- (4.033815542441498e4))/sxè<ğ
EPSILON
) &&

272 (
	`çbs
((
sy
- (-2.660669192809235e4))/syè<ğ
EPSILON
)) {

273 
v”if›d
 = 
TRUE
;

275 } ià(
M
 == 32) {

276 ià((
	`çbs
((
sx
- (4.764367927995374e4))/sxè<ğ
EPSILON
) &&

277 (
	`çbs
((
sy
- (-8.084072988043731e4))/syè<ğ
EPSILON
)) {

278 
v”if›d
 = 
TRUE
;

282 
Mİs
 = 
	`pow
(2.0, 
M
+1)/
tm
/1000000.0;

284 
	`´štf
("EP Benchmark Results: \n"

290 
tm
, 
M
, 
gc
, 
sx
, 
sy
);

291 
i
 = 0; i <ğ
NQ
-1; i++) {

292 
	`´štf
("%3d %15.0f\n", 
i
, 
q
[i]);

295 
	`c_´št_»suÉs
("EP", 
CLASS
, 
M
+1, 0, 0, 
n™
, 
Áh»ads
,

296 
tm
, 
Mİs
,

298 
v”if›d
, 
NPBVERSION
, 
COMPILETIME
,

299 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

301 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

302 
	`´štf
("TÙ®ime: %f", 
	`tim”_»ad
(1));

303 
	`´štf
("GaussŸÀ·œs: %f", 
	`tim”_»ad
(2));

304 
	`´štf
("Rªdom‚umb”s: %f", 
	`tim”_»ad
(3));

306 
	}
}

	@EP/npbparams.h

7 
	#CLASS
 'C'

	)

8 
	#M
 32

	)

9 
	#CONVERTDOUBLE
 
FALSE


	)

10 
	#COMPILETIME
 "01 Feb 2021"

	)

11 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

12 
	#CS1
 "ÒÚe)"

	)

13 
	#CS2
 "ÒÚe)"

	)

14 
	#CS3
 "ÒÚe)"

	)

15 
	#CS4
 "ÒÚe)"

	)

16 
	#CS5
 "-o3 $(C_IN)"

	)

17 
	#CS6
 "ÒÚe)"

	)

18 
	#CS7
 "ÒÚe)"

	)

	@FT/ft.c

34 
	~"../commÚ/Åb-C.h
"

35 
	~"../m©h/Çs_m©h.h
"

37 
	~"glob®.h
"

39 
	~<Çutus/Çutus.h
>

40 
	~<Çutus/sh–l.h
>

43 
evŞve
(
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
], dcom¶ex 
u1
[NZ][NY][NX],

44 
t
, 
šdexm­
[
NZ
][
NY
][
NX
], 
d
[3]);

45 
compu‹_š™Ÿl_cÚd™iÚs
(
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
], 
d
[3]);

46 
ow46
(
a
, 
expÚ’t
, *
»suÉ
);

47 
£tup
();

48 
compu‹_šdexm­
(
šdexm­
[
NZ
][
NY
][
NX
], 
d
[3]);

49 
´št_tim”s
();

50 
fá
(
dœ
, 
dcom¶ex
 
x1
[
NZ
][
NY
][
NX
], dcom¶ex 
x2
[NZ][NY][NX]);

51 
cfás1
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

52 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

53 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

54 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]);

55 
cfás2
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

56 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

57 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

58 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]);

59 
cfás3
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

60 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

61 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

62 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]);

63 
fá_š™
 (
n
);

64 
cfáz
 (
is
, 
m
, 
n
, 
dcom¶ex
 
x
[
NX
][
FFTBLOCKPAD
],

65 
dcom¶ex
 
y
[
NX
][
FFTBLOCKPAD
]);

66 
fáz2
 (
is
, 
l
, 
m
, 
n
, 
ny
, 
ny1
,

67 
dcom¶ex
 
u
[
NX
], dcom¶ex 
x
[NX][
FFTBLOCKPAD
],

68 
dcom¶ex
 
y
[
NX
][
FFTBLOCKPAD
]);

69 
og2
(
n
);

70 
checksum
(
i
, 
dcom¶ex
 
u1
[
NZ
][
NY
][
NX
], 
d
[3]);

71 
v”ify
 (
d1
, 
d2
, 
d3
, 
Á
,

72 
boŞ—n
 *
v”if›d
, *
şass
);

78 
´og¿m_FT
(*
_buf
, * 
_´iv
);

80 
sh–l_cmd_im¶
 
	gÇs_á_im¶
 = {

81 .
cmd
 = "nas-ft",

82 .
	gh–p_¡r
 = "NAS…arallel benchmark FT",

83 .
	ghªdËr
 = 
´og¿m_FT
,

85 
nk_»gi¡”_sh–l_cmd
(
Çs_á_im¶
);

87 
	$´og¿m_FT
(* 
_buf
, *
_´iv
) {

92 
i
, 
›¼
;

112 
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
];

113 
dcom¶ex
 
·d1
[3];

114 
dcom¶ex
 
u1
[
NZ
][
NY
][
NX
];

115 
dcom¶ex
 
·d2
[3];

116 
dcom¶ex
 
u2
[
NZ
][
NY
][
NX
];

117 
dcom¶ex
 
·d3
[3];

118 
šdexm­
[
NZ
][
NY
][
NX
];

120 
™”
;

121 
Áh»ads
 = 1;

122 
tÙ®_time
, 
mæİs
;

123 
boŞ—n
 
v”if›d
;

124 
şass
;

131 
i
 = 0; i < 
T_MAX
; i++) {

132 
	`tim”_ş—r
(
i
);

134 
	`£tup
();

136 
	`compu‹_šdexm­
(
šdexm­
, 
dims
[2]);

138 
	`compu‹_š™Ÿl_cÚd™iÚs
(
u1
, 
dims
[0]);

139 
	`fá_š™
 (
dims
[0][0]);

142 
	`fá
(1, 
u1
, 
u0
);

150 
i
 = 0; i < 
T_MAX
; i++) {

151 
	`tim”_ş—r
(
i
);

154 
	`tim”_¡¬t
(
T_TOTAL
);

155 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡¬t
(
T_SETUP
);

157 
	`compu‹_šdexm­
(
šdexm­
, 
dims
[2]);

159 
	`compu‹_š™Ÿl_cÚd™iÚs
(
u1
, 
dims
[0]);

160 
	`fá_š™
 (
dims
[0][0]);

163 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

164 
	`tim”_¡İ
(
T_SETUP
);

166 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

167 
	`tim”_¡¬t
(
T_FFT
);

170 
	`fá
(1, 
u1
, 
u0
);

171 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

172 
	`tim”_¡İ
(
T_FFT
);

175 
™”
 = 1; i‹¸<ğ
n™”
; iter++) {

176 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

177 
	`tim”_¡¬t
(
T_EVOLVE
);

180 
	`evŞve
(
u0
, 
u1
, 
™”
, 
šdexm­
, 
dims
[0]);

182 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

183 
	`tim”_¡İ
(
T_EVOLVE
);

185 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

186 
	`tim”_¡¬t
(
T_FFT
);

189 
	`fá
(-1, 
u1
, 
u2
);

191 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

192 
	`tim”_¡İ
(
T_FFT
);

194 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

195 
	`tim”_¡¬t
(
T_CHECKSUM
);

197 
	`checksum
(
™”
, 
u2
, 
dims
[0]);

199 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

200 
	`tim”_¡İ
(
T_CHECKSUM
);

205 
	`v”ify
(
NX
, 
NY
, 
NZ
, 
n™”
, &
v”if›d
, &
şass
);

207 #´agm¨
omp
 
·¿Î–


210 #ià
	`defšed
(
_OPENMP
)

211 #´agm¨
omp
 
ma¡”


212 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

216 
	`tim”_¡İ
(
T_TOTAL
);

217 
tÙ®_time
 = 
	`tim”_»ad
(
T_TOTAL
);

219 ifĞ
tÙ®_time
 != 0.0) {

220 
mæİs
 = 1.0e-6*()(
NTOTAL
) *

221 (14.8157+7.19641*
	`log
(()(
NTOTAL
))

222 + (5.23518+7.21113*
	`log
(()(
NTOTAL
)))*
n™”
)

223 /
tÙ®_time
;

225 
mæİs
 = 0.0;

227 
	`c_´št_»suÉs
("FT", 
şass
, 
NX
, 
NY
, 
NZ
, 
n™”
, 
Áh»ads
,

228 
tÙ®_time
, 
mæİs
, " flßtšg…ošt", 
v”if›d
,

229 
NPBVERSION
, 
COMPILETIME
,

230 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

231 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`´št_tim”s
();

232 
	}
}

237 
	$evŞve
(
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
], dcom¶ex 
u1
[NZ][NY][NX],

238 
t
, 
šdexm­
[
NZ
][
NY
][
NX
], 
d
[3]) {

247 
i
, 
j
, 
k
;

249 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
)

250 
k
 = 0; k < 
d
[2]; k++) {

251 
j
 = 0; j < 
d
[1]; j++) {

252 
i
 = 0; i < 
d
[0]; i++) {

253 
	`ümul
(
u1
[
k
][
j
][
i
], 
u0
[k][j][i], 
ex
[
t
*
šdexm­
[k][j][i]]);

257 
	}
}

262 
	$compu‹_š™Ÿl_cÚd™iÚs
(
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
], 
d
[3]) {

272 
k
;

273 
x0
, 
¡¬t
, 
ª
, 
dummy
;

274 
tmp
[
NX
*2*
MAXDIM
+1];

275 
i
,
j
,
t
;

277 
¡¬t
 = 
SEED
;

281 
	`ow46
(
A
, (
z¡¬t
[0]-1)*2*
NX
*
NY
 + (
y¡¬t
[0]-1)*2*NX, &
ª
);

282 
dummy
 = 
	`¿ndlc
(&
¡¬t
, 
ª
);

283 
	`ow46
(
A
, 2*
NX
*
NY
, &
ª
);

288 
k
 = 0; k < 
dims
[0][2]; k++) {

289 
x0
 = 
¡¬t
;

290 
	`v¿Æc
(2*
NX
*
dims
[0][1], &
x0
, 
A
, 
tmp
);

292 
t
 = 1;

293 
j
 = 0; j < 
dims
[0][1]; j++)

294 
i
 = 0; i < 
NX
; i++) {

295 
u0
[
k
][
j
][
i
].
»®
 = 
tmp
[
t
++];

296 
u0
[
k
][
j
][
i
].
imag
 = 
tmp
[
t
++];

299 ià(
k
 !ğ
dims
[0][2]è
dummy
 = 
	`¿ndlc
(&
¡¬t
, 
ª
);

301 
	}
}

306 
	$ow46
(
a
, 
expÚ’t
, *
»suÉ
) {

315 
dummy
, 
q
, 
r
;

316 
n
, 
n2
;

323 *
»suÉ
 = 1;

324 ià(
expÚ’t
 == 0) ;

325 
q
 = 
a
;

326 
r
 = 1;

327 
n
 = 
expÚ’t
;

329 
n
 > 1) {

330 
n2
 = 
n
/2;

331 ià(
n2
 * 2 =ğ
n
) {

332 
dummy
 = 
	`¿ndlc
(&
q
, q);

333 
n
 = 
n2
;

335 
dummy
 = 
	`¿ndlc
(&
r
, 
q
);

336 
n
 =‚-1;

339 
dummy
 = 
	`¿ndlc
(&
r
, 
q
);

340 *
»suÉ
 = 
r
;

341 
	}
}

346 
	$£tup
() {

351 
›¼
, 
i
, 
j
, 
f¡©us
;

353 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

356 
n™”
 = 
NITER_DEFAULT
;

358 
	`´štf
(" Siz : %3dx%3dx%3d\n", 
NX
, 
NY
, 
NZ
);

359 
	`´štf
(" I‹¿tiÚ  : %7d\n", 
n™”
);

366 
i
 = 0;i < 3 ; i++) {

367 
dims
[
i
][0] = 
NX
;

368 
dims
[
i
][1] = 
NY
;

369 
dims
[
i
][2] = 
NZ
;

373 
i
 = 0; i < 3; i++) {

374 
x¡¬t
[
i
] = 1;

375 
x’d
[
i
] = 
NX
;

376 
y¡¬t
[
i
] = 1;

377 
y’d
[
i
] = 
NY
;

378 
z¡¬t
[
i
] = 1;

379 
z’d
[
i
] = 
NZ
;

397 
fáblock
 = 
FFTBLOCK_DEFAULT
;

398 
fáblock·d
 = 
FFTBLOCKPAD_DEFAULT
;

400 ià(
fáblock
 !ğ
FFTBLOCK_DEFAULT
è
fáblock·d
 = fftblock+3;

401 
	}
}

406 
	$compu‹_šdexm­
(
šdexm­
[
NZ
][
NY
][
NX
], 
d
[3]) {

416 
i
, 
j
, 
k
, 
ii
, 
ii2
, 
jj
, 
ij2
, 
kk
;

417 
­
;

428 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
ii
,
ii2
,
jj
,
ij2
,
kk
)

429 
i
 = 0; i < 
dims
[2][0]; i++) {

430 
ii
 = (
i
+1+
x¡¬t
[2]-2+
NX
/2)%NX - NX/2;

431 
ii2
 = 
ii
*ii;

432 
j
 = 0; j < 
dims
[2][1]; j++) {

433 
jj
 = (
j
+1+
y¡¬t
[2]-2+
NY
/2)%NY - NY/2;

434 
ij2
 = 
jj
*jj+
ii2
;

435 
k
 = 0; k < 
dims
[2][2]; k++) {

436 
kk
 = (
k
+1+
z¡¬t
[2]-2+
NZ
/2)%NZ - NZ/2;

437 
šdexm­
[
k
][
j
][
i
] = 
kk
*kk+
ij2
;

445 
­
 = - 4.0 * 
ALPHA
 * 
PI
 * PI;

447 
ex
[0] = 1.0;

448 
ex
[1] = 
	`exp
(
­
);

449 
i
 = 2; i <ğ
EXPMAX
; i++) {

450 
ex
[
i
] =ƒx[i-1]*ex[1];

453 
	}
}

458 
	$´št_tim”s
() {

463 
i
;

464 *
t¡ršgs
[] = { "otal ",

472 
i
 = 0; i < 
T_MAX
; i++) {

473 ià(
	`tim”_»ad
(
i
) != 0.0) {

474 
	`´štf
("tim” %2d(%16sĞ:%10.6f\n", 
i
, 
t¡ršgs
[i], 
	`tim”_»ad
(i));

477 
	}
}

483 
	$fá
(
dœ
, 
dcom¶ex
 
x1
[
NZ
][
NY
][
NX
], dcom¶ex 
x2
[NZ][NY][NX]) {

488 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
];

489 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
];

498 ià(
dœ
 == 1) {

499 
	`cfás1
(1, 
dims
[0], 
x1
, x1, 
y0
, 
y1
);

500 
	`cfás2
(1, 
dims
[1], 
x1
, x1, 
y0
, 
y1
);

501 
	`cfás3
(1, 
dims
[2], 
x1
, 
x2
, 
y0
, 
y1
);

503 
	`cfás3
(-1, 
dims
[2], 
x1
, x1, 
y0
, 
y1
);

504 
	`cfás2
(-1, 
dims
[1], 
x1
, x1, 
y0
, 
y1
);

505 
	`cfás1
(-1, 
dims
[0], 
x1
, 
x2
, 
y0
, 
y1
);

507 
	}
}

513 
	$cfás1
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

514 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

515 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

516 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]) {

521 
logd
[3];

522 
i
, 
j
, 
k
, 
jj
;

524 
i
 = 0; i < 3; i++) {

525 
logd
[
i
] = 
	`og2
(
d
[i]);

528 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
jj
è
	`sh¬ed
(
is
)

530 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
];

531 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
];

533 #´agm¨
omp
 

534 
k
 = 0; k < 
d
[2]; k++) {

535 
jj
 = 0; jj <ğ
d
[1] - 
fáblock
; jj+=fftblock) {

537 
j
 = 0; j < 
fáblock
; j++) {

538 
i
 = 0; i < 
d
[0]; i++) {

540 
y0
[
i
][
j
].
»®
 = 
x
[
k
][j+
jj
][i].real;

542 
y0
[
i
][
j
].
imag
 = 
x
[
k
][j+
jj
][i].imag;

548 
	`cfáz
 (
is
, 
logd
[0],

549 
d
[0], 
y0
, 
y1
);

553 
j
 = 0; j < 
fáblock
; j++) {

554 
i
 = 0; i < 
d
[0]; i++) {

555 
xout
[
k
][
j
+
jj
][
i
].
»®
 = 
y0
[i][j].real;

556 
xout
[
k
][
j
+
jj
][
i
].
imag
 = 
y0
[i][j].imag;

563 
	}
}

568 
	$cfás2
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

569 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

570 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

571 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]) {

576 
logd
[3];

577 
i
, 
j
, 
k
, 
ii
;

579 
i
 = 0; i < 3; i++) {

580 
logd
[
i
] = 
	`og2
(
d
[i]);

582 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
ii
è
	`sh¬ed
(
is
)

584 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
];

585 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
];

587 #´agm¨
omp
 

588 
k
 = 0; k < 
d
[2]; k++) {

589 
ii
 = 0; i˜<ğ
d
[0] - 
fáblock
; ii+=fftblock) {

591 
j
 = 0; j < 
d
[1]; j++) {

592 
i
 = 0; i < 
fáblock
; i++) {

593 
y0
[
j
][
i
].
»®
 = 
x
[
k
][j][i+
ii
].real;

594 
y0
[
j
][
i
].
imag
 = 
x
[
k
][j][i+
ii
].imag;

599 
	`cfáz
 (
is
, 
logd
[1],

600 
d
[1], 
y0
, 
y1
);

604 
j
 = 0; j < 
d
[1]; j++) {

605 
i
 = 0; i < 
fáblock
; i++) {

606 
xout
[
k
][
j
][
i
+
ii
].
»®
 = 
y0
[j][i].real;

607 
xout
[
k
][
j
][
i
+
ii
].
imag
 = 
y0
[j][i].imag;

614 
	}
}

618 
	$cfás3
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

619 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

620 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

621 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]) {

626 
logd
[3];

627 
i
, 
j
, 
k
, 
ii
;

629 
i
 = 0;i < 3; i++) {

630 
logd
[
i
] = 
	`og2
(
d
[i]);

632 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
ii
è
	`sh¬ed
(
is
)

634 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
];

635 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
];

637 #´agm¨
omp
 

638 
j
 = 0; j < 
d
[1]; j++) {

639 
ii
 = 0; i˜<ğ
d
[0] - 
fáblock
; ii+=fftblock) {

641 
k
 = 0; k < 
d
[2]; k++) {

642 
i
 = 0; i < 
fáblock
; i++) {

643 
y0
[
k
][
i
].
»®
 = 
x
[k][
j
][i+
ii
].real;

644 
y0
[
k
][
i
].
imag
 = 
x
[k][
j
][i+
ii
].imag;

650 
	`cfáz
 (
is
, 
logd
[2],

651 
d
[2], 
y0
, 
y1
);

654 
k
 = 0; k < 
d
[2]; k++) {

655 
i
 = 0; i < 
fáblock
; i++) {

656 
xout
[
k
][
j
][
i
+
ii
].
»®
 = 
y0
[k][i].real;

657 
xout
[
k
][
j
][
i
+
ii
].
imag
 = 
y0
[k][i].imag;

664 
	}
}

669 
	$fá_š™
 (
n
) {

678 
m
,
nu
,
ku
,
i
,
j
,
Ê
;

679 
t
, 
ti
;

686 
nu
 = 
n
;

687 
m
 = 
	`og2
(
n
);

688 
u
[0].
»®
 = ()
m
;

689 
u
[0].
imag
 = 0.0;

690 
ku
 = 1;

691 
Ê
 = 1;

693 
j
 = 1; j <ğ
m
; j++) {

694 
t
 = 
PI
 / 
Ê
;

696 
i
 = 0; i <ğ
Ê
 - 1; i++) {

697 
ti
 = 
i
 * 
t
;

698 
u
[
i
+
ku
].
»®
 = 
	`cos
(
ti
);

699 
u
[
i
+
ku
].
imag
 = 
	`sš
(
ti
);

702 
ku
 = ku + 
Ê
;

703 
Ê
 = 2 *†n;

705 
	}
}

711 
	$cfáz
 (
is
, 
m
, 
n
, 
dcom¶ex
 
x
[
NX
][
FFTBLOCKPAD
],

712 
dcom¶ex
 
y
[
NX
][
FFTBLOCKPAD
]) {

726 
i
,
j
,
l
,
mx
;

731 
mx
 = ()(
u
[0].
»®
);

732 ià((
is
 !ğ1 && i !ğ-1è|| 
m
 < 1 || m > 
mx
) {

733 
	`´štf
("CFFTZ: Either U has‚ot been initialized, orƒlse\n"

735 
is
, 
m
, 
mx
);

736 
	`ex™
(1);

742 
l
 = 1;† <ğ
m
;†+=2) {

743 
	`fáz2
 (
is
, 
l
, 
m
, 
n
, 
fáblock
, 
fáblock·d
, 
u
, 
x
, 
y
);

744 ià(
l
 =ğ
m
) ;

745 
	`fáz2
 (
is
, 
l
 + 1, 
m
, 
n
, 
fáblock
, 
fáblock·d
, 
u
, 
y
, 
x
);

751 ià(
m
 % 2 == 1) {

752 
j
 = 0; j < 
n
; j++) {

753 
i
 = 0; i < 
fáblock
; i++) {

754 
x
[
j
][
i
].
»®
 = 
y
[j][i].real;

755 
x
[
j
][
i
].
imag
 = 
y
[j][i].imag;

759 
	}
}

765 
	$fáz2
 (
is
, 
l
, 
m
, 
n
, 
ny
, 
ny1
,

766 
dcom¶ex
 
u
[
NX
], dcom¶ex 
x
[NX][
FFTBLOCKPAD
],

767 
dcom¶ex
 
y
[
NX
][
FFTBLOCKPAD
]) {

776 
k
,
n1
,
li
,
lj
,
lk
,
ku
,
i
,
j
,
i11
,
i12
,
i21
,
i22
;

777 
dcom¶ex
 
u1
,
x11
,
x21
;

783 
n1
 = 
n
 / 2;

784 ià(
l
-1 == 0) {

785 
lk
 = 1;

787 
lk
 = 2 << ((
l
 - 1)-1);

789 ià(
m
-
l
 == 0) {

790 
li
 = 1;

792 
li
 = 2 << ((
m
 - 
l
)-1);

794 
lj
 = 2 * 
lk
;

795 
ku
 = 
li
;

797 
i
 = 0; i < 
li
; i++) {

799 
i11
 = 
i
 * 
lk
;

800 
i12
 = 
i11
 + 
n1
;

801 
i21
 = 
i
 * 
lj
;

802 
i22
 = 
i21
 + 
lk
;

803 ià(
is
 >= 1) {

804 
u1
.
»®
 = 
u
[
ku
+
i
].real;

805 
u1
.
imag
 = 
u
[
ku
+
i
].imag;

807 
u1
.
»®
 = 
u
[
ku
+
i
].real;

808 
u1
.
imag
 = -
u
[
ku
+
i
].imag;

814 
k
 = 0; k < 
lk
; k++) {

815 
j
 = 0; j < 
ny
; j++) {

816 
x11»®
, 
x11imag
;

817 
x21»®
, 
x21imag
;

818 
x11»®
 = 
x
[
i11
+
k
][
j
].
»®
;

819 
x11imag
 = 
x
[
i11
+
k
][
j
].
imag
;

820 
x21»®
 = 
x
[
i12
+
k
][
j
].
»®
;

821 
x21imag
 = 
x
[
i12
+
k
][
j
].
imag
;

822 
y
[
i21
+
k
][
j
].
»®
 = 
x11»®
 + 
x21»®
;

823 
y
[
i21
+
k
][
j
].
imag
 = 
x11imag
 + 
x21imag
;

824 
y
[
i22
+
k
][
j
].
»®
 = 
u1
.»® * (
x11»®
 - 
x21»®
)

825 - 
u1
.
imag
 * (
x11imag
 - 
x21imag
);

826 
y
[
i22
+
k
][
j
].
imag
 = 
u1
.
»®
 * (
x11imag
 - 
x21imag
)

827 + 
u1
.
imag
 * (
x11»®
 - 
x21»®
);

831 
	}
}

837 
	$og2
(
n
) {

842 
Â
, 
lg
;

844 ià(
n
 == 1) {

847 
lg
 = 1;

848 
Â
 = 2;

849 
Â
 < 
n
) {

850 
Â
 =‚n << 1;

851 
lg
++;

854  
lg
;

855 
	}
}

861 
	$checksum
(
i
, 
dcom¶ex
 
u1
[
NZ
][
NY
][
NX
], 
d
[3]) {

863 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
)

869 
j
, 
q
,
r
,
s
, 
›¼
;

870 
dcom¶ex
 
chk
,
®lchk
;

872 
chk
.
»®
 = 0.0;

873 
chk
.
imag
 = 0.0;

876 #´agm¨
omp
 
nowa™


877 
j
 = 1; j <= 1024; j++) {

878 
q
 = 
j
%
NX
+1;

879 ià(
q
 >ğ
x¡¬t
[0] && q <ğ
x’d
[0]) {

880 
r
 = (3*
j
)%
NY
+1;

881 ià(
r
 >ğ
y¡¬t
[0] &&„ <ğ
y’d
[0]) {

882 
s
 = (5*
j
)%
NZ
+1;

883 ià(
s
 >ğ
z¡¬t
[0] && s <ğ
z’d
[0]) {

884 
	`ÿdd
(
chk
,chk,
u1
[
s
-
z¡¬t
[0]][
r
-
y¡¬t
[0]][
q
-
x¡¬t
[0]]);

889 #´agm¨
omp
 
ü™iÿl


891 
sums
[
i
].
»®
 +ğ
chk
.real;

892 
sums
[
i
].
imag
 +ğ
chk
.imag;

894 #´agm¨
omp
 
b¬r›r


895 #´agm¨
omp
 
sšgË


898 
sums
[
i
].
»®
 = sums[i].»®/()(
NTOTAL
);

899 
sums
[
i
].
imag
 = sums[i].imag/()(
NTOTAL
);

901 
	`´štf
("T = %5d Checksum = %22.12e %22.12e\n",

902 
i
, 
sums
[i].
»®
, sums[i].
imag
);

905 
	}
}

910 
	$v”ify
 (
d1
, 
d2
, 
d3
, 
Á
,

911 
boŞ—n
 *
v”if›d
, *
şass
) {

916 
›¼
, 
size
, 
i
;

917 
”r
, 
•sÚ
;

926 
vd©a_»®_s
[6+1] = { 0.0,

933 
vd©a_imag_s
[6+1] = { 0.0,

943 
vd©a_»®_w
[6+1] = { 0.0,

950 
vd©a_imag_w
[6+1] = { 0.0,

960 
vd©a_»®_a
[6+1] = { 0.0,

967 
vd©a_imag_a
[6+1] = { 0.0,

977 
vd©a_»®_b
[20+1] = { 0.0,

998 
vd©a_imag_b
[20+1] = { 0.0,

1022 
vd©a_»®_c
[20+1] = { 0.0,

1043 
vd©a_imag_c
[20+1] = { 0.0,

1065 
•sÚ
 = 1.0e-12;

1066 *
v”if›d
 = 
TRUE
;

1067 *
şass
 = 'U';

1069 ià(
d1
 == 64 &&

1070 
d2
 == 64 &&

1071 
d3
 == 64 &&

1072 
Á
 == 6) {

1073 *
şass
 = 'S';

1074 
i
 = 1; i <ğ
Á
; i++) {

1075 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_s
[i]) / vdata_real_s[i];

1076 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1077 *
v”if›d
 = 
FALSE
;

1080 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_s
[i]) / vdata_imag_s[i];

1081 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1082 *
v”if›d
 = 
FALSE
;

1086 } ià(
d1
 == 128 &&

1087 
d2
 == 128 &&

1088 
d3
 == 32 &&

1089 
Á
 == 6) {

1090 *
şass
 = 'W';

1091 
i
 = 1; i <ğ
Á
; i++) {

1092 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_w
[i]) / vdata_real_w[i];

1093 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1094 *
v”if›d
 = 
FALSE
;

1097 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_w
[i]) / vdata_imag_w[i];

1098 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1099 *
v”if›d
 = 
FALSE
;

1103 } ià(
d1
 == 256 &&

1104 
d2
 == 256 &&

1105 
d3
 == 128 &&

1106 
Á
 == 6) {

1107 *
şass
 = 'A';

1108 
i
 = 1; i <ğ
Á
; i++) {

1109 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_a
[i]) / vdata_real_a[i];

1110 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1111 *
v”if›d
 = 
FALSE
;

1114 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_a
[i]) / vdata_imag_a[i];

1115 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1116 *
v”if›d
 = 
FALSE
;

1120 } ià(
d1
 == 512 &&

1121 
d2
 == 256 &&

1122 
d3
 == 256 &&

1123 
Á
 == 20) {

1124 *
şass
 = 'B';

1125 
i
 = 1; i <ğ
Á
; i++) {

1126 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_b
[i]) / vdata_real_b[i];

1127 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1128 *
v”if›d
 = 
FALSE
;

1131 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_b
[i]) / vdata_imag_b[i];

1132 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1133 *
v”if›d
 = 
FALSE
;

1137 } ià(
d1
 == 512 &&

1138 
d2
 == 512 &&

1139 
d3
 == 512 &&

1140 
Á
 == 20) {

1141 *
şass
 = 'C';

1142 
i
 = 1; i <ğ
Á
; i++) {

1143 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_c
[i]) / vdata_real_c[i];

1144 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1145 *
v”if›d
 = 
FALSE
;

1148 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_c
[i]) / vdata_imag_c[i];

1149 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1150 *
v”if›d
 = 
FALSE
;

1156 ià(*
şass
 != 'U') {

1157 
	`´štf
("Result verification successful\n");

1159 
	`´štf
("Result verification failed\n");

1161 
	`´štf
("şas ğ%1c\n", *
şass
);

1162 
	}
}

	@FT/global.h

1 
	~"Åb·¿ms.h
"

20 
	#FFTBLOCK_DEFAULT
 16

	)

21 
	#FFTBLOCKPAD_DEFAULT
 18

	)

23 
	#FFTBLOCK
 
FFTBLOCK_DEFAULT


	)

24 
	#FFTBLOCKPAD
 
FFTBLOCKPAD_DEFAULT


	)

27 
	gfáblock
;

28 
	gfáblock·d
;

64 
	gdims
[3][3];

65 
	gx¡¬t
[3];

66 
	gy¡¬t
[3];

67 
	gz¡¬t
[3];

68 
	gx’d
[3];

69 
	gy’d
[3];

70 
	gz’d
[3];

72 
	#T_TOTAL
 0

	)

73 
	#T_SETUP
 1

	)

74 
	#T_FFT
 2

	)

75 
	#T_EVOLVE
 3

	)

76 
	#T_CHECKSUM
 4

	)

77 
	#T_FFTLOW
 5

	)

78 
	#T_FFTCOPY
 6

	)

79 
	#T_MAX
 7

	)

81 
	#TIMERS_ENABLED
 
FALSE


	)

85 
	#SEED
 314159265.0

	)

86 
	#A
 1220703125.0

	)

87 
	#PI
 3.141592653589793238

	)

88 
	#ALPHA
 1.0e-6

	)

90 
	#EXPMAX
 (
NITER_DEFAULT
*(
NX
*NX/4+
NY
*NY/4+
NZ
*NZ/4))

	)

93 
	gex
[
EXPMAX
+1];

101 
dcom¶ex
 
	gu
[
NX
];

106 
dcom¶ex
 
	gsums
[
NITER_DEFAULT
+1];

111 
	gn™”
;

	@FT/npbparams.h

7 
	#NX
 512

	)

8 
	#NY
 512

	)

9 
	#NZ
 512

	)

10 
	#MAXDIM
 512

	)

11 
	#NITER_DEFAULT
 20

	)

12 
	#NTOTAL
 134217728

	)

13 
	#CONVERTDOUBLE
 
FALSE


	)

14 
	#COMPILETIME
 "01 Feb 2021"

	)

15 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

16 
	#CS1
 "ÒÚe)"

	)

17 
	#CS2
 "ÒÚe)"

	)

18 
	#CS3
 "ÒÚe)"

	)

19 
	#CS4
 "ÒÚe)"

	)

20 
	#CS5
 "-o3 $(C_IN)"

	)

21 
	#CS6
 "ÒÚe)"

	)

22 
	#CS7
 "ÒÚe)"

	)

	@IS/is.c

33 
	~"Åb·¿ms.h
"

34 
	~<Çutus/Çutus.h
>

35 
	~<Çutus/sh–l.h
>

61 #iâdeà
CLASS


62 
	#CLASS
 'S'

	)

69 #ià
CLASS
 == 'S'

70 
	#TOTAL_KEYS_LOG_2
 16

	)

71 
	#MAX_KEY_LOG_2
 11

	)

72 
	#NUM_BUCKETS_LOG_2
 9

	)

79 #ià
CLASS
 == 'W'

80 
	#TOTAL_KEYS_LOG_2
 20

	)

81 
	#MAX_KEY_LOG_2
 16

	)

82 
	#NUM_BUCKETS_LOG_2
 10

	)

88 #ià
CLASS
 == 'A'

89 
	#TOTAL_KEYS_LOG_2
 23

	)

90 
	#MAX_KEY_LOG_2
 19

	)

91 
	#NUM_BUCKETS_LOG_2
 10

	)

98 #ià
CLASS
 == 'B'

99 
	#TOTAL_KEYS_LOG_2
 25

	)

100 
	#MAX_KEY_LOG_2
 21

	)

101 
	#NUM_BUCKETS_LOG_2
 10

	)

108 #ià
CLASS
 == 'C'

109 
	#TOTAL_KEYS_LOG_2
 27

	)

110 
	#MAX_KEY_LOG_2
 23

	)

111 
	#NUM_BUCKETS_LOG_2
 10

	)

115 
	#TOTAL_KEYS
 (1 << 
TOTAL_KEYS_LOG_2
)

	)

116 
	#MAX_KEY
 (1 << 
MAX_KEY_LOG_2
)

	)

117 
	#NUM_BUCKETS
 (1 << 
NUM_BUCKETS_LOG_2
)

	)

118 
	#NUM_KEYS
 
TOTAL_KEYS


	)

119 
	#SIZE_OF_BUFFERS
 
NUM_KEYS


	)

122 
	#MAX_ITERATIONS
 10

	)

123 
	#TEST_ARRAY_SIZE
 5

	)

131 
	tINT_TYPE
;

137 
INT_TYPE
 *
	gkey_buff_±r_glob®
;

140 
	g·s£d_v”ifiÿtiÚ
;

147 
INT_TYPE
 
	gkey_¬¿y
[
SIZE_OF_BUFFERS
],

148 
	gkey_buff1
[
SIZE_OF_BUFFERS
],

149 
	gkey_buff2
[
SIZE_OF_BUFFERS
],

150 
	g·¹Ÿl_v”ify_v®s
[
TEST_ARRAY_SIZE
];

152 #ifdeà
USE_BUCKETS


153 
INT_TYPE
 
	gbuck‘_size
[
NUM_BUCKETS
],

154 
	gbuck‘_±rs
[
NUM_BUCKETS
];

161 
INT_TYPE
 
	g‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
],

162 
	g‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
],

164 
	gS_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

166 
	gS_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

169 
	gW_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

171 
	gW_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

174 
	gA_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

176 
	gA_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

179 
	gB_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

181 
	gB_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

184 
	gC_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

186 
	gC_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

194 
¿ndlc
Ğ*
X
, *
A
 );

196 
fuÎ_v”ify
( );

237 
	$¿ndlc
(
X
, 
A
)

238 *
X
;

239 *
A
;

241 
KS
=0;

242 
R23
, 
R46
, 
T23
, 
T46
;

243 
T1
, 
T2
, 
T3
, 
T4
;

244 
A1
;

245 
A2
;

246 
X1
;

247 
X2
;

248 
Z
;

249 
i
, 
j
;

251 ià(
KS
 == 0)

253 
R23
 = 1.0;

254 
R46
 = 1.0;

255 
T23
 = 1.0;

256 
T46
 = 1.0;

258 
i
=1; i<=23; i++)

260 
R23
 = 0.50 * R23;

261 
T23
 = 2.0 * T23;

263 
i
=1; i<=46; i++)

265 
R46
 = 0.50 * R46;

266 
T46
 = 2.0 * T46;

268 
KS
 = 1;

273 
T1
 = 
R23
 * *
A
;

274 
j
 = 
T1
;

275 
A1
 = 
j
;

276 
A2
 = *
A
 - 
T23
 * 
A1
;

282 
T1
 = 
R23
 * *
X
;

283 
j
 = 
T1
;

284 
X1
 = 
j
;

285 
X2
 = *
X
 - 
T23
 * 
X1
;

286 
T1
 = 
A1
 * 
X2
 + 
A2
 * 
X1
;

288 
j
 = 
R23
 * 
T1
;

289 
T2
 = 
j
;

290 
Z
 = 
T1
 - 
T23
 * 
T2
;

291 
T3
 = 
T23
 * 
Z
 + 
A2
 * 
X2
;

292 
j
 = 
R46
 * 
T3
;

293 
T4
 = 
j
;

294 *
X
 = 
T3
 - 
T46
 * 
T4
;

295 (
R46
 * *
X
);

296 
	}
}

305 
	$ü—‹_£q
Ğ
£ed
, 
a
 )

307 
x
;

308 
i
, 
j
, 
k
;

310 
k
 = 
MAX_KEY
/4;

312 
i
=0; i<
NUM_KEYS
; i++)

314 
x
 = 
	`¿ndlc
(&
£ed
, &
a
);

315 
x
 +ğ
	`¿ndlc
(&
£ed
, &
a
);

316 
x
 +ğ
	`¿ndlc
(&
£ed
, &
a
);

317 
x
 +ğ
	`¿ndlc
(&
£ed
, &
a
);

319 
key_¬¿y
[
i
] = 
k
*
x
;

321 
	}
}

331 
	$fuÎ_v”ify
()

333 
INT_TYPE
 
i
, 
j
;

334 
INT_TYPE
 
k
;

335 
INT_TYPE
 
m
, 
unique_keys
;

340  
i
=0; i<
NUM_KEYS
; i++ )

341 
key_¬¿y
[--
key_buff_±r_glob®
[
key_buff2
[
i
]]] = key_buff2[i];

346 
j
 = 0;

347  
i
=1; i<
NUM_KEYS
; i++ )

348 ifĞ
key_¬¿y
[
i
-1] > key_array[i] )

349 
j
++;

352 ifĞ
j
 != 0 )

354 
	`´štf
( "Full_verify:‚umber of keys out of sort: %d\n",

355 
j
 );

358 
·s£d_v”ifiÿtiÚ
++;

361 
	}
}

370 
	$¿nk
Ğ
™”©iÚ
 )

373 
INT_TYPE
 
i
, 
j
, 
k
;

374 
INT_TYPE
 
l
, 
m
;

376 
INT_TYPE
 
shiá
 = 
MAX_KEY_LOG_2
 - 
NUM_BUCKETS_LOG_2
;

377 
INT_TYPE
 
key
;

378 
INT_TYPE
 
mš_key_v®
, 
max_key_v®
;

380 
INT_TYPE
 
´v_buff1
[
MAX_KEY
];

382 #´agm¨
omp
 
ma¡”


384 
key_¬¿y
[
™”©iÚ
] = iteration;

385 
key_¬¿y
[
™”©iÚ
+
MAX_ITERATIONS
] = 
MAX_KEY
 - iteration;

389  
i
=0; i<
TEST_ARRAY_SIZE
; i++ )

390 
·¹Ÿl_v”ify_v®s
[
i
] = 
key_¬¿y
[
‹¡_šdex_¬¿y
[i]];

393  
i
=0; i<
MAX_KEY
; i++ )

394 
key_buff1
[
i
] = 0;

396 #´agm¨
omp
 
b¬r›r


398 
i
=0; i<
MAX_KEY
; i++)

399 
´v_buff1
[
i
] = 0;

402 #´agm¨
omp
 
nowa™


403  
i
=0; i<
NUM_KEYS
; i++ ) {

404 
key_buff2
[
i
] = 
key_¬¿y
[i];

412 
´v_buff1
[
key_buff2
[
i
]]++;

415  
i
=0; i<
MAX_KEY
-1; i++ )

416 
´v_buff1
[
i
+1] +=…rv_buff1[i];

419 #´agm¨
omp
 
	`ü™iÿl
(
is
)

421  
i
=0; i<
MAX_KEY
; i++ )

422 
key_buff1
[
i
] +ğ
´v_buff1
[i];

429 #´agm¨
omp
 
b¬r›r


430 #´agm¨
omp
 
ma¡”


436  
i
=0; i<
TEST_ARRAY_SIZE
; i++ )

438 
k
 = 
·¹Ÿl_v”ify_v®s
[
i
];

439 ifĞ0 <ğ
k
 && k <ğ
NUM_KEYS
-1 )

440  
CLASS
 )

443 ifĞ
i
 <= 2 )

445 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]+
™”©iÚ
 )

447 
	`´štf
( "Failed…artial verification: "

449 
™”©iÚ
, 
i
 );

452 
·s£d_v”ifiÿtiÚ
++;

456 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]-
™”©iÚ
 )

458 
	`´štf
( "Failed…artial verification: "

460 
™”©iÚ
, 
i
 );

463 
·s£d_v”ifiÿtiÚ
++;

467 ifĞ
i
 < 2 )

469 ifĞ
key_buff1
[
k
-1] !=

470 
‹¡_¿nk_¬¿y
[
i
]+(
™”©iÚ
-2) )

472 
	`´štf
( "Failed…artial verification: "

474 
™”©iÚ
, 
i
 );

477 
·s£d_v”ifiÿtiÚ
++;

481 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]-
™”©iÚ
 )

483 
	`´štf
( "Failed…artial verification: "

485 
™”©iÚ
, 
i
 );

488 
·s£d_v”ifiÿtiÚ
++;

492 ifĞ
i
 <= 2 )

494 ifĞ
key_buff1
[
k
-1] !=

495 
‹¡_¿nk_¬¿y
[
i
]+(
™”©iÚ
-1) )

497 
	`´štf
( "Failed…artial verification: "

499 
™”©iÚ
, 
i
 );

502 
·s£d_v”ifiÿtiÚ
++;

506 ifĞ
key_buff1
[
k
-1] !=

507 
‹¡_¿nk_¬¿y
[
i
]-(
™”©iÚ
-1) )

509 
	`´štf
( "Failed…artial verification: "

511 
™”©iÚ
, 
i
 );

514 
·s£d_v”ifiÿtiÚ
++;

518 ifĞ
i
 == 1 || i == 2 || i == 4 )

520 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]+
™”©iÚ
 )

522 
	`´štf
( "Failed…artial verification: "

524 
™”©iÚ
, 
i
 );

527 
·s£d_v”ifiÿtiÚ
++;

531 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]-
™”©iÚ
 )

533 
	`´štf
( "Failed…artial verification: "

535 
™”©iÚ
, 
i
 );

538 
·s£d_v”ifiÿtiÚ
++;

542 ifĞ
i
 <= 2 )

544 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]+
™”©iÚ
 )

546 
	`´štf
( "Failed…artial verification: "

548 
™”©iÚ
, 
i
 );

551 
·s£d_v”ifiÿtiÚ
++;

555 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]-
™”©iÚ
 )

557 
	`´štf
( "Failed…artial verification: "

559 
™”©iÚ
, 
i
 );

562 
·s£d_v”ifiÿtiÚ
++;

575 ifĞ
™”©iÚ
 =ğ
MAX_ITERATIONS
 )

576 
key_buff_±r_glob®
 = 
key_buff1
;

579 
	}
}

587 
´og¿m_IS
(*
_buf
, * 
_´iv
);

588 
´og¿m_IS_´ofe
(*
_
, *
__
);

591 
sh–l_cmd_im¶
 
	gÇs_is_im¶
 = {

592 .
cmd
 = "nas-is",

593 .
	gh–p_¡r
 = "NAS…arallel benchmark IS",

594 .
	ghªdËr
 = 
´og¿m_IS_´ofe
,

596 
nk_»gi¡”_sh–l_cmd
(
Çs_is_im¶
);

598 
	$´og¿m_IS_´ofe
(*
_
, *
__
){

600 #ifdeà
NAUT_CONFIG_PROFILE


601 
	`nk_š¡rum’t_ş—r
();

602 
	`nk_š¡rum’t_¡¬t
();

604 
	`´og¿m_IS
(
_
,
__
);

605 #ifdeà
NAUT_CONFIG_PROFILE


606 
	`nk_š¡rum’t_’d
();

607 
	`nk_š¡rum’t_qu”y
();

610 
	}
}

612 
	$´og¿m_IS
(* 
_buf
, *
_´iv
) {

615 
i
, 
™”©iÚ
, 
™emp
;

616 
Áh»ads
 = 1;

617 
timecouÁ”
, 
maxtime
;

622  
i
=0; i<
TEST_ARRAY_SIZE
; i++ )

623  
CLASS
 )

626 
‹¡_šdex_¬¿y
[
i
] = 
S_‹¡_šdex_¬¿y
[i];

627 
‹¡_¿nk_¬¿y
[
i
] = 
S_‹¡_¿nk_¬¿y
[i];

630 
‹¡_šdex_¬¿y
[
i
] = 
A_‹¡_šdex_¬¿y
[i];

631 
‹¡_¿nk_¬¿y
[
i
] = 
A_‹¡_¿nk_¬¿y
[i];

634 
‹¡_šdex_¬¿y
[
i
] = 
W_‹¡_šdex_¬¿y
[i];

635 
‹¡_¿nk_¬¿y
[
i
] = 
W_‹¡_¿nk_¬¿y
[i];

638 
‹¡_šdex_¬¿y
[
i
] = 
B_‹¡_šdex_¬¿y
[i];

639 
‹¡_¿nk_¬¿y
[
i
] = 
B_‹¡_¿nk_¬¿y
[i];

642 
‹¡_šdex_¬¿y
[
i
] = 
C_‹¡_šdex_¬¿y
[i];

643 
‹¡_¿nk_¬¿y
[
i
] = 
C_‹¡_¿nk_¬¿y
[i];

650 
	`´štf
( "\n\n NAS Parallel Benchmarks 2.3 OpenMP C version"

652 
	`´štf
Ğ" Size: %d (şas %c)\n", 
TOTAL_KEYS
, 
CLASS
 );

653 
	`´štf
Ğ" I‹¿tiÚs: %d\n", 
MAX_ITERATIONS
 );

656 
	`tim”_ş—r
( 0 );

659 
	`ü—‹_£q
( 314159265.00,

665 #´agm¨
omp
 
·¿Î–


666 
	`¿nk
( 1 );

669 
·s£d_v”ifiÿtiÚ
 = 0;

671 ifĞ
CLASS
 !ğ'S' ) 
	`´štf
( "\n iteration\n" );

674 
	`tim”_¡¬t
( 0 );

679 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
™”©iÚ
)

680  
™”©iÚ
=1; i‹¿tiÚ<=
MAX_ITERATIONS
; iteration++ )

682 #´agm¨
omp
 
ma¡”


683 ifĞ
CLASS
 !ğ'S' ) 
	`´štf
Ğ" %d\n", 
™”©iÚ
 );

685 
	`¿nk
Ğ
™”©iÚ
 );

687 #ià
	`defšed
(
_OPENMP
)

688 #´agm¨
omp
 
ma¡”


689 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

694 
	`tim”_¡İ
( 0 );

695 
timecouÁ”
 = 
	`tim”_»ad
( 0 );

700 
	`fuÎ_v”ify
();

705 ifĞ
·s£d_v”ifiÿtiÚ
 !ğ5*
MAX_ITERATIONS
 + 1 )

706 
·s£d_v”ifiÿtiÚ
 = 0;

707 
	`c_´št_»suÉs
( "IS",

708 
CLASS
,

709 
TOTAL_KEYS
,

712 
MAX_ITERATIONS
,

713 
Áh»ads
,

714 
timecouÁ”
,

715 ((è(
MAX_ITERATIONS
*
TOTAL_KEYS
))

716 /
timecouÁ”
/1000000.,

718 
·s£d_v”ifiÿtiÚ
,

719 
NPBVERSION
,

720 
COMPILETIME
,

721 
CC
,

722 
CLINK
,

723 
C_LIB
,

724 
C_INC
,

725 
CFLAGS
,

726 
CLINKFLAGS
,

732 
	}
}

	@IS/npbparams.h

1 
	#CLASS
 'C'

	)

7 
	#COMPILETIME
 "01 Feb 2021"

	)

8 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

9 
	#CC
 "ÒÚe)"

	)

10 
	#CFLAGS
 "-o3 $(C_IN)"

	)

11 
	#CLINK
 "ÒÚe)"

	)

12 
	#CLINKFLAGS
 "ÒÚe)"

	)

13 
	#C_LIB
 "ÒÚe)"

	)

14 
	#C_INC
 "ÒÚe)"

	)

	@LU/applu.h

12 
	~"Åb·¿ms.h
"

22 
	#IPR_DEFAULT
 1

	)

23 
	#OMEGA_DEFAULT
 1.2

	)

25 
	#TOLRSD1_DEF
 1.0e-8

	)

26 
	#TOLRSD2_DEF
 1.0e-8

	)

27 
	#TOLRSD3_DEF
 1.0e-8

	)

28 
	#TOLRSD4_DEF
 1.0e-8

	)

29 
	#TOLRSD5_DEF
 1.0e-8

	)

31 
	#C1
 1.40e+00

	)

32 
	#C2
 0.40e+00

	)

33 
	#C3
 1.00e-01

	)

34 
	#C4
 1.00e+00

	)

35 
	#C5
 1.40e+00

	)

42 
	gnx
, 
	gny
, 
	gnz
;

43 
	gnx0
, 
	gny0
, 
	gnz0
;

44 
	gi¡
, 
	g›nd
;

45 
	gj¡
, 
	gj’d
;

46 
	gii1
, 
	gii2
;

47 
	gji1
, 
	gji2
;

48 
	gki1
, 
	gki2
;

49 
	gdxi
, 
	gd‘a
, 
	gdz‘a
;

50 
	gtx1
, 
	gtx2
, 
	gtx3
;

51 
	gty1
, 
	gty2
, 
	gty3
;

52 
	gtz1
, 
	gtz2
, 
	gtz3
;

59 
	gdx1
, 
	gdx2
, 
	gdx3
, 
	gdx4
, 
	gdx5
;

60 
	gdy1
, 
	gdy2
, 
	gdy3
, 
	gdy4
, 
	gdy5
;

61 
	gdz1
, 
	gdz2
, 
	gdz3
, 
	gdz4
, 
	gdz5
;

62 
	gds¥
;

73 
	gu
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5];

74 
	grsd
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5];

75 
	gäù
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5];

76 
	gæux
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5];

83 
	gr
, 
	gšÜm
;

90 
	g™max
, 
	gšv”t
;

91 
	gdt
, 
	gomega
, 
	gtŞrsd
[5], 
	grsdnm
[5], 
	g”ºm
[5], 
	gäc
, 
	g‰Ù®
;

94 
	ga
[
ISIZ1
][
ISIZ2
][5][5];

95 
	gb
[
ISIZ1
][
ISIZ2
][5][5];

96 
	gc
[
ISIZ1
][
ISIZ2
][5][5];

97 
	gd
[
ISIZ1
][
ISIZ2
][5][5];

104 
	gû
[5][13];

111 
	gmaxtime
;

	@LU/lu.c

36 
	~"../commÚ/Åb-C.h
"

37 
	~<Çutus/Çutus.h
>

38 
	~<Çutus/sh–l.h
>

39 
	~"../m©h/Çs_m©h.h
"

41 
	~"­¶u.h
"

43 #ià
defšed
(
_OPENMP
)

45 
boŞ—n
 
	gæag
[
ISIZ1
/2*2+1];

49 
bÉs
 (
nx
, 
ny
, 
nz
, 
k
,

50 
omega
,

51 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

52 
ldz
[
ISIZ1
][
ISIZ2
][5][5],

53 
ldy
[
ISIZ1
][
ISIZ2
][5][5],

54 
ldx
[
ISIZ1
][
ISIZ2
][5][5],

55 
d
[
ISIZ1
][
ISIZ2
][5][5],

56 
i¡
, 
›nd
, 
j¡
, 
j’d
,

57 
nx0
, 
ny0
 );

58 
buts
(
nx
, 
ny
, 
nz
, 
k
,

59 
omega
,

60 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

61 
tv
[
ISIZ1
][
ISIZ2
][5],

62 
d
[
ISIZ1
][
ISIZ2
][5][5],

63 
udx
[
ISIZ1
][
ISIZ2
][5][5],

64 
udy
[
ISIZ1
][
ISIZ2
][5][5],

65 
udz
[
ISIZ1
][
ISIZ2
][5][5],

66 
i¡
, 
›nd
, 
j¡
, 
j’d
,

67 
nx0
, 
ny0
 );

68 
domaš
();

69 
”hs
();

70 
”rÜ
();

71 
exaù
Ğ
i
, 
j
, 
k
, 
u000ijk
[5] );

72 
jaşd
(
k
);

73 
jacu
(
k
);

74 
l2nÜm
 (
nx0
, 
ny0
, 
nz0
,

75 
i¡
, 
›nd
,

76 
j¡
, 
j’d
,

77 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

78 
sum
[5]);

79 
pštgr
();

80 
»ad_šput
();

81 
rhs
();

82 
£tbv
();

83 
£tcÛff
();

84 
£tiv
();

85 
ssÜ
();

86 
v”ify
(
xü
[5], 
xû
[5], 
xci
,

87 *
şass
, 
boŞ—n
 *
v”if›d
);

93 
´og¿m_LU
(*
_buf
, * 
_´iv
);

95 
sh–l_cmd_im¶
 
	gÇs_lu_im¶
 = {

96 .
cmd
 = "nas-lu",

97 .
	gh–p_¡r
 = "NAS…arallel benchmark LU",

98 .
	ghªdËr
 = 
´og¿m_LU
,

100 
nk_»gi¡”_sh–l_cmd
(
Çs_lu_im¶
);

102 
	$´og¿m_LU_´ofe
(*
_
, *
__
){

104 #ifdeà
NAUT_CONFIG_PROFILE


105 
	`nk_š¡rum’t_ş—r
();

106 
	`nk_š¡rum’t_¡¬t
();

108 
	`´og¿m_LU
(
_
,
__
);

109 #ifdeà
NAUT_CONFIG_PROFILE


110 
	`nk_š¡rum’t_’d
();

111 
	`nk_š¡rum’t_qu”y
();

114 
	}
}

116 
	$´og¿m_LU
(* 
_buf
, *
_´iv
) {

125 
şass
;

126 
boŞ—n
 
v”if›d
;

127 
mæİs
;

128 
Áh»ads
 = 1;

133 
	`»ad_šput
();

138 
	`domaš
();

143 
	`£tcÛff
();

148 
	`£tbv
();

153 
	`£tiv
();

158 
	`”hs
();

160 #´agm¨
omp
 
·¿Î–


163 #ià
	`defšed
(
_OPENMP
)

164 #´agm¨
omp
 
ma¡”


165 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

172 
	`ssÜ
();

177 
	`”rÜ
();

182 
	`pštgr
();

187 
	`v”ify
 ( 
rsdnm
, 
”ºm
, 
äc
, &
şass
, &
v”if›d
 );

188 
mæİs
 = ()
™max
*(1984.77*()
nx0


189 *()
ny0


190 *()
nz0


191 -10923.3*
	`pow2
(()Ğ
nx0
+
ny0
+
nz0
 )/3.0)

192 +27770.9* ()Ğ
nx0
+
ny0
+
nz0
 )/3.0

194 / (
maxtime
*1000000.0);

196 
	`c_´št_»suÉs
("LU", 
şass
, 
nx0
,

197 
ny0
, 
nz0
, 
™max
, 
Áh»ads
,

198 
maxtime
, 
mæİs
, " flßtšg…ošt", 
v”if›d
,

199 
NPBVERSION
, 
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
,

201 
	}
}

206 
bÉs
 (
nx
, 
ny
, 
nz
, 
k
,

207 
omega
,

212 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

213 
ldz
[
ISIZ1
][
ISIZ2
][5][5],

214 
ldy
[
ISIZ1
][
ISIZ2
][5][5],

215 
ldx
[
ISIZ1
][
ISIZ2
][5][5],

216 
d
[
ISIZ1
][
ISIZ2
][5][5],

217 
i¡
, 
›nd
, 
j¡
, 
j’d
,

218 
nx0
, 
ny0
 ) {

230 
	gi
, 
	gj
, 
	gm
;

231 
	gtmp
, 
	gtmp1
;

232 
	gtm©
[5][5];

234 #´agm¨
omp
 
nowa™
 
scheduË
()

235 
	gi
 = 
i¡
; i <ğ
›nd
; i++) {

236 
	gj
 = 
j¡
; j <ğ
j’d
; j++) {

237 
	gm
 = 0; m < 5; m++) {

238 
	gv
[
i
][
j
][
k
][
m
] = 
v
[i][j][k][m]

239 - 
omega
 * ( 
ldz
[
i
][
j
][
m
][0] * 
v
[i][j][
k
-1][0]

240 + 
ldz
[
i
][
j
][
m
][1] * 
v
[i][j][
k
-1][1]

241 + 
ldz
[
i
][
j
][
m
][2] * 
v
[i][j][
k
-1][2]

242 + 
ldz
[
i
][
j
][
m
][3] * 
v
[i][j][
k
-1][3]

243 + 
ldz
[
i
][
j
][
m
][4] * 
v
[i][j][
k
-1][4] );

248 #´agm¨
omp
 
nowa™
 
scheduË
()

249 
	gi
 = 
i¡
; i <ğ
›nd
; i++) {

251 #ià
defšed
(
_OPENMP
)

252 ià(
	gi
 !ğ
i¡
) {

253 
æag
[
i
-1] == 0) {

254 #´agm¨
omp
 
æush
(
æag
)

258 ià(
	gi
 !ğ
›nd
) {

259 
æag
[
i
] == 1) {

260 #´agm¨
omp
 
æush
(
æag
)

266 
	gj
 = 
j¡
; j <ğ
j’d
; j++) {

267 
	gm
 = 0; m < 5; m++) {

269 
	gv
[
i
][
j
][
k
][
m
] = 
v
[i][j][k][m]

270 - 
omega
 * ( 
ldy
[
i
][
j
][
m
][0] * 
v
[i][j-1][
k
][0]

271 + 
ldx
[
i
][
j
][
m
][0] * 
v
[i-1][j][
k
][0]

272 + 
ldy
[
i
][
j
][
m
][1] * 
v
[i][j-1][
k
][1]

273 + 
ldx
[
i
][
j
][
m
][1] * 
v
[i-1][j][
k
][1]

274 + 
ldy
[
i
][
j
][
m
][2] * 
v
[i][j-1][
k
][2]

275 + 
ldx
[
i
][
j
][
m
][2] * 
v
[i-1][j][
k
][2]

276 + 
ldy
[
i
][
j
][
m
][3] * 
v
[i][j-1][
k
][3]

277 + 
ldx
[
i
][
j
][
m
][3] * 
v
[i-1][j][
k
][3]

278 + 
ldy
[
i
][
j
][
m
][4] * 
v
[i][j-1][
k
][4]

279 + 
ldx
[
i
][
j
][
m
][4] * 
v
[i-1][j][
k
][4] );

287 
	gm
 = 0; m < 5; m++) {

288 
	gtm©
[
m
][0] = 
d
[
i
][
j
][m][0];

289 
	gtm©
[
m
][1] = 
d
[
i
][
j
][m][1];

290 
	gtm©
[
m
][2] = 
d
[
i
][
j
][m][2];

291 
	gtm©
[
m
][3] = 
d
[
i
][
j
][m][3];

292 
	gtm©
[
m
][4] = 
d
[
i
][
j
][m][4];

295 
	gtmp1
 = 1.0 / 
tm©
[0][0];

296 
	gtmp
 = 
tmp1
 * 
tm©
[1][0];

297 
	gtm©
[1][1] = 
tm©
[1][1]

298 - 
tmp
 * 
tm©
[0][1];

299 
	gtm©
[1][2] = 
tm©
[1][2]

300 - 
tmp
 * 
tm©
[0][2];

301 
	gtm©
[1][3] = 
tm©
[1][3]

302 - 
tmp
 * 
tm©
[0][3];

303 
	gtm©
[1][4] = 
tm©
[1][4]

304 - 
tmp
 * 
tm©
[0][4];

305 
	gv
[
i
][
j
][
k
][1] = 
v
[i][j][k][1]

306 - 
v
[
i
][
j
][
k
][0] * 
tmp
;

308 
	gtmp
 = 
tmp1
 * 
tm©
[2][0];

309 
	gtm©
[2][1] = 
tm©
[2][1]

310 - 
tmp
 * 
tm©
[0][1];

311 
	gtm©
[2][2] = 
tm©
[2][2]

312 - 
tmp
 * 
tm©
[0][2];

313 
	gtm©
[2][3] = 
tm©
[2][3]

314 - 
tmp
 * 
tm©
[0][3];

315 
	gtm©
[2][4] = 
tm©
[2][4]

316 - 
tmp
 * 
tm©
[0][4];

317 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2]

318 - 
v
[
i
][
j
][
k
][0] * 
tmp
;

320 
	gtmp
 = 
tmp1
 * 
tm©
[3][0];

321 
	gtm©
[3][1] = 
tm©
[3][1]

322 - 
tmp
 * 
tm©
[0][1];

323 
	gtm©
[3][2] = 
tm©
[3][2]

324 - 
tmp
 * 
tm©
[0][2];

325 
	gtm©
[3][3] = 
tm©
[3][3]

326 - 
tmp
 * 
tm©
[0][3];

327 
	gtm©
[3][4] = 
tm©
[3][4]

328 - 
tmp
 * 
tm©
[0][4];

329 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

330 - 
v
[
i
][
j
][
k
][0] * 
tmp
;

332 
	gtmp
 = 
tmp1
 * 
tm©
[4][0];

333 
	gtm©
[4][1] = 
tm©
[4][1]

334 - 
tmp
 * 
tm©
[0][1];

335 
	gtm©
[4][2] = 
tm©
[4][2]

336 - 
tmp
 * 
tm©
[0][2];

337 
	gtm©
[4][3] = 
tm©
[4][3]

338 - 
tmp
 * 
tm©
[0][3];

339 
	gtm©
[4][4] = 
tm©
[4][4]

340 - 
tmp
 * 
tm©
[0][4];

341 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

342 - 
v
[
i
][
j
][
k
][0] * 
tmp
;

344 
	gtmp1
 = 1.0 / 
tm©
[ 1][1];

345 
	gtmp
 = 
tmp1
 * 
tm©
[ 2][1];

346 
	gtm©
[2][2] = 
tm©
[2][2]

347 - 
tmp
 * 
tm©
[1][2];

348 
	gtm©
[2][3] = 
tm©
[2][3]

349 - 
tmp
 * 
tm©
[1][3];

350 
	gtm©
[2][4] = 
tm©
[2][4]

351 - 
tmp
 * 
tm©
[1][4];

352 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2]

353 - 
v
[
i
][
j
][
k
][1] * 
tmp
;

355 
	gtmp
 = 
tmp1
 * 
tm©
[3][1];

356 
	gtm©
[3][2] = 
tm©
[3][2]

357 - 
tmp
 * 
tm©
[1][2];

358 
	gtm©
[3][3] = 
tm©
[3][3]

359 - 
tmp
 * 
tm©
[1][3];

360 
	gtm©
[3][4] = 
tm©
[3][4]

361 - 
tmp
 * 
tm©
[1][4];

362 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

363 - 
v
[
i
][
j
][
k
][1] * 
tmp
;

365 
	gtmp
 = 
tmp1
 * 
tm©
[4][1];

366 
	gtm©
[4][2] = 
tm©
[4][2]

367 - 
tmp
 * 
tm©
[1][2];

368 
	gtm©
[4][3] = 
tm©
[4][3]

369 - 
tmp
 * 
tm©
[1][3];

370 
	gtm©
[4][4] = 
tm©
[4][4]

371 - 
tmp
 * 
tm©
[1][4];

372 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

373 - 
v
[
i
][
j
][
k
][1] * 
tmp
;

375 
	gtmp1
 = 1.0 / 
tm©
[2][2];

376 
	gtmp
 = 
tmp1
 * 
tm©
[3][2];

377 
	gtm©
[3][3] = 
tm©
[3][3]

378 - 
tmp
 * 
tm©
[2][3];

379 
	gtm©
[3][4] = 
tm©
[3][4]

380 - 
tmp
 * 
tm©
[2][4];

381 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

382 - 
v
[
i
][
j
][
k
][2] * 
tmp
;

384 
	gtmp
 = 
tmp1
 * 
tm©
[4][2];

385 
	gtm©
[4][3] = 
tm©
[4][3]

386 - 
tmp
 * 
tm©
[2][3];

387 
	gtm©
[4][4] = 
tm©
[4][4]

388 - 
tmp
 * 
tm©
[2][4];

389 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

390 - 
v
[
i
][
j
][
k
][2] * 
tmp
;

392 
	gtmp1
 = 1.0 / 
tm©
[3][3];

393 
	gtmp
 = 
tmp1
 * 
tm©
[4][3];

394 
	gtm©
[4][4] = 
tm©
[4][4]

395 - 
tmp
 * 
tm©
[3][4];

396 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

397 - 
v
[
i
][
j
][
k
][3] * 
tmp
;

402 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

403 / 
tm©
[4][4];

405 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

406 - 
tm©
[3][4] * 
v
[
i
][
j
][
k
][4];

407 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

408 / 
tm©
[3][3];

410 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2]

411 - 
tm©
[2][3] * 
v
[
i
][
j
][
k
][3]

412 - 
tm©
[2][4] * 
v
[
i
][
j
][
k
][4];

413 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2]

414 / 
tm©
[2][2];

416 
	gv
[
i
][
j
][
k
][1] = 
v
[i][j][k][1]

417 - 
tm©
[1][2] * 
v
[
i
][
j
][
k
][2]

418 - 
tm©
[1][3] * 
v
[
i
][
j
][
k
][3]

419 - 
tm©
[1][4] * 
v
[
i
][
j
][
k
][4];

420 
	gv
[
i
][
j
][
k
][1] = 
v
[i][j][k][1]

421 / 
tm©
[1][1];

423 
	gv
[
i
][
j
][
k
][0] = 
v
[i][j][k][0]

424 - 
tm©
[0][1] * 
v
[
i
][
j
][
k
][1]

425 - 
tm©
[0][2] * 
v
[
i
][
j
][
k
][2]

426 - 
tm©
[0][3] * 
v
[
i
][
j
][
k
][3]

427 - 
tm©
[0][4] * 
v
[
i
][
j
][
k
][4];

428 
	gv
[
i
][
j
][
k
][0] = 
v
[i][j][k][0]

429 / 
tm©
[0][0];

432 #ià
defšed
(
_OPENMP
)

433 ià(
	gi
 !ğ
i¡
è
æag
[
i
-1] = 0;

434 ià(
	gi
 !ğ
›nd
è
æag
[
i
] = 1;

435 #´agm¨
omp
 
æush
(
æag
)

443 
buts
(
nx
, 
ny
, 
nz
, 
k
,

444 
omega
,

449 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

450 
tv
[
ISIZ1
][
ISIZ2
][5],

451 
d
[
ISIZ1
][
ISIZ2
][5][5],

452 
udx
[
ISIZ1
][
ISIZ2
][5][5],

453 
udy
[
ISIZ1
][
ISIZ2
][5][5],

454 
udz
[
ISIZ1
][
ISIZ2
][5][5],

455 
i¡
, 
›nd
, 
j¡
, 
j’d
,

456 
nx0
, 
ny0
 ) {

468 
	gi
, 
	gj
, 
	gm
;

469 
	gtmp
, 
	gtmp1
;

470 
	gtm©
[5][5];

472 #´agm¨
omp
 
nowa™
 
scheduË
()

473 
	gi
 = 
›nd
; i >ğ
i¡
; i--) {

474 
	gj
 = 
j’d
; j >ğ
j¡
; j--) {

475 
	gm
 = 0; m < 5; m++) {

476 
	gtv
[
i
][
j
][
m
] =

477 
omega
 * ( 
udz
[
i
][
j
][
m
][0] * 
v
[i][j][
k
+1][0]

478 + 
udz
[
i
][
j
][
m
][1] * 
v
[i][j][
k
+1][1]

479 + 
udz
[
i
][
j
][
m
][2] * 
v
[i][j][
k
+1][2]

480 + 
udz
[
i
][
j
][
m
][3] * 
v
[i][j][
k
+1][3]

481 + 
udz
[
i
][
j
][
m
][4] * 
v
[i][j][
k
+1][4] );

486 #´agm¨
omp
 
nowa™
 
scheduË
()

487 
	gi
 = 
›nd
; i >ğ
i¡
; i--) {

488 #ià
defšed
(
_OPENMP
)

489 ià(
	gi
 !ğ
›nd
) {

490 
æag
[
i
+1] == 0) {

491 #´agm¨
omp
 
æush
(
æag
)

495 ià(
	gi
 !ğ
i¡
) {

496 
æag
[
i
] == 1) {

497 #´agm¨
omp
 
æush
(
æag
)

503 
	gj
 = 
j’d
; j >ğ
j¡
; j--) {

504 
	gm
 = 0; m < 5; m++) {

505 
	gtv
[
i
][
j
][
m
] = 
tv
[i][j][m]

506 + 
omega
 * ( 
udy
[
i
][
j
][
m
][0] * 
v
[i][j+1][
k
][0]

507 + 
udx
[
i
][
j
][
m
][0] * 
v
[i+1][j][
k
][0]

508 + 
udy
[
i
][
j
][
m
][1] * 
v
[i][j+1][
k
][1]

509 + 
udx
[
i
][
j
][
m
][1] * 
v
[i+1][j][
k
][1]

510 + 
udy
[
i
][
j
][
m
][2] * 
v
[i][j+1][
k
][2]

511 + 
udx
[
i
][
j
][
m
][2] * 
v
[i+1][j][
k
][2]

512 + 
udy
[
i
][
j
][
m
][3] * 
v
[i][j+1][
k
][3]

513 + 
udx
[
i
][
j
][
m
][3] * 
v
[i+1][j][
k
][3]

514 + 
udy
[
i
][
j
][
m
][4] * 
v
[i][j+1][
k
][4]

515 + 
udx
[
i
][
j
][
m
][4] * 
v
[i+1][j][
k
][4] );

521 
	gm
 = 0; m < 5; m++) {

522 
	gtm©
[
m
][0] = 
d
[
i
][
j
][m][0];

523 
	gtm©
[
m
][1] = 
d
[
i
][
j
][m][1];

524 
	gtm©
[
m
][2] = 
d
[
i
][
j
][m][2];

525 
	gtm©
[
m
][3] = 
d
[
i
][
j
][m][3];

526 
	gtm©
[
m
][4] = 
d
[
i
][
j
][m][4];

529 
	gtmp1
 = 1.0 / 
tm©
[0][0];

530 
	gtmp
 = 
tmp1
 * 
tm©
[1][0];

531 
	gtm©
[1][1] = 
tm©
[1][1]

532 - 
tmp
 * 
tm©
[0][1];

533 
	gtm©
[1][2] = 
tm©
[1][2]

534 - 
tmp
 * 
tm©
[0][2];

535 
	gtm©
[1][3] = 
tm©
[1][3]

536 - 
tmp
 * 
tm©
[0][3];

537 
	gtm©
[1][4] = 
tm©
[1][4]

538 - 
tmp
 * 
tm©
[0][4];

539 
	gtv
[
i
][
j
][1] = 
tv
[i][j][1]

540 - 
tv
[
i
][
j
][0] * 
tmp
;

542 
	gtmp
 = 
tmp1
 * 
tm©
[2][0];

543 
	gtm©
[2][1] = 
tm©
[2][1]

544 - 
tmp
 * 
tm©
[0][1];

545 
	gtm©
[2][2] = 
tm©
[2][2]

546 - 
tmp
 * 
tm©
[0][2];

547 
	gtm©
[2][3] = 
tm©
[2][3]

548 - 
tmp
 * 
tm©
[0][3];

549 
	gtm©
[2][4] = 
tm©
[2][4]

550 - 
tmp
 * 
tm©
[0][4];

551 
	gtv
[
i
][
j
][2] = 
tv
[i][j][2]

552 - 
tv
[
i
][
j
][0] * 
tmp
;

554 
	gtmp
 = 
tmp1
 * 
tm©
[3][0];

555 
	gtm©
[3][1] = 
tm©
[3][1]

556 - 
tmp
 * 
tm©
[0][1];

557 
	gtm©
[3][2] = 
tm©
[3][2]

558 - 
tmp
 * 
tm©
[0][2];

559 
	gtm©
[3][3] = 
tm©
[3][3]

560 - 
tmp
 * 
tm©
[0][3];

561 
	gtm©
[3][4] = 
tm©
[3][4]

562 - 
tmp
 * 
tm©
[0][4];

563 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

564 - 
tv
[
i
][
j
][0] * 
tmp
;

566 
	gtmp
 = 
tmp1
 * 
tm©
[4][0];

567 
	gtm©
[4][1] = 
tm©
[4][1]

568 - 
tmp
 * 
tm©
[0][1];

569 
	gtm©
[4][2] = 
tm©
[4][2]

570 - 
tmp
 * 
tm©
[0][2];

571 
	gtm©
[4][3] = 
tm©
[4][3]

572 - 
tmp
 * 
tm©
[0][3];

573 
	gtm©
[4][4] = 
tm©
[4][4]

574 - 
tmp
 * 
tm©
[0][4];

575 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

576 - 
tv
[
i
][
j
][0] * 
tmp
;

578 
	gtmp1
 = 1.0 / 
tm©
[1][1];

579 
	gtmp
 = 
tmp1
 * 
tm©
[2][1];

580 
	gtm©
[2][2] = 
tm©
[2][2]

581 - 
tmp
 * 
tm©
[1][2];

582 
	gtm©
[2][3] = 
tm©
[2][3]

583 - 
tmp
 * 
tm©
[1][3];

584 
	gtm©
[2][4] = 
tm©
[2][4]

585 - 
tmp
 * 
tm©
[1][4];

586 
	gtv
[
i
][
j
][2] = 
tv
[i][j][2]

587 - 
tv
[
i
][
j
][1] * 
tmp
;

589 
	gtmp
 = 
tmp1
 * 
tm©
[3][1];

590 
	gtm©
[3][2] = 
tm©
[3][2]

591 - 
tmp
 * 
tm©
[1][2];

592 
	gtm©
[3][3] = 
tm©
[3][3]

593 - 
tmp
 * 
tm©
[1][3];

594 
	gtm©
[3][4] = 
tm©
[3][4]

595 - 
tmp
 * 
tm©
[1][4];

596 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

597 - 
tv
[
i
][
j
][1] * 
tmp
;

599 
	gtmp
 = 
tmp1
 * 
tm©
[4][1];

600 
	gtm©
[4][2] = 
tm©
[4][2]

601 - 
tmp
 * 
tm©
[1][2];

602 
	gtm©
[4][3] = 
tm©
[4][3]

603 - 
tmp
 * 
tm©
[1][3];

604 
	gtm©
[4][4] = 
tm©
[4][4]

605 - 
tmp
 * 
tm©
[1][4];

606 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

607 - 
tv
[
i
][
j
][1] * 
tmp
;

609 
	gtmp1
 = 1.0 / 
tm©
[2][2];

610 
	gtmp
 = 
tmp1
 * 
tm©
[3][2];

611 
	gtm©
[3][3] = 
tm©
[3][3]

612 - 
tmp
 * 
tm©
[2][3];

613 
	gtm©
[3][4] = 
tm©
[3][4]

614 - 
tmp
 * 
tm©
[2][4];

615 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

616 - 
tv
[
i
][
j
][2] * 
tmp
;

618 
	gtmp
 = 
tmp1
 * 
tm©
[4][2];

619 
	gtm©
[4][3] = 
tm©
[4][3]

620 - 
tmp
 * 
tm©
[2][3];

621 
	gtm©
[4][4] = 
tm©
[4][4]

622 - 
tmp
 * 
tm©
[2][4];

623 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

624 - 
tv
[
i
][
j
][2] * 
tmp
;

626 
	gtmp1
 = 1.0 / 
tm©
[3][3];

627 
	gtmp
 = 
tmp1
 * 
tm©
[4][3];

628 
	gtm©
[4][4] = 
tm©
[4][4]

629 - 
tmp
 * 
tm©
[3][4];

630 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

631 - 
tv
[
i
][
j
][3] * 
tmp
;

636 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

637 / 
tm©
[4][4];

639 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

640 - 
tm©
[3][4] * 
tv
[
i
][
j
][4];

641 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

642 / 
tm©
[3][3];

644 
	gtv
[
i
][
j
][2] = 
tv
[i][j][2]

645 - 
tm©
[2][3] * 
tv
[
i
][
j
][3]

646 - 
tm©
[2][4] * 
tv
[
i
][
j
][4];

647 
	gtv
[
i
][
j
][2] = 
tv
[i][j][2]

648 / 
tm©
[2][2];

650 
	gtv
[
i
][
j
][1] = 
tv
[i][j][1]

651 - 
tm©
[1][2] * 
tv
[
i
][
j
][2]

652 - 
tm©
[1][3] * 
tv
[
i
][
j
][3]

653 - 
tm©
[1][4] * 
tv
[
i
][
j
][4];

654 
	gtv
[
i
][
j
][1] = 
tv
[i][j][1]

655 / 
tm©
[1][1];

657 
	gtv
[
i
][
j
][0] = 
tv
[i][j][0]

658 - 
tm©
[0][1] * 
tv
[
i
][
j
][1]

659 - 
tm©
[0][2] * 
tv
[
i
][
j
][2]

660 - 
tm©
[0][3] * 
tv
[
i
][
j
][3]

661 - 
tm©
[0][4] * 
tv
[
i
][
j
][4];

662 
	gtv
[
i
][
j
][0] = 
tv
[i][j][0]

663 / 
tm©
[0][0];

665 
	gv
[
i
][
j
][
k
][0] = 
v
[i][j][k][0] - 
tv
[i][j][0];

666 
	gv
[
i
][
j
][
k
][1] = 
v
[i][j][k][1] - 
tv
[i][j][1];

667 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2] - 
tv
[i][j][2];

668 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3] - 
tv
[i][j][3];

669 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4] - 
tv
[i][j][4];

672 #ià
defšed
(
_OPENMP
)

673 ià(
	gi
 !ğ
›nd
è
æag
[
i
+1] = 0;

674 ià(
	gi
 !ğ
i¡
è
æag
[
i
] = 1;

675 #´agm¨
omp
 
æush
(
æag
)

683 
	$domaš
() {

689 
nx
 = 
nx0
;

690 
ny
 = 
ny0
;

691 
nz
 = 
nz0
;

696 iàĞ
nx
 < 4 || 
ny
 < 4 || 
nz
 < 4 ) {

697 
	`´štf
(" SUBDOMAIN SIZE IS TOO SMALL - \n"

700 " TO 4 THEY ARE CURRENTLY%3d%3d%3d\n", 
nx
, 
ny
, 
nz
);

701 
	`ex™
(1);

704 iàĞ
nx
 > 
ISIZ1
 || 
ny
 > 
ISIZ2
 || 
nz
 > 
ISIZ3
 ) {

705 
	`´štf
(" SUBDOMAIN SIZE IS TOO LARGE - \n"

709 " CURRENTLY%4d%4d%4d\n", 
nx
, 
ny
, 
nz
);

710 
	`ex™
(1);

716 
i¡
 = 1;

717 
›nd
 = 
nx
 - 2;

719 
j¡
 = 1;

720 
j’d
 = 
ny
 - 2;

721 
	}
}

726 
	$”hs
() {

728 #´agm¨
omp
 
·¿Î–


740 
i
, 
j
, 
k
, 
m
;

741 
iglob
, 
jglob
;

742 
L1
, 
L2
;

743 
i¡1
, 
›nd1
;

744 
j¡1
, 
j’d1
;

745 
ds¥m
;

746 
xi
, 
‘a
, 
z‘a
;

747 
q
;

748 
u21
, 
u31
, 
u41
;

749 
tmp
;

750 
u21i
, 
u31i
, 
u41i
, 
u51i
;

751 
u21j
, 
u31j
, 
u41j
, 
u51j
;

752 
u21k
, 
u31k
, 
u41k
, 
u51k
;

753 
u21im1
, 
u31im1
, 
u41im1
, 
u51im1
;

754 
u21jm1
, 
u31jm1
, 
u41jm1
, 
u51jm1
;

755 
u21km1
, 
u31km1
, 
u41km1
, 
u51km1
;

757 
ds¥m
 = 
ds¥
;

759 #´agm¨
omp
 

760 
i
 = 0; i < 
nx
; i++) {

761 
j
 = 0; j < 
ny
; j++) {

762 
k
 = 0; k < 
nz
; k++) {

763 
m
 = 0; m < 5; m++) {

764 
äù
[
i
][
j
][
k
][
m
] = 0.0;

770 #´agm¨
omp
 

771 
i
 = 0; i < 
nx
; i++) {

772 
iglob
 = 
i
;

773 
xi
 = ( ()(
iglob
èè/ ( 
nx0
 - 1 );

774 
j
 = 0; j < 
ny
; j++) {

775 
jglob
 = 
j
;

776 
‘a
 = ( ()(
jglob
èè/ ( 
ny0
 - 1 );

777 
k
 = 0; k < 
nz
; k++) {

778 
z‘a
 = ( ()(
k
èè/ ( 
nz
 - 1 );

779 
m
 = 0; m < 5; m++) {

780 
rsd
[
i
][
j
][
k
][
m
] = 
û
[m][0]

781 + 
û
[
m
][1] * 
xi


782 + 
û
[
m
][2] * 
‘a


783 + 
û
[
m
][3] * 
z‘a


784 + 
û
[
m
][4] * 
xi
 * xi

785 + 
û
[
m
][5] * 
‘a
 *ƒta

786 + 
û
[
m
][6] * 
z‘a
 * zeta

787 + 
û
[
m
][7] * 
xi
 * xi * xi

788 + 
û
[
m
][8] * 
‘a
 *ƒta *ƒta

789 + 
û
[
m
][9] * 
z‘a
 * zeta * zeta

790 + 
û
[
m
][10] * 
xi
 * xi * xi * xi

791 + 
û
[
m
][11] * 
‘a
 *ƒta *ƒta *ƒta

792 + 
û
[
m
][12] * 
z‘a
 * zeta * zeta * zeta;

802 
L1
 = 0;

803 
L2
 = 
nx
-1;

805 #´agm¨
omp
 

806 
i
 = 
L1
; i <ğ
L2
; i++) {

807 
j
 = 
j¡
; j <ğ
j’d
; j++) {

808 
k
 = 1; k < 
nz
 - 1; k++) {

809 
æux
[
i
][
j
][
k
][0] = 
rsd
[i][j][k][1];

810 
u21
 = 
rsd
[
i
][
j
][
k
][1] /„sd[i][j][k][0];

811 
q
 = 0.50 * ( 
rsd
[
i
][
j
][
k
][1] *„sd[i][j][k][1]

812 + 
rsd
[
i
][
j
][
k
][2] *„sd[i][j][k][2]

813 + 
rsd
[
i
][
j
][
k
][3] *„sd[i][j][k][3] )

814 / 
rsd
[
i
][
j
][
k
][0];

815 
æux
[
i
][
j
][
k
][1] = 
rsd
[i][j][k][1] * 
u21
 + 
C2
 *

816 Ğ
rsd
[
i
][
j
][
k
][4] - 
q
 );

817 
æux
[
i
][
j
][
k
][2] = 
rsd
[i][j][k][2] * 
u21
;

818 
æux
[
i
][
j
][
k
][3] = 
rsd
[i][j][k][3] * 
u21
;

819 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
rsd
[i][j][k][4] - 
C2
 * 
q
 ) * 
u21
;

824 #´agm¨
omp
 

825 
j
 = 
j¡
; j <ğ
j’d
; j++) {

826 
k
 = 1; k <ğ
nz
 - 2; k++) {

827 
i
 = 
i¡
; i <ğ
›nd
; i++) {

828 
m
 = 0; m < 5; m++) {

829 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

830 - 
tx2
 * ( 
æux
[
i
+1][
j
][
k
][
m
] - flux[i-1][j][k][m] );

833 
i
 = 
i¡
; i <ğ
L2
; i++) {

834 
tmp
 = 1.0 / 
rsd
[
i
][
j
][
k
][0];

836 
u21i
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][1];

837 
u31i
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][2];

838 
u41i
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][3];

839 
u51i
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][4];

841 
tmp
 = 1.0 / 
rsd
[
i
-1][
j
][
k
][0];

843 
u21im1
 = 
tmp
 * 
rsd
[
i
-1][
j
][
k
][1];

844 
u31im1
 = 
tmp
 * 
rsd
[
i
-1][
j
][
k
][2];

845 
u41im1
 = 
tmp
 * 
rsd
[
i
-1][
j
][
k
][3];

846 
u51im1
 = 
tmp
 * 
rsd
[
i
-1][
j
][
k
][4];

848 
æux
[
i
][
j
][
k
][1] = (4.0/3.0è* 
tx3
 *

849 Ğ
u21i
 - 
u21im1
 );

850 
æux
[
i
][
j
][
k
][2] = 
tx3
 * ( 
u31i
 - 
u31im1
 );

851 
æux
[
i
][
j
][
k
][3] = 
tx3
 * ( 
u41i
 - 
u41im1
 );

852 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

853 * 
tx3
 * ( ( 
u21i
 * u21˜+ 
u31i
 * u31˜+ 
u41i
 * u41i )

854 - ( 
u21im1
*u21im1 + 
u31im1
*u31im1 + 
u41im1
*u41im1 ) )

856 * 
tx3
 * ( 
u21i
*u21˜- 
u21im1
*u21im1 )

857 + 
C1
 * 
C5
 * 
tx3
 * ( 
u51i
 - 
u51im1
 );

860 
i
 = 
i¡
; i <ğ
›nd
; i++) {

861 
äù
[
i
][
j
][
k
][0] = frct[i][j][k][0]

862 + 
dx1
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][0]

863 - 2.0 * 
rsd
[
i
][
j
][
k
][0]

864 + 
rsd
[
i
+1][
j
][
k
][0] );

865 
äù
[
i
][
j
][
k
][1] = frct[i][j][k][1]

866 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][1] - flux[i][j][k][1] )

867 + 
dx2
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][1]

868 - 2.0 * 
rsd
[
i
][
j
][
k
][1]

869 + 
rsd
[
i
+1][
j
][
k
][1] );

870 
äù
[
i
][
j
][
k
][2] = frct[i][j][k][2]

871 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][2] - flux[i][j][k][2] )

872 + 
dx3
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][2]

873 - 2.0 * 
rsd
[
i
][
j
][
k
][2]

874 + 
rsd
[
i
+1][
j
][
k
][2] );

875 
äù
[
i
][
j
][
k
][3] = frct[i][j][k][3]

876 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][3] - flux[i][j][k][3] )

877 + 
dx4
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][3]

878 - 2.0 * 
rsd
[
i
][
j
][
k
][3]

879 + 
rsd
[
i
+1][
j
][
k
][3] );

880 
äù
[
i
][
j
][
k
][4] = frct[i][j][k][4]

881 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][4] - flux[i][j][k][4] )

882 + 
dx5
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][4]

883 - 2.0 * 
rsd
[
i
][
j
][
k
][4]

884 + 
rsd
[
i
+1][
j
][
k
][4] );

890 
m
 = 0; m < 5; m++) {

891 
äù
[1][
j
][
k
][
m
] = frct[1][j][k][m]

892 - 
ds¥m
 * ( + 5.0 * 
rsd
[1][
j
][
k
][
m
]

893 - 4.0 * 
rsd
[2][
j
][
k
][
m
]

894 + 
rsd
[3][
j
][
k
][
m
] );

895 
äù
[2][
j
][
k
][
m
] = frct[2][j][k][m]

896 - 
ds¥m
 * ( - 4.0 * 
rsd
[1][
j
][
k
][
m
]

897 + 6.0 * 
rsd
[2][
j
][
k
][
m
]

898 - 4.0 * 
rsd
[3][
j
][
k
][
m
]

899 + 
rsd
[4][
j
][
k
][
m
] );

902 
i¡1
 = 3;

903 
›nd1
 = 
nx
 - 4;

904 
i
 = 
i¡1
; i <=
›nd1
; i++) {

905 
m
 = 0; m < 5; m++) {

906 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

907 - 
ds¥m
 * ( 
rsd
[
i
-2][
j
][
k
][
m
]

908 - 4.0 * 
rsd
[
i
-1][
j
][
k
][
m
]

909 + 6.0 * 
rsd
[
i
][
j
][
k
][
m
]

910 - 4.0 * 
rsd
[
i
+1][
j
][
k
][
m
]

911 + 
rsd
[
i
+2][
j
][
k
][
m
] );

915 
m
 = 0; m < 5; m++) {

916 
äù
[
nx
-3][
j
][
k
][
m
] = frct[nx-3][j][k][m]

917 - 
ds¥m
 * ( 
rsd
[
nx
-5][
j
][
k
][
m
]

918 - 4.0 * 
rsd
[
nx
-4][
j
][
k
][
m
]

919 + 6.0 * 
rsd
[
nx
-3][
j
][
k
][
m
]

920 - 4.0 * 
rsd
[
nx
-2][
j
][
k
][
m
] );

921 
äù
[
nx
-2][
j
][
k
][
m
] = frct[nx-2][j][k][m]

922 - 
ds¥m
 * ( 
rsd
[
nx
-4][
j
][
k
][
m
]

923 - 4.0 * 
rsd
[
nx
-3][
j
][
k
][
m
]

924 + 5.0 * 
rsd
[
nx
-2][
j
][
k
][
m
] );

933 
L1
 = 0;

934 
L2
 = 
ny
-1;

936 #´agm¨
omp
 

937 
i
 = 
i¡
; i <ğ
›nd
; i++) {

938 
j
 = 
L1
; j <ğ
L2
; j++) {

939 
k
 = 1; k <ğ
nz
 - 2; k++) {

940 
æux
[
i
][
j
][
k
][0] = 
rsd
[i][j][k][2];

941 
u31
 = 
rsd
[
i
][
j
][
k
][2] /„sd[i][j][k][0];

942 
q
 = 0.50 * ( 
rsd
[
i
][
j
][
k
][1] *„sd[i][j][k][1]

943 + 
rsd
[
i
][
j
][
k
][2] *„sd[i][j][k][2]

944 + 
rsd
[
i
][
j
][
k
][3] *„sd[i][j][k][3] )

945 / 
rsd
[
i
][
j
][
k
][0];

946 
æux
[
i
][
j
][
k
][1] = 
rsd
[i][j][k][1] * 
u31
;

947 
æux
[
i
][
j
][
k
][2] = 
rsd
[i][j][k][2] * 
u31
 + 
C2
 *

948 Ğ
rsd
[
i
][
j
][
k
][4] - 
q
 );

949 
æux
[
i
][
j
][
k
][3] = 
rsd
[i][j][k][3] * 
u31
;

950 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
rsd
[i][j][k][4] - 
C2
 * 
q
 ) * 
u31
;

955 #´agm¨
omp
 

956 
i
 = 
i¡
; i <ğ
›nd
; i++) {

957 
k
 = 1; k <ğ
nz
 - 2; k++) {

958 
j
 = 
j¡
; j <ğ
j’d
; j++) {

959 
m
 = 0; m < 5; m++) {

960 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

961 - 
ty2
 * ( 
æux
[
i
][
j
+1][
k
][
m
] - flux[i][j-1][k][m] );

964 
j
 = 
j¡
; j <ğ
L2
; j++) {

965 
tmp
 = 1.0 / 
rsd
[
i
][
j
][
k
][0];

967 
u21j
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][1];

968 
u31j
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][2];

969 
u41j
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][3];

970 
u51j
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][4];

972 
tmp
 = 1.0 / 
rsd
[
i
][
j
-1][
k
][0];

974 
u21jm1
 = 
tmp
 * 
rsd
[
i
][
j
-1][
k
][1];

975 
u31jm1
 = 
tmp
 * 
rsd
[
i
][
j
-1][
k
][2];

976 
u41jm1
 = 
tmp
 * 
rsd
[
i
][
j
-1][
k
][3];

977 
u51jm1
 = 
tmp
 * 
rsd
[
i
][
j
-1][
k
][4];

979 
æux
[
i
][
j
][
k
][1] = 
ty3
 * ( 
u21j
 - 
u21jm1
 );

980 
æux
[
i
][
j
][
k
][2] = (4.0/3.0è* 
ty3
 *

981 Ğ
u31j
 - 
u31jm1
 );

982 
æux
[
i
][
j
][
k
][3] = 
ty3
 * ( 
u41j
 - 
u41jm1
 );

983 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

984 * 
ty3
 * ( ( 
u21j
 *u21j + 
u31j
 *u31j + 
u41j
 *u41j )

985 - ( 
u21jm1
*u21jm1 + 
u31jm1
*u31jm1 + 
u41jm1
*u41jm1 ) )

987 * 
ty3
 * ( 
u31j
*u31j - 
u31jm1
*u31jm1 )

988 + 
C1
 * 
C5
 * 
ty3
 * ( 
u51j
 - 
u51jm1
 );

991 
j
 = 
j¡
; j <ğ
j’d
; j++) {

992 
äù
[
i
][
j
][
k
][0] = frct[i][j][k][0]

993 + 
dy1
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][0]

994 - 2.0 * 
rsd
[
i
][
j
][
k
][0]

995 + 
rsd
[
i
][
j
+1][
k
][0] );

996 
äù
[
i
][
j
][
k
][1] = frct[i][j][k][1]

997 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][1] - flux[i][j][k][1] )

998 + 
dy2
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][1]

999 - 2.0 * 
rsd
[
i
][
j
][
k
][1]

1000 + 
rsd
[
i
][
j
+1][
k
][1] );

1001 
äù
[
i
][
j
][
k
][2] = frct[i][j][k][2]

1002 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][2] - flux[i][j][k][2] )

1003 + 
dy3
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][2]

1004 - 2.0 * 
rsd
[
i
][
j
][
k
][2]

1005 + 
rsd
[
i
][
j
+1][
k
][2] );

1006 
äù
[
i
][
j
][
k
][3] = frct[i][j][k][3]

1007 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][3] - flux[i][j][k][3] )

1008 + 
dy4
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][3]

1009 - 2.0 * 
rsd
[
i
][
j
][
k
][3]

1010 + 
rsd
[
i
][
j
+1][
k
][3] );

1011 
äù
[
i
][
j
][
k
][4] = frct[i][j][k][4]

1012 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][4] - flux[i][j][k][4] )

1013 + 
dy5
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][4]

1014 - 2.0 * 
rsd
[
i
][
j
][
k
][4]

1015 + 
rsd
[
i
][
j
+1][
k
][4] );

1021 
m
 = 0; m < 5; m++) {

1022 
äù
[
i
][1][
k
][
m
] = frct[i][1][k][m]

1023 - 
ds¥m
 * ( + 5.0 * 
rsd
[
i
][1][
k
][
m
]

1024 - 4.0 * 
rsd
[
i
][2][
k
][
m
]

1025 + 
rsd
[
i
][3][
k
][
m
] );

1026 
äù
[
i
][2][
k
][
m
] = frct[i][2][k][m]

1027 - 
ds¥m
 * ( - 4.0 * 
rsd
[
i
][1][
k
][
m
]

1028 + 6.0 * 
rsd
[
i
][2][
k
][
m
]

1029 - 4.0 * 
rsd
[
i
][3][
k
][
m
]

1030 + 
rsd
[
i
][4][
k
][
m
] );

1033 
j¡1
 = 3;

1034 
j’d1
 = 
ny
 - 4;

1036 
j
 = 
j¡1
; j <ğ
j’d1
; j++) {

1037 
m
 = 0; m < 5; m++) {

1038 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

1039 - 
ds¥m
 * ( 
rsd
[
i
][
j
-2][
k
][
m
]

1040 - 4.0 * 
rsd
[
i
][
j
-1][
k
][
m
]

1041 + 6.0 * 
rsd
[
i
][
j
][
k
][
m
]

1042 - 4.0 * 
rsd
[
i
][
j
+1][
k
][
m
]

1043 + 
rsd
[
i
][
j
+2][
k
][
m
] );

1047 
m
 = 0; m < 5; m++) {

1048 
äù
[
i
][
ny
-3][
k
][
m
] = frct[i][ny-3][k][m]

1049 - 
ds¥m
 * ( 
rsd
[
i
][
ny
-5][
k
][
m
]

1050 - 4.0 * 
rsd
[
i
][
ny
-4][
k
][
m
]

1051 + 6.0 * 
rsd
[
i
][
ny
-3][
k
][
m
]

1052 - 4.0 * 
rsd
[
i
][
ny
-2][
k
][
m
] );

1053 
äù
[
i
][
ny
-2][
k
][
m
] = frct[i][ny-2][k][m]

1054 - 
ds¥m
 * ( 
rsd
[
i
][
ny
-4][
k
][
m
]

1055 - 4.0 * 
rsd
[
i
][
ny
-3][
k
][
m
]

1056 + 5.0 * 
rsd
[
i
][
ny
-2][
k
][
m
] );

1065 #´agm¨
omp
 

1066 
i
 = 
i¡
; i <ğ
›nd
; i++) {

1067 
j
 = 
j¡
; j <ğ
j’d
; j++) {

1068 
k
 = 0; k <ğ
nz
-1; k++) {

1069 
æux
[
i
][
j
][
k
][0] = 
rsd
[i][j][k][3];

1070 
u41
 = 
rsd
[
i
][
j
][
k
][3] /„sd[i][j][k][0];

1071 
q
 = 0.50 * ( 
rsd
[
i
][
j
][
k
][1] *„sd[i][j][k][1]

1072 + 
rsd
[
i
][
j
][
k
][2] *„sd[i][j][k][2]

1073 + 
rsd
[
i
][
j
][
k
][3] *„sd[i][j][k][3] )

1074 / 
rsd
[
i
][
j
][
k
][0];

1075 
æux
[
i
][
j
][
k
][1] = 
rsd
[i][j][k][1] * 
u41
;

1076 
æux
[
i
][
j
][
k
][2] = 
rsd
[i][j][k][2] * 
u41
;

1077 
æux
[
i
][
j
][
k
][3] = 
rsd
[i][j][k][3] * 
u41
 + 
C2
 *

1078 Ğ
rsd
[
i
][
j
][
k
][4] - 
q
 );

1079 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
rsd
[i][j][k][4] - 
C2
 * 
q
 ) * 
u41
;

1082 
k
 = 1; k <ğ
nz
 - 2; k++) {

1083 
m
 = 0; m < 5; m++) {

1084 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

1085 - 
tz2
 * ( 
æux
[
i
][
j
][
k
+1][
m
] - flux[i][j][k-1][m] );

1088 
k
 = 1; k <ğ
nz
-1; k++) {

1089 
tmp
 = 1.0 / 
rsd
[
i
][
j
][
k
][0];

1091 
u21k
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][1];

1092 
u31k
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][2];

1093 
u41k
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][3];

1094 
u51k
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][4];

1096 
tmp
 = 1.0 / 
rsd
[
i
][
j
][
k
-1][0];

1098 
u21km1
 = 
tmp
 * 
rsd
[
i
][
j
][
k
-1][1];

1099 
u31km1
 = 
tmp
 * 
rsd
[
i
][
j
][
k
-1][2];

1100 
u41km1
 = 
tmp
 * 
rsd
[
i
][
j
][
k
-1][3];

1101 
u51km1
 = 
tmp
 * 
rsd
[
i
][
j
][
k
-1][4];

1103 
æux
[
i
][
j
][
k
][1] = 
tz3
 * ( 
u21k
 - 
u21km1
 );

1104 
æux
[
i
][
j
][
k
][2] = 
tz3
 * ( 
u31k
 - 
u31km1
 );

1105 
æux
[
i
][
j
][
k
][3] = (4.0/3.0è* 
tz3
 * ( 
u41k


1106 - 
u41km1
 );

1107 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

1108 * 
tz3
 * ( ( 
u21k
 *u21k + 
u31k
 *u31k + 
u41k
 *u41k )

1109 - ( 
u21km1
*u21km1 + 
u31km1
*u31km1 + 
u41km1
*u41km1 ) )

1111 * 
tz3
 * ( 
u41k
*u41k - 
u41km1
*u41km1 )

1112 + 
C1
 * 
C5
 * 
tz3
 * ( 
u51k
 - 
u51km1
 );

1115 
k
 = 1; k <ğ
nz
 - 2; k++) {

1116 
äù
[
i
][
j
][
k
][0] = frct[i][j][k][0]

1117 + 
dz1
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][0]

1118 - 2.0 * 
rsd
[
i
][
j
][
k
][0]

1119 + 
rsd
[
i
][
j
][
k
-1][0] );

1120 
äù
[
i
][
j
][
k
][1] = frct[i][j][k][1]

1121 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][1] - flux[i][j][k][1] )

1122 + 
dz2
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][1]

1123 - 2.0 * 
rsd
[
i
][
j
][
k
][1]

1124 + 
rsd
[
i
][
j
][
k
-1][1] );

1125 
äù
[
i
][
j
][
k
][2] = frct[i][j][k][2]

1126 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][2] - flux[i][j][k][2] )

1127 + 
dz3
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][2]

1128 - 2.0 * 
rsd
[
i
][
j
][
k
][2]

1129 + 
rsd
[
i
][
j
][
k
-1][2] );

1130 
äù
[
i
][
j
][
k
][3] = frct[i][j][k][3]

1131 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][3] - flux[i][j][k][3] )

1132 + 
dz4
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][3]

1133 - 2.0 * 
rsd
[
i
][
j
][
k
][3]

1134 + 
rsd
[
i
][
j
][
k
-1][3] );

1135 
äù
[
i
][
j
][
k
][4] = frct[i][j][k][4]

1136 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][4] - flux[i][j][k][4] )

1137 + 
dz5
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][4]

1138 - 2.0 * 
rsd
[
i
][
j
][
k
][4]

1139 + 
rsd
[
i
][
j
][
k
-1][4] );

1145 
m
 = 0; m < 5; m++) {

1146 
äù
[
i
][
j
][1][
m
] = frct[i][j][1][m]

1147 - 
ds¥m
 * ( + 5.0 * 
rsd
[
i
][
j
][1][
m
]

1148 - 4.0 * 
rsd
[
i
][
j
][2][
m
]

1149 + 
rsd
[
i
][
j
][3][
m
] );

1150 
äù
[
i
][
j
][2][
m
] = frct[i][j][2][m]

1151 - 
ds¥m
 * (- 4.0 * 
rsd
[
i
][
j
][1][
m
]

1152 + 6.0 * 
rsd
[
i
][
j
][2][
m
]

1153 - 4.0 * 
rsd
[
i
][
j
][3][
m
]

1154 + 
rsd
[
i
][
j
][4][
m
] );

1157 
k
 = 3; k <ğ
nz
 - 4; k++) {

1158 
m
 = 0; m < 5; m++) {

1159 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

1160 - 
ds¥m
 * ( 
rsd
[
i
][
j
][
k
-2][
m
]

1161 - 4.0 * 
rsd
[
i
][
j
][
k
-1][
m
]

1162 + 6.0 * 
rsd
[
i
][
j
][
k
][
m
]

1163 - 4.0 * 
rsd
[
i
][
j
][
k
+1][
m
]

1164 + 
rsd
[
i
][
j
][
k
+2][
m
] );

1168 
m
 = 0; m < 5; m++) {

1169 
äù
[
i
][
j
][
nz
-3][
m
] = frct[i][j][nz-3][m]

1170 - 
ds¥m
 * ( 
rsd
[
i
][
j
][
nz
-5][
m
]

1171 - 4.0 * 
rsd
[
i
][
j
][
nz
-4][
m
]

1172 + 6.0 * 
rsd
[
i
][
j
][
nz
-3][
m
]

1173 - 4.0 * 
rsd
[
i
][
j
][
nz
-2][
m
] );

1174 
äù
[
i
][
j
][
nz
-2][
m
] = frct[i][j][nz-2][m]

1175 - 
ds¥m
 * ( 
rsd
[
i
][
j
][
nz
-4][
m
]

1176 - 4.0 * 
rsd
[
i
][
j
][
nz
-3][
m
]

1177 + 5.0 * 
rsd
[
i
][
j
][
nz
-2][
m
] );

1182 
	}
}

1186 
	$”rÜ
() {

1197 
i
, 
j
, 
k
, 
m
;

1198 
iglob
, 
jglob
;

1199 
tmp
;

1200 
u000ijk
[5];

1202 
m
 = 0; m < 5; m++) {

1203 
”ºm
[
m
] = 0.0;

1206 
i
 = 
i¡
; i <ğ
›nd
; i++) {

1207 
iglob
 = 
i
;

1208 
j
 = 
j¡
; j <ğ
j’d
; j++) {

1209 
jglob
 = 
j
;

1210 
k
 = 1; k <ğ
nz
-2; k++) {

1211 
	`exaù
Ğ
iglob
, 
jglob
, 
k
, 
u000ijk
 );

1212 
m
 = 0; m < 5; m++) {

1213 
tmp
 = ( 
u000ijk
[
m
] - 
u
[
i
][
j
][
k
][m] );

1214 
”ºm
[
m
] =ƒ¼nm[m] + 
tmp
 *tmp;

1220 
m
 = 0; m < 5; m++) {

1221 
”ºm
[
m
] = 
	`sq¹
 (ƒ¼nm[m] / ( (
nx0
-2)*(
ny0
-2)*(
nz0
-2) ) );

1223 
	}
}

1228 
	$exaù
Ğ
i
, 
j
, 
k
, 
u000ijk
[5] ) {

1239 
m
;

1240 
xi
, 
‘a
, 
z‘a
;

1242 
xi
 = (()
i
è/ (
nx0
 - 1);

1243 
‘a
 = (()
j
è/ (
ny0
 - 1);

1244 
z‘a
 = (()
k
è/ (
nz
 - 1);

1246 
m
 = 0; m < 5; m++) {

1247 
u000ijk
[
m
] = 
û
[m][0]

1248 + 
û
[
m
][1] * 
xi


1249 + 
û
[
m
][2] * 
‘a


1250 + 
û
[
m
][3] * 
z‘a


1251 + 
û
[
m
][4] * 
xi
 * xi

1252 + 
û
[
m
][5] * 
‘a
 *ƒta

1253 + 
û
[
m
][6] * 
z‘a
 * zeta

1254 + 
û
[
m
][7] * 
xi
 * xi * xi

1255 + 
û
[
m
][8] * 
‘a
 *ƒta *ƒta

1256 + 
û
[
m
][9] * 
z‘a
 * zeta * zeta

1257 + 
û
[
m
][10] * 
xi
 * xi * xi * xi

1258 + 
û
[
m
][11] * 
‘a
 *ƒta *ƒta *ƒta

1259 + 
û
[
m
][12] * 
z‘a
 * zeta * zeta * zeta;

1261 
	}
}

1266 
	$jaşd
(
k
) {

1275 
i
, 
j
;

1276 
r43
;

1277 
c1345
;

1278 
c34
;

1279 
tmp1
, 
tmp2
, 
tmp3
;

1281 
r43
 = ( 4.0 / 3.0 );

1282 
c1345
 = 
C1
 * 
C3
 * 
C4
 * 
C5
;

1283 
c34
 = 
C3
 * 
C4
;

1285 #´agm¨
omp
 
nowa™
 
	`scheduË
()

1286 
i
 = 
i¡
; i <ğ
›nd
; i++) {

1287 
j
 = 
j¡
; j <ğ
j’d
; j++) {

1292 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1293 
tmp2
 = 
tmp1
 *mp1;

1294 
tmp3
 = 
tmp1
 * 
tmp2
;

1296 
d
[
i
][
j
][0][0] = 1.0

1297 + 
dt
 * 2.0 * ( 
tx1
 * 
dx1


1298 + 
ty1
 * 
dy1


1299 + 
tz1
 * 
dz1
 );

1300 
d
[
i
][
j
][0][1] = 0.0;

1301 
d
[
i
][
j
][0][2] = 0.0;

1302 
d
[
i
][
j
][0][3] = 0.0;

1303 
d
[
i
][
j
][0][4] = 0.0;

1305 
d
[
i
][
j
][1][0] = 
dt
 * 2.0

1306 * ( 
tx1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] )

1307 + 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] )

1308 + 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] ) );

1309 
d
[
i
][
j
][1][1] = 1.0

1310 + 
dt
 * 2.0

1311 * ( 
tx1
 * 
r43
 * 
c34
 * 
tmp1


1312 + 
ty1
 * 
c34
 * 
tmp1


1313 + 
tz1
 * 
c34
 * 
tmp1
 )

1314 + 
dt
 * 2.0 * ( 
tx1
 * 
dx2


1315 + 
ty1
 * 
dy2


1316 + 
tz1
 * 
dz2
 );

1317 
d
[
i
][
j
][1][2] = 0.0;

1318 
d
[
i
][
j
][1][3] = 0.0;

1319 
d
[
i
][
j
][1][4] = 0.0;

1321 
d
[
i
][
j
][2][0] = 
dt
 * 2.0

1322 * ( 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] )

1323 + 
ty1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] )

1324 + 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] ) );

1325 
d
[
i
][
j
][2][1] = 0.0;

1326 
d
[
i
][
j
][2][2] = 1.0

1327 + 
dt
 * 2.0

1328 * ( 
tx1
 * 
c34
 * 
tmp1


1329 + 
ty1
 * 
r43
 * 
c34
 * 
tmp1


1330 + 
tz1
 * 
c34
 * 
tmp1
 )

1331 + 
dt
 * 2.0 * ( 
tx1
 * 
dx3


1332 + 
ty1
 * 
dy3


1333 + 
tz1
 * 
dz3
 );

1334 
d
[
i
][
j
][2][3] = 0.0;

1335 
d
[
i
][
j
][2][4] = 0.0;

1337 
d
[
i
][
j
][3][0] = 
dt
 * 2.0

1338 * ( 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] )

1339 + 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] )

1340 + 
tz1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] ) );

1341 
d
[
i
][
j
][3][1] = 0.0;

1342 
d
[
i
][
j
][3][2] = 0.0;

1343 
d
[
i
][
j
][3][3] = 1.0

1344 + 
dt
 * 2.0

1345 * ( 
tx1
 * 
c34
 * 
tmp1


1346 + 
ty1
 * 
c34
 * 
tmp1


1347 + 
tz1
 * 
r43
 * 
c34
 * 
tmp1
 )

1348 + 
dt
 * 2.0 * ( 
tx1
 * 
dx4


1349 + 
ty1
 * 
dy4


1350 + 
tz1
 * 
dz4
 );

1351 
d
[
i
][
j
][3][4] = 0.0;

1353 
d
[
i
][
j
][4][0] = 
dt
 * 2.0

1354 * ( 
tx1
 * ( - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1355 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1356 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1357 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] )

1358 + 
ty1
 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1359 - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1360 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1361 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] )

1362 + 
tz1
 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1363 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1364 - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1365 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] ) );

1366 
d
[
i
][
j
][4][1] = 
dt
 * 2.0

1367 * ( 
tx1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1]

1368 + 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1]

1369 + 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1] );

1370 
d
[
i
][
j
][4][2] = 
dt
 * 2.0

1371 * ( 
tx1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2]

1372 + 
ty1
 * ( 
r43
*
c34
 -
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2]

1373 + 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2] );

1374 
d
[
i
][
j
][4][3] = 
dt
 * 2.0

1375 * ( 
tx1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3]

1376 + 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3]

1377 + 
tz1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3] );

1378 
d
[
i
][
j
][4][4] = 1.0

1379 + 
dt
 * 2.0 * ( 
tx1
 * 
c1345
 * 
tmp1


1380 + 
ty1
 * 
c1345
 * 
tmp1


1381 + 
tz1
 * 
c1345
 * 
tmp1
 )

1382 + 
dt
 * 2.0 * ( 
tx1
 * 
dx5


1383 + 
ty1
 * 
dy5


1384 + 
tz1
 * 
dz5
 );

1389 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
-1][0];

1390 
tmp2
 = 
tmp1
 *mp1;

1391 
tmp3
 = 
tmp1
 * 
tmp2
;

1393 
a
[
i
][
j
][0][0] = - 
dt
 * 
tz1
 * 
dz1
;

1394 
a
[
i
][
j
][0][1] = 0.0;

1395 
a
[
i
][
j
][0][2] = 0.0;

1396 
a
[
i
][
j
][0][3] = - 
dt
 * 
tz2
;

1397 
a
[
i
][
j
][0][4] = 0.0;

1399 
a
[
i
][
j
][1][0] = - 
dt
 * 
tz2


1400 * ( - ( 
u
[
i
][
j
][
k
-1][1]*u[i][j][k-1][3] ) * 
tmp2
 )

1401 - 
dt
 * 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
-1][1] );

1402 
a
[
i
][
j
][1][1] = - 
dt
 * 
tz2
 * ( 
u
[i][j][
k
-1][3] * 
tmp1
 )

1403 - 
dt
 * 
tz1
 * 
c34
 * 
tmp1


1404 - 
dt
 * 
tz1
 * 
dz2
 ;

1405 
a
[
i
][
j
][1][2] = 0.0;

1406 
a
[
i
][
j
][1][3] = - 
dt
 * 
tz2
 * ( 
u
[i][j][
k
-1][1] * 
tmp1
 );

1407 
a
[
i
][
j
][1][4] = 0.0;

1409 
a
[
i
][
j
][2][0] = - 
dt
 * 
tz2


1410 * ( - ( 
u
[
i
][
j
][
k
-1][2]*u[i][j][k-1][3] ) * 
tmp2
 )

1411 - 
dt
 * 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
-1][2] );

1412 
a
[
i
][
j
][2][1] = 0.0;

1413 
a
[
i
][
j
][2][2] = - 
dt
 * 
tz2
 * ( 
u
[i][j][
k
-1][3] * 
tmp1
 )

1414 - 
dt
 * 
tz1
 * ( 
c34
 * 
tmp1
 )

1415 - 
dt
 * 
tz1
 * 
dz3
;

1416 
a
[
i
][
j
][2][3] = - 
dt
 * 
tz2
 * ( 
u
[i][j][
k
-1][2] * 
tmp1
 );

1417 
a
[
i
][
j
][2][4] = 0.0;

1419 
a
[
i
][
j
][3][0] = - 
dt
 * 
tz2


1420 * ( - ( 
u
[
i
][
j
][
k
-1][3] * 
tmp1
 ) *( u[i][j][k-1][3] *mp1 )

1421 + 0.50 * 
C2


1422 * ( ( 
u
[
i
][
j
][
k
-1][1] * u[i][j][k-1][1]

1423 + 
u
[
i
][
j
][
k
-1][2] * u[i][j][k-1][2]

1424 + 
u
[
i
][
j
][
k
-1][3] * u[i][j][k-1][3] ) * 
tmp2
 ) )

1425 - 
dt
 * 
tz1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
-1][3] );

1426 
a
[
i
][
j
][3][1] = - 
dt
 * 
tz2


1427 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
-1][1] * 
tmp1
 ) );

1428 
a
[
i
][
j
][3][2] = - 
dt
 * 
tz2


1429 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
-1][2] * 
tmp1
 ) );

1430 
a
[
i
][
j
][3][3] = - 
dt
 * 
tz2
 * ( 2.0 - 
C2
 )

1431 * ( 
u
[
i
][
j
][
k
-1][3] * 
tmp1
 )

1432 - 
dt
 * 
tz1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1433 - 
dt
 * 
tz1
 * 
dz4
;

1434 
a
[
i
][
j
][3][4] = - 
dt
 * 
tz2
 * 
C2
;

1436 
a
[
i
][
j
][4][0] = - 
dt
 * 
tz2


1437 * ( ( 
C2
 * ( 
u
[
i
][
j
][
k
-1][1] * u[i][j][k-1][1]

1438 + 
u
[
i
][
j
][
k
-1][2] * u[i][j][k-1][2]

1439 + 
u
[
i
][
j
][
k
-1][3] * u[i][j][k-1][3] ) * 
tmp2


1440 - 
C1
 * ( 
u
[
i
][
j
][
k
-1][4] * 
tmp1
 ) )

1441 * ( 
u
[
i
][
j
][
k
-1][3] * 
tmp1
 ) )

1442 - 
dt
 * 
tz1


1443 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * (
u
[
i
][
j
][
k
-1][1]*u[i][j][k-1][1])

1444 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * (
u
[
i
][
j
][
k
-1][2]*u[i][j][k-1][2])

1445 - ( 
r43
*
c34
 - 
c1345
 )* 
tmp3
 * (
u
[
i
][
j
][
k
-1][3]*u[i][j][k-1][3])

1446 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
-1][4] );

1447 
a
[
i
][
j
][4][1] = - 
dt
 * 
tz2


1448 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
-1][1]*u[i][j][k-1][3] ) * 
tmp2
 )

1449 - 
dt
 * 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
-1][1];

1450 
a
[
i
][
j
][4][2] = - 
dt
 * 
tz2


1451 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
-1][2]*u[i][j][k-1][3] ) * 
tmp2
 )

1452 - 
dt
 * 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
-1][2];

1453 
a
[
i
][
j
][4][3] = - 
dt
 * 
tz2


1454 * ( 
C1
 * ( 
u
[
i
][
j
][
k
-1][4] * 
tmp1
 )

1455 - 0.50 * 
C2


1456 * ( ( 
u
[
i
][
j
][
k
-1][1]*u[i][j][k-1][1]

1457 + 
u
[
i
][
j
][
k
-1][2]*u[i][j][k-1][2]

1458 + 3.0*
u
[
i
][
j
][
k
-1][3]*u[i][j][k-1][3] ) * 
tmp2
 ) )

1459 - 
dt
 * 
tz1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
-1][3];

1460 
a
[
i
][
j
][4][4] = - 
dt
 * 
tz2


1461 * ( 
C1
 * ( 
u
[
i
][
j
][
k
-1][3] * 
tmp1
 ) )

1462 - 
dt
 * 
tz1
 * 
c1345
 * 
tmp1


1463 - 
dt
 * 
tz1
 * 
dz5
;

1468 
tmp1
 = 1.0 / 
u
[
i
][
j
-1][
k
][0];

1469 
tmp2
 = 
tmp1
 *mp1;

1470 
tmp3
 = 
tmp1
 * 
tmp2
;

1472 
b
[
i
][
j
][0][0] = - 
dt
 * 
ty1
 * 
dy1
;

1473 
b
[
i
][
j
][0][1] = 0.0;

1474 
b
[
i
][
j
][0][2] = - 
dt
 * 
ty2
;

1475 
b
[
i
][
j
][0][3] = 0.0;

1476 
b
[
i
][
j
][0][4] = 0.0;

1478 
b
[
i
][
j
][1][0] = - 
dt
 * 
ty2


1479 * ( - ( 
u
[
i
][
j
-1][
k
][1]*u[i][j-1][k][2] ) * 
tmp2
 )

1480 - 
dt
 * 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
-1][
k
][1] );

1481 
b
[
i
][
j
][1][1] = - 
dt
 * 
ty2
 * ( 
u
[i][j-1][
k
][2] * 
tmp1
 )

1482 - 
dt
 * 
ty1
 * ( 
c34
 * 
tmp1
 )

1483 - 
dt
 * 
ty1
 * 
dy2
;

1484 
b
[
i
][
j
][1][2] = - 
dt
 * 
ty2
 * ( 
u
[i][j-1][
k
][1] * 
tmp1
 );

1485 
b
[
i
][
j
][1][3] = 0.0;

1486 
b
[
i
][
j
][1][4] = 0.0;

1488 
b
[
i
][
j
][2][0] = - 
dt
 * 
ty2


1489 * ( - ( 
u
[
i
][
j
-1][
k
][2] * 
tmp1
 ) *( u[i][j-1][k][2] *mp1 )

1490 + 0.50 * 
C2
 * ( ( 
u
[
i
][
j
-1][
k
][1] * u[i][j-1][k][1]

1491 + 
u
[
i
][
j
-1][
k
][2] * u[i][j-1][k][2]

1492 + 
u
[
i
][
j
-1][
k
][3] * u[i][j-1][k][3] )

1493 * 
tmp2
 ) )

1494 - 
dt
 * 
ty1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
-1][
k
][2] );

1495 
b
[
i
][
j
][2][1] = - 
dt
 * 
ty2


1496 * ( - 
C2
 * ( 
u
[
i
][
j
-1][
k
][1] * 
tmp1
 ) );

1497 
b
[
i
][
j
][2][2] = - 
dt
 * 
ty2
 * ( ( 2.0 - 
C2
 )

1498 * ( 
u
[
i
][
j
-1][
k
][2] * 
tmp1
 ) )

1499 - 
dt
 * 
ty1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1500 - 
dt
 * 
ty1
 * 
dy3
;

1501 
b
[
i
][
j
][2][3] = - 
dt
 * 
ty2


1502 * ( - 
C2
 * ( 
u
[
i
][
j
-1][
k
][3] * 
tmp1
 ) );

1503 
b
[
i
][
j
][2][4] = - 
dt
 * 
ty2
 * 
C2
;

1505 
b
[
i
][
j
][3][0] = - 
dt
 * 
ty2


1506 * ( - ( 
u
[
i
][
j
-1][
k
][2]*u[i][j-1][k][3] ) * 
tmp2
 )

1507 - 
dt
 * 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
-1][
k
][3] );

1508 
b
[
i
][
j
][3][1] = 0.0;

1509 
b
[
i
][
j
][3][2] = - 
dt
 * 
ty2
 * ( 
u
[i][j-1][
k
][3] * 
tmp1
 );

1510 
b
[
i
][
j
][3][3] = - 
dt
 * 
ty2
 * ( 
u
[i][j-1][
k
][2] * 
tmp1
 )

1511 - 
dt
 * 
ty1
 * ( 
c34
 * 
tmp1
 )

1512 - 
dt
 * 
ty1
 * 
dy4
;

1513 
b
[
i
][
j
][3][4] = 0.0;

1515 
b
[
i
][
j
][4][0] = - 
dt
 * 
ty2


1516 * ( ( 
C2
 * ( 
u
[
i
][
j
-1][
k
][1] * u[i][j-1][k][1]

1517 + 
u
[
i
][
j
-1][
k
][2] * u[i][j-1][k][2]

1518 + 
u
[
i
][
j
-1][
k
][3] * u[i][j-1][k][3] ) * 
tmp2


1519 - 
C1
 * ( 
u
[
i
][
j
-1][
k
][4] * 
tmp1
 ) )

1520 * ( 
u
[
i
][
j
-1][
k
][2] * 
tmp1
 ) )

1521 - 
dt
 * 
ty1


1522 * ( - ( 
c34
 - 
c1345
 )*
tmp3
*(
	`pow2
(
u
[
i
][
j
-1][
k
][1]))

1523 - ( 
r43
*
c34
 - 
c1345
 )*
tmp3
*(
	`pow2
(
u
[
i
][
j
-1][
k
][2]))

1524 - ( 
c34
 - 
c1345
 )*
tmp3
*(
	`pow2
(
u
[
i
][
j
-1][
k
][3]))

1525 - 
c1345
*
tmp2
*
u
[
i
][
j
-1][
k
][4] );

1526 
b
[
i
][
j
][4][1] = - 
dt
 * 
ty2


1527 * ( - 
C2
 * ( 
u
[
i
][
j
-1][
k
][1]*u[i][j-1][k][2] ) * 
tmp2
 )

1528 - 
dt
 * 
ty1


1529 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
-1][
k
][1];

1530 
b
[
i
][
j
][4][2] = - 
dt
 * 
ty2


1531 * ( 
C1
 * ( 
u
[
i
][
j
-1][
k
][4] * 
tmp1
 )

1532 - 0.50 * 
C2


1533 * ( ( 
u
[
i
][
j
-1][
k
][1]*u[i][j-1][k][1]

1534 + 3.0 * 
u
[
i
][
j
-1][
k
][2]*u[i][j-1][k][2]

1535 + 
u
[
i
][
j
-1][
k
][3]*u[i][j-1][k][3] ) * 
tmp2
 ) )

1536 - 
dt
 * 
ty1


1537 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
-1][
k
][2];

1538 
b
[
i
][
j
][4][3] = - 
dt
 * 
ty2


1539 * ( - 
C2
 * ( 
u
[
i
][
j
-1][
k
][2]*u[i][j-1][k][3] ) * 
tmp2
 )

1540 - 
dt
 * 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
-1][
k
][3];

1541 
b
[
i
][
j
][4][4] = - 
dt
 * 
ty2


1542 * ( 
C1
 * ( 
u
[
i
][
j
-1][
k
][2] * 
tmp1
 ) )

1543 - 
dt
 * 
ty1
 * 
c1345
 * 
tmp1


1544 - 
dt
 * 
ty1
 * 
dy5
;

1549 
tmp1
 = 1.0 / 
u
[
i
-1][
j
][
k
][0];

1550 
tmp2
 = 
tmp1
 *mp1;

1551 
tmp3
 = 
tmp1
 * 
tmp2
;

1553 
c
[
i
][
j
][0][0] = - 
dt
 * 
tx1
 * 
dx1
;

1554 
c
[
i
][
j
][0][1] = - 
dt
 * 
tx2
;

1555 
c
[
i
][
j
][0][2] = 0.0;

1556 
c
[
i
][
j
][0][3] = 0.0;

1557 
c
[
i
][
j
][0][4] = 0.0;

1559 
c
[
i
][
j
][1][0] = - 
dt
 * 
tx2


1560 * ( - ( 
u
[
i
-1][
j
][
k
][1] * 
tmp1
 ) *( u[i-1][j][k][1] *mp1 )

1561 + 
C2
 * 0.50 * ( 
u
[
i
-1][
j
][
k
][1] * u[i-1][j][k][1]

1562 + 
u
[
i
-1][
j
][
k
][2] * u[i-1][j][k][2]

1563 + 
u
[
i
-1][
j
][
k
][3] * u[i-1][j][k][3] ) * 
tmp2
 )

1564 - 
dt
 * 
tx1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
-1][
j
][
k
][1] );

1565 
c
[
i
][
j
][1][1] = - 
dt
 * 
tx2


1566 * ( ( 2.0 - 
C2
 ) * ( 
u
[
i
-1][
j
][
k
][1] * 
tmp1
 ) )

1567 - 
dt
 * 
tx1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1568 - 
dt
 * 
tx1
 * 
dx2
;

1569 
c
[
i
][
j
][1][2] = - 
dt
 * 
tx2


1570 * ( - 
C2
 * ( 
u
[
i
-1][
j
][
k
][2] * 
tmp1
 ) );

1571 
c
[
i
][
j
][1][3] = - 
dt
 * 
tx2


1572 * ( - 
C2
 * ( 
u
[
i
-1][
j
][
k
][3] * 
tmp1
 ) );

1573 
c
[
i
][
j
][1][4] = - 
dt
 * 
tx2
 * 
C2
;

1575 
c
[
i
][
j
][2][0] = - 
dt
 * 
tx2


1576 * ( - ( 
u
[
i
-1][
j
][
k
][1] * u[i-1][j][k][2] ) * 
tmp2
 )

1577 - 
dt
 * 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
-1][
j
][
k
][2] );

1578 
c
[
i
][
j
][2][1] = - 
dt
 * 
tx2
 * ( 
u
[i-1][j][
k
][2] * 
tmp1
 );

1579 
c
[
i
][
j
][2][2] = - 
dt
 * 
tx2
 * ( 
u
[i-1][j][
k
][1] * 
tmp1
 )

1580 - 
dt
 * 
tx1
 * ( 
c34
 * 
tmp1
 )

1581 - 
dt
 * 
tx1
 * 
dx3
;

1582 
c
[
i
][
j
][2][3] = 0.0;

1583 
c
[
i
][
j
][2][4] = 0.0;

1585 
c
[
i
][
j
][3][0] = - 
dt
 * 
tx2


1586 * ( - ( 
u
[
i
-1][
j
][
k
][1]*u[i-1][j][k][3] ) * 
tmp2
 )

1587 - 
dt
 * 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
-1][
j
][
k
][3] );

1588 
c
[
i
][
j
][3][1] = - 
dt
 * 
tx2
 * ( 
u
[i-1][j][
k
][3] * 
tmp1
 );

1589 
c
[
i
][
j
][3][2] = 0.0;

1590 
c
[
i
][
j
][3][3] = - 
dt
 * 
tx2
 * ( 
u
[i-1][j][
k
][1] * 
tmp1
 )

1591 - 
dt
 * 
tx1
 * ( 
c34
 * 
tmp1
 )

1592 - 
dt
 * 
tx1
 * 
dx4
;

1593 
c
[
i
][
j
][3][4] = 0.0;

1595 
c
[
i
][
j
][4][0] = - 
dt
 * 
tx2


1596 * ( ( 
C2
 * ( 
u
[
i
-1][
j
][
k
][1] * u[i-1][j][k][1]

1597 + 
u
[
i
-1][
j
][
k
][2] * u[i-1][j][k][2]

1598 + 
u
[
i
-1][
j
][
k
][3] * u[i-1][j][k][3] ) * 
tmp2


1599 - 
C1
 * ( 
u
[
i
-1][
j
][
k
][4] * 
tmp1
 ) )

1600 * ( 
u
[
i
-1][
j
][
k
][1] * 
tmp1
 ) )

1601 - 
dt
 * 
tx1


1602 * ( - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
-1][
j
][
k
][1]) )

1603 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
-1][
j
][
k
][2]) )

1604 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
-1][
j
][
k
][3]) )

1605 - 
c1345
 * 
tmp2
 * 
u
[
i
-1][
j
][
k
][4] );

1606 
c
[
i
][
j
][4][1] = - 
dt
 * 
tx2


1607 * ( 
C1
 * ( 
u
[
i
-1][
j
][
k
][4] * 
tmp1
 )

1608 - 0.50 * 
C2


1609 * ( ( 3.0*
u
[
i
-1][
j
][
k
][1]*u[i-1][j][k][1]

1610 + 
u
[
i
-1][
j
][
k
][2]*u[i-1][j][k][2]

1611 + 
u
[
i
-1][
j
][
k
][3]*u[i-1][j][k][3] ) * 
tmp2
 ) )

1612 - 
dt
 * 
tx1


1613 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
-1][
j
][
k
][1];

1614 
c
[
i
][
j
][4][2] = - 
dt
 * 
tx2


1615 * ( - 
C2
 * ( 
u
[
i
-1][
j
][
k
][2]*u[i-1][j][k][1] ) * 
tmp2
 )

1616 - 
dt
 * 
tx1


1617 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
-1][
j
][
k
][2];

1618 
c
[
i
][
j
][4][3] = - 
dt
 * 
tx2


1619 * ( - 
C2
 * ( 
u
[
i
-1][
j
][
k
][3]*u[i-1][j][k][1] ) * 
tmp2
 )

1620 - 
dt
 * 
tx1


1621 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
-1][
j
][
k
][3];

1622 
c
[
i
][
j
][4][4] = - 
dt
 * 
tx2


1623 * ( 
C1
 * ( 
u
[
i
-1][
j
][
k
][1] * 
tmp1
 ) )

1624 - 
dt
 * 
tx1
 * 
c1345
 * 
tmp1


1625 - 
dt
 * 
tx1
 * 
dx5
;

1628 
	}
}

1634 
	$jacu
(
k
) {

1643 
i
, 
j
;

1644 
r43
;

1645 
c1345
;

1646 
c34
;

1647 
tmp1
, 
tmp2
, 
tmp3
;

1649 
r43
 = ( 4.0 / 3.0 );

1650 
c1345
 = 
C1
 * 
C3
 * 
C4
 * 
C5
;

1651 
c34
 = 
C3
 * 
C4
;

1653 #´agm¨
omp
 
nowa™
 
	`scheduË
()

1654 #ià
	`defšed
(
_OPENMP
)

1655 
i
 = 
›nd
; i >ğ
i¡
; i--) {

1656 
j
 = 
j’d
; j >ğ
j¡
; j--) {

1658 
i
 = 
i¡
; i <ğ
›nd
; i++) {

1659 
j
 = 
j¡
; j <ğ
j’d
; j++) {

1665 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1666 
tmp2
 = 
tmp1
 *mp1;

1667 
tmp3
 = 
tmp1
 * 
tmp2
;

1669 
d
[
i
][
j
][0][0] = 1.0

1670 + 
dt
 * 2.0 * ( 
tx1
 * 
dx1


1671 + 
ty1
 * 
dy1


1672 + 
tz1
 * 
dz1
 );

1673 
d
[
i
][
j
][0][1] = 0.0;

1674 
d
[
i
][
j
][0][2] = 0.0;

1675 
d
[
i
][
j
][0][3] = 0.0;

1676 
d
[
i
][
j
][0][4] = 0.0;

1678 
d
[
i
][
j
][1][0] = 
dt
 * 2.0

1679 * ( 
tx1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] )

1680 + 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] )

1681 + 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] ) );

1682 
d
[
i
][
j
][1][1] = 1.0

1683 + 
dt
 * 2.0

1684 * ( 
tx1
 * 
r43
 * 
c34
 * 
tmp1


1685 + 
ty1
 * 
c34
 * 
tmp1


1686 + 
tz1
 * 
c34
 * 
tmp1
 )

1687 + 
dt
 * 2.0 * ( 
tx1
 * 
dx2


1688 + 
ty1
 * 
dy2


1689 + 
tz1
 * 
dz2
 );

1690 
d
[
i
][
j
][1][2] = 0.0;

1691 
d
[
i
][
j
][1][3] = 0.0;

1692 
d
[
i
][
j
][1][4] = 0.0;

1694 
d
[
i
][
j
][2][0] = 
dt
 * 2.0

1695 * ( 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] )

1696 + 
ty1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] )

1697 + 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] ) );

1698 
d
[
i
][
j
][2][1] = 0.0;

1699 
d
[
i
][
j
][2][2] = 1.0

1700 + 
dt
 * 2.0

1701 * ( 
tx1
 * 
c34
 * 
tmp1


1702 + 
ty1
 * 
r43
 * 
c34
 * 
tmp1


1703 + 
tz1
 * 
c34
 * 
tmp1
 )

1704 + 
dt
 * 2.0 * ( 
tx1
 * 
dx3


1705 + 
ty1
 * 
dy3


1706 + 
tz1
 * 
dz3
 );

1707 
d
[
i
][
j
][2][3] = 0.0;

1708 
d
[
i
][
j
][2][4] = 0.0;

1710 
d
[
i
][
j
][3][0] = 
dt
 * 2.0

1711 * ( 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] )

1712 + 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] )

1713 + 
tz1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] ) );

1714 
d
[
i
][
j
][3][1] = 0.0;

1715 
d
[
i
][
j
][3][2] = 0.0;

1716 
d
[
i
][
j
][3][3] = 1.0

1717 + 
dt
 * 2.0

1718 * ( 
tx1
 * 
c34
 * 
tmp1


1719 + 
ty1
 * 
c34
 * 
tmp1


1720 + 
tz1
 * 
r43
 * 
c34
 * 
tmp1
 )

1721 + 
dt
 * 2.0 * ( 
tx1
 * 
dx4


1722 + 
ty1
 * 
dy4


1723 + 
tz1
 * 
dz4
 );

1724 
d
[
i
][
j
][3][4] = 0.0;

1726 
d
[
i
][
j
][4][0] = 
dt
 * 2.0

1727 * ( 
tx1
 * ( - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1728 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1729 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1730 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] )

1731 + 
ty1
 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1732 - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1733 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1734 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] )

1735 + 
tz1
 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1736 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1737 - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1738 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] ) );

1739 
d
[
i
][
j
][4][1] = 
dt
 * 2.0

1740 * ( 
tx1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1]

1741 + 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1]

1742 + 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1] );

1743 
d
[
i
][
j
][4][2] = 
dt
 * 2.0

1744 * ( 
tx1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2]

1745 + 
ty1
 * ( 
r43
*
c34
 -
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2]

1746 + 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2] );

1747 
d
[
i
][
j
][4][3] = 
dt
 * 2.0

1748 * ( 
tx1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3]

1749 + 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3]

1750 + 
tz1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3] );

1751 
d
[
i
][
j
][4][4] = 1.0

1752 + 
dt
 * 2.0 * ( 
tx1
 * 
c1345
 * 
tmp1


1753 + 
ty1
 * 
c1345
 * 
tmp1


1754 + 
tz1
 * 
c1345
 * 
tmp1
 )

1755 + 
dt
 * 2.0 * ( 
tx1
 * 
dx5


1756 + 
ty1
 * 
dy5


1757 + 
tz1
 * 
dz5
 );

1762 
tmp1
 = 1.0 / 
u
[
i
+1][
j
][
k
][0];

1763 
tmp2
 = 
tmp1
 *mp1;

1764 
tmp3
 = 
tmp1
 * 
tmp2
;

1766 
a
[
i
][
j
][0][0] = - 
dt
 * 
tx1
 * 
dx1
;

1767 
a
[
i
][
j
][0][1] = 
dt
 * 
tx2
;

1768 
a
[
i
][
j
][0][2] = 0.0;

1769 
a
[
i
][
j
][0][3] = 0.0;

1770 
a
[
i
][
j
][0][4] = 0.0;

1772 
a
[
i
][
j
][1][0] = 
dt
 * 
tx2


1773 * ( - ( 
u
[
i
+1][
j
][
k
][1] * 
tmp1
 ) *( u[i+1][j][k][1] *mp1 )

1774 + 
C2
 * 0.50 * ( 
u
[
i
+1][
j
][
k
][1] * u[i+1][j][k][1]

1775 + 
u
[
i
+1][
j
][
k
][2] * u[i+1][j][k][2]

1776 + 
u
[
i
+1][
j
][
k
][3] * u[i+1][j][k][3] ) * 
tmp2
 )

1777 - 
dt
 * 
tx1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
+1][
j
][
k
][1] );

1778 
a
[
i
][
j
][1][1] = 
dt
 * 
tx2


1779 * ( ( 2.0 - 
C2
 ) * ( 
u
[
i
+1][
j
][
k
][1] * 
tmp1
 ) )

1780 - 
dt
 * 
tx1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1781 - 
dt
 * 
tx1
 * 
dx2
;

1782 
a
[
i
][
j
][1][2] = 
dt
 * 
tx2


1783 * ( - 
C2
 * ( 
u
[
i
+1][
j
][
k
][2] * 
tmp1
 ) );

1784 
a
[
i
][
j
][1][3] = 
dt
 * 
tx2


1785 * ( - 
C2
 * ( 
u
[
i
+1][
j
][
k
][3] * 
tmp1
 ) );

1786 
a
[
i
][
j
][1][4] = 
dt
 * 
tx2
 * 
C2
 ;

1788 
a
[
i
][
j
][2][0] = 
dt
 * 
tx2


1789 * ( - ( 
u
[
i
+1][
j
][
k
][1] * u[i+1][j][k][2] ) * 
tmp2
 )

1790 - 
dt
 * 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
+1][
j
][
k
][2] );

1791 
a
[
i
][
j
][2][1] = 
dt
 * 
tx2
 * ( 
u
[i+1][j][
k
][2] * 
tmp1
 );

1792 
a
[
i
][
j
][2][2] = 
dt
 * 
tx2
 * ( 
u
[i+1][j][
k
][1] * 
tmp1
 )

1793 - 
dt
 * 
tx1
 * ( 
c34
 * 
tmp1
 )

1794 - 
dt
 * 
tx1
 * 
dx3
;

1795 
a
[
i
][
j
][2][3] = 0.0;

1796 
a
[
i
][
j
][2][4] = 0.0;

1798 
a
[
i
][
j
][3][0] = 
dt
 * 
tx2


1799 * ( - ( 
u
[
i
+1][
j
][
k
][1]*u[i+1][j][k][3] ) * 
tmp2
 )

1800 - 
dt
 * 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
+1][
j
][
k
][3] );

1801 
a
[
i
][
j
][3][1] = 
dt
 * 
tx2
 * ( 
u
[i+1][j][
k
][3] * 
tmp1
 );

1802 
a
[
i
][
j
][3][2] = 0.0;

1803 
a
[
i
][
j
][3][3] = 
dt
 * 
tx2
 * ( 
u
[i+1][j][
k
][1] * 
tmp1
 )

1804 - 
dt
 * 
tx1
 * ( 
c34
 * 
tmp1
 )

1805 - 
dt
 * 
tx1
 * 
dx4
;

1806 
a
[
i
][
j
][3][4] = 0.0;

1808 
a
[
i
][
j
][4][0] = 
dt
 * 
tx2


1809 * ( ( 
C2
 * ( 
u
[
i
+1][
j
][
k
][1] * u[i+1][j][k][1]

1810 + 
u
[
i
+1][
j
][
k
][2] * u[i+1][j][k][2]

1811 + 
u
[
i
+1][
j
][
k
][3] * u[i+1][j][k][3] ) * 
tmp2


1812 - 
C1
 * ( 
u
[
i
+1][
j
][
k
][4] * 
tmp1
 ) )

1813 * ( 
u
[
i
+1][
j
][
k
][1] * 
tmp1
 ) )

1814 - 
dt
 * 
tx1


1815 * ( - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
+1][
j
][
k
][1]) )

1816 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
+1][
j
][
k
][2]) )

1817 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
+1][
j
][
k
][3]) )

1818 - 
c1345
 * 
tmp2
 * 
u
[
i
+1][
j
][
k
][4] );

1819 
a
[
i
][
j
][4][1] = 
dt
 * 
tx2


1820 * ( 
C1
 * ( 
u
[
i
+1][
j
][
k
][4] * 
tmp1
 )

1821 - 0.50 * 
C2


1822 * ( ( 3.0*
u
[
i
+1][
j
][
k
][1]*u[i+1][j][k][1]

1823 + 
u
[
i
+1][
j
][
k
][2]*u[i+1][j][k][2]

1824 + 
u
[
i
+1][
j
][
k
][3]*u[i+1][j][k][3] ) * 
tmp2
 ) )

1825 - 
dt
 * 
tx1


1826 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
+1][
j
][
k
][1];

1827 
a
[
i
][
j
][4][2] = 
dt
 * 
tx2


1828 * ( - 
C2
 * ( 
u
[
i
+1][
j
][
k
][2]*u[i+1][j][k][1] ) * 
tmp2
 )

1829 - 
dt
 * 
tx1


1830 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
+1][
j
][
k
][2];

1831 
a
[
i
][
j
][4][3] = 
dt
 * 
tx2


1832 * ( - 
C2
 * ( 
u
[
i
+1][
j
][
k
][3]*u[i+1][j][k][1] ) * 
tmp2
 )

1833 - 
dt
 * 
tx1


1834 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
+1][
j
][
k
][3];

1835 
a
[
i
][
j
][4][4] = 
dt
 * 
tx2


1836 * ( 
C1
 * ( 
u
[
i
+1][
j
][
k
][1] * 
tmp1
 ) )

1837 - 
dt
 * 
tx1
 * 
c1345
 * 
tmp1


1838 - 
dt
 * 
tx1
 * 
dx5
;

1843 
tmp1
 = 1.0 / 
u
[
i
][
j
+1][
k
][0];

1844 
tmp2
 = 
tmp1
 *mp1;

1845 
tmp3
 = 
tmp1
 * 
tmp2
;

1847 
b
[
i
][
j
][0][0] = - 
dt
 * 
ty1
 * 
dy1
;

1848 
b
[
i
][
j
][0][1] = 0.0;

1849 
b
[
i
][
j
][0][2] = 
dt
 * 
ty2
;

1850 
b
[
i
][
j
][0][3] = 0.0;

1851 
b
[
i
][
j
][0][4] = 0.0;

1853 
b
[
i
][
j
][1][0] = 
dt
 * 
ty2


1854 * ( - ( 
u
[
i
][
j
+1][
k
][1]*u[i][j+1][k][2] ) * 
tmp2
 )

1855 - 
dt
 * 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
+1][
k
][1] );

1856 
b
[
i
][
j
][1][1] = 
dt
 * 
ty2
 * ( 
u
[i][j+1][
k
][2] * 
tmp1
 )

1857 - 
dt
 * 
ty1
 * ( 
c34
 * 
tmp1
 )

1858 - 
dt
 * 
ty1
 * 
dy2
;

1859 
b
[
i
][
j
][1][2] = 
dt
 * 
ty2
 * ( 
u
[i][j+1][
k
][1] * 
tmp1
 );

1860 
b
[
i
][
j
][1][3] = 0.0;

1861 
b
[
i
][
j
][1][4] = 0.0;

1863 
b
[
i
][
j
][2][0] = 
dt
 * 
ty2


1864 * ( - ( 
u
[
i
][
j
+1][
k
][2] * 
tmp1
 ) *( u[i][j+1][k][2] *mp1 )

1865 + 0.50 * 
C2
 * ( ( 
u
[
i
][
j
+1][
k
][1] * u[i][j+1][k][1]

1866 + 
u
[
i
][
j
+1][
k
][2] * u[i][j+1][k][2]

1867 + 
u
[
i
][
j
+1][
k
][3] * u[i][j+1][k][3] )

1868 * 
tmp2
 ) )

1869 - 
dt
 * 
ty1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
+1][
k
][2] );

1870 
b
[
i
][
j
][2][1] = 
dt
 * 
ty2


1871 * ( - 
C2
 * ( 
u
[
i
][
j
+1][
k
][1] * 
tmp1
 ) );

1872 
b
[
i
][
j
][2][2] = 
dt
 * 
ty2
 * ( ( 2.0 - 
C2
 )

1873 * ( 
u
[
i
][
j
+1][
k
][2] * 
tmp1
 ) )

1874 - 
dt
 * 
ty1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1875 - 
dt
 * 
ty1
 * 
dy3
;

1876 
b
[
i
][
j
][2][3] = 
dt
 * 
ty2


1877 * ( - 
C2
 * ( 
u
[
i
][
j
+1][
k
][3] * 
tmp1
 ) );

1878 
b
[
i
][
j
][2][4] = 
dt
 * 
ty2
 * 
C2
;

1880 
b
[
i
][
j
][3][0] = 
dt
 * 
ty2


1881 * ( - ( 
u
[
i
][
j
+1][
k
][2]*u[i][j+1][k][3] ) * 
tmp2
 )

1882 - 
dt
 * 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
+1][
k
][3] );

1883 
b
[
i
][
j
][3][1] = 0.0;

1884 
b
[
i
][
j
][3][2] = 
dt
 * 
ty2
 * ( 
u
[i][j+1][
k
][3] * 
tmp1
 );

1885 
b
[
i
][
j
][3][3] = 
dt
 * 
ty2
 * ( 
u
[i][j+1][
k
][2] * 
tmp1
 )

1886 - 
dt
 * 
ty1
 * ( 
c34
 * 
tmp1
 )

1887 - 
dt
 * 
ty1
 * 
dy4
;

1888 
b
[
i
][
j
][3][4] = 0.0;

1890 
b
[
i
][
j
][4][0] = 
dt
 * 
ty2


1891 * ( ( 
C2
 * ( 
u
[
i
][
j
+1][
k
][1] * u[i][j+1][k][1]

1892 + 
u
[
i
][
j
+1][
k
][2] * u[i][j+1][k][2]

1893 + 
u
[
i
][
j
+1][
k
][3] * u[i][j+1][k][3] ) * 
tmp2


1894 - 
C1
 * ( 
u
[
i
][
j
+1][
k
][4] * 
tmp1
 ) )

1895 * ( 
u
[
i
][
j
+1][
k
][2] * 
tmp1
 ) )

1896 - 
dt
 * 
ty1


1897 * ( - ( 
c34
 - 
c1345
 )*
tmp3
*Ğ
	`pow2
(
u
[
i
][
j
+1][
k
][1]) )

1898 - ( 
r43
*
c34
 - 
c1345
 )*
tmp3
*Ğ
	`pow2
(
u
[
i
][
j
+1][
k
][2]) )

1899 - ( 
c34
 - 
c1345
 )*
tmp3
*Ğ
	`pow2
(
u
[
i
][
j
+1][
k
][3]) )

1900 - 
c1345
*
tmp2
*
u
[
i
][
j
+1][
k
][4] );

1901 
b
[
i
][
j
][4][1] = 
dt
 * 
ty2


1902 * ( - 
C2
 * ( 
u
[
i
][
j
+1][
k
][1]*u[i][j+1][k][2] ) * 
tmp2
 )

1903 - 
dt
 * 
ty1


1904 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
+1][
k
][1];

1905 
b
[
i
][
j
][4][2] = 
dt
 * 
ty2


1906 * ( 
C1
 * ( 
u
[
i
][
j
+1][
k
][4] * 
tmp1
 )

1907 - 0.50 * 
C2


1908 * ( ( 
u
[
i
][
j
+1][
k
][1]*u[i][j+1][k][1]

1909 + 3.0 * 
u
[
i
][
j
+1][
k
][2]*u[i][j+1][k][2]

1910 + 
u
[
i
][
j
+1][
k
][3]*u[i][j+1][k][3] ) * 
tmp2
 ) )

1911 - 
dt
 * 
ty1


1912 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
+1][
k
][2];

1913 
b
[
i
][
j
][4][3] = 
dt
 * 
ty2


1914 * ( - 
C2
 * ( 
u
[
i
][
j
+1][
k
][2]*u[i][j+1][k][3] ) * 
tmp2
 )

1915 - 
dt
 * 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
+1][
k
][3];

1916 
b
[
i
][
j
][4][4] = 
dt
 * 
ty2


1917 * ( 
C1
 * ( 
u
[
i
][
j
+1][
k
][2] * 
tmp1
 ) )

1918 - 
dt
 * 
ty1
 * 
c1345
 * 
tmp1


1919 - 
dt
 * 
ty1
 * 
dy5
;

1924 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
+1][0];

1925 
tmp2
 = 
tmp1
 *mp1;

1926 
tmp3
 = 
tmp1
 * 
tmp2
;

1928 
c
[
i
][
j
][0][0] = - 
dt
 * 
tz1
 * 
dz1
;

1929 
c
[
i
][
j
][0][1] = 0.0;

1930 
c
[
i
][
j
][0][2] = 0.0;

1931 
c
[
i
][
j
][0][3] = 
dt
 * 
tz2
;

1932 
c
[
i
][
j
][0][4] = 0.0;

1934 
c
[
i
][
j
][1][0] = 
dt
 * 
tz2


1935 * ( - ( 
u
[
i
][
j
][
k
+1][1]*u[i][j][k+1][3] ) * 
tmp2
 )

1936 - 
dt
 * 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
+1][1] );

1937 
c
[
i
][
j
][1][1] = 
dt
 * 
tz2
 * ( 
u
[i][j][
k
+1][3] * 
tmp1
 )

1938 - 
dt
 * 
tz1
 * 
c34
 * 
tmp1


1939 - 
dt
 * 
tz1
 * 
dz2
 ;

1940 
c
[
i
][
j
][1][2] = 0.0;

1941 
c
[
i
][
j
][1][3] = 
dt
 * 
tz2
 * ( 
u
[i][j][
k
+1][1] * 
tmp1
 );

1942 
c
[
i
][
j
][1][4] = 0.0;

1944 
c
[
i
][
j
][2][0] = 
dt
 * 
tz2


1945 * ( - ( 
u
[
i
][
j
][
k
+1][2]*u[i][j][k+1][3] ) * 
tmp2
 )

1946 - 
dt
 * 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
+1][2] );

1947 
c
[
i
][
j
][2][1] = 0.0;

1948 
c
[
i
][
j
][2][2] = 
dt
 * 
tz2
 * ( 
u
[i][j][
k
+1][3] * 
tmp1
 )

1949 - 
dt
 * 
tz1
 * ( 
c34
 * 
tmp1
 )

1950 - 
dt
 * 
tz1
 * 
dz3
;

1951 
c
[
i
][
j
][2][3] = 
dt
 * 
tz2
 * ( 
u
[i][j][
k
+1][2] * 
tmp1
 );

1952 
c
[
i
][
j
][2][4] = 0.0;

1954 
c
[
i
][
j
][3][0] = 
dt
 * 
tz2


1955 * ( - ( 
u
[
i
][
j
][
k
+1][3] * 
tmp1
 ) *( u[i][j][k+1][3] *mp1 )

1956 + 0.50 * 
C2


1957 * ( ( 
u
[
i
][
j
][
k
+1][1] * u[i][j][k+1][1]

1958 + 
u
[
i
][
j
][
k
+1][2] * u[i][j][k+1][2]

1959 + 
u
[
i
][
j
][
k
+1][3] * u[i][j][k+1][3] ) * 
tmp2
 ) )

1960 - 
dt
 * 
tz1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
+1][3] );

1961 
c
[
i
][
j
][3][1] = 
dt
 * 
tz2


1962 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
+1][1] * 
tmp1
 ) );

1963 
c
[
i
][
j
][3][2] = 
dt
 * 
tz2


1964 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
+1][2] * 
tmp1
 ) );

1965 
c
[
i
][
j
][3][3] = 
dt
 * 
tz2
 * ( 2.0 - 
C2
 )

1966 * ( 
u
[
i
][
j
][
k
+1][3] * 
tmp1
 )

1967 - 
dt
 * 
tz1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1968 - 
dt
 * 
tz1
 * 
dz4
;

1969 
c
[
i
][
j
][3][4] = 
dt
 * 
tz2
 * 
C2
;

1971 
c
[
i
][
j
][4][0] = 
dt
 * 
tz2


1972 * ( ( 
C2
 * ( 
u
[
i
][
j
][
k
+1][1] * u[i][j][k+1][1]

1973 + 
u
[
i
][
j
][
k
+1][2] * u[i][j][k+1][2]

1974 + 
u
[
i
][
j
][
k
+1][3] * u[i][j][k+1][3] ) * 
tmp2


1975 - 
C1
 * ( 
u
[
i
][
j
][
k
+1][4] * 
tmp1
 ) )

1976 * ( 
u
[
i
][
j
][
k
+1][3] * 
tmp1
 ) )

1977 - 
dt
 * 
tz1


1978 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
+1][1]) )

1979 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
+1][2]) )

1980 - ( 
r43
*
c34
 - 
c1345
 )* 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
+1][3]) )

1981 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
+1][4] );

1982 
c
[
i
][
j
][4][1] = 
dt
 * 
tz2


1983 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
+1][1]*u[i][j][k+1][3] ) * 
tmp2
 )

1984 - 
dt
 * 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
+1][1];

1985 
c
[
i
][
j
][4][2] = 
dt
 * 
tz2


1986 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
+1][2]*u[i][j][k+1][3] ) * 
tmp2
 )

1987 - 
dt
 * 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
+1][2];

1988 
c
[
i
][
j
][4][3] = 
dt
 * 
tz2


1989 * ( 
C1
 * ( 
u
[
i
][
j
][
k
+1][4] * 
tmp1
 )

1990 - 0.50 * 
C2


1991 * ( ( 
u
[
i
][
j
][
k
+1][1]*u[i][j][k+1][1]

1992 + 
u
[
i
][
j
][
k
+1][2]*u[i][j][k+1][2]

1993 + 3.0*
u
[
i
][
j
][
k
+1][3]*u[i][j][k+1][3] ) * 
tmp2
 ) )

1994 - 
dt
 * 
tz1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
+1][3];

1995 
c
[
i
][
j
][4][4] = 
dt
 * 
tz2


1996 * ( 
C1
 * ( 
u
[
i
][
j
][
k
+1][3] * 
tmp1
 ) )

1997 - 
dt
 * 
tz1
 * 
c1345
 * 
tmp1


1998 - 
dt
 * 
tz1
 * 
dz5
;

2001 
	}
}

2006 
l2nÜm
 (
nx0
, 
ny0
, 
nz0
,

2007 
i¡
, 
›nd
,

2008 
j¡
, 
j’d
,

2013 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

2014 
sum
[5]) {

2016 #´agm¨
omp
 
·¿Î–


2026 
	gi
, 
	gj
, 
	gk
, 
	gm
;

2027 
	gsum0
=0.0, 
	gsum1
=0.0, 
	gsum2
=0.0, 
	gsum3
=0.0, 
	gsum4
=0.0;

2029 #´agm¨
omp
 
sšgË


2030 
	gm
 = 0; m < 5; m++) {

2031 
	gsum
[
m
] = 0.0;

2034 #´agm¨
omp
 
nowa™


2035 
	gi
 = 
i¡
; i <ğ
›nd
; i++) {

2036 
	gj
 = 
j¡
; j <ğ
j’d
; j++) {

2037 
	gk
 = 1; k <ğ
nz0
-2; k++) {

2038 
	gsum0
 = 
sum0
 + 
v
[
i
][
j
][
k
][0] * v[i][j][k][0];

2039 
	gsum1
 = 
sum1
 + 
v
[
i
][
j
][
k
][1] * v[i][j][k][1];

2040 
	gsum2
 = 
sum2
 + 
v
[
i
][
j
][
k
][2] * v[i][j][k][2];

2041 
	gsum3
 = 
sum3
 + 
v
[
i
][
j
][
k
][3] * v[i][j][k][3];

2042 
	gsum4
 = 
sum4
 + 
v
[
i
][
j
][
k
][4] * v[i][j][k][4];

2047 #´agm¨
omp
 
ü™iÿl
(
lu
)

2049 
	gsum
[0] +ğ
sum0
;

2050 
	gsum
[1] +ğ
sum1
;

2051 
	gsum
[2] +ğ
sum2
;

2052 
	gsum
[3] +ğ
sum3
;

2053 
	gsum
[4] +ğ
sum4
;

2055 #´agm¨
omp
 
b¬r›r


2057 #´agm¨
omp
 
sšgË


2058 
	gm
 = 0; m < 5; m++) {

2059 
	gsum
[
m
] = 
sq¹
 ( 
sum
[m] / ( (
nx0
-2)*(
ny0
-2)*(
nz0
-2) ) );

2066 
	$pštgr
() {

2071 
i
, 
j
, 
k
;

2072 
ibeg
, 
ifš
, 
ifš1
;

2073 
jbeg
, 
jfš
, 
jfš1
;

2074 
iglob
, 
iglob1
, 
iglob2
;

2075 
jglob
, 
jglob1
, 
jglob2
;

2076 
phi1
[
ISIZ2
+2][
ISIZ3
+2];

2077 
phi2
[
ISIZ2
+2][
ISIZ3
+2];

2078 
äc1
, 
äc2
, 
äc3
;

2083 
ibeg
 = 
nx
;

2084 
ifš
 = 0;

2085 
iglob1
 = -1;

2086 
iglob2
 = 
nx
-1;

2087 ià(
iglob1
 >ğ
ii1
 && 
iglob2
 < 
ii2
+
nx
è
ibeg
 = 0;

2088 ià(
iglob1
 >ğ
ii1
-
nx
 && 
iglob2
 <ğ
ii2
è
ifš
 =‚x;

2089 ià(
ii1
 >ğ
iglob1
 && ii1 <ğ
iglob2
è
ibeg
 = ii1;

2090 ià(
ii2
 >ğ
iglob1
 && ii2 <ğ
iglob2
è
ifš
 = ii2;

2091 
jbeg
 = 
ny
;

2092 
jfš
 = -1;

2093 
jglob1
 = 0;

2094 
jglob2
 = 
ny
-1;

2095 ià(
jglob1
 >ğ
ji1
 && 
jglob2
 < 
ji2
+
ny
è
jbeg
 = 0;

2096 ià(
jglob1
 > 
ji1
-
ny
 && 
jglob2
 <ğ
ji2
è
jfš
 =‚y;

2097 ià(
ji1
 >ğ
jglob1
 && ji1 <ğ
jglob2
è
jbeg
 = ji1;

2098 ià(
ji2
 >ğ
jglob1
 && ji2 <ğ
jglob2
è
jfš
 = ji2;

2099 
ifš1
 = 
ifš
;

2100 
jfš1
 = 
jfš
;

2101 ià(
ifš1
 =ğ
ii2
èifš1 = 
ifš
 -1;

2102 ià(
jfš1
 =ğ
ji2
èjfš1 = 
jfš
 -1;

2107 
i
 = 0; i <ğ
ISIZ2
+1; i++) {

2108 
k
 = 0; k <ğ
ISIZ3
+1; k++) {

2109 
phi1
[
i
][
k
] = 0.0;

2110 
phi2
[
i
][
k
] = 0.0;

2113 
i
 = 
ibeg
; i <ğ
ifš
; i++) {

2114 
iglob
 = 
i
;

2115 
j
 = 
jbeg
; j <ğ
jfš
; j++) {

2116 
jglob
 = 
j
;

2118 
k
 = 
ki1
;

2120 
phi1
[
i
][
j
] = 
C2
*Ğ
u
[i][j][
k
][4]

2121 - 0.50 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1])

2122 + 
	`pow2
(
u
[
i
][
j
][
k
][2])

2123 + 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

2124 / 
u
[
i
][
j
][
k
][0] );

2126 
k
 = 
ki2
;

2128 
phi2
[
i
][
j
] = 
C2
*Ğ
u
[i][j][
k
][4]

2129 - 0.50 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1])

2130 + 
	`pow2
(
u
[
i
][
j
][
k
][2])

2131 + 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

2132 / 
u
[
i
][
j
][
k
][0] );

2136 
äc1
 = 0.0;

2138 
i
 = 
ibeg
; i <ğ
ifš1
; i++) {

2139 
j
 = 
jbeg
; j <ğ
jfš1
; j++) {

2140 
äc1
 = frc1 + ( 
phi1
[
i
][
j
]

2141 + 
phi1
[
i
+1][
j
]

2142 + 
phi1
[
i
][
j
+1]

2143 + 
phi1
[
i
+1][
j
+1]

2144 + 
phi2
[
i
][
j
]

2145 + 
phi2
[
i
+1][
j
]

2146 + 
phi2
[
i
][
j
+1]

2147 + 
phi2
[
i
+1][
j
+1] );

2151 
äc1
 = 
dxi
 * 
d‘a
 * frc1;

2156 
i
 = 0; i <ğ
ISIZ2
+1; i++) {

2157 
k
 = 0; k <ğ
ISIZ3
+1; k++) {

2158 
phi1
[
i
][
k
] = 0.0;

2159 
phi2
[
i
][
k
] = 0.0;

2162 
jglob
 = 
jbeg
;

2163 ià(
jglob
 =ğ
ji1
) {

2164 
i
 = 
ibeg
; i <ğ
ifš
; i++) {

2165 
iglob
 = 
i
;

2166 
k
 = 
ki1
; k <ğ
ki2
; k++) {

2167 
phi1
[
i
][
k
] = 
C2
*Ğ
u
[i][
jbeg
][k][4]

2168 - 0.50 * ( 
	`pow2
(
u
[
i
][
jbeg
][
k
][1])

2169 + 
	`pow2
(
u
[
i
][
jbeg
][
k
][2])

2170 + 
	`pow2
(
u
[
i
][
jbeg
][
k
][3]) )

2171 / 
u
[
i
][
jbeg
][
k
][0] );

2176 
jglob
 = 
jfš
;

2177 ià(
jglob
 =ğ
ji2
) {

2178 
i
 = 
ibeg
; i <ğ
ifš
; i++) {

2179 
iglob
 = 
i
;

2180 
k
 = 
ki1
; k <ğ
ki2
; k++) {

2181 
phi2
[
i
][
k
] = 
C2
*Ğ
u
[i][
jfš
][k][4]

2182 - 0.50 * ( 
	`pow2
(
u
[
i
][
jfš
][
k
][1])

2183 + 
	`pow2
(
u
[
i
][
jfš
][
k
][2])

2184 + 
	`pow2
(
u
[
i
][
jfš
][
k
][3]) )

2185 / 
u
[
i
][
jfš
][
k
][0] );

2191 
äc2
 = 0.0;

2192 
i
 = 
ibeg
; i <ğ
ifš1
; i++) {

2193 
k
 = 
ki1
; k <ğ
ki2
-1; k++) {

2194 
äc2
 = frc2 + ( 
phi1
[
i
][
k
]

2195 + 
phi1
[
i
+1][
k
]

2196 + 
phi1
[
i
][
k
+1]

2197 + 
phi1
[
i
+1][
k
+1]

2198 + 
phi2
[
i
][
k
]

2199 + 
phi2
[
i
+1][
k
]

2200 + 
phi2
[
i
][
k
+1]

2201 + 
phi2
[
i
+1][
k
+1] );

2206 
äc2
 = 
dxi
 * 
dz‘a
 * frc2;

2211 
i
 = 0; i <ğ
ISIZ2
+1; i++) {

2212 
k
 = 0; k <ğ
ISIZ3
+1; k++) {

2213 
phi1
[
i
][
k
] = 0.0;

2214 
phi2
[
i
][
k
] = 0.0;

2217 
iglob
 = 
ibeg
;

2218 ià(
iglob
 =ğ
ii1
) {

2219 
j
 = 
jbeg
; j <ğ
jfš
; j++) {

2220 
jglob
 = 
j
;

2221 
k
 = 
ki1
; k <ğ
ki2
; k++) {

2222 
phi1
[
j
][
k
] = 
C2
*Ğ
u
[
ibeg
][j][k][4]

2223 - 0.50 * ( 
	`pow2
(
u
[
ibeg
][
j
][
k
][1])

2224 + 
	`pow2
(
u
[
ibeg
][
j
][
k
][2])

2225 + 
	`pow2
(
u
[
ibeg
][
j
][
k
][3]) )

2226 / 
u
[
ibeg
][
j
][
k
][0] );

2231 
iglob
 = 
ifš
;

2232 ià(
iglob
 =ğ
ii2
) {

2233 
j
 = 
jbeg
; j <ğ
jfš
; j++) {

2234 
jglob
 = 
j
;

2235 
k
 = 
ki1
; k <ğ
ki2
; k++) {

2236 
phi2
[
j
][
k
] = 
C2
*Ğ
u
[
ifš
][j][k][4]

2237 - 0.50 * ( 
	`pow2
(
u
[
ifš
][
j
][
k
][1])

2238 + 
	`pow2
(
u
[
ifš
][
j
][
k
][2])

2239 + 
	`pow2
(
u
[
ifš
][
j
][
k
][3]) )

2240 / 
u
[
ifš
][
j
][
k
][0] );

2245 
äc3
 = 0.0;

2247 
j
 = 
jbeg
; j <ğ
jfš1
; j++) {

2248 
k
 = 
ki1
; k <ğ
ki2
-1; k++) {

2249 
äc3
 = frc3 + ( 
phi1
[
j
][
k
]

2250 + 
phi1
[
j
+1][
k
]

2251 + 
phi1
[
j
][
k
+1]

2252 + 
phi1
[
j
+1][
k
+1]

2253 + 
phi2
[
j
][
k
]

2254 + 
phi2
[
j
+1][
k
]

2255 + 
phi2
[
j
][
k
+1]

2256 + 
phi2
[
j
+1][
k
+1] );

2260 
äc3
 = 
d‘a
 * 
dz‘a
 * frc3;

2261 
äc
 = 0.25 * ( 
äc1
 + 
äc2
 + 
äc3
 );

2262 
	}
}

2267 
	$»ad_šput
() {

2282 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

2315 
r
 = 
IPR_DEFAULT
;

2316 
šÜm
 = 
INORM_DEFAULT
;

2317 
™max
 = 
ITMAX_DEFAULT
;

2318 
dt
 = 
DT_DEFAULT
;

2319 
omega
 = 
OMEGA_DEFAULT
;

2320 
tŞrsd
[0] = 
TOLRSD1_DEF
;

2321 
tŞrsd
[1] = 
TOLRSD2_DEF
;

2322 
tŞrsd
[2] = 
TOLRSD3_DEF
;

2323 
tŞrsd
[3] = 
TOLRSD4_DEF
;

2324 
tŞrsd
[4] = 
TOLRSD5_DEF
;

2325 
nx0
 = 
ISIZ1
;

2326 
ny0
 = 
ISIZ2
;

2327 
nz0
 = 
ISIZ3
;

2334 iàĞ
nx0
 < 4 || 
ny0
 < 4 || 
nz0
 < 4 ) {

2335 
	`´štf
(" PROBLEM SIZE IS TOO SMALL - \n"

2337 
	`ex™
(1);

2340 iàĞ
nx0
 > 
ISIZ1
 || 
ny0
 > 
ISIZ2
 || 
nz0
 > 
ISIZ3
 ) {

2341 
	`´štf
(" PROBLEM SIZE IS TOO LARGE - \n"

2344 
	`ex™
(1);

2347 
	`´štf
(" Size: %3dx%3dx%3d\n", 
nx0
, 
ny0
, 
nz0
);

2348 
	`´štf
(" I‹¿tiÚs: %3d\n", 
™max
);

2349 
	}
}

2354 
	$rhs
() {

2356 #´agm¨
omp
 
·¿Î–


2366 
i
, 
j
, 
k
, 
m
;

2367 
L1
, 
L2
;

2368 
i¡1
, 
›nd1
;

2369 
j¡1
, 
j’d1
;

2370 
q
;

2371 
u21
, 
u31
, 
u41
;

2372 
tmp
;

2373 
u21i
, 
u31i
, 
u41i
, 
u51i
;

2374 
u21j
, 
u31j
, 
u41j
, 
u51j
;

2375 
u21k
, 
u31k
, 
u41k
, 
u51k
;

2376 
u21im1
, 
u31im1
, 
u41im1
, 
u51im1
;

2377 
u21jm1
, 
u31jm1
, 
u41jm1
, 
u51jm1
;

2378 
u21km1
, 
u31km1
, 
u41km1
, 
u51km1
;

2380 #´agm¨
omp
 

2381 
i
 = 0; i <ğ
nx
-1; i++) {

2382 
j
 = 0; j <ğ
ny
-1; j++) {

2383 
k
 = 0; k <ğ
nz
-1; k++) {

2384 
m
 = 0; m < 5; m++) {

2385 
rsd
[
i
][
j
][
k
][
m
] = - 
äù
[i][j][k][m];

2395 
L1
 = 0;

2396 
L2
 = 
nx
-1;

2398 #´agm¨
omp
 

2399 
i
 = 
L1
; i <ğ
L2
; i++) {

2400 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2401 
k
 = 1; k <ğ
nz
 - 2; k++) {

2402 
æux
[
i
][
j
][
k
][0] = 
u
[i][j][k][1];

2403 
u21
 = 
u
[
i
][
j
][
k
][1] / u[i][j][k][0];

2405 
q
 = 0.50 * ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

2406 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

2407 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

2408 / 
u
[
i
][
j
][
k
][0];

2410 
æux
[
i
][
j
][
k
][1] = 
u
[i][j][k][1] * 
u21
 + 
C2
 *

2411 Ğ
u
[
i
][
j
][
k
][4] - 
q
 );

2412 
æux
[
i
][
j
][
k
][2] = 
u
[i][j][k][2] * 
u21
;

2413 
æux
[
i
][
j
][
k
][3] = 
u
[i][j][k][3] * 
u21
;

2414 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
u
[i][j][k][4] - 
C2
 * 
q
 ) * 
u21
;

2419 #´agm¨
omp
 

2420 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2421 
k
 = 1; k <ğ
nz
 - 2; k++) {

2422 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2423 
m
 = 0; m < 5; m++) {

2424 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2425 - 
tx2
 * ( 
æux
[
i
+1][
j
][
k
][
m
] - flux[i-1][j][k][m] );

2429 
L2
 = 
nx
-1;

2431 
i
 = 
i¡
; i <ğ
L2
; i++) {

2432 
tmp
 = 1.0 / 
u
[
i
][
j
][
k
][0];

2434 
u21i
 = 
tmp
 * 
u
[
i
][
j
][
k
][1];

2435 
u31i
 = 
tmp
 * 
u
[
i
][
j
][
k
][2];

2436 
u41i
 = 
tmp
 * 
u
[
i
][
j
][
k
][3];

2437 
u51i
 = 
tmp
 * 
u
[
i
][
j
][
k
][4];

2439 
tmp
 = 1.0 / 
u
[
i
-1][
j
][
k
][0];

2441 
u21im1
 = 
tmp
 * 
u
[
i
-1][
j
][
k
][1];

2442 
u31im1
 = 
tmp
 * 
u
[
i
-1][
j
][
k
][2];

2443 
u41im1
 = 
tmp
 * 
u
[
i
-1][
j
][
k
][3];

2444 
u51im1
 = 
tmp
 * 
u
[
i
-1][
j
][
k
][4];

2446 
æux
[
i
][
j
][
k
][1] = (4.0/3.0è* 
tx3
 * (
u21i
-
u21im1
);

2447 
æux
[
i
][
j
][
k
][2] = 
tx3
 * ( 
u31i
 - 
u31im1
 );

2448 
æux
[
i
][
j
][
k
][3] = 
tx3
 * ( 
u41i
 - 
u41im1
 );

2449 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

2450 * 
tx3
 * ( ( 
	`pow2
(
u21i
è+…ow2(
u31i
è+…ow2(
u41i
) )

2451 - ( 
	`pow2
(
u21im1
è+…ow2(
u31im1
è+…ow2(
u41im1
) ) )

2453 * 
tx3
 * ( 
	`pow2
(
u21i
è-…ow2(
u21im1
) )

2454 + 
C1
 * 
C5
 * 
tx3
 * ( 
u51i
 - 
u51im1
 );

2457 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2458 
rsd
[
i
][
j
][
k
][0] =„sd[i][j][k][0]

2459 + 
dx1
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][0]

2460 - 2.0 * 
u
[
i
][
j
][
k
][0]

2461 + 
u
[
i
+1][
j
][
k
][0] );

2462 
rsd
[
i
][
j
][
k
][1] =„sd[i][j][k][1]

2463 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][1] - flux[i][j][k][1] )

2464 + 
dx2
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][1]

2465 - 2.0 * 
u
[
i
][
j
][
k
][1]

2466 + 
u
[
i
+1][
j
][
k
][1] );

2467 
rsd
[
i
][
j
][
k
][2] =„sd[i][j][k][2]

2468 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][2] - flux[i][j][k][2] )

2469 + 
dx3
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][2]

2470 - 2.0 * 
u
[
i
][
j
][
k
][2]

2471 + 
u
[
i
+1][
j
][
k
][2] );

2472 
rsd
[
i
][
j
][
k
][3] =„sd[i][j][k][3]

2473 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][3] - flux[i][j][k][3] )

2474 + 
dx4
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][3]

2475 - 2.0 * 
u
[
i
][
j
][
k
][3]

2476 + 
u
[
i
+1][
j
][
k
][3] );

2477 
rsd
[
i
][
j
][
k
][4] =„sd[i][j][k][4]

2478 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][4] - flux[i][j][k][4] )

2479 + 
dx5
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][4]

2480 - 2.0 * 
u
[
i
][
j
][
k
][4]

2481 + 
u
[
i
+1][
j
][
k
][4] );

2487 
m
 = 0; m < 5; m++) {

2488 
rsd
[1][
j
][
k
][
m
] =„sd[1][j][k][m]

2489 - 
ds¥
 * ( + 5.0 * 
u
[1][
j
][
k
][
m
]

2490 - 4.0 * 
u
[2][
j
][
k
][
m
]

2491 + 
u
[3][
j
][
k
][
m
] );

2492 
rsd
[2][
j
][
k
][
m
] =„sd[2][j][k][m]

2493 - 
ds¥
 * ( - 4.0 * 
u
[1][
j
][
k
][
m
]

2494 + 6.0 * 
u
[2][
j
][
k
][
m
]

2495 - 4.0 * 
u
[3][
j
][
k
][
m
]

2496 + 
u
[4][
j
][
k
][
m
] );

2499 
i¡1
 = 3;

2500 
›nd1
 = 
nx
 - 4;

2502 
i
 = 
i¡1
; i <ğ
›nd1
; i++) {

2503 
m
 = 0; m < 5; m++) {

2504 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2505 - 
ds¥
 * ( 
u
[
i
-2][
j
][
k
][
m
]

2506 - 4.0 * 
u
[
i
-1][
j
][
k
][
m
]

2507 + 6.0 * 
u
[
i
][
j
][
k
][
m
]

2508 - 4.0 * 
u
[
i
+1][
j
][
k
][
m
]

2509 + 
u
[
i
+2][
j
][
k
][
m
] );

2514 
m
 = 0; m < 5; m++) {

2515 
rsd
[
nx
-3][
j
][
k
][
m
] =„sd[nx-3][j][k][m]

2516 - 
ds¥
 * ( 
u
[
nx
-5][
j
][
k
][
m
]

2517 - 4.0 * 
u
[
nx
-4][
j
][
k
][
m
]

2518 + 6.0 * 
u
[
nx
-3][
j
][
k
][
m
]

2519 - 4.0 * 
u
[
nx
-2][
j
][
k
][
m
] );

2520 
rsd
[
nx
-2][
j
][
k
][
m
] =„sd[nx-2][j][k][m]

2521 - 
ds¥
 * ( 
u
[
nx
-4][
j
][
k
][
m
]

2522 - 4.0 * 
u
[
nx
-3][
j
][
k
][
m
]

2523 + 5.0 * 
u
[
nx
-2][
j
][
k
][
m
] );

2532 
L1
 = 0;

2533 
L2
 = 
ny
-1;

2535 #´agm¨
omp
 

2536 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2537 
j
 = 
L1
; j <ğ
L2
; j++) {

2538 
k
 = 1; k <ğ
nz
 - 2; k++) {

2539 
æux
[
i
][
j
][
k
][0] = 
u
[i][j][k][2];

2540 
u31
 = 
u
[
i
][
j
][
k
][2] / u[i][j][k][0];

2542 
q
 = 0.50 * ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

2543 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

2544 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

2545 / 
u
[
i
][
j
][
k
][0];

2547 
æux
[
i
][
j
][
k
][1] = 
u
[i][j][k][1] * 
u31
;

2548 
æux
[
i
][
j
][
k
][2] = 
u
[i][j][k][2] * 
u31
 + 
C2
 * (u[i][j][k][4]-
q
);

2549 
æux
[
i
][
j
][
k
][3] = 
u
[i][j][k][3] * 
u31
;

2550 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
u
[i][j][k][4] - 
C2
 * 
q
 ) * 
u31
;

2555 #´agm¨
omp
 

2556 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2557 
k
 = 1; k <ğ
nz
 - 2; k++) {

2558 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2559 
m
 = 0; m < 5; m++) {

2560 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2561 - 
ty2
 * ( 
æux
[
i
][
j
+1][
k
][
m
] - flux[i][j-1][k][m] );

2565 
L2
 = 
ny
-1;

2566 
j
 = 
j¡
; j <ğ
L2
; j++) {

2567 
tmp
 = 1.0 / 
u
[
i
][
j
][
k
][0];

2569 
u21j
 = 
tmp
 * 
u
[
i
][
j
][
k
][1];

2570 
u31j
 = 
tmp
 * 
u
[
i
][
j
][
k
][2];

2571 
u41j
 = 
tmp
 * 
u
[
i
][
j
][
k
][3];

2572 
u51j
 = 
tmp
 * 
u
[
i
][
j
][
k
][4];

2574 
tmp
 = 1.0 / 
u
[
i
][
j
-1][
k
][0];

2575 
u21jm1
 = 
tmp
 * 
u
[
i
][
j
-1][
k
][1];

2576 
u31jm1
 = 
tmp
 * 
u
[
i
][
j
-1][
k
][2];

2577 
u41jm1
 = 
tmp
 * 
u
[
i
][
j
-1][
k
][3];

2578 
u51jm1
 = 
tmp
 * 
u
[
i
][
j
-1][
k
][4];

2580 
æux
[
i
][
j
][
k
][1] = 
ty3
 * ( 
u21j
 - 
u21jm1
 );

2581 
æux
[
i
][
j
][
k
][2] = (4.0/3.0è* 
ty3
 * (
u31j
-
u31jm1
);

2582 
æux
[
i
][
j
][
k
][3] = 
ty3
 * ( 
u41j
 - 
u41jm1
 );

2583 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

2584 * 
ty3
 * ( ( 
	`pow2
(
u21j
è+…ow2(
u31j
è+…ow2(
u41j
) )

2585 - ( 
	`pow2
(
u21jm1
è+…ow2(
u31jm1
è+…ow2(
u41jm1
) ) )

2587 * 
ty3
 * ( 
	`pow2
(
u31j
è-…ow2(
u31jm1
) )

2588 + 
C1
 * 
C5
 * 
ty3
 * ( 
u51j
 - 
u51jm1
 );

2591 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2593 
rsd
[
i
][
j
][
k
][0] =„sd[i][j][k][0]

2594 + 
dy1
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][0]

2595 - 2.0 * 
u
[
i
][
j
][
k
][0]

2596 + 
u
[
i
][
j
+1][
k
][0] );

2598 
rsd
[
i
][
j
][
k
][1] =„sd[i][j][k][1]

2599 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][1] - flux[i][j][k][1] )

2600 + 
dy2
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][1]

2601 - 2.0 * 
u
[
i
][
j
][
k
][1]

2602 + 
u
[
i
][
j
+1][
k
][1] );

2604 
rsd
[
i
][
j
][
k
][2] =„sd[i][j][k][2]

2605 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][2] - flux[i][j][k][2] )

2606 + 
dy3
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][2]

2607 - 2.0 * 
u
[
i
][
j
][
k
][2]

2608 + 
u
[
i
][
j
+1][
k
][2] );

2610 
rsd
[
i
][
j
][
k
][3] =„sd[i][j][k][3]

2611 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][3] - flux[i][j][k][3] )

2612 + 
dy4
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][3]

2613 - 2.0 * 
u
[
i
][
j
][
k
][3]

2614 + 
u
[
i
][
j
+1][
k
][3] );

2616 
rsd
[
i
][
j
][
k
][4] =„sd[i][j][k][4]

2617 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][4] - flux[i][j][k][4] )

2618 + 
dy5
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][4]

2619 - 2.0 * 
u
[
i
][
j
][
k
][4]

2620 + 
u
[
i
][
j
+1][
k
][4] );

2627 
m
 = 0; m < 5; m++) {

2628 
rsd
[
i
][1][
k
][
m
] =„sd[i][1][k][m]

2629 - 
ds¥
 * ( + 5.0 * 
u
[
i
][1][
k
][
m
]

2630 - 4.0 * 
u
[
i
][2][
k
][
m
]

2631 + 
u
[
i
][3][
k
][
m
] );

2632 
rsd
[
i
][2][
k
][
m
] =„sd[i][2][k][m]

2633 - 
ds¥
 * ( - 4.0 * 
u
[
i
][1][
k
][
m
]

2634 + 6.0 * 
u
[
i
][2][
k
][
m
]

2635 - 4.0 * 
u
[
i
][3][
k
][
m
]

2636 + 
u
[
i
][4][
k
][
m
] );

2639 
j¡1
 = 3;

2640 
j’d1
 = 
ny
 - 4;

2641 
j
 = 
j¡1
; j <ğ
j’d1
; j++) {

2642 
m
 = 0; m < 5; m++) {

2643 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2644 - 
ds¥
 * ( 
u
[
i
][
j
-2][
k
][
m
]

2645 - 4.0 * 
u
[
i
][
j
-1][
k
][
m
]

2646 + 6.0 * 
u
[
i
][
j
][
k
][
m
]

2647 - 4.0 * 
u
[
i
][
j
+1][
k
][
m
]

2648 + 
u
[
i
][
j
+2][
k
][
m
] );

2652 
m
 = 0; m < 5; m++) {

2653 
rsd
[
i
][
ny
-3][
k
][
m
] =„sd[i][ny-3][k][m]

2654 - 
ds¥
 * ( 
u
[
i
][
ny
-5][
k
][
m
]

2655 - 4.0 * 
u
[
i
][
ny
-4][
k
][
m
]

2656 + 6.0 * 
u
[
i
][
ny
-3][
k
][
m
]

2657 - 4.0 * 
u
[
i
][
ny
-2][
k
][
m
] );

2658 
rsd
[
i
][
ny
-2][
k
][
m
] =„sd[i][ny-2][k][m]

2659 - 
ds¥
 * ( 
u
[
i
][
ny
-4][
k
][
m
]

2660 - 4.0 * 
u
[
i
][
ny
-3][
k
][
m
]

2661 + 5.0 * 
u
[
i
][
ny
-2][
k
][
m
] );

2669 #´agm¨
omp
 

2670 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2671 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2672 
k
 = 0; k <ğ
nz
-1; k++) {

2673 
æux
[
i
][
j
][
k
][0] = 
u
[i][j][k][3];

2674 
u41
 = 
u
[
i
][
j
][
k
][3] / u[i][j][k][0];

2676 
q
 = 0.50 * ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

2677 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

2678 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

2679 / 
u
[
i
][
j
][
k
][0];

2681 
æux
[
i
][
j
][
k
][1] = 
u
[i][j][k][1] * 
u41
;

2682 
æux
[
i
][
j
][
k
][2] = 
u
[i][j][k][2] * 
u41
;

2683 
æux
[
i
][
j
][
k
][3] = 
u
[i][j][k][3] * 
u41
 + 
C2
 * (u[i][j][k][4]-
q
);

2684 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
u
[i][j][k][4] - 
C2
 * 
q
 ) * 
u41
;

2687 
k
 = 1; k <ğ
nz
 - 2; k++) {

2688 
m
 = 0; m < 5; m++) {

2689 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2690 - 
tz2
 * ( 
æux
[
i
][
j
][
k
+1][
m
] - flux[i][j][k-1][m] );

2694 
k
 = 1; k <ğ
nz
-1; k++) {

2695 
tmp
 = 1.0 / 
u
[
i
][
j
][
k
][0];

2697 
u21k
 = 
tmp
 * 
u
[
i
][
j
][
k
][1];

2698 
u31k
 = 
tmp
 * 
u
[
i
][
j
][
k
][2];

2699 
u41k
 = 
tmp
 * 
u
[
i
][
j
][
k
][3];

2700 
u51k
 = 
tmp
 * 
u
[
i
][
j
][
k
][4];

2702 
tmp
 = 1.0 / 
u
[
i
][
j
][
k
-1][0];

2704 
u21km1
 = 
tmp
 * 
u
[
i
][
j
][
k
-1][1];

2705 
u31km1
 = 
tmp
 * 
u
[
i
][
j
][
k
-1][2];

2706 
u41km1
 = 
tmp
 * 
u
[
i
][
j
][
k
-1][3];

2707 
u51km1
 = 
tmp
 * 
u
[
i
][
j
][
k
-1][4];

2709 
æux
[
i
][
j
][
k
][1] = 
tz3
 * ( 
u21k
 - 
u21km1
 );

2710 
æux
[
i
][
j
][
k
][2] = 
tz3
 * ( 
u31k
 - 
u31km1
 );

2711 
æux
[
i
][
j
][
k
][3] = (4.0/3.0è* 
tz3
 * (
u41k
-
u41km1
);

2712 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

2713 * 
tz3
 * ( ( 
	`pow2
(
u21k
è+…ow2(
u31k
è+…ow2(
u41k
) )

2714 - ( 
	`pow2
(
u21km1
è+…ow2(
u31km1
è+…ow2(
u41km1
) ) )

2716 * 
tz3
 * ( 
	`pow2
(
u41k
è-…ow2(
u41km1
) )

2717 + 
C1
 * 
C5
 * 
tz3
 * ( 
u51k
 - 
u51km1
 );

2720 
k
 = 1; k <ğ
nz
 - 2; k++) {

2721 
rsd
[
i
][
j
][
k
][0] =„sd[i][j][k][0]

2722 + 
dz1
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][0]

2723 - 2.0 * 
u
[
i
][
j
][
k
][0]

2724 + 
u
[
i
][
j
][
k
+1][0] );

2725 
rsd
[
i
][
j
][
k
][1] =„sd[i][j][k][1]

2726 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][1] - flux[i][j][k][1] )

2727 + 
dz2
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][1]

2728 - 2.0 * 
u
[
i
][
j
][
k
][1]

2729 + 
u
[
i
][
j
][
k
+1][1] );

2730 
rsd
[
i
][
j
][
k
][2] =„sd[i][j][k][2]

2731 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][2] - flux[i][j][k][2] )

2732 + 
dz3
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][2]

2733 - 2.0 * 
u
[
i
][
j
][
k
][2]

2734 + 
u
[
i
][
j
][
k
+1][2] );

2735 
rsd
[
i
][
j
][
k
][3] =„sd[i][j][k][3]

2736 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][3] - flux[i][j][k][3] )

2737 + 
dz4
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][3]

2738 - 2.0 * 
u
[
i
][
j
][
k
][3]

2739 + 
u
[
i
][
j
][
k
+1][3] );

2740 
rsd
[
i
][
j
][
k
][4] =„sd[i][j][k][4]

2741 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][4] - flux[i][j][k][4] )

2742 + 
dz5
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][4]

2743 - 2.0 * 
u
[
i
][
j
][
k
][4]

2744 + 
u
[
i
][
j
][
k
+1][4] );

2750 
m
 = 0; m < 5; m++) {

2751 
rsd
[
i
][
j
][1][
m
] =„sd[i][j][1][m]

2752 - 
ds¥
 * ( + 5.0 * 
u
[
i
][
j
][1][
m
]

2753 - 4.0 * 
u
[
i
][
j
][2][
m
]

2754 + 
u
[
i
][
j
][3][
m
] );

2755 
rsd
[
i
][
j
][2][
m
] =„sd[i][j][2][m]

2756 - 
ds¥
 * ( - 4.0 * 
u
[
i
][
j
][1][
m
]

2757 + 6.0 * 
u
[
i
][
j
][2][
m
]

2758 - 4.0 * 
u
[
i
][
j
][3][
m
]

2759 + 
u
[
i
][
j
][4][
m
] );

2762 
k
 = 3; k <ğ
nz
 - 4; k++) {

2763 
m
 = 0; m < 5; m++) {

2764 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2765 - 
ds¥
 * ( 
u
[
i
][
j
][
k
-2][
m
]

2766 - 4.0 * 
u
[
i
][
j
][
k
-1][
m
]

2767 + 6.0 * 
u
[
i
][
j
][
k
][
m
]

2768 - 4.0 * 
u
[
i
][
j
][
k
+1][
m
]

2769 + 
u
[
i
][
j
][
k
+2][
m
] );

2773 
m
 = 0; m < 5; m++) {

2774 
rsd
[
i
][
j
][
nz
-3][
m
] =„sd[i][j][nz-3][m]

2775 - 
ds¥
 * ( 
u
[
i
][
j
][
nz
-5][
m
]

2776 - 4.0 * 
u
[
i
][
j
][
nz
-4][
m
]

2777 + 6.0 * 
u
[
i
][
j
][
nz
-3][
m
]

2778 - 4.0 * 
u
[
i
][
j
][
nz
-2][
m
] );

2779 
rsd
[
i
][
j
][
nz
-2][
m
] =„sd[i][j][nz-2][m]

2780 - 
ds¥
 * ( 
u
[
i
][
j
][
nz
-4][
m
]

2781 - 4.0 * 
u
[
i
][
j
][
nz
-3][
m
]

2782 + 5.0 * 
u
[
i
][
j
][
nz
-2][
m
] );

2788 
	}
}

2793 
	$£tbv
() {

2795 #´agm¨
omp
 
·¿Î–


2805 
i
, 
j
, 
k
;

2806 
iglob
, 
jglob
;

2811 #´agm¨
omp
 

2812 
i
 = 0; i < 
nx
; i++) {

2813 
iglob
 = 
i
;

2814 
j
 = 0; j < 
ny
; j++) {

2815 
jglob
 = 
j
;

2816 
	`exaù
Ğ
iglob
, 
jglob
, 0, &
u
[
i
][
j
][0][0] );

2817 
	`exaù
Ğ
iglob
, 
jglob
, 
nz
-1, &
u
[
i
][
j
][nz-1][0] );

2824 #´agm¨
omp
 

2825 
i
 = 0; i < 
nx
; i++) {

2826 
iglob
 = 
i
;

2827 
k
 = 0; k < 
nz
; k++) {

2828 
	`exaù
Ğ
iglob
, 0, 
k
, &
u
[
i
][0][k][0] );

2832 #´agm¨
omp
 

2833 
i
 = 0; i < 
nx
; i++) {

2834 
iglob
 = 
i
;

2835 
k
 = 0; k < 
nz
; k++) {

2836 
	`exaù
Ğ
iglob
, 
ny0
-1, 
k
, &
u
[
i
][
ny
-1][k][0] );

2843 #´agm¨
omp
 

2844 
j
 = 0; j < 
ny
; j++) {

2845 
jglob
 = 
j
;

2846 
k
 = 0; k < 
nz
; k++) {

2847 
	`exaù
Ğ0, 
jglob
, 
k
, &
u
[0][
j
][k][0] );

2851 #´agm¨
omp
 

2852 
j
 = 0; j < 
ny
; j++) {

2853 
jglob
 = 
j
;

2854 
k
 = 0; k < 
nz
; k++) {

2855 
	`exaù
Ğ
nx0
-1, 
jglob
, 
k
, &
u
[
nx
-1][
j
][k][0] );

2860 
	}
}

2865 
	$£tcÛff
() {

2870 
dxi
 = 1.0 / ( 
nx0
 - 1 );

2871 
d‘a
 = 1.0 / ( 
ny0
 - 1 );

2872 
dz‘a
 = 1.0 / ( 
nz0
 - 1 );

2874 
tx1
 = 1.0 / ( 
dxi
 * dxi );

2875 
tx2
 = 1.0 / ( 2.0 * 
dxi
 );

2876 
tx3
 = 1.0 / 
dxi
;

2878 
ty1
 = 1.0 / ( 
d‘a
 * deta );

2879 
ty2
 = 1.0 / ( 2.0 * 
d‘a
 );

2880 
ty3
 = 1.0 / 
d‘a
;

2882 
tz1
 = 1.0 / ( 
dz‘a
 * dzeta );

2883 
tz2
 = 1.0 / ( 2.0 * 
dz‘a
 );

2884 
tz3
 = 1.0 / 
dz‘a
;

2886 
ii1
 = 1;

2887 
ii2
 = 
nx0
 - 2;

2888 
ji1
 = 1;

2889 
ji2
 = 
ny0
 - 3;

2890 
ki1
 = 2;

2891 
ki2
 = 
nz0
 - 2;

2896 
dx1
 = 0.75;

2897 
dx2
 = 
dx1
;

2898 
dx3
 = 
dx1
;

2899 
dx4
 = 
dx1
;

2900 
dx5
 = 
dx1
;

2902 
dy1
 = 0.75;

2903 
dy2
 = 
dy1
;

2904 
dy3
 = 
dy1
;

2905 
dy4
 = 
dy1
;

2906 
dy5
 = 
dy1
;

2908 
dz1
 = 1.00;

2909 
dz2
 = 
dz1
;

2910 
dz3
 = 
dz1
;

2911 
dz4
 = 
dz1
;

2912 
dz5
 = 
dz1
;

2917 
ds¥
 = ( 
	`max
 (
dx1
, max(
dy1
, 
dz1
) ) ) / 4.0;

2922 
û
[0][0] = 2.0;

2923 
û
[0][1] = 0.0;

2924 
û
[0][2] = 0.0;

2925 
û
[0][3] = 4.0;

2926 
û
[0][4] = 5.0;

2927 
û
[0][5] = 3.0;

2928 
û
[0][6] = 5.0e-01;

2929 
û
[0][7] = 2.0e-02;

2930 
û
[0][8] = 1.0e-02;

2931 
û
[0][9] = 3.0e-02;

2932 
û
[0][10] = 5.0e-01;

2933 
û
[0][11] = 4.0e-01;

2934 
û
[0][12] = 3.0e-01;

2939 
û
[1][0] = 1.0;

2940 
û
[1][1] = 0.0;

2941 
û
[1][2] = 0.0;

2942 
û
[1][3] = 0.0;

2943 
û
[1][4] = 1.0;

2944 
û
[1][5] = 2.0;

2945 
û
[1][6] = 3.0;

2946 
û
[1][7] = 1.0e-02;

2947 
û
[1][8] = 3.0e-02;

2948 
û
[1][9] = 2.0e-02;

2949 
û
[1][10] = 4.0e-01;

2950 
û
[1][11] = 3.0e-01;

2951 
û
[1][12] = 5.0e-01;

2956 
û
[2][0] = 2.0;

2957 
û
[2][1] = 2.0;

2958 
û
[2][2] = 0.0;

2959 
û
[2][3] = 0.0;

2960 
û
[2][4] = 0.0;

2961 
û
[2][5] = 2.0;

2962 
û
[2][6] = 3.0;

2963 
û
[2][7] = 4.0e-02;

2964 
û
[2][8] = 3.0e-02;

2965 
û
[2][9] = 5.0e-02;

2966 
û
[2][10] = 3.0e-01;

2967 
û
[2][11] = 5.0e-01;

2968 
û
[2][12] = 4.0e-01;

2973 
û
[3][0] = 2.0;

2974 
û
[3][1] = 2.0;

2975 
û
[3][2] = 0.0;

2976 
û
[3][3] = 0.0;

2977 
û
[3][4] = 0.0;

2978 
û
[3][5] = 2.0;

2979 
û
[3][6] = 3.0;

2980 
û
[3][7] = 3.0e-02;

2981 
û
[3][8] = 5.0e-02;

2982 
û
[3][9] = 4.0e-02;

2983 
û
[3][10] = 2.0e-01;

2984 
û
[3][11] = 1.0e-01;

2985 
û
[3][12] = 3.0e-01;

2990 
û
[4][0] = 5.0;

2991 
û
[4][1] = 4.0;

2992 
û
[4][2] = 3.0;

2993 
û
[4][3] = 2.0;

2994 
û
[4][4] = 1.0e-01;

2995 
û
[4][5] = 4.0e-01;

2996 
û
[4][6] = 3.0e-01;

2997 
û
[4][7] = 5.0e-02;

2998 
û
[4][8] = 4.0e-02;

2999 
û
[4][9] = 3.0e-02;

3000 
û
[4][10] = 1.0e-01;

3001 
û
[4][11] = 3.0e-01;

3002 
û
[4][12] = 2.0e-01;

3003 
	}
}

3009 
	$£tiv
() {

3011 #´agm¨
omp
 
·¿Î–


3023 
i
, 
j
, 
k
, 
m
;

3024 
iglob
, 
jglob
;

3025 
xi
, 
‘a
, 
z‘a
;

3026 
pxi
, 
³
, 
pz‘a
;

3027 
ue_1jk
[5],
ue_nx0jk
[5],
ue_i1k
[5],

3028 
ue_šy0k
[5],
ue_ij1
[5],
ue_ijnz
[5];

3030 #´agm¨
omp
 

3031 
j
 = 0; j < 
ny
; j++) {

3032 
jglob
 = 
j
;

3033 
k
 = 1; k < 
nz
 - 1; k++) {

3034 
z‘a
 = (()
k
è/ (
nz
-1);

3035 ià(
jglob
 !ğ0 && jglob !ğ
ny0
-1) {

3036 
‘a
 = ( (è(
jglob
èè/ (
ny0
-1);

3037 
i
 = 0; i < 
nx
; i++) {

3038 
iglob
 = 
i
;

3039 if(
iglob
 !ğ0 && iglob !ğ
nx0
-1) {

3040 
xi
 = ( (è(
iglob
èè/ (
nx0
-1);

3041 
	`exaù
 (0,
jglob
,
k
,
ue_1jk
);

3042 
	`exaù
 (
nx0
-1,
jglob
,
k
,
ue_nx0jk
);

3043 
	`exaù
 (
iglob
,0,
k
,
ue_i1k
);

3044 
	`exaù
 (
iglob
,
ny0
-1,
k
,
ue_šy0k
);

3045 
	`exaù
 (
iglob
,
jglob
,0,
ue_ij1
);

3046 
	`exaù
 (
iglob
,
jglob
,
nz
-1,
ue_ijnz
);

3047 
m
 = 0; m < 5; m++) {

3048 
pxi
 = ( 1.0 - 
xi
 ) * 
ue_1jk
[
m
]

3049 + 
xi
 * 
ue_nx0jk
[
m
];

3050 
³
 = ( 1.0 - 
‘a
 ) * 
ue_i1k
[
m
]

3051 + 
‘a
 * 
ue_šy0k
[
m
];

3052 
pz‘a
 = ( 1.0 - 
z‘a
 ) * 
ue_ij1
[
m
]

3053 + 
z‘a
 * 
ue_ijnz
[
m
];

3055 
u
[
i
][
j
][
k
][
m
] = 
pxi
 + 
³
 + 
pz‘a


3056 - 
pxi
 * 
³
 -…‘¨* 
pz‘a
 -…zeta *…xi

3057 + 
pxi
 * 
³
 * 
pz‘a
;

3065 
	}
}

3069 
	$ssÜ
() {

3079 
i
, 
j
, 
k
, 
m
;

3080 
i¡•
;

3081 
tmp
;

3082 
d–unm
[5], 
tv
[
ISIZ1
][
ISIZ2
][5];

3087 
tmp
 = 1.0 / ( 
omega
 * ( 2.0 - omega ) ) ;

3093 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
i
,
j
,
k
,
m
)

3095 #´agm¨
omp
 

3096 
i
 = 0; i < 
ISIZ1
; i++) {

3097 
j
 = 0; j < 
ISIZ2
; j++) {

3098 
k
 = 0; k < 5; k++) {

3099 
m
 = 0; m < 5; m++) {

3100 
a
[
i
][
j
][
k
][
m
] = 0.0;

3101 
b
[
i
][
j
][
k
][
m
] = 0.0;

3102 
c
[
i
][
j
][
k
][
m
] = 0.0;

3103 
d
[
i
][
j
][
k
][
m
] = 0.0;

3112 
	`rhs
();

3117 
	`l2nÜm
Ğ
nx0
, 
ny0
, 
nz0
,

3118 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3119 
rsd
, 
rsdnm
 );

3122 
	`tim”_ş—r
(1);

3123 
	`tim”_¡¬t
(1);

3130 
i¡•
 = 1; i¡• <ğ
™max
; istep++) {

3132 ià(
i¡•
%20 =ğ0 || i¡• =ğ
™max
 || istep == 1) {

3133 #´agm¨
omp
 
ma¡”


3134 
	`´štf
(" Tim¡• %4d\n", 
i¡•
);

3137 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
i¡•
,
i
,
j
,
k
,
m
)

3143 #´agm¨
omp
 

3144 
i
 = 
i¡
; i <ğ
›nd
; i++) {

3145 
j
 = 
j¡
; j <ğ
j’d
; j++) {

3146 
k
 = 1; k <ğ
nz
 - 2; k++) {

3147 
m
 = 0; m < 5; m++) {

3148 
rsd
[
i
][
j
][
k
][
m
] = 
dt
 *„sd[i][j][k][m];

3154 
k
 = 1; k <ğ
nz
 - 2; k++) {

3158 
	`jaşd
(
k
);

3163 
	`bÉs
(
nx
, 
ny
, 
nz
, 
k
,

3164 
omega
,

3165 
rsd
,

3166 
a
, 
b
, 
c
, 
d
,

3167 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3168 
nx0
, 
ny0
 );

3171 #´agm¨
omp
 
b¬r›r


3173 
k
 = 
nz
 - 2; k >= 1; k--) {

3177 
	`jacu
(
k
);

3182 
	`buts
(
nx
, 
ny
, 
nz
, 
k
,

3183 
omega
,

3184 
rsd
, 
tv
,

3185 
d
, 
a
, 
b
, 
c
,

3186 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3187 
nx0
, 
ny0
 );

3189 #´agm¨
omp
 
b¬r›r


3195 #´agm¨
omp
 

3196 
i
 = 
i¡
; i <ğ
›nd
; i++) {

3197 
j
 = 
j¡
; j <ğ
j’d
; j++) {

3198 
k
 = 1; k <ğ
nz
-2; k++) {

3199 
m
 = 0; m < 5; m++) {

3200 
u
[
i
][
j
][
k
][
m
] = u[i][j][k][m]

3201 + 
tmp
 * 
rsd
[
i
][
j
][
k
][
m
];

3210 iàĞ
i¡•
 % 
šÜm
 == 0 ) {

3211 
	`l2nÜm
Ğ
nx0
, 
ny0
, 
nz0
,

3212 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3213 
rsd
, 
d–unm
 );

3219 
	`rhs
();

3224 iàĞĞ
i¡•
 % 
šÜm
 == 0 ) ||

3225 Ğ
i¡•
 =ğ
™max
 ) ) {

3226 
	`l2nÜm
Ğ
nx0
, 
ny0
, 
nz0
,

3227 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3228 
rsd
, 
rsdnm
 );

3234 iàĞĞ
rsdnm
[0] < 
tŞrsd
[0] ) &&

3235 Ğ
rsdnm
[1] < 
tŞrsd
[1] ) &&

3236 Ğ
rsdnm
[2] < 
tŞrsd
[2] ) &&

3237 Ğ
rsdnm
[3] < 
tŞrsd
[3] ) &&

3238 Ğ
rsdnm
[4] < 
tŞrsd
[4] ) ) {

3239 
	`ex™
(1);

3244 
	`tim”_¡İ
(1);

3245 
maxtime
ğ
	`tim”_»ad
(1);

3247 
	}
}

3252 
	$v”ify
(
xü
[5], 
xû
[5], 
xci
,

3253 *
şass
, 
boŞ—n
 *
v”if›d
) {

3259 
xü»f
[5],
xû»f
[5],
xcœef
,

3260 
xüdif
[5],
xûdif
[5],
xcidif
,

3261 
•sÚ
, 
dŒef
;

3262 
m
;

3267 
•sÚ
 = 1.0e-08;

3269 *
şass
 = 'U';

3270 *
v”if›d
 = 
TRUE
;

3272 
m
 = 0; m < 5; m++) {

3273 
xü»f
[
m
] = 1.0;

3274 
xû»f
[
m
] = 1.0;

3276 
xcœef
 = 1.0;

3278 iàĞ
nx0
 =ğ12 && 
ny0
 =ğ12 && 
nz0
 =ğ12 && 
™max
 == 50) {

3279 *
şass
 = 'S';

3280 
dŒef
 = 5.0e-1;

3286 
xü»f
[0] = 1.6196343210976702e-02;

3287 
xü»f
[1] = 2.1976745164821318e-03;

3288 
xü»f
[2] = 1.5179927653399185e-03;

3289 
xü»f
[3] = 1.5029584435994323e-03;

3290 
xü»f
[4] = 3.4264073155896461e-02;

3296 
xû»f
[0] = 6.4223319957960924e-04;

3297 
xû»f
[1] = 8.4144342047347926e-05;

3298 
xû»f
[2] = 5.8588269616485186e-05;

3299 
xû»f
[3] = 5.8474222595157350e-05;

3300 
xû»f
[4] = 1.3103347914111294e-03;

3306 
xcœef
 = 7.8418928865937083;

3308 } iàĞ
nx0
 =ğ33 && 
ny0
 =ğ33 && 
nz0
 =ğ33 && 
™max
 == 300) {

3310 *
şass
 = 'W';

3311 
dŒef
 = 1.5e-3;

3316 
xü»f
[0] = 0.1236511638192e+02;

3317 
xü»f
[1] = 0.1317228477799e+01;

3318 
xü»f
[2] = 0.2550120713095e+01;

3319 
xü»f
[3] = 0.2326187750252e+01;

3320 
xü»f
[4] = 0.2826799444189e+02;

3325 
xû»f
[0] = 0.4867877144216;

3326 
xû»f
[1] = 0.5064652880982e-01;

3327 
xû»f
[2] = 0.9281818101960e-01;

3328 
xû»f
[3] = 0.8570126542733e-01;

3329 
xû»f
[4] = 0.1084277417792e+01;

3335 
xcœef
 = 0.1161399311023e+02;

3337 } iàĞ
nx0
 =ğ64 && 
ny0
 =ğ64 && 
nz0
 =ğ64 && 
™max
 == 250) {

3339 *
şass
 = 'A';

3340 
dŒef
 = 2.0e+0;

3345 
xü»f
[0] = 7.7902107606689367e+02;

3346 
xü»f
[1] = 6.3402765259692870e+01;

3347 
xü»f
[2] = 1.9499249727292479e+02;

3348 
xü»f
[3] = 1.7845301160418537e+02;

3349 
xü»f
[4] = 1.8384760349464247e+03;

3355 
xû»f
[0] = 2.9964085685471943e+01;

3356 
xû»f
[1] = 2.8194576365003349;

3357 
xû»f
[2] = 7.3473412698774742;

3358 
xû»f
[3] = 6.7139225687777051;

3359 
xû»f
[4] = 7.0715315688392578e+01;

3365 
xcœef
 = 2.6030925604886277e+01;

3367 } iàĞ
nx0
 =ğ102 && 
ny0
 =ğ102 && 
nz0
 =ğ102 && 
™max
 == 250) {

3369 *
şass
 = 'B';

3370 
dŒef
 = 2.0e+0;

3376 
xü»f
[0] = 3.5532672969982736e+03;

3377 
xü»f
[1] = 2.6214750795310692e+02;

3378 
xü»f
[2] = 8.8333721850952190e+02;

3379 
xü»f
[3] = 7.7812774739425265e+02;

3380 
xü»f
[4] = 7.3087969592545314e+03;

3386 
xû»f
[0] = 1.1401176380212709e+02;

3387 
xû»f
[1] = 8.1098963655421574;

3388 
xû»f
[2] = 2.8480597317698308e+01;

3389 
xû»f
[3] = 2.5905394567832939e+01;

3390 
xû»f
[4] = 2.6054907504857413e+02;

3396 
xcœef
 = 4.7887162703308227e+01;

3398 } iàĞ
nx0
 =ğ162 && 
ny0
 =ğ162 && 
nz0
 =ğ162 && 
™max
 == 250) {

3400 *
şass
 = 'C';

3401 
dŒef
 = 2.0e+0;

3407 
xü»f
[0] = 1.03766980323537846e+04;

3408 
xü»f
[1] = 8.92212458801008552e+02;

3409 
xü»f
[2] = 2.56238814582660871e+03;

3410 
xü»f
[3] = 2.19194343857831427e+03;

3411 
xü»f
[4] = 1.78078057261061185e+04;

3417 
xû»f
[0] = 2.15986399716949279e+02;

3418 
xû»f
[1] = 1.55789559239863600e+01;

3419 
xû»f
[2] = 5.41318863077207766e+01;

3420 
xû»f
[3] = 4.82262643154045421e+01;

3421 
xû»f
[4] = 4.55902910043250358e+02;

3427 
xcœef
 = 6.66404553572181300e+01;

3429 *
v”if›d
 = 
FALSE
;

3440 
m
 = 0; m < 5; m++) {

3442 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]);

3443 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

3446 
xcidif
 = 
	`çbs
((
xci
 - 
xcœef
)/xciref);

3452 ià(*
şass
 != 'U') {

3453 
	`´štf
("\ÀV”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

3454 
	`´štf
(" Accu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

3455 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

3456 *
v”if›d
 = 
FALSE
;

3457 *
şass
 = 'U';

3458 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

3461 
	`´štf
(" Unknown class\n");

3464 ià(*
şass
 != 'U') {

3465 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

3467 
	`´štf
(" RMS-norms of„esidual\n");

3470 
m
 = 0; m < 5; m++) {

3471 ià(*
şass
 == 'U') {

3472 
	`´štf
(" %2d %20.13e\n", 
m
, 
xü
[m]);

3473 } ià(
xüdif
[
m
] > 
•sÚ
) {

3474 *
v”if›d
 = 
FALSE
;

3475 
	`´štf
(" FAILURE: %2d %20.13e%20.13e%20.13e\n",

3476 
m
,
xü
[m],
xü»f
[m],
xüdif
[m]);

3478 
	`´štf
(" %2d %20.13e%20.13e%20.13e\n",

3479 
m
,
xü
[m],
xü»f
[m],
xüdif
[m]);

3483 ià(*
şass
 != 'U') {

3484 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

3486 
	`´štf
(" RMS-norms of solutionƒrror\n");

3489 
m
 = 0; m < 5; m++) {

3490 ià(*
şass
 == 'U') {

3491 
	`´štf
(" %2d %20.13e\n", 
m
, 
xû
[m]);

3492 } ià(
xûdif
[
m
] > 
•sÚ
) {

3493 *
v”if›d
 = 
FALSE
;

3494 
	`´štf
(" FAILURE: %2d %20.13e%20.13e%20.13e\n",

3495 
m
,
xû
[m],
xû»f
[m],
xûdif
[m]);

3497 
	`´štf
(" %2d %20.13e%20.13e%20.13e\n",

3498 
m
,
xû
[m],
xû»f
[m],
xûdif
[m]);

3502 ià(*
şass
 != 'U') {

3503 
	`´štf
(" Comparison of surface integral\n");

3505 
	`´štf
(" Surface integral\n");

3508 ià(*
şass
 == 'U') {

3509 
	`´štf
(" %20.13e\n", 
xci
);

3510 } ià(
xcidif
 > 
•sÚ
) {

3511 *
v”if›d
 = 
FALSE
;

3512 
	`´štf
(" FAILURE: %20.13e%20.13e%20.13e\n",

3513 
xci
, 
xcœef
, 
xcidif
);

3515 
	`´štf
(" %20.13e%20.13e%20.13e\n",

3516 
xci
, 
xcœef
, 
xcidif
);

3519 ià(*
şass
 == 'U') {

3520 
	`´štf
(" No„eference values…rovided\n");

3521 
	`´štf
(" No verification…erformed\n");

3522 } ià(*
v”if›d
) {

3523 
	`´štf
(" Verification Successful\n");

3525 
	`´štf
(" Verification failed\n");

3527 
	}
}

	@LU/npbparams.h

9 
	#ISIZ1
 162

	)

10 
	#ISIZ2
 162

	)

11 
	#ISIZ3
 162

	)

13 
	#ITMAX_DEFAULT
 250

	)

14 
	#INORM_DEFAULT
 250

	)

15 
	#DT_DEFAULT
 2.0

	)

16 
	#CONVERTDOUBLE
 
FALSE


	)

17 
	#COMPILETIME
 "01 Feb 2021"

	)

18 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

19 
	#CS1
 "ÒÚe)"

	)

20 
	#CS2
 "ÒÚe)"

	)

21 
	#CS3
 "ÒÚe)"

	)

22 
	#CS4
 "ÒÚe)"

	)

23 
	#CS5
 "-o3 $(C_IN)"

	)

24 
	#CS6
 "ÒÚe)"

	)

25 
	#CS7
 "ÒÚe)"

	)

	@MG/globals.h

11 
	~"Åb·¿ms.h
"

15 
	#NM
 (2+(2<<(
LM
-1)))

	)

17 
	#NV
 (2+(2<<(
NDIM1
-1))*(2+(2<<(
NDIM2
-1)))*(2+(2<<(
NDIM3
-1))))

	)

19 
	#NR
 ((8*(
NV
+(
NM
*NM)+5*NM+7*
LM
))/7)

	)

21 
	#NM2
 (2*
NM
*NM)

	)

23 
	#MAXLEVEL
 11

	)

27 
	gnx
[
MAXLEVEL
+1], 
	gny
[MAXLEVEL+1], 
	gnz
[MAXLEVEL+1];

29 
	gCÏss
;

31 
	gdebug_vec
[8];

34 
	gm1
[
MAXLEVEL
+1], 
	gm2
[MAXLEVEL+1], 
	gm3
[MAXLEVEL+1];

35 
	gÉ
, 
	glb
;

40 
	#M
 1037

	)

	@MG/mg.c

36 
	~"../commÚ/Åb-C.h
"

37 
	~"glob®s.h
"

38 
	~"../m©h/Çs_m©h.h
"

40 
	~<Çutus/Çutus.h
>

41 
	~<Çutus/sh–l.h
>

43 
	#T_BENCH
 1

	)

44 
	#T_INIT
 2

	)

48 
	gis1
, 
	gis2
, 
	gis3
, 
	g›1
, 
	g›2
, 
	g›3
;

51 
£tup
(*
n1
, *
n2
, *
n3
, 
É
);

52 
mg3P
(****
u
, ***
v
, ****
r
, 
a
[4],

53 
c
[4], 
n1
, 
n2
, 
n3
, 
k
);

54 
psšv
Ğ***
r
, ***
u
, 
n1
, 
n2
, 
n3
,

55 
c
[4], 
k
);

56 
»sid
Ğ***
u
, ***
v
, ***
r
,

57 
n1
, 
n2
, 
n3
, 
a
[4], 
k
 );

58 
½rj3
Ğ***
r
, 
m1k
, 
m2k
, 
m3k
,

59 ***
s
, 
m1j
, 
m2j
, 
m3j
, 
k
 );

60 
š‹½
Ğ***
z
, 
mm1
, 
mm2
, 
mm3
,

61 ***
u
, 
n1
, 
n2
, 
n3
, 
k
 );

62 
nÜm2u3
(***
r
, 
n1
, 
n2
, 
n3
,

63 *
ºm2
, *
ºmu
, 
nx
, 
ny
, 
nz
);

64 
»p_Äm
(***
u
, 
n1
, 
n2
, 
n3
,

65 *
t™Ë
, 
kk
);

66 
comm3
(***
u
, 
n1
, 
n2
, 
n3
, 
kk
);

67 
z¿n3
(***
z
, 
n1
, 
n2
, 
n3
, 
nx
, 
ny
, 
k
);

68 
show®l
(***
z
, 
n1
, 
n2
, 
n3
);

69 
pow”
Ğ
a
, 
n
 );

70 
bubbË
Ğ
‹n
[
M
][2], 
j1
[M][2], 
j2
[M][2],

71 
j3
[
M
][2], 
m
, 
šd
 );

72 
z”o3
(***
z
, 
n1
, 
n2
, 
n3
);

73 
nÚz”o
(***
z
, 
n1
, 
n2
, 
n3
);

78 
´og¿m_MG
(*
_buf
, * 
_´iv
);

79 
´og¿m_MG_´ofe
(*
_
, *
__
);

81 
sh–l_cmd_im¶
 
	gÇs_mg_im¶
 = {

82 .
cmd
 = "nas-mg",

83 .
	gh–p_¡r
 = "NAS…arallel benchmark MG",

84 .
	ghªdËr
 = 
´og¿m_MG_´ofe
,

86 
nk_»gi¡”_sh–l_cmd
(
Çs_mg_im¶
);

88 
	$´og¿m_MG_´ofe
(*
_
, *
__
){

90 #ifdeà
NAUT_CONFIG_PROFILE


91 
	`nk_š¡rum’t_ş—r
();

92 
	`nk_š¡rum’t_¡¬t
();

94 
	`´og¿m_MG
(
_
,
__
);

95 #ifdeà
NAUT_CONFIG_PROFILE


96 
	`nk_š¡rum’t_’d
();

97 
	`nk_š¡rum’t_qu”y
();

100 
	}
}

103 
	$´og¿m_MG
(* 
_buf
, *
_´iv
) {

110 
k
, 
™
;

111 
t
, 
tš™
, 
mæİs
;

112 
Áh»ads
 = 1;

120 ****
u
, ***
v
, ****
r
;

121 
a
[4], 
c
[4];

123 
ºm2
, 
ºmu
;

124 
•sÚ
 = 1.0e-8;

125 
n1
, 
n2
, 
n3
, 
n™
;

126 
v”ify_v®ue
;

127 
boŞ—n
 
v”if›d
;

129 
i
, 
j
, 
l
;

132 
	`tim”_ş—r
(
T_BENCH
);

133 
	`tim”_ş—r
(
T_INIT
);

135 
	`tim”_¡¬t
(
T_INIT
);

141 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

160 
É
 = 
LT_DEFAULT
;

161 
n™
 = 
NIT_DEFAULT
;

162 
nx
[
É
] = 
NX_DEFAULT
;

163 
ny
[
É
] = 
NY_DEFAULT
;

164 
nz
[
É
] = 
NZ_DEFAULT
;

166 
i
 = 0; i <= 7; i++) {

167 
debug_vec
[
i
] = 
DEBUG_DEFAULT
;

171 iàĞ(
nx
[
É
] !ğ
ny
[É]è|| (nx[É] !ğ
nz
[lt]) ) {

172 
CÏss
 = 'U';

173 } ifĞ
nx
[
É
] =ğ32 && 
n™
 == 4 ) {

174 
CÏss
 = 'S';

175 } ifĞ
nx
[
É
] =ğ64 && 
n™
 == 40 ) {

176 
CÏss
 = 'W';

177 } ifĞ
nx
[
É
] =ğ256 && 
n™
 == 20 ) {

178 
CÏss
 = 'B';

179 } ifĞ
nx
[
É
] =ğ512 && 
n™
 == 20 ) {

180 
CÏss
 = 'C';

181 } ifĞ
nx
[
É
] =ğ256 && 
n™
 == 4 ) {

182 
CÏss
 = 'A';

184 
CÏss
 = 'U';

201 
a
[0] = -8.0/3.0;

202 
a
[1] = 0.0;

203 
a
[2] = 1.0/6.0;

204 
a
[3] = 1.0/12.0;

206 ià(
CÏss
 == 'A' || Class == 'S' || Class =='W') {

210 
c
[0] = -3.0/8.0;

211 
c
[1] = 1.0/32.0;

212 
c
[2] = -1.0/64.0;

213 
c
[3] = 0.0;

218 
c
[0] = -3.0/17.0;

219 
c
[1] = 1.0/33.0;

220 
c
[2] = -1.0/61.0;

221 
c
[3] = 0.0;

224 
lb
 = 1;

226 
	`£tup
(&
n1
,&
n2
,&
n3
,
É
);

228 
u
 = (****)
	`m®loc
((
É
+1)*(***));

229 
l
 = 
É
;† >=1;†--) {

230 
u
[
l
] = (***)
	`m®loc
(
m3
[l]*(**));

231 
k
 = 0; k < 
m3
[
l
]; k++) {

232 
u
[
l
][
k
] = (**)
	`m®loc
(
m2
[l]*(*));

233 
j
 = 0; j < 
m2
[
l
]; j++) {

234 
u
[
l
][
k
][
j
] = (*)
	`m®loc
(
m1
[l]*());

238 
v
 = (***)
	`m®loc
(
m3
[
É
]*(**));

239 
k
 = 0; k < 
m3
[
É
]; k++) {

240 
v
[
k
] = (**)
	`m®loc
(
m2
[
É
]*(*));

241 
j
 = 0; j < 
m2
[
É
]; j++) {

242 
v
[
k
][
j
] = (*)
	`m®loc
(
m1
[
É
]*());

245 
r
 = (****)
	`m®loc
((
É
+1)*(***));

246 
l
 = 
É
;† >=1;†--) {

247 
r
[
l
] = (***)
	`m®loc
(
m3
[l]*(**));

248 
k
 = 0; k < 
m3
[
l
]; k++) {

249 
r
[
l
][
k
] = (**)
	`m®loc
(
m2
[l]*(*));

250 
j
 = 0; j < 
m2
[
l
]; j++) {

251 
r
[
l
][
k
][
j
] = (*)
	`m®loc
(
m1
[l]*());

256 
	`z”o3
(
u
[
É
],
n1
,
n2
,
n3
);

257 
	`z¿n3
(
v
,
n1
,
n2
,
n3
,
nx
[
É
],
ny
[lt],lt);

259 
	`nÜm2u3
(
v
,
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[
É
],
ny
[É],
nz
[lt]);

265 
	`´štf
(" Size: %3dx%3dx%3d (class %1c)\n",

266 
nx
[
É
], 
ny
[É], 
nz
[É], 
CÏss
);

267 
	`´štf
(" I‹¿tiÚs: %3d\n", 
n™
);

269 
	`»sid
(
u
[
É
],
v
,
r
[É],
n1
,
n2
,
n3
,
a
,lt);

270 
	`nÜm2u3
(
r
[
É
],
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[É],
ny
[É],
nz
[lt]);

275 
	`mg3P
(
u
,
v
,
r
,
a
,
c
,
n1
,
n2
,
n3
,
É
);

276 
	`»sid
(
u
[
É
],
v
,
r
[É],
n1
,
n2
,
n3
,
a
,lt);

278 
	`£tup
(&
n1
,&
n2
,&
n3
,
É
);

280 
	`z”o3
(
u
[
É
],
n1
,
n2
,
n3
);

282 
	`z¿n3
(
v
,
n1
,
n2
,
n3
,
nx
[
É
],
ny
[lt],lt);

285 
	`tim”_¡İ
(
T_INIT
);

286 
	`tim”_¡¬t
(
T_BENCH
);

288 
	`»sid
(
u
[
É
],
v
,
r
[É],
n1
,
n2
,
n3
,
a
,lt);

289 
	`nÜm2u3
(
r
[
É
],
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[É],
ny
[É],
nz
[lt]);

291  
™
 = 1; iˆ<ğ
n™
; it++) {

292 
	`mg3P
(
u
,
v
,
r
,
a
,
c
,
n1
,
n2
,
n3
,
É
);

293 
	`»sid
(
u
[
É
],
v
,
r
[É],
n1
,
n2
,
n3
,
a
,lt);

295 
	`nÜm2u3
(
r
[
É
],
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[É],
ny
[É],
nz
[lt]);

297 #´agm¨
omp
 
·¿Î–


299 #ià
	`defšed
(
_OPENMP
)

300 #´agm¨
omp
 
ma¡”


301 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

305 
	`tim”_¡İ
(
T_BENCH
);

306 
t
 = 
	`tim”_»ad
(
T_BENCH
);

307 
tš™
 = 
	`tim”_»ad
(
T_INIT
);

309 
v”if›d
 = 
FALSE
;

310 
v”ify_v®ue
 = 0.0;

312 
	`´štf
(" In™Ÿliz©iÚime: %15.3à£cÚds\n", 
tš™
);

313 
	`´štf
(" Benchmark completed\n");

315 ià(
CÏss
 != 'U') {

316 ià(
CÏss
 == 'S') {

317 
v”ify_v®ue
 = 0.530770700573e-04;

318 } ià(
CÏss
 == 'W') {

319 
v”ify_v®ue
 = 0.250391406439e-17;

321 } ià(
CÏss
 == 'A') {

322 
v”ify_v®ue
 = 0.2433365309e-5;

323 } ià(
CÏss
 == 'B') {

324 
v”ify_v®ue
 = 0.180056440132e-5;

325 } ià(
CÏss
 == 'C') {

326 
v”ify_v®ue
 = 0.570674826298e-06;

329 iàĞ
	`çbs
Ğ
ºm2
 - 
v”ify_v®ue
 ) <ğ
•sÚ
 ) {

330 
v”if›d
 = 
TRUE
;

331 
	`´štf
(" VERIFICATION SUCCESSFUL\n");

332 
	`´štf
(" L2 NÜm i %20.12e\n", 
ºm2
);

333 
	`´štf
(" E¼Ü i  %20.12e\n", 
ºm2
 - 
v”ify_v®ue
);

335 
v”if›d
 = 
FALSE
;

336 
	`´štf
(" VERIFICATION FAILED\n");

337 
	`´štf
(" L2 NÜm i  %20.12e\n", 
ºm2
);

338 
	`´štf
(" ThcÜ»ù L2 NÜm i %20.12e\n", 
v”ify_v®ue
);

341 
v”if›d
 = 
FALSE
;

342 
	`´štf
(" Problem size unknown\n");

343 
	`´štf
(" NO VERIFICATION PERFORMED\n");

346 iàĞ
t
 != 0.0 ) {

347 
Â
 = 
nx
[
É
]*
ny
[É]*
nz
[lt];

348 
mæİs
 = 58.*
n™
*
Â
*1.0e-6 / 
t
;

350 
mæİs
 = 0.0;

353 
	`c_´št_»suÉs
("MG", 
CÏss
, 
nx
[
É
], 
ny
[É], 
nz
[lt],

354 
n™
, 
Áh»ads
, 
t
, 
mæİs
, " floating…oint",

355 
v”if›d
, 
NPBVERSION
, 
COMPILETIME
,

356 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

357 
	}
}

362 
	$£tup
(*
n1
, *
n2
, *
n3
, 
É
) {

367 
k
;

369  
k
 = 
É
-1; k >= 1; k--) {

370 
nx
[
k
] =‚x[k+1]/2;

371 
ny
[
k
] =‚y[k+1]/2;

372 
nz
[
k
] =‚z[k+1]/2;

375 
k
 = 1; k <ğ
É
; k++) {

376 
m1
[
k
] = 
nx
[k]+2;

377 
m2
[
k
] = 
nz
[k]+2;

378 
m3
[
k
] = 
ny
[k]+2;

381 
is1
 = 1;

382 
›1
 = 
nx
[
É
];

383 *
n1
 = 
nx
[
É
]+2;

384 
is2
 = 1;

385 
›2
 = 
ny
[
É
];

386 *
n2
 = 
ny
[
É
]+2;

387 
is3
 = 1;

388 
›3
 = 
nz
[
É
];

389 *
n3
 = 
nz
[
É
]+2;

391 ià(
debug_vec
[1] >= 1 ) {

392 
	`´štf
(" in setup, \n");

393 
	`´štf
("†t‚x‚y‚z‚1‚2‚3 is1 is2 is3 ie1 ie2 ie3\n");

394 
	`´štf
("%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d\n",

395 
É
,
nx
[É],
ny
[É],
nz
[É],*
n1
,*
n2
,*
n3
,
is1
,
is2
,
is3
,
›1
,
›2
,
›3
);

397 
	}
}

402 
	$mg3P
(****
u
, ***
v
, ****
r
, 
a
[4],

403 
c
[4], 
n1
, 
n2
, 
n3
, 
k
) {

412 
j
;

419 
k
 = 
É
; k >ğ
lb
+1; k--) {

420 
j
 = 
k
-1;

421 
	`½rj3
(
r
[
k
], 
m1
[k], 
m2
[k], 
m3
[k],

422 
r
[
j
], 
m1
[j], 
m2
[j], 
m3
[j], 
k
);

425 
k
 = 
lb
;

429 
	`z”o3
(
u
[
k
], 
m1
[k], 
m2
[k], 
m3
[k]);

430 
	`psšv
(
r
[
k
], 
u
[k], 
m1
[k], 
m2
[k], 
m3
[k], 
c
, k);

432 
k
 = 
lb
+1; k <ğ
É
-1; k++) {

433 
j
 = 
k
-1;

437 
	`z”o3
(
u
[
k
], 
m1
[k], 
m2
[k], 
m3
[k]);

438 
	`š‹½
(
u
[
j
], 
m1
[j], 
m2
[j], 
m3
[j],

439 
u
[
k
], 
m1
[k], 
m2
[k], 
m3
[k], k);

443 
	`»sid
(
u
[
k
], 
r
[k],„[k], 
m1
[k], 
m2
[k], 
m3
[k], 
a
, k);

447 
	`psšv
(
r
[
k
], 
u
[k], 
m1
[k], 
m2
[k], 
m3
[k], 
c
, k);

450 
j
 = 
É
 - 1;

451 
k
 = 
É
;

452 
	`š‹½
(
u
[
j
], 
m1
[j], 
m2
[j], 
m3
[j], u[
É
], 
n1
, 
n2
, 
n3
, 
k
);

453 
	`»sid
(
u
[
É
], 
v
, 
r
[É], 
n1
, 
n2
, 
n3
, 
a
, 
k
);

454 
	`psšv
(
r
[
É
], 
u
[É], 
n1
, 
n2
, 
n3
, 
c
, 
k
);

455 
	}
}

460 
	$psšv
Ğ***
r
, ***
u
, 
n1
, 
n2
, 
n3
,

461 
c
[4], 
k
) {

478 
i3
, 
i2
, 
i1
;

479 
r1
[
M
], 
r2
[M];

480 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
,
r1
,
r2
)

481 
i3
 = 1; i3 < 
n3
-1; i3++) {

482 
i2
 = 1; i2 < 
n2
-1; i2++) {

483 
i1
 = 0; i1 < 
n1
; i1++) {

484 
r1
[
i1
] = 
r
[
i3
][
i2
-1][i1] +„[i3][i2+1][i1]

485 + 
r
[
i3
-1][
i2
][
i1
] +„[i3+1][i2][i1];

486 
r2
[
i1
] = 
r
[
i3
-1][
i2
-1][i1] +„[i3-1][i2+1][i1]

487 + 
r
[
i3
+1][
i2
-1][
i1
] +„[i3+1][i2+1][i1];

489 
i1
 = 1; i1 < 
n1
-1; i1++) {

490 
u
[
i3
][
i2
][
i1
] = u[i3][i2][i1]

491 + 
c
[0] * 
r
[
i3
][
i2
][
i1
]

492 + 
c
[1] * ( 
r
[
i3
][
i2
][
i1
-1] +„[i3][i2][i1+1]

493 + 
r1
[
i1
] )

494 + 
c
[2] * ( 
r2
[
i1
] + 
r1
[i1-1] +„1[i1+1] );

507 
	`comm3
(
u
,
n1
,
n2
,
n3
,
k
);

509 ià(
debug_vec
[0] >= 1 ) {

510 
	`»p_Äm
(
u
,
n1
,
n2
,
n3
,"…sšv",
k
);

513 iàĞ
debug_vec
[3] >ğ
k
 ) {

514 
	`show®l
(
u
,
n1
,
n2
,
n3
);

516 
	}
}

521 
	$»sid
Ğ***
u
, ***
v
, ***
r
,

522 
n1
, 
n2
, 
n3
, 
a
[4], 
k
 ) {

540 
i3
, 
i2
, 
i1
;

541 
u1
[
M
], 
u2
[M];

542 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
,
u1
,
u2
)

543 
i3
 = 1; i3 < 
n3
-1; i3++) {

544 
i2
 = 1; i2 < 
n2
-1; i2++) {

545 
i1
 = 0; i1 < 
n1
; i1++) {

546 
u1
[
i1
] = 
u
[
i3
][
i2
-1][i1] + u[i3][i2+1][i1]

547 + 
u
[
i3
-1][
i2
][
i1
] + u[i3+1][i2][i1];

548 
u2
[
i1
] = 
u
[
i3
-1][
i2
-1][i1] + u[i3-1][i2+1][i1]

549 + 
u
[
i3
+1][
i2
-1][
i1
] + u[i3+1][i2+1][i1];

551 
i1
 = 1; i1 < 
n1
-1; i1++) {

552 
r
[
i3
][
i2
][
i1
] = 
v
[i3][i2][i1]

553 - 
a
[0] * 
u
[
i3
][
i2
][
i1
]

560 - 
a
[2] * ( 
u2
[
i1
] + 
u1
[i1-1] + u1[i1+1] )

561 - 
a
[3] * ( 
u2
[
i1
-1] + u2[i1+1] );

569 
	`comm3
(
r
,
n1
,
n2
,
n3
,
k
);

571 ià(
debug_vec
[0] >= 1 ) {

572 
	`»p_Äm
(
r
,
n1
,
n2
,
n3
,"„esid",
k
);

575 iàĞ
debug_vec
[2] >ğ
k
 ) {

576 
	`show®l
(
r
,
n1
,
n2
,
n3
);

578 
	}
}

583 
	$½rj3
Ğ***
r
, 
m1k
, 
m2k
, 
m3k
,

584 ***
s
, 
m1j
, 
m2j
, 
m3j
, 
k
 ) {

599 
j3
, 
j2
, 
j1
, 
i3
, 
i2
, 
i1
, 
d1
, 
d2
, 
d3
;

601 
x1
[
M
], 
y1
[M], 
x2
, 
y2
;

604 ià(
m1k
 == 3) {

605 
d1
 = 2;

607 
d1
 = 1;

610 ià(
m2k
 == 3) {

611 
d2
 = 2;

613 
d2
 = 1;

616 ià(
m3k
 == 3) {

617 
d3
 = 2;

619 
d3
 = 1;

621 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j1
,
j2
,
j3
,
i1
,
i2
,
i3
,
x1
,
y1
,
x2
,
y2
)

622 
j3
 = 1; j3 < 
m3j
-1; j3++) {

623 
i3
 = 2*
j3
-
d3
;

625 
j2
 = 1; j2 < 
m2j
-1; j2++) {

626 
i2
 = 2*
j2
-
d2
;

629 
j1
 = 1; j1 < 
m1j
; j1++) {

630 
i1
 = 2*
j1
-
d1
;

632 
x1
[
i1
] = 
r
[
i3
+1][
i2
][i1] +„[i3+1][i2+2][i1]

633 + 
r
[
i3
][
i2
+1][
i1
] +„[i3+2][i2+1][i1];

634 
y1
[
i1
] = 
r
[
i3
][
i2
][i1] +„[i3+2][i2][i1]

635 + 
r
[
i3
][
i2
+2][
i1
] +„[i3+2][i2+2][i1];

638 
j1
 = 1; j1 < 
m1j
-1; j1++) {

639 
i1
 = 2*
j1
-
d1
;

641 
y2
 = 
r
[
i3
][
i2
][
i1
+1] +„[i3+2][i2][i1+1]

642 + 
r
[
i3
][
i2
+2][
i1
+1] +„[i3+2][i2+2][i1+1];

643 
x2
 = 
r
[
i3
+1][
i2
][
i1
+1] +„[i3+1][i2+2][i1+1]

644 + 
r
[
i3
][
i2
+1][
i1
+1] +„[i3+2][i2+1][i1+1];

645 
s
[
j3
][
j2
][
j1
] =

646 0.5 * 
r
[
i3
+1][
i2
+1][
i1
+1]

647 + 0.25 * ( 
r
[
i3
+1][
i2
+1][
i1
] +„[i3+1][i2+1][i1+2] + 
x2
)

648 + 0.125 * ( 
x1
[
i1
] + x1[i1+2] + 
y2
)

649 + 0.0625 * ( 
y1
[
i1
] + y1[i1+2] );

653 
	`comm3
(
s
,
m1j
,
m2j
,
m3j
,
k
-1);

655 ià(
debug_vec
[0] >= 1 ) {

656 
	`»p_Äm
(
s
,
m1j
,
m2j
,
m3j
,"„´j3",
k
-1);

659 ià(
debug_vec
[4] >ğ
k
 ) {

660 
	`show®l
(
s
,
m1j
,
m2j
,
m3j
);

662 
	}
}

667 
	$š‹½
Ğ***
z
, 
mm1
, 
mm2
, 
mm3
,

668 ***
u
, 
n1
, 
n2
, 
n3
, 
k
 ) {

684 
i3
, 
i2
, 
i1
, 
d1
, 
d2
, 
d3
, 
t1
, 
t2
, 
t3
;

692 
z1
[
M
], 
z2
[M], 
z3
[M];

694 iàĞ
n1
 !ğ3 && 
n2
 !ğ3 && 
n3
 != 3 ) {

695 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
,
z1
,
z2
,
z3
)

696 
i3
 = 0; i3 < 
mm3
-1; i3++) {

697 
i2
 = 0; i2 < 
mm2
-1; i2++) {

698 
i1
 = 0; i1 < 
mm1
; i1++) {

699 
z1
[
i1
] = 
z
[
i3
][
i2
+1][i1] + z[i3][i2][i1];

700 
z2
[
i1
] = 
z
[
i3
+1][
i2
][i1] + z[i3][i2][i1];

701 
z3
[
i1
] = 
z
[
i3
+1][
i2
+1][i1] + z[i3+1][i2][i1] + 
z1
[i1];

703 
i1
 = 0; i1 < 
mm1
-1; i1++) {

704 
u
[2*
i3
][2*
i2
][2*
i1
] = u[2*i3][2*i2][2*i1]

705 +
z
[
i3
][
i2
][
i1
];

706 
u
[2*
i3
][2*
i2
][2*
i1
+1] = u[2*i3][2*i2][2*i1+1]

707 +0.5*(
z
[
i3
][
i2
][
i1
+1]+z[i3][i2][i1]);

709 
i1
 = 0; i1 < 
mm1
-1; i1++) {

710 
u
[2*
i3
][2*
i2
+1][2*
i1
] = u[2*i3][2*i2+1][2*i1]

711 +0.5 * 
z1
[
i1
];

712 
u
[2*
i3
][2*
i2
+1][2*
i1
+1] = u[2*i3][2*i2+1][2*i1+1]

713 +0.25*Ğ
z1
[
i1
] + z1[i1+1] );

715 
i1
 = 0; i1 < 
mm1
-1; i1++) {

716 
u
[2*
i3
+1][2*
i2
][2*
i1
] = u[2*i3+1][2*i2][2*i1]

717 +0.5 * 
z2
[
i1
];

718 
u
[2*
i3
+1][2*
i2
][2*
i1
+1] = u[2*i3+1][2*i2][2*i1+1]

719 +0.25*Ğ
z2
[
i1
] + z2[i1+1] );

721 
i1
 = 0; i1 < 
mm1
-1; i1++) {

722 
u
[2*
i3
+1][2*
i2
+1][2*
i1
] = u[2*i3+1][2*i2+1][2*i1]

723 +0.25* 
z3
[
i1
];

724 
u
[2*
i3
+1][2*
i2
+1][2*
i1
+1] = u[2*i3+1][2*i2+1][2*i1+1]

725 +0.125*Ğ
z3
[
i1
] + z3[i1+1] );

730 ià(
n1
 == 3) {

731 
d1
 = 2;

732 
t1
 = 1;

734 
d1
 = 1;

735 
t1
 = 0;

738 ià(
n2
 == 3) {

739 
d2
 = 2;

740 
t2
 = 1;

742 
d2
 = 1;

743 
t2
 = 0;

746 ià(
n3
 == 3) {

747 
d3
 = 2;

748 
t3
 = 1;

750 
d3
 = 1;

751 
t3
 = 0;

754 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
)

756 #´agm¨
omp
 

757  
i3
 = 
d3
; i3 <ğ
mm3
-1; i3++) {

758  
i2
 = 
d2
; i2 <ğ
mm2
-1; i2++) {

759  
i1
 = 
d1
; i1 <ğ
mm1
-1; i1++) {

760 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1] =

761 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1]

762 +
z
[
i3
-1][
i2
-1][
i1
-1];

764  
i1
 = 1; i1 <ğ
mm1
-1; i1++) {

765 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1] =

766 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1]

767 +0.5*(
z
[
i3
-1][
i2
-1][
i1
]+z[i3-1][i2-1][i1-1]);

770  
i2
 = 1; i2 <ğ
mm2
-1; i2++) {

771  
i1
 = 
d1
; i1 <ğ
mm1
-1; i1++) {

772 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1] =

773 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1]

774 +0.5*(
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

776  
i1
 = 1; i1 <ğ
mm1
-1; i1++) {

777 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1] =

778 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1]

779 +0.25*(
z
[
i3
-1][
i2
][
i1
]+z[i3-1][i2-1][i1]

780 +
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

784 #´agm¨
omp
 
nowa™


785  
i3
 = 1; i3 <ğ
mm3
-1; i3++) {

786  
i2
 = 
d2
; i2 <ğ
mm2
-1; i2++) {

787  
i1
 = 
d1
; i1 <ğ
mm1
-1; i1++) {

788 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1] =

789 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1]

790 +0.5*(
z
[
i3
][
i2
-1][
i1
-1]+z[i3-1][i2-1][i1-1]);

792  
i1
 = 1; i1 <ğ
mm1
-1; i1++) {

793 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1] =

794 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1]

795 +0.25*(
z
[
i3
][
i2
-1][
i1
]+z[i3][i2-1][i1-1]

796 +
z
[
i3
-1][
i2
-1][
i1
]+z[i3-1][i2-1][i1-1]);

799  
i2
 = 1; i2 <ğ
mm2
-1; i2++) {

800  
i1
 = 
d1
; i1 <ğ
mm1
-1; i1++) {

801 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1] =

802 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1]

803 +0.25*(
z
[
i3
][
i2
][
i1
-1]+z[i3][i2-1][i1-1]

804 +
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

806  
i1
 = 1; i1 <ğ
mm1
-1; i1++) {

807 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1] =

808 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1]

809 +0.125*(
z
[
i3
][
i2
][
i1
]+z[i3][i2-1][i1]

810 +
z
[
i3
][
i2
][
i1
-1]+z[i3][i2-1][i1-1]

811 +
z
[
i3
-1][
i2
][
i1
]+z[i3-1][i2-1][i1]

812 +
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

818 ià(
debug_vec
[0] >= 1 ) {

819 
	`»p_Äm
(
z
,
mm1
,
mm2
,
mm3
,"z: iÁ”",
k
-1);

820 
	`»p_Äm
(
u
,
n1
,
n2
,
n3
,"u: iÁ”",
k
);

823 iàĞ
debug_vec
[5] >ğ
k
 ) {

824 
	`show®l
(
z
,
mm1
,
mm2
,
mm3
);

825 
	`show®l
(
u
,
n1
,
n2
,
n3
);

827 
	}
}

832 
	$nÜm2u3
(***
r
, 
n1
, 
n2
, 
n3
,

833 *
ºm2
, *
ºmu
, 
nx
, 
ny
, 
nz
) {

846 
s
 = 0.0;

847 
i3
, 
i2
, 
i1
, 
n
;

848 
a
 = 0.0, 
tmp
 = 0.0;

850 
n
 = 
nx
*
ny
*
nz
;

852 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
,
a
è
	`»duùiÚ
(+:
s
è»duùiÚ(
max
:
tmp
)

853 
i3
 = 1; i3 < 
n3
-1; i3++) {

854 
i2
 = 1; i2 < 
n2
-1; i2++) {

855 
i1
 = 1; i1 < 
n1
-1; i1++) {

856 
s
 = s + 
r
[
i3
][
i2
][
i1
] *„[i3][i2][i1];

857 
a
 = 
	`çbs
(
r
[
i3
][
i2
][
i1
]);

858 ià(
a
 > 
tmp
)mp =‡;

862 *
ºmu
 = 
tmp
;

863 *
ºm2
 = 
	`sq¹
(
s
/()
n
);

864 
	}
}

869 
	$»p_Äm
(***
u
, 
n1
, 
n2
, 
n3
,

870 *
t™Ë
, 
kk
) {

879 
ºm2
, 
ºmu
;

882 
	`nÜm2u3
(
u
,
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[
kk
],
ny
[kk],
nz
[kk]);

883 
	`´štf
(" Level%2d in %8s:‚orms =%21.14e%21.14e\n",

884 
kk
, 
t™Ë
, 
ºm2
, 
ºmu
);

885 
	}
}

890 
	$comm3
(***
u
, 
n1
, 
n2
, 
n3
, 
kk
) {

899 
i1
, 
i2
, 
i3
;

902 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
)

904 #´agm¨
omp
 

905  
i3
 = 1; i3 < 
n3
-1; i3++) {

906  
i2
 = 1; i2 < 
n2
-1; i2++) {

907 
u
[
i3
][
i2
][
n1
-1] = u[i3][i2][1];

908 
u
[
i3
][
i2
][0] = u[i3][i2][
n1
-2];

915  
i1
 = 0; i1 < 
n1
; i1++) {

916 
u
[
i3
][
n2
-1][
i1
] = u[i3][1][i1];

917 
u
[
i3
][0][
i1
] = u[i3][
n2
-2][i1];

922 #´agm¨
omp
 
nowa™


923  
i2
 = 0; i2 < 
n2
; i2++) {

924  
i1
 = 0; i1 < 
n1
; i1++) {

925 
u
[
n3
-1][
i2
][
i1
] = u[1][i2][i1];

926 
u
[0][
i2
][
i1
] = u[
n3
-2][i2][i1];

930 
	}
}

935 
	$z¿n3
(***
z
, 
n1
, 
n2
, 
n3
, 
nx
, 
ny
, 
k
) {

946 
	#MM
 10

	)

947 
__A
=1220703125.e0;

948 
	#A
 
__A


	)

949 
	#X
 314159265.e0

	)

951 
i0
, 
m0
, 
m1
;

952 
i1
, 
i2
, 
i3
, 
d1
, 
e1
, 
e2
, 
e3
;

953 
xx
, 
x0
, 
x1
, 
a1
, 
a2
, 
ai
;

955 
‹n
[
MM
][2], 
be¡
;

956 
i
, 
j1
[
MM
][2], 
j2
[MM][2], 
j3
[MM][2];

957 
jg
[4][
MM
][2];

959 
rdummy
;

961 
a1
 = 
	`pow”
Ğ
A
, 
nx
 );

962 
a2
 = 
	`pow”
Ğ
A
, 
nx
*
ny
 );

964 
	`z”o3
(
z
,
n1
,
n2
,
n3
);

966 
i
 = 
is1
-1+
nx
*(
is2
-1+
ny
*(
is3
-1));

968 
ai
 = 
	`pow”
Ğ
A
, 
i
 );

969 
d1
 = 
›1
 - 
is1
 + 1;

970 
e1
 = 
›1
 - 
is1
 + 2;

971 
e2
 = 
›2
 - 
is2
 + 2;

972 
e3
 = 
›3
 - 
is3
 + 2;

973 
x0
 = 
X
;

974 
rdummy
 = 
	`¿ndlc
Ğ&
x0
, 
ai
 );

976 
i3
 = 1; i3 < 
e3
; i3++) {

977 
x1
 = 
x0
;

978 
i2
 = 1; i2 < 
e2
; i2++) {

979 
xx
 = 
x1
;

980 
	`v¿Æc
Ğ
d1
, &
xx
, 
A
, &(
z
[
i3
][
i2
][0]));

981 
rdummy
 = 
	`¿ndlc
Ğ&
x1
, 
a1
 );

983 
rdummy
 = 
	`¿ndlc
Ğ&
x0
, 
a2
 );

994 
i
 = 0; i < 
MM
; i++) {

995 
‹n
[
i
][1] = 0.0;

996 
j1
[
i
][1] = 0;

997 
j2
[
i
][1] = 0;

998 
j3
[
i
][1] = 0;

999 
‹n
[
i
][0] = 1.0;

1000 
j1
[
i
][0] = 0;

1001 
j2
[
i
][0] = 0;

1002 
j3
[
i
][0] = 0;

1004 
i3
 = 1; i3 < 
n3
-1; i3++) {

1005 
i2
 = 1; i2 < 
n2
-1; i2++) {

1006 
i1
 = 1; i1 < 
n1
-1; i1++) {

1007 iàĞ
z
[
i3
][
i2
][
i1
] > 
‹n
[0][1] ) {

1008 
‹n
[0][1] = 
z
[
i3
][
i2
][
i1
];

1009 
j1
[0][1] = 
i1
;

1010 
j2
[0][1] = 
i2
;

1011 
j3
[0][1] = 
i3
;

1012 
	`bubbË
Ğ
‹n
, 
j1
, 
j2
, 
j3
, 
MM
, 1 );

1014 iàĞ
z
[
i3
][
i2
][
i1
] < 
‹n
[0][0] ) {

1015 
‹n
[0][0] = 
z
[
i3
][
i2
][
i1
];

1016 
j1
[0][0] = 
i1
;

1017 
j2
[0][0] = 
i2
;

1018 
j3
[0][0] = 
i3
;

1019 
	`bubbË
Ğ
‹n
, 
j1
, 
j2
, 
j3
, 
MM
, 0 );

1028 
i1
 = 
MM
 - 1;

1029 
i0
 = 
MM
 - 1;

1030 
i
 = 
MM
 - 1 ; i >= 0; i--) {

1031 
be¡
 = 
z
[
j3
[
i1
][1]][
j2
[i1][1]][
j1
[i1][1]];

1032 ià(
be¡
 =ğ
z
[
j3
[
i1
][1]][
j2
[i1][1]][
j1
[i1][1]]) {

1033 
jg
[0][
i
][1] = 0;

1034 
jg
[1][
i
][1] = 
is1
 - 1 + 
j1
[
i1
][1];

1035 
jg
[2][
i
][1] = 
is2
 - 1 + 
j2
[
i1
][1];

1036 
jg
[3][
i
][1] = 
is3
 - 1 + 
j3
[
i1
][1];

1037 
i1
 = i1-1;

1039 
jg
[0][
i
][1] = 0;

1040 
jg
[1][
i
][1] = 0;

1041 
jg
[2][
i
][1] = 0;

1042 
jg
[3][
i
][1] = 0;

1044 
‹n
[
i
][1] = 
be¡
;

1045 
be¡
 = 
z
[
j3
[
i0
][0]][
j2
[i0][0]][
j1
[i0][0]];

1046 ià(
be¡
 =ğ
z
[
j3
[
i0
][0]][
j2
[i0][0]][
j1
[i0][0]]) {

1047 
jg
[0][
i
][0] = 0;

1048 
jg
[1][
i
][0] = 
is1
 - 1 + 
j1
[
i0
][0];

1049 
jg
[2][
i
][0] = 
is2
 - 1 + 
j2
[
i0
][0];

1050 
jg
[3][
i
][0] = 
is3
 - 1 + 
j3
[
i0
][0];

1051 
i0
 = i0-1;

1053 
jg
[0][
i
][0] = 0;

1054 
jg
[1][
i
][0] = 0;

1055 
jg
[2][
i
][0] = 0;

1056 
jg
[3][
i
][0] = 0;

1058 
‹n
[
i
][0] = 
be¡
;

1060 
m1
 = 
i1
+1;

1061 
m0
 = 
i0
+1;

1091 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
i2
, 
i1
)

1092 
i3
 = 0; i3 < 
n3
; i3++) {

1093 
i2
 = 0; i2 < 
n2
; i2++) {

1094 
i1
 = 0; i1 < 
n1
; i1++) {

1095 
z
[
i3
][
i2
][
i1
] = 0.0;

1099 
i
 = 
MM
-1; i >ğ
m0
; i--) {

1100 
z
[
j3
[
i
][0]][
j2
[i][0]][
j1
[i][0]] = -1.0;

1102 
i
 = 
MM
-1; i >ğ
m1
; i--) {

1103 
z
[
j3
[
i
][1]][
j2
[i][1]][
j1
[i][1]] = 1.0;

1105 
	`comm3
(
z
,
n1
,
n2
,
n3
,
k
);

1110 
	}
}

1115 
	$show®l
(***
z
, 
n1
, 
n2
, 
n3
) {

1120 
i1
,
i2
,
i3
;

1121 
m1
, 
m2
, 
m3
;

1123 
m1
 = 
	`mš
(
n1
,18);

1124 
m2
 = 
	`mš
(
n2
,14);

1125 
m3
 = 
	`mš
(
n3
,18);

1127 
	`´štf
("\n");

1128 
i3
 = 0; i3 < 
m3
; i3++) {

1129 
i1
 = 0; i1 < 
m1
; i1++) {

1130 
i2
 = 0; i2 < 
m2
; i2++) {

1131 
	`´štf
("%6.3f", 
z
[
i3
][
i2
][
i1
]);

1133 
	`´štf
("\n");

1135 
	`´štf
(" - - - - - - - \n");

1137 
	`´štf
("\n");

1138 
	}
}

1143 
	$pow”
Ğ
a
, 
n
 ) {

1152 
aj
;

1153 
nj
;

1154 
rdummy
;

1155 
pow”
;

1157 
pow”
 = 1.0;

1158 
nj
 = 
n
;

1159 
aj
 = 
a
;

1161 
nj
 != 0) {

1162 ifĞ(
nj
%2è=ğ1 ) 
rdummy
 = 
	`¿ndlc
Ğ&
pow”
, 
aj
 );

1163 
rdummy
 = 
	`¿ndlc
Ğ&
aj
,‡j );

1164 
nj
 =‚j/2;

1167  (
pow”
);

1168 
	}
}

1173 
	$bubbË
Ğ
‹n
[
M
][2], 
j1
[M][2], 
j2
[M][2],

1174 
j3
[
M
][2], 
m
, 
šd
 ) {

1183 
‹mp
;

1184 
i
, 
j_‹mp
;

1186 iàĞ
šd
 == 1 ) {

1187 
i
 = 0; i < 
m
-1; i++) {

1188 iàĞ
‹n
[
i
][
šd
] >en[i+1][ind] ) {

1190 
‹mp
 = 
‹n
[
i
+1][
šd
];

1191 
‹n
[
i
+1][
šd
] =en[i][ind];

1192 
‹n
[
i
][
šd
] = 
‹mp
;

1194 
j_‹mp
 = 
j1
[
i
+1][
šd
];

1195 
j1
[
i
+1][
šd
] = j1[i][ind];

1196 
j1
[
i
][
šd
] = 
j_‹mp
;

1198 
j_‹mp
 = 
j2
[
i
+1][
šd
];

1199 
j2
[
i
+1][
šd
] = j2[i][ind];

1200 
j2
[
i
][
šd
] = 
j_‹mp
;

1202 
j_‹mp
 = 
j3
[
i
+1][
šd
];

1203 
j3
[
i
+1][
šd
] = j3[i][ind];

1204 
j3
[
i
][
šd
] = 
j_‹mp
;

1210 
i
 = 0; i < 
m
-1; i++) {

1211 iàĞ
‹n
[
i
][
šd
] <en[i+1][ind] ) {

1213 
‹mp
 = 
‹n
[
i
+1][
šd
];

1214 
‹n
[
i
+1][
šd
] =en[i][ind];

1215 
‹n
[
i
][
šd
] = 
‹mp
;

1217 
j_‹mp
 = 
j1
[
i
+1][
šd
];

1218 
j1
[
i
+1][
šd
] = j1[i][ind];

1219 
j1
[
i
][
šd
] = 
j_‹mp
;

1221 
j_‹mp
 = 
j2
[
i
+1][
šd
];

1222 
j2
[
i
+1][
šd
] = j2[i][ind];

1223 
j2
[
i
][
šd
] = 
j_‹mp
;

1225 
j_‹mp
 = 
j3
[
i
+1][
šd
];

1226 
j3
[
i
+1][
šd
] = j3[i][ind];

1227 
j3
[
i
][
šd
] = 
j_‹mp
;

1233 
	}
}

1238 
	$z”o3
(***
z
, 
n1
, 
n2
, 
n3
) {

1243 
i1
, 
i2
, 
i3
;

1244 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
i1
,
i2
,
i3
)

1245 
i3
 = 0;i3 < 
n3
; i3++) {

1246 
i2
 = 0; i2 < 
n2
; i2++) {

1247 
i1
 = 0; i1 < 
n1
; i1++) {

1248 
z
[
i3
][
i2
][
i1
] = 0.0;

1252 
	}
}

	@MG/npbparams.h

7 
	#NX_DEFAULT
 512

	)

8 
	#NY_DEFAULT
 512

	)

9 
	#NZ_DEFAULT
 512

	)

10 
	#NIT_DEFAULT
 20

	)

11 
	#LM
 9

	)

12 
	#LT_DEFAULT
 9

	)

13 
	#DEBUG_DEFAULT
 0

	)

14 
	#NDIM1
 9

	)

15 
	#NDIM2
 9

	)

16 
	#NDIM3
 9

	)

17 
	#CONVERTDOUBLE
 
FALSE


	)

18 
	#COMPILETIME
 "01 Feb 2021"

	)

19 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

20 
	#CS1
 "ÒÚe)"

	)

21 
	#CS2
 "ÒÚe)"

	)

22 
	#CS3
 "ÒÚe)"

	)

23 
	#CS4
 "ÒÚe)"

	)

24 
	#CS5
 "-o3 $(C_IN)"

	)

25 
	#CS6
 "ÒÚe)"

	)

26 
	#CS7
 "ÒÚe)"

	)

	@SP/header.h

14 
	~"Åb·¿ms.h
"

17 
	ggrid_pošts
[3];

20 
	gtx1
, 
	gtx2
, 
	gtx3
, 
	gty1
, 
	gty2
, 
	gty3
, 
	gtz1
, 
	gtz2
, 
	gtz3
,

21 
	gdx1
, 
	gdx2
, 
	gdx3
, 
	gdx4
, 
	gdx5
, 
	gdy1
, 
	gdy2
, 
	gdy3
, 
	gdy4
,

22 
	gdy5
, 
	gdz1
, 
	gdz2
, 
	gdz3
, 
	gdz4
, 
	gdz5
, 
	gds¥
, 
	gdt
,

23 
	gû
[13][5], 
	gdxmax
, 
	gdymax
, 
	gdzmax
, 
	gxxcÚ1
, 
	gxxcÚ2
,

24 
	gxxcÚ3
, 
	gxxcÚ4
, 
	gxxcÚ5
, 
	gdx1tx1
, 
	gdx2tx1
, 
	gdx3tx1
,

25 
	gdx4tx1
, 
	gdx5tx1
, 
	gyycÚ1
, 
	gyycÚ2
, 
	gyycÚ3
, 
	gyycÚ4
,

26 
	gyycÚ5
, 
	gdy1ty1
, 
	gdy2ty1
, 
	gdy3ty1
, 
	gdy4ty1
, 
	gdy5ty1
,

27 
	gzzcÚ1
, 
	gzzcÚ2
, 
	gzzcÚ3
, 
	gzzcÚ4
, 
	gzzcÚ5
, 
	gdz1tz1
,

28 
	gdz2tz1
, 
	gdz3tz1
, 
	gdz4tz1
, 
	gdz5tz1
, 
	gdnxm1
, 
	gdnym1
,

29 
	gdnzm1
, 
	gc1c2
, 
	gc1c5
, 
	gc3c4
, 
	gc1345
, 
	gcÚz1
, 
	gc1
, 
	gc2
,

30 
	gc3
, 
	gc4
, 
	gc5
, 
	gc4ds¥
, 
	gc5ds¥
, 
	gdtds¥
, 
	gd‰x1
, 
	gbt
,

31 
	gd‰x2
, 
	gd‰y1
, 
	gd‰y2
, 
	gd‰z1
, 
	gd‰z2
, 
	gc2d‰x1
,

32 
	gc2d‰y1
, 
	gc2d‰z1
, 
	gcomz1
, 
	gcomz4
, 
	gcomz5
, 
	gcomz6
,

33 
	gc3c4tx3
, 
	gc3c4ty3
, 
	gc3c4tz3
, 
	gc2iv
, 
	gcÚ43
, 
	gcÚ16
;

36 
	#IMAX
 
PROBLEM_SIZE


	)

37 
	#JMAX
 
PROBLEM_SIZE


	)

38 
	#KMAX
 
PROBLEM_SIZE


	)

46 
	gu
 [5][
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

47 
	gus
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

48 
	gvs
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

49 
	gws
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

50 
	gqs
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

51 
	gašv
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

52 
	grho_i
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

53 
	g¥“d
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

54 
	gsqu¬e
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

55 
	grhs
 [5][
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

56 
	gfÜcšg
 [5][
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

57 
	glhs
 [15][
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1];

60 
	gcv
[
PROBLEM_SIZE
], 
	grhÚ
[PROBLEM_SIZE],

61 
	grhos
[
PROBLEM_SIZE
], 
	grhoq
[PROBLEM_SIZE],

62 
	gcuf
[
PROBLEM_SIZE
], 
	gq
[PROBLEM_SIZE],

63 
	gue
[5][
PROBLEM_SIZE
], 
	gbuf
[5][PROBLEM_SIZE];

	@SP/npbparams.h

7 
	#PROBLEM_SIZE
 162

	)

8 
	#NITER_DEFAULT
 400

	)

9 
	#DT_DEFAULT
 0.00067

	)

10 
	#CONVERTDOUBLE
 
FALSE


	)

11 
	#COMPILETIME
 "01 Feb 2021"

	)

12 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

13 
	#CS1
 "ÒÚe)"

	)

14 
	#CS2
 "ÒÚe)"

	)

15 
	#CS3
 "ÒÚe)"

	)

16 
	#CS4
 "ÒÚe)"

	)

17 
	#CS5
 "-o3 $(C_IN)"

	)

18 
	#CS6
 "ÒÚe)"

	)

19 
	#CS7
 "ÒÚe)"

	)

	@SP/sp.c

34 
	~"../commÚ/Åb-C.h
"

35 
	~"../m©h/Çs_m©h.h
"

36 
	~<Çutus/Çutus.h
>

37 
	~<Çutus/sh–l.h
>

39 
	~"h—d”.h
"

42 
add
();

43 
adi
();

44 
”rÜ_nÜm
(
rms
[5]);

45 
rhs_nÜm
(
rms
[5]);

46 
exaù_rhs
();

47 
exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

48 
d‹mp
[5]);

49 
š™Ÿlize
();

50 
lhsš™
();

51 
lhsx
();

52 
lhsy
();

53 
lhsz
();

54 
nšvr
();

55 
pšvr
();

56 
compu‹_rhs
();

57 
£t_cÚ¡ªts
();

58 
txšvr
();

59 
tz‘¬
();

60 
v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
);

61 
x_sŞve
();

62 
y_sŞve
();

63 
z_sŞve
();

68 
´og¿m_SP
(*
_buf
, * 
_´iv
);

69 
´og¿m_SP_´ofe
(*
_
, *
__
);

71 
sh–l_cmd_im¶
 
	gÇs_¥_im¶
 = {

72 .
cmd
 = "nas-sp",

73 .
	gh–p_¡r
 = "NAS…arallel benchmark SP",

74 .
	ghªdËr
 = 
´og¿m_SP_´ofe
,

76 
nk_»gi¡”_sh–l_cmd
(
Çs_¥_im¶
);

79 
	$´og¿m_SP_´ofe
(*
_
, *
__
){

81 #ifdeà
NAUT_CONFIG_PROFILE


82 
	`nk_š¡rum’t_ş—r
();

83 
	`nk_š¡rum’t_¡¬t
();

85 
	`´og¿m_SP
(
_
,
__
);

86 #ifdeà
NAUT_CONFIG_PROFILE


87 
	`nk_š¡rum’t_’d
();

88 
	`nk_š¡rum’t_qu”y
();

91 
	}
}

94 
	$´og¿m_SP
(* 
_buf
, * 
_´iv
) {

96 
n™”
, 
¡•
;

97 
mæİs
, 
tmax
;

98 
Áh»ads
 = 1;

99 
boŞ—n
 
v”if›d
;

100 
şass
;

108 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

124 
n™”
 = 
NITER_DEFAULT
;

125 
dt
 = 
DT_DEFAULT
;

126 
grid_pošts
[0] = 
PROBLEM_SIZE
;

127 
grid_pošts
[1] = 
PROBLEM_SIZE
;

128 
grid_pošts
[2] = 
PROBLEM_SIZE
;

131 
	`´štf
(" Size: %3dx%3dx%3d\n",

132 
grid_pošts
[0], grid_points[1], grid_points[2]);

133 
	`´štf
(" I‹¿tiÚs: %3d dt: %10.6f\n", 
n™”
, 
dt
);

135 iàĞ(
grid_pošts
[0] > 
IMAX
) ||

136 (
grid_pošts
[1] > 
JMAX
) ||

137 (
grid_pošts
[2] > 
KMAX
) ) {

138 
	`´štf
("%d, %d, %d\n", 
grid_pošts
[0], grid_points[1], grid_points[2]);

139 
	`´štf
(" Problem sizeoo big for compiled‡rray sizes\n");

140 
	`ex™
(1);

143 
	`£t_cÚ¡ªts
();

145 
	`š™Ÿlize
();

147 
	`lhsš™
();

149 
	`exaù_rhs
();

156 
	`adi
();

159 
	`š™Ÿlize
();

161 
	`tim”_ş—r
(1);

162 
	`tim”_¡¬t
(1);

164 
¡•
 = 1; s‹°<ğ
n™”
; step++) {

165 ià(
¡•
 % 20 == 0 || step == 1) {

167 
	`´štf
(" Tim¡• %4d\n", 
¡•
);

169 
	`adi
();

171 #´agm¨
omp
 
·¿Î–


173 #ià
	`defšed
(
_OPENMP
)

174 #´agm¨
omp
 
ma¡”


175 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

179 
	`tim”_¡İ
(1);

180 
tmax
 = 
	`tim”_»ad
(1);

182 
	`v”ify
(
n™”
, &
şass
, &
v”if›d
);

184 ià(
tmax
 != 0) {

185 
mæİs
 = ( 881.174 * (()
PROBLEM_SIZE
*PROBLEM_SIZE*PROBLEM_SIZE)

186 - 4683.91 * 
	`pow2
(()
PROBLEM_SIZE
)

187 + 11484.5 * ()
PROBLEM_SIZE


188 - 19272.4è* ()
n™”
 / (
tmax
*1000000.0);

190 
mæİs
 = 0.0;

193 
	`c_´št_»suÉs
("SP", 
şass
, 
grid_pošts
[0],

194 
grid_pošts
[1], grid_pošts[2], 
n™”
, 
Áh»ads
,

195 
tmax
, 
mæİs
, " floating…oint",

196 
v”if›d
, 
NPBVERSION
, 
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
,

197 
CS6
, "(none)");

198 
	}
}

203 
	$add
() {

204 
i
, 
j
, 
k
, 
m
;

212 #´agm¨
omp
 

213 
m
 = 0; m < 5; m++) {

214 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

215 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

216 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

217 
u
[
m
][
i
][
j
][
k
] = u[m][i][j][k] + 
rhs
[m][i][j][k];

222 
	}
}

227 
	$adi
() {

231 
	`compu‹_rhs
();

233 
	`txšvr
();

235 
	`x_sŞve
();

237 
	`y_sŞve
();

239 
	`z_sŞve
();

241 
	`add
();

243 
	}
}

248 
	$”rÜ_nÜm
(
rms
[5]) {

258 
i
, 
j
, 
k
, 
m
, 
d
;

259 
xi
, 
‘a
, 
z‘a
, 
u_exaù
[5], 
add
;

261 
m
 = 0; m < 5; m++) {

262 
rms
[
m
] = 0.0;

265 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

266 
xi
 = ()
i
 * 
dnxm1
;

267 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

268 
‘a
 = ()
j
 * 
dnym1
;

269 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

270 
z‘a
 = ()
k
 * 
dnzm1
;

271 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
u_exaù
);

272 
m
 = 0; m < 5; m++) {

273 
add
 = 
u
[
m
][
i
][
j
][
k
] - 
u_exaù
[m];

274 
rms
[
m
] =„ms[m] + 
add
*add;

280 
m
 = 0; m < 5; m++) {

281 
d
 = 0; d < 3; d++) {

282 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

284 
rms
[
m
] = 
	`sq¹
(rms[m]);

286 
	}
}

291 
	$rhs_nÜm
(
rms
[5]) {

296 
i
, 
j
, 
k
, 
d
, 
m
;

297 
add
;

299 
m
 = 0; m < 5; m++) {

300 
rms
[
m
] = 0.0;

303 
i
 = 0; i <ğ
grid_pošts
[0]-2; i++) {

304 
j
 = 0; j <ğ
grid_pošts
[1]-2; j++) {

305 
k
 = 0; k <ğ
grid_pošts
[2]-2; k++) {

306 
m
 = 0; m < 5; m++) {

307 
add
 = 
rhs
[
m
][
i
][
j
][
k
];

308 
rms
[
m
] =„ms[m] + 
add
*add;

314 
m
 = 0; m < 5; m++) {

315 
d
 = 0; d < 3; d++) {

316 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

318 
rms
[
m
] = 
	`sq¹
(rms[m]);

320 
	}
}

325 
	$exaù_rhs
() {

334 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

335 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

340 
m
 = 0; m < 5; m++) {

341 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

342 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

343 
k
ğ0; k <ğ
grid_pošts
[2]-1; k++) {

344 
fÜcšg
[
m
][
i
][
j
][
k
] = 0.0;

353 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

354 
z‘a
 = ()
k
 * 
dnzm1
;

355 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

356 
‘a
 = ()
j
 * 
dnym1
;

358 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

359 
xi
 = ()
i
 * 
dnxm1
;

361 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

362 
m
 = 0; m < 5; m++) {

363 
ue
[
m
][
i
] = 
d‹mp
[m];

366 
dp
 = 1.0 / 
d‹mp
[0];

368 
m
 = 1; m < 5; m++) {

369 
buf
[
m
][
i
] = 
dp
 * 
d‹mp
[m];

372 
cuf
[
i
] = 
buf
[1][i] * buf[1][i];

373 
buf
[0][
i
] = 
cuf
[i] + buf[2][i] * buf[2][i] + buf[3][i] * buf[3][i];

374 
q
[
i
] = 0.5 * (
buf
[1][i]*
ue
[1][i] + buf[2][i]*ue[2][i]

375 + 
buf
[3][
i
]*
ue
[3][i]);

378 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

379 
im1
 = 
i
-1;

380 
1
 = 
i
+1;

382 
fÜcšg
[0][
i
][
j
][
k
] = forcing[0][i][j][k] -

383 
tx2
*Ğ
ue
[1][
1
]-ue[1][
im1
] )+

384 
dx1tx1
*(
ue
[0][
1
]-2.0*ue[0][
i
]+ue[0][
im1
]);

386 
fÜcšg
[1][
i
][
j
][
k
] = forcing[1][i][j][k]

387 - 
tx2
 * ((
ue
[1][
1
]*
buf
[1][1]+
c2
*(ue[4][1]-
q
[ip1]))-

388 (
ue
[1][
im1
]*
buf
[1][im1]+
c2
*(ue[4][im1]-
q
[im1])))+

389 
xxcÚ1
*(
buf
[1][
1
]-2.0*buf[1][
i
]+buf[1][
im1
])+

390 
dx2tx1
*Ğ
ue
[1][
1
]-2.0* ue[1][
i
]+ue[1][
im1
]);

392 
fÜcšg
[2][
i
][
j
][
k
] = forcing[2][i][j][k]

393 - 
tx2
 * (
ue
[2][
1
]*
buf
[1][1]-ue[2][
im1
]*buf[1][im1])+

394 
xxcÚ2
*(
buf
[2][
1
]-2.0*buf[2][
i
]+buf[2][
im1
])+

395 
dx3tx1
*Ğ
ue
[2][
1
]-2.0*ue[2][
i
] +ue[2][
im1
]);

397 
fÜcšg
[3][
i
][
j
][
k
] = forcing[3][i][j][k]

398 - 
tx2
*(
ue
[3][
1
]*
buf
[1][1]-ue[3][
im1
]*buf[1][im1])+

399 
xxcÚ2
*(
buf
[3][
1
]-2.0*buf[3][
i
]+buf[3][
im1
])+

400 
dx4tx1
*Ğ
ue
[3][
1
]-2.0* ue[3][
i
]+ ue[3][
im1
]);

402 
fÜcšg
[4][
i
][
j
][
k
] = forcing[4][i][j][k]

403 - 
tx2
*(
buf
[1][
1
]*(
c1
*
ue
[4][1]-
c2
*
q
[ip1])-

404 
buf
[1][
im1
]*(
c1
*
ue
[4][im1]-
c2
*
q
[im1]))+

405 0.5*
xxcÚ3
*(
buf
[0][
1
]-2.0*buf[0][
i
]+

406 
buf
[0][
im1
])+

407 
xxcÚ4
*(
cuf
[
1
]-2.0*cuf[
i
]+cuf[
im1
])+

408 
xxcÚ5
*(
buf
[4][
1
]-2.0*buf[4][
i
]+buf[4][
im1
])+

409 
dx5tx1
*Ğ
ue
[4][
1
]-2.0* ue[4][
i
]+ ue[4][
im1
]);

415 
m
 = 0; m < 5; m++) {

416 
i
 = 1;

417 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

418 (5.0*
ue
[
m
][
i
] - 4.0*ue[m][i+1] +ue[m][i+2]);

419 
i
 = 2;

420 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

421 (-4.0*
ue
[
m
][
i
-1] + 6.0*ue[m][i] -

422 4.0*
ue
[
m
][
i
+1] + ue[m][i+2]);

425 
m
 = 0; m < 5; m++) {

426 
i
 = 3; i <ğ
grid_pošts
[0]-4; i++) {

427 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
*

428 (
ue
[
m
][
i
-2] - 4.0*ue[m][i-1] +

429 6.0*
ue
[
m
][
i
] - 4.0*ue[m][i+1] + ue[m][i+2]);

433 
m
 = 0; m < 5; m++) {

434 
i
 = 
grid_pošts
[0]-3;

435 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

436 (
ue
[
m
][
i
-2] - 4.0*ue[m][i-1] +

437 6.0*
ue
[
m
][
i
] - 4.0*ue[m][i+1]);

438 
i
 = 
grid_pošts
[0]-2;

439 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

440 (
ue
[
m
][
i
-2] - 4.0*ue[m][i-1] + 5.0*ue[m][i]);

448 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

449 
z‘a
 = ()
k
 * 
dnzm1
;

450 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

451 
xi
 = ()
i
 * 
dnxm1
;

453 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

454 
‘a
 = ()
j
 * 
dnym1
;

456 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

457 
m
 = 0; m < 5; m++) {

458 
ue
[
m
][
j
] = 
d‹mp
[m];

460 
dp
 = 1.0/
d‹mp
[0];

462 
m
 = 1; m < 5; m++) {

463 
buf
[
m
][
j
] = 
dp
 * 
d‹mp
[m];

466 
cuf
[
j
] = 
buf
[2][j] * buf[2][j];

467 
buf
[0][
j
] = 
cuf
[j] + buf[1][j] * buf[1][j] +

468 
buf
[3][
j
] * buf[3][j];

469 
q
[
j
] = 0.5*(
buf
[1][j]*
ue
[1][j] + buf[2][j]*ue[2][j] +

470 
buf
[3][
j
]*
ue
[3][j]);

473 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

474 
jm1
 = 
j
-1;

475 
jp1
 = 
j
+1;

477 
fÜcšg
[0][
i
][
j
][
k
] = forcing[0][i][j][k] -

478 
ty2
*Ğ
ue
[2][
jp1
]-ue[2][
jm1
] )+

479 
dy1ty1
*(
ue
[0][
jp1
]-2.0*ue[0][
j
]+ue[0][
jm1
]);

481 
fÜcšg
[1][
i
][
j
][
k
] = forcing[1][i][j][k]

482 - 
ty2
*(
ue
[1][
jp1
]*
buf
[2][jp1]-ue[1][
jm1
]*buf[2][jm1])+

483 
yycÚ2
*(
buf
[1][
jp1
]-2.0*buf[1][
j
]+buf[1][
jm1
])+

484 
dy2ty1
*Ğ
ue
[1][
jp1
]-2.0* ue[1][
j
]+ ue[1][
jm1
]);

486 
fÜcšg
[2][
i
][
j
][
k
] = forcing[2][i][j][k]

487 - 
ty2
*((
ue
[2][
jp1
]*
buf
[2][jp1]+
c2
*(ue[4][jp1]-
q
[jp1]))-

488 (
ue
[2][
jm1
]*
buf
[2][jm1]+
c2
*(ue[4][jm1]-
q
[jm1])))+

489 
yycÚ1
*(
buf
[2][
jp1
]-2.0*buf[2][
j
]+buf[2][
jm1
])+

490 
dy3ty1
*Ğ
ue
[2][
jp1
]-2.0*ue[2][
j
] +ue[2][
jm1
]);

492 
fÜcšg
[3][
i
][
j
][
k
] = forcing[3][i][j][k]

493 - 
ty2
*(
ue
[3][
jp1
]*
buf
[2][jp1]-ue[3][
jm1
]*buf[2][jm1])+

494 
yycÚ2
*(
buf
[3][
jp1
]-2.0*buf[3][
j
]+buf[3][
jm1
])+

495 
dy4ty1
*Ğ
ue
[3][
jp1
]-2.0*ue[3][
j
]+ ue[3][
jm1
]);

497 
fÜcšg
[4][
i
][
j
][
k
] = forcing[4][i][j][k]

498 - 
ty2
*(
buf
[2][
jp1
]*(
c1
*
ue
[4][jp1]-
c2
*
q
[jp1])-

499 
buf
[2][
jm1
]*(
c1
*
ue
[4][jm1]-
c2
*
q
[jm1]))+

500 0.5*
yycÚ3
*(
buf
[0][
jp1
]-2.0*buf[0][
j
]+

501 
buf
[0][
jm1
])+

502 
yycÚ4
*(
cuf
[
jp1
]-2.0*cuf[
j
]+cuf[
jm1
])+

503 
yycÚ5
*(
buf
[4][
jp1
]-2.0*buf[4][
j
]+buf[4][
jm1
])+

504 
dy5ty1
*(
ue
[4][
jp1
]-2.0*ue[4][
j
]+ue[4][
jm1
]);

510 
m
 = 0; m < 5; m++) {

511 
j
 = 1;

512 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

513 (5.0*
ue
[
m
][
j
] - 4.0*ue[m][j+1] +ue[m][j+2]);

514 
j
 = 2;

515 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

516 (-4.0*
ue
[
m
][
j
-1] + 6.0*ue[m][j] -

517 4.0*
ue
[
m
][
j
+1] + ue[m][j+2]);

520 
m
 = 0; m < 5; m++) {

521 
j
 = 3; j <ğ
grid_pošts
[1]-4; j++) {

522 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
*

523 (
ue
[
m
][
j
-2] - 4.0*ue[m][j-1] +

524 6.0*
ue
[
m
][
j
] - 4.0*ue[m][j+1] + ue[m][j+2]);

528 
m
 = 0; m < 5; m++) {

529 
j
 = 
grid_pošts
[1]-3;

530 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

531 (
ue
[
m
][
j
-2] - 4.0*ue[m][j-1] +

532 6.0*
ue
[
m
][
j
] - 4.0*ue[m][j+1]);

533 
j
 = 
grid_pošts
[1]-2;

534 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

535 (
ue
[
m
][
j
-2] - 4.0*ue[m][j-1] + 5.0*ue[m][j]);

544 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

545 
‘a
 = ()
j
 * 
dnym1
;

546 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

547 
xi
 = ()
i
 * 
dnxm1
;

549 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

550 
z‘a
 = ()
k
 * 
dnzm1
;

552 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

553 
m
 = 0; m < 5; m++) {

554 
ue
[
m
][
k
] = 
d‹mp
[m];

557 
dp
 = 1.0/
d‹mp
[0];

559 
m
 = 1; m < 5; m++) {

560 
buf
[
m
][
k
] = 
dp
 * 
d‹mp
[m];

563 
cuf
[
k
] = 
buf
[3][k] * buf[3][k];

564 
buf
[0][
k
] = 
cuf
[k] + buf[1][k] * buf[1][k] +

565 
buf
[2][
k
] * buf[2][k];

566 
q
[
k
] = 0.5*(
buf
[1][k]*
ue
[1][k] + buf[2][k]*ue[2][k] +

567 
buf
[3][
k
]*
ue
[3][k]);

570 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

571 
km1
 = 
k
-1;

572 
kp1
 = 
k
+1;

574 
fÜcšg
[0][
i
][
j
][
k
] = forcing[0][i][j][k] -

575 
tz2
*Ğ
ue
[3][
kp1
]-ue[3][
km1
] )+

576 
dz1tz1
*(
ue
[0][
kp1
]-2.0*ue[0][
k
]+ue[0][
km1
]);

578 
fÜcšg
[1][
i
][
j
][
k
] = forcing[1][i][j][k]

579 - 
tz2
 * (
ue
[1][
kp1
]*
buf
[3][kp1]-ue[1][
km1
]*buf[3][km1])+

580 
zzcÚ2
*(
buf
[1][
kp1
]-2.0*buf[1][
k
]+buf[1][
km1
])+

581 
dz2tz1
*Ğ
ue
[1][
kp1
]-2.0* ue[1][
k
]+ ue[1][
km1
]);

583 
fÜcšg
[2][
i
][
j
][
k
] = forcing[2][i][j][k]

584 - 
tz2
 * (
ue
[2][
kp1
]*
buf
[3][kp1]-ue[2][
km1
]*buf[3][km1])+

585 
zzcÚ2
*(
buf
[2][
kp1
]-2.0*buf[2][
k
]+buf[2][
km1
])+

586 
dz3tz1
*(
ue
[2][
kp1
]-2.0*ue[2][
k
]+ue[2][
km1
]);

588 
fÜcšg
[3][
i
][
j
][
k
] = forcing[3][i][j][k]

589 - 
tz2
 * ((
ue
[3][
kp1
]*
buf
[3][kp1]+
c2
*(ue[4][kp1]-
q
[kp1]))-

590 (
ue
[3][
km1
]*
buf
[3][km1]+
c2
*(ue[4][km1]-
q
[km1])))+

591 
zzcÚ1
*(
buf
[3][
kp1
]-2.0*buf[3][
k
]+buf[3][
km1
])+

592 
dz4tz1
*Ğ
ue
[3][
kp1
]-2.0*ue[3][
k
] +ue[3][
km1
]);

594 
fÜcšg
[4][
i
][
j
][
k
] = forcing[4][i][j][k]

595 - 
tz2
 * (
buf
[3][
kp1
]*(
c1
*
ue
[4][kp1]-
c2
*
q
[kp1])-

596 
buf
[3][
km1
]*(
c1
*
ue
[4][km1]-
c2
*
q
[km1]))+

597 0.5*
zzcÚ3
*(
buf
[0][
kp1
]-2.0*buf[0][
k
]

598 +
buf
[0][
km1
])+

599 
zzcÚ4
*(
cuf
[
kp1
]-2.0*cuf[
k
]+cuf[
km1
])+

600 
zzcÚ5
*(
buf
[4][
kp1
]-2.0*buf[4][
k
]+buf[4][
km1
])+

601 
dz5tz1
*Ğ
ue
[4][
kp1
]-2.0*ue[4][
k
]+ ue[4][
km1
]);

607 
m
 = 0; m < 5; m++) {

608 
k
 = 1;

609 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

610 (5.0*
ue
[
m
][
k
] - 4.0*ue[m][k+1] +ue[m][k+2]);

611 
k
 = 2;

612 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

613 (-4.0*
ue
[
m
][
k
-1] + 6.0*ue[m][k] -

614 4.0*
ue
[
m
][
k
+1] + ue[m][k+2]);

617 
m
 = 0; m < 5; m++) {

618 
k
 = 3; k <ğ
grid_pošts
[2]-4; k++) {

619 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
*

620 (
ue
[
m
][
k
-2] - 4.0*ue[m][k-1] +

621 6.0*
ue
[
m
][
k
] - 4.0*ue[m][k+1] + ue[m][k+2]);

625 
m
 = 0; m < 5; m++) {

626 
k
 = 
grid_pošts
[2]-3;

627 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

628 (
ue
[
m
][
k
-2] - 4.0*ue[m][k-1] +

629 6.0*
ue
[
m
][
k
] - 4.0*ue[m][k+1]);

630 
k
 = 
grid_pošts
[2]-2;

631 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

632 (
ue
[
m
][
k
-2] - 4.0*ue[m][k-1] + 5.0*ue[m][k]);

640 
m
 = 0; m < 5; m++) {

641 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

642 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

643 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

644 
fÜcšg
[
m
][
i
][
j
][
k
] = -1.0 * forcing[m][i][j][k];

649 
	}
}

654 
	$exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

655 
d‹mp
[5]) {

664 
m
;

666 
m
 = 0; m < 5; m++) {

667 
d‹mp
[
m
] = 
û
[0][m] +

668 
xi
*(
û
[1][
m
] + xi*(ce[4][m] +

669 
xi
*(
û
[7][
m
] + xi*ce[10][m]))) +

670 
‘a
*(
û
[2][
m
] +ƒta*(ce[5][m] +

671 
‘a
*(
û
[8][
m
] +ƒta*ce[11][m])))+

672 
z‘a
*(
û
[3][
m
] + zeta*(ce[6][m] +

673 
z‘a
*(
û
[9][
m
] +

674 
z‘a
*
û
[12][
m
])));

676 
	}
}

681 
	$š™Ÿlize
() {

691 
i
, 
j
, 
k
, 
m
, 
ix
, 
iy
, 
iz
;

692 
xi
, 
‘a
, 
z‘a
, 
Pçû
[2][3][5], 
Pxi
, 
P‘a
, 
Pz‘a
, 
‹mp
[5];

701 
i
 = 0; i <ğ
IMAX
-1; i++) {

702 
j
 = 0; j <ğ
IMAX
-1; j++) {

703 
k
 = 0; k <ğ
IMAX
-1; k++) {

704 
u
[0][
i
][
j
][
k
] = 1.0;

705 
u
[1][
i
][
j
][
k
] = 0.0;

706 
u
[2][
i
][
j
][
k
] = 0.0;

707 
u
[3][
i
][
j
][
k
] = 0.0;

708 
u
[4][
i
][
j
][
k
] = 1.0;

717 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

718 
xi
 = ()
i
 * 
dnxm1
;

719 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

720 
‘a
 = ()
j
 * 
dnym1
;

721 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

722 
z‘a
 = ()
k
 * 
dnzm1
;

724 
ix
 = 0; ix < 2; ix++) {

725 
	`exaù_sŞutiÚ
(()
ix
, 
‘a
, 
z‘a
,

726 &
Pçû
[
ix
][0][0]);

729 
iy
 = 0; iy < 2; iy++) {

730 
	`exaù_sŞutiÚ
(
xi
, ()
iy
 , 
z‘a
,

731 &
Pçû
[
iy
][1][0]);

734 
iz
 = 0; iz < 2; iz++) {

735 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, ()
iz
,

736 &
Pçû
[
iz
][2][0]);

739 
m
 = 0; m < 5; m++) {

740 
Pxi
 = 
xi
 * 
Pçû
[1][0][
m
] +

741 (1.0-
xi
è* 
Pçû
[0][0][
m
];

742 
P‘a
 = 
‘a
 * 
Pçû
[1][1][
m
] +

743 (1.0-
‘a
è* 
Pçû
[0][1][
m
];

744 
Pz‘a
 = 
z‘a
 * 
Pçû
[1][2][
m
] +

745 (1.0-
z‘a
è* 
Pçû
[0][2][
m
];

747 
u
[
m
][
i
][
j
][
k
] = 
Pxi
 + 
P‘a
 + 
Pz‘a
 -

748 
Pxi
*
P‘a
 - Pxi*
Pz‘a
 - Peta*Pzeta +

749 
Pxi
*
P‘a
*
Pz‘a
;

764 
xi
 = 0.0;

765 
i
 = 0;

766 
j
 = 0; j < 
grid_pošts
[1]; j++) {

767 
‘a
 = ()
j
 * 
dnym1
;

768 
k
 = 0; k < 
grid_pošts
[2]; k++) {

769 
z‘a
 = ()
k
 * 
dnzm1
;

770 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

771 
m
 = 0; m < 5; m++) {

772 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

781 
xi
 = 1.0;

782 
i
 = 
grid_pošts
[0]-1;

783 
j
 = 0; j < 
grid_pošts
[1]; j++) {

784 
‘a
 = ()
j
 * 
dnym1
;

785 
k
 = 0; k < 
grid_pošts
[2]; k++) {

786 
z‘a
 = ()
k
 * 
dnzm1
;

787 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

788 
m
 = 0; m < 5; m++) {

789 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

798 
‘a
 = 0.0;

799 
j
 = 0;

800 
i
 = 0; i < 
grid_pošts
[0]; i++) {

801 
xi
 = ()
i
 * 
dnxm1
;

802 
k
 = 0; k < 
grid_pošts
[2]; k++) {

803 
z‘a
 = ()
k
 * 
dnzm1
;

804 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

805 
m
 = 0; m < 5; m++) {

806 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

815 
‘a
 = 1.0;

816 
j
 = 
grid_pošts
[1]-1;

817 
i
 = 0; i < 
grid_pošts
[0]; i++) {

818 
xi
 = ()
i
 * 
dnxm1
;

819 
k
 = 0; k < 
grid_pošts
[2]; k++) {

820 
z‘a
 = ()
k
 * 
dnzm1
;

821 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

822 
m
 = 0; m < 5; m++) {

823 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

832 
z‘a
 = 0.0;

833 
k
 = 0;

834 
i
 = 0; i < 
grid_pošts
[0]; i++) {

835 
xi
 = ()
i
 *
dnxm1
;

836 
j
 = 0; j < 
grid_pošts
[1]; j++) {

837 
‘a
 = ()
j
 * 
dnym1
;

838 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

839 
m
 = 0; m < 5; m++) {

840 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

849 
z‘a
 = 1.0;

850 
k
 = 
grid_pošts
[2]-1;

851 
i
 = 0; i < 
grid_pošts
[0]; i++) {

852 
xi
 = ()
i
 * 
dnxm1
;

853 
j
 = 0; j < 
grid_pošts
[1]; j++) {

854 
‘a
 = ()
j
 * 
dnym1
;

855 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

856 
m
 = 0; m < 5; m++) {

857 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

861 
	}
}

867 
	$lhsš™
() {

872 
i
, 
j
, 
k
, 
n
;

877 
n
 = 0;‚ < 15;‚++) {

878 #´agm¨
omp
 
nowa™


879 
i
 = 0; i < 
grid_pošts
[0]; i++) {

880 
j
 = 0; j < 
grid_pošts
[1]; j++) {

881 
k
 = 0; k < 
grid_pošts
[2]; k++) {

882 
lhs
[
n
][
i
][
j
][
k
] = 0.0;

887 #´agm¨
omp
 
b¬r›r


893 
n
 = 0;‚ < 3;‚++) {

894 #´agm¨
omp
 

895 
i
 = 0; i < 
grid_pošts
[0]; i++) {

896 
j
 = 0; j < 
grid_pošts
[1]; j++) {

897 
k
 = 0; k < 
grid_pošts
[2]; k++) {

898 
lhs
[5*
n
+2][
i
][
j
][
k
] = 1.0;

903 
	}
}

908 
	$lhsx
() {

917 
ru1
;

918 
i
, 
j
, 
k
;

923 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

924 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

925 #´agm¨
omp
 

926 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

927 
ru1
 = 
c3c4
*
rho_i
[
i
][
j
][
k
];

928 
cv
[
i
] = 
us
[i][
j
][
k
];

929 
rhÚ
[
i
] = 
	`max
(
dx2
+
cÚ43
*
ru1
,

930 
	`max
(
dx5
+
c1c5
*
ru1
,

931 
	`max
(
dxmax
+
ru1
,

932 
dx1
)));

935 #´agm¨
omp
 

936 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

937 
lhs
[0][
i
][
j
][
k
] = 0.0;

938 
lhs
[1][
i
][
j
][
k
] = - 
d‰x2
 * 
cv
[i-1] - 
d‰x1
 * 
rhÚ
[i-1];

939 
lhs
[2][
i
][
j
][
k
] = 1.0 + 
c2d‰x1
 * 
rhÚ
[i];

940 
lhs
[3][
i
][
j
][
k
] = 
d‰x2
 * 
cv
[i+1] - 
d‰x1
 * 
rhÚ
[i+1];

941 
lhs
[4][
i
][
j
][
k
] = 0.0;

950 
i
 = 1;

951 #´agm¨
omp
 
nowa™


952 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

953 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

954 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz5
;

955 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

956 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

957 
lhs
[1][
i
+1][
j
][
k
] =†hs[1][i+1][j][k] - 
comz4
;

958 
lhs
[2][
i
+1][
j
][
k
] =†hs[2][i+1][j][k] + 
comz6
;

959 
lhs
[3][
i
+1][
j
][
k
] =†hs[3][i+1][j][k] - 
comz4
;

960 
lhs
[4][
i
+1][
j
][
k
] =†hs[4][i+1][j][k] + 
comz1
;

964 #´agm¨
omp
 
nowa™


965 
i
 = 3; i <ğ
grid_pošts
[0]-4; i++) {

966 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

967 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

968 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

969 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

970 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

971 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

972 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

977 
i
 = 
grid_pošts
[0]-3;

978 #´agm¨
omp
 

979 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

980 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

981 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

982 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

983 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

984 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

986 
lhs
[0][
i
+1][
j
][
k
] =†hs[0][i+1][j][k] + 
comz1
;

987 
lhs
[1][
i
+1][
j
][
k
] =†hs[1][i+1][j][k] - 
comz4
;

988 
lhs
[2][
i
+1][
j
][
k
] =†hs[2][i+1][j][k] + 
comz5
;

996 #´agm¨
omp
 

997 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

998 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

999 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1000 
lhs
[0+5][
i
][
j
][
k
] =†hs[0][i][j][k];

1001 
lhs
[1+5][
i
][
j
][
k
] =†hs[1][i][j][k] -

1002 
d‰x2
 * 
¥“d
[
i
-1][
j
][
k
];

1003 
lhs
[2+5][
i
][
j
][
k
] =†hs[2][i][j][k];

1004 
lhs
[3+5][
i
][
j
][
k
] =†hs[3][i][j][k] +

1005 
d‰x2
 * 
¥“d
[
i
+1][
j
][
k
];

1006 
lhs
[4+5][
i
][
j
][
k
] =†hs[4][i][j][k];

1007 
lhs
[0+10][
i
][
j
][
k
] =†hs[0][i][j][k];

1008 
lhs
[1+10][
i
][
j
][
k
] =†hs[1][i][j][k] +

1009 
d‰x2
 * 
¥“d
[
i
-1][
j
][
k
];

1010 
lhs
[2+10][
i
][
j
][
k
] =†hs[2][i][j][k];

1011 
lhs
[3+10][
i
][
j
][
k
] =†hs[3][i][j][k] -

1012 
d‰x2
 * 
¥“d
[
i
+1][
j
][
k
];

1013 
lhs
[4+10][
i
][
j
][
k
] =†hs[4][i][j][k];

1017 
	}
}

1022 
	$lhsy
() {

1031 
ru1
;

1032 
i
, 
j
, 
k
;

1037 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1038 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1039 #´agm¨
omp
 

1040 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

1041 
ru1
 = 
c3c4
*
rho_i
[
i
][
j
][
k
];

1042 
cv
[
j
] = 
vs
[
i
][j][
k
];

1043 
rhoq
[
j
] = 
	`max
(
dy3
 + 
cÚ43
 * 
ru1
,

1044 
	`max
(
dy5
 + 
c1c5
*
ru1
,

1045 
	`max
(
dymax
 + 
ru1
,

1046 
dy1
)));

1049 #´agm¨
omp
 

1050 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1051 
lhs
[0][
i
][
j
][
k
] = 0.0;

1052 
lhs
[1][
i
][
j
][
k
] = -
d‰y2
 * 
cv
[j-1] - 
d‰y1
 * 
rhoq
[j-1];

1053 
lhs
[2][
i
][
j
][
k
] = 1.0 + 
c2d‰y1
 * 
rhoq
[j];

1054 
lhs
[3][
i
][
j
][
k
] = 
d‰y2
 * 
cv
[j+1] - 
d‰y1
 * 
rhoq
[j+1];

1055 
lhs
[4][
i
][
j
][
k
] = 0.0;

1064 
j
 = 1;

1065 #´agm¨
omp
 
nowa™


1066 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1067 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1069 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz5
;

1070 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1071 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

1073 
lhs
[1][
i
][
j
+1][
k
] =†hs[1][i][j+1][k] - 
comz4
;

1074 
lhs
[2][
i
][
j
+1][
k
] =†hs[2][i][j+1][k] + 
comz6
;

1075 
lhs
[3][
i
][
j
+1][
k
] =†hs[3][i][j+1][k] - 
comz4
;

1076 
lhs
[4][
i
][
j
+1][
k
] =†hs[4][i][j+1][k] + 
comz1
;

1080 #´agm¨
omp
 
nowa™


1081 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1082 
j
 = 3; j <ğ
grid_pošts
[1]-4; j++) {

1083 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1084 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

1085 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

1086 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

1087 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1088 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

1093 
j
 = 
grid_pošts
[1]-3;

1094 #´agm¨
omp
 

1095 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1096 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1097 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

1098 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

1099 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

1100 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1102 
lhs
[0][
i
][
j
+1][
k
] =†hs[0][i][j+1][k] + 
comz1
;

1103 
lhs
[1][
i
][
j
+1][
k
] =†hs[1][i][j+1][k] - 
comz4
;

1104 
lhs
[2][
i
][
j
+1][
k
] =†hs[2][i][j+1][k] + 
comz5
;

1111 #´agm¨
omp
 

1112 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1113 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1114 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1115 
lhs
[0+5][
i
][
j
][
k
] =†hs[0][i][j][k];

1116 
lhs
[1+5][
i
][
j
][
k
] =†hs[1][i][j][k] -

1117 
d‰y2
 * 
¥“d
[
i
][
j
-1][
k
];

1118 
lhs
[2+5][
i
][
j
][
k
] =†hs[2][i][j][k];

1119 
lhs
[3+5][
i
][
j
][
k
] =†hs[3][i][j][k] +

1120 
d‰y2
 * 
¥“d
[
i
][
j
+1][
k
];

1121 
lhs
[4+5][
i
][
j
][
k
] =†hs[4][i][j][k];

1122 
lhs
[0+10][
i
][
j
][
k
] =†hs[0][i][j][k];

1123 
lhs
[1+10][
i
][
j
][
k
] =†hs[1][i][j][k] +

1124 
d‰y2
 * 
¥“d
[
i
][
j
-1][
k
];

1125 
lhs
[2+10][
i
][
j
][
k
] =†hs[2][i][j][k];

1126 
lhs
[3+10][
i
][
j
][
k
] =†hs[3][i][j][k] -

1127 
d‰y2
 * 
¥“d
[
i
][
j
+1][
k
];

1128 
lhs
[4+10][
i
][
j
][
k
] =†hs[4][i][j][k];

1132 
	}
}

1137 
	$lhsz
() {

1146 
ru1
;

1147 
i
, 
j
, 
k
;

1152 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1153 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1154 #´agm¨
omp
 

1155 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

1156 
ru1
 = 
c3c4
*
rho_i
[
i
][
j
][
k
];

1157 
cv
[
k
] = 
ws
[
i
][
j
][k];

1158 
rhos
[
k
] = 
	`max
(
dz4
 + 
cÚ43
 * 
ru1
,

1159 
	`max
(
dz5
 + 
c1c5
 * 
ru1
,

1160 
	`max
(
dzmax
 + 
ru1
,

1161 
dz1
)));

1164 #´agm¨
omp
 

1165 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1166 
lhs
[0][
i
][
j
][
k
] = 0.0;

1167 
lhs
[1][
i
][
j
][
k
] = -
d‰z2
 * 
cv
[k-1] - 
d‰z1
 * 
rhos
[k-1];

1168 
lhs
[2][
i
][
j
][
k
] = 1.0 + 
c2d‰z1
 * 
rhos
[k];

1169 
lhs
[3][
i
][
j
][
k
] = 
d‰z2
 * 
cv
[k+1] - 
d‰z1
 * 
rhos
[k+1];

1170 
lhs
[4][
i
][
j
][
k
] = 0.0;

1179 
k
 = 1;

1180 #´agm¨
omp
 
nowa™


1181 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1182 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1183 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz5
;

1184 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1185 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

1187 
lhs
[1][
i
][
j
][
k
+1] =†hs[1][i][j][k+1] - 
comz4
;

1188 
lhs
[2][
i
][
j
][
k
+1] =†hs[2][i][j][k+1] + 
comz6
;

1189 
lhs
[3][
i
][
j
][
k
+1] =†hs[3][i][j][k+1] - 
comz4
;

1190 
lhs
[4][
i
][
j
][
k
+1] =†hs[4][i][j][k+1] + 
comz1
;

1194 #´agm¨
omp
 
nowa™


1195 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1196 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1197 
k
 = 3; k <ğ
grid_pošts
[2]-4; k++) {

1198 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

1199 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

1200 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

1201 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1202 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

1207 
k
 = 
grid_pošts
[2]-3;

1208 #´agm¨
omp
 

1209 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1210 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1211 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

1212 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

1213 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

1214 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1216 
lhs
[0][
i
][
j
][
k
+1] =†hs[0][i][j][k+1] + 
comz1
;

1217 
lhs
[1][
i
][
j
][
k
+1] =†hs[1][i][j][k+1] - 
comz4
;

1218 
lhs
[2][
i
][
j
][
k
+1] =†hs[2][i][j][k+1] + 
comz5
;

1225 #´agm¨
omp
 

1226 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1227 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1228 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1229 
lhs
[0+5][
i
][
j
][
k
] =†hs[0][i][j][k];

1230 
lhs
[1+5][
i
][
j
][
k
] =†hs[1][i][j][k] -

1231 
d‰z2
 * 
¥“d
[
i
][
j
][
k
-1];

1232 
lhs
[2+5][
i
][
j
][
k
] =†hs[2][i][j][k];

1233 
lhs
[3+5][
i
][
j
][
k
] =†hs[3][i][j][k] +

1234 
d‰z2
 * 
¥“d
[
i
][
j
][
k
+1];

1235 
lhs
[4+5][
i
][
j
][
k
] =†hs[4][i][j][k];

1236 
lhs
[0+10][
i
][
j
][
k
] =†hs[0][i][j][k];

1237 
lhs
[1+10][
i
][
j
][
k
] =†hs[1][i][j][k] +

1238 
d‰z2
 * 
¥“d
[
i
][
j
][
k
-1];

1239 
lhs
[2+10][
i
][
j
][
k
] =†hs[2][i][j][k];

1240 
lhs
[3+10][
i
][
j
][
k
] =†hs[3][i][j][k] -

1241 
d‰z2
 * 
¥“d
[
i
][
j
][
k
+1];

1242 
lhs
[4+10][
i
][
j
][
k
] =†hs[4][i][j][k];

1246 
	}
}

1251 
	$nšvr
() {

1260 
i
, 
j
, 
k
;

1261 
r1
, 
r2
, 
r3
, 
r4
, 
r5
, 
t1
, 
t2
;

1262 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
r1
,
r2
,
r3
,
r4
,
r5
,
t1
,
t2
)

1263 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1264 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1265 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1267 
r1
 = 
rhs
[0][
i
][
j
][
k
];

1268 
r2
 = 
rhs
[1][
i
][
j
][
k
];

1269 
r3
 = 
rhs
[2][
i
][
j
][
k
];

1270 
r4
 = 
rhs
[3][
i
][
j
][
k
];

1271 
r5
 = 
rhs
[4][
i
][
j
][
k
];

1273 
t1
 = 
bt
 * 
r3
;

1274 
t2
 = 0.5 * ( 
r4
 + 
r5
 );

1276 
rhs
[0][
i
][
j
][
k
] = -
r2
;

1277 
rhs
[1][
i
][
j
][
k
] = 
r1
;

1278 
rhs
[2][
i
][
j
][
k
] = 
bt
 * ( 
r4
 - 
r5
 );

1279 
rhs
[3][
i
][
j
][
k
] = -
t1
 + 
t2
;

1280 
rhs
[4][
i
][
j
][
k
] = 
t1
 + 
t2
;

1284 
	}
}

1289 
	$pšvr
() {

1298 
i
, 
j
, 
k
;

1299 
r1
, 
r2
, 
r3
, 
r4
, 
r5
, 
t1
, 
t2
;

1301 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
r1
,
r2
,
r3
,
r4
,
r5
,
t1
,
t2
)

1302 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1303 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1304 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1306 
r1
 = 
rhs
[0][
i
][
j
][
k
];

1307 
r2
 = 
rhs
[1][
i
][
j
][
k
];

1308 
r3
 = 
rhs
[2][
i
][
j
][
k
];

1309 
r4
 = 
rhs
[3][
i
][
j
][
k
];

1310 
r5
 = 
rhs
[4][
i
][
j
][
k
];

1312 
t1
 = 
bt
 * 
r1
;

1313 
t2
 = 0.5 * ( 
r4
 + 
r5
 );

1315 
rhs
[0][
i
][
j
][
k
] = 
bt
 * ( 
r4
 - 
r5
 );

1316 
rhs
[1][
i
][
j
][
k
] = -
r3
;

1317 
rhs
[2][
i
][
j
][
k
] = 
r2
;

1318 
rhs
[3][
i
][
j
][
k
] = -
t1
 + 
t2
;

1319 
rhs
[4][
i
][
j
][
k
] = 
t1
 + 
t2
;

1323 
	}
}

1328 
	$compu‹_rhs
() {

1330 #´agm¨
omp
 
·¿Î–


1336 
i
, 
j
, 
k
, 
m
;

1337 
aux
, 
rho_šv
, 
uijk
, 
up1
, 
um1
, 
vijk
, 
vp1
, 
vm1
,

1338 
wijk
, 
wp1
, 
wm1
;

1345 #´agm¨
omp
 
nowa™


1346 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

1347 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

1348 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

1349 
rho_šv
 = 1.0/
u
[0][
i
][
j
][
k
];

1350 
rho_i
[
i
][
j
][
k
] = 
rho_šv
;

1351 
us
[
i
][
j
][
k
] = 
u
[1][i][j][k] * 
rho_šv
;

1352 
vs
[
i
][
j
][
k
] = 
u
[2][i][j][k] * 
rho_šv
;

1353 
ws
[
i
][
j
][
k
] = 
u
[3][i][j][k] * 
rho_šv
;

1354 
squ¬e
[
i
][
j
][
k
] = 0.5* (
u
[1][i][j][k]*u[1][i][j][k] +

1355 
u
[2][
i
][
j
][
k
]*u[2][i][j][k] +

1356 
u
[3][
i
][
j
][
k
]*u[3][i][j][k] ) * 
rho_šv
;

1357 
qs
[
i
][
j
][
k
] = 
squ¬e
[i][j][k] * 
rho_šv
;

1361 
aux
 = 
c1c2
*
rho_šv
* (
u
[4][
i
][
j
][
k
] - 
squ¬e
[i][j][k]);

1362 
aux
 = 
	`sq¹
(aux);

1363 
¥“d
[
i
][
j
][
k
] = 
aux
;

1364 
ašv
[
i
][
j
][
k
] = 1.0/
aux
;

1375 
m
 = 0; m < 5; m++) {

1376 #´agm¨
omp
 

1377 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

1378 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

1379 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

1380 
rhs
[
m
][
i
][
j
][
k
] = 
fÜcšg
[m][i][j][k];

1389 #´agm¨
omp
 

1390 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1391 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1392 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1393 
uijk
 = 
us
[
i
][
j
][
k
];

1394 
up1
 = 
us
[
i
+1][
j
][
k
];

1395 
um1
 = 
us
[
i
-1][
j
][
k
];

1397 
rhs
[0][
i
][
j
][
k
] =„hs[0][i][j][k] + 
dx1tx1
 *

1398 (
u
[0][
i
+1][
j
][
k
] - 2.0*u[0][i][j][k] +

1399 
u
[0][
i
-1][
j
][
k
]) -

1400 
tx2
 * (
u
[1][
i
+1][
j
][
k
] - u[1][i-1][j][k]);

1401 
rhs
[1][
i
][
j
][
k
] =„hs[1][i][j][k] + 
dx2tx1
 *

1402 (
u
[1][
i
+1][
j
][
k
] - 2.0*u[1][i][j][k] +

1403 
u
[1][
i
-1][
j
][
k
]) +

1404 
xxcÚ2
*
cÚ43
 * (
up1
 - 2.0*
uijk
 + 
um1
) -

1405 
tx2
 * (
u
[1][
i
+1][
j
][
k
]*
up1
 -

1406 
u
[1][
i
-1][
j
][
k
]*
um1
 +

1407 (
u
[4][
i
+1][
j
][
k
]- 
squ¬e
[i+1][j][k]-

1408 
u
[4][
i
-1][
j
][
k
]+ 
squ¬e
[i-1][j][k])*

1409 
c2
);

1411 
rhs
[2][
i
][
j
][
k
] =„hs[2][i][j][k] + 
dx3tx1
 *

1412 (
u
[2][
i
+1][
j
][
k
] - 2.0*u[2][i][j][k] +

1413 
u
[2][
i
-1][
j
][
k
]) +

1414 
xxcÚ2
 * (
vs
[
i
+1][
j
][
k
] - 2.0*vs[i][j][k] +

1415 
vs
[
i
-1][
j
][
k
]) -

1416 
tx2
 * (
u
[2][
i
+1][
j
][
k
]*
up1
 -

1417 
u
[2][
i
-1][
j
][
k
]*
um1
);

1419 
rhs
[3][
i
][
j
][
k
] =„hs[3][i][j][k] + 
dx4tx1
 *

1420 (
u
[3][
i
+1][
j
][
k
] - 2.0*u[3][i][j][k] +

1421 
u
[3][
i
-1][
j
][
k
]) +

1422 
xxcÚ2
 * (
ws
[
i
+1][
j
][
k
] - 2.0*ws[i][j][k] +

1423 
ws
[
i
-1][
j
][
k
]) -

1424 
tx2
 * (
u
[3][
i
+1][
j
][
k
]*
up1
 -

1425 
u
[3][
i
-1][
j
][
k
]*
um1
);

1427 
rhs
[4][
i
][
j
][
k
] =„hs[4][i][j][k] + 
dx5tx1
 *

1428 (
u
[4][
i
+1][
j
][
k
] - 2.0*u[4][i][j][k] +

1429 
u
[4][
i
-1][
j
][
k
]) +

1430 
xxcÚ3
 * (
qs
[
i
+1][
j
][
k
] - 2.0*qs[i][j][k] +

1431 
qs
[
i
-1][
j
][
k
]) +

1432 
xxcÚ4
 * (
up1
*up1 - 2.0*
uijk
*uijk +

1433 
um1
*um1) +

1434 
xxcÚ5
 * (
u
[4][
i
+1][
j
][
k
]*
rho_i
[i+1][j][k] -

1435 2.0*
u
[4][
i
][
j
][
k
]*
rho_i
[i][j][k] +

1436 
u
[4][
i
-1][
j
][
k
]*
rho_i
[i-1][j][k]) -

1437 
tx2
 * ( (
c1
*
u
[4][
i
+1][
j
][
k
] -

1438 
c2
*
squ¬e
[
i
+1][
j
][
k
])*
up1
 -

1439 (
c1
*
u
[4][
i
-1][
j
][
k
] -

1440 
c2
*
squ¬e
[
i
-1][
j
][
k
])*
um1
 );

1449 
i
 = 1;

1450 
m
 = 0; m < 5; m++) {

1451 #´agm¨
omp
 

1452 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1453 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1454 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k]- 
ds¥
 *

1455 Ğ5.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i+1][j][k] +

1456 
u
[
m
][
i
+2][
j
][
k
]);

1460 
i
 = 2;

1461 
m
 = 0; m < 5; m++) {

1462 #´agm¨
omp
 

1463 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1464 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1465 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1466 (-4.0*
u
[
m
][
i
-1][
j
][
k
] + 6.0*u[m][i][j][k] -

1467 4.0*
u
[
m
][
i
+1][
j
][
k
] + u[m][i+2][j][k]);

1472 
m
 = 0; m < 5; m++) {

1473 #´agm¨
omp
 

1474 
i
 = 3*1; i <ğ
grid_pošts
[0]-3*1-1; i++) {

1475 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1476 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1477 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1478 Ğ
u
[
m
][
i
-2][
j
][
k
] - 4.0*u[m][i-1][j][k] +

1479 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i+1][j][k] +

1480 
u
[
m
][
i
+2][
j
][
k
] );

1486 
i
 = 
grid_pošts
[0]-3;

1487 
m
 = 0; m < 5; m++) {

1488 #´agm¨
omp
 

1489 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1490 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1491 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1492 Ğ
u
[
m
][
i
-2][
j
][
k
] - 4.0*u[m][i-1][j][k] +

1493 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i+1][j][k] );

1498 
i
 = 
grid_pošts
[0]-2;

1499 
m
 = 0; m < 5; m++) {

1500 #´agm¨
omp
 

1501 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1502 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1503 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1504 Ğ
u
[
m
][
i
-2][
j
][
k
] - 4.0*u[m][i-1][j][k] +

1505 5.0*
u
[
m
][
i
][
j
][
k
] );

1509 #´agm¨
omp
 
b¬r›r


1514 #´agm¨
omp
 

1515 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1516 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1517 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1518 
vijk
 = 
vs
[
i
][
j
][
k
];

1519 
vp1
 = 
vs
[
i
][
j
+1][
k
];

1520 
vm1
 = 
vs
[
i
][
j
-1][
k
];

1521 
rhs
[0][
i
][
j
][
k
] =„hs[0][i][j][k] + 
dy1ty1
 *

1522 (
u
[0][
i
][
j
+1][
k
] - 2.0*u[0][i][j][k] +

1523 
u
[0][
i
][
j
-1][
k
]) -

1524 
ty2
 * (
u
[2][
i
][
j
+1][
k
] - u[2][i][j-1][k]);

1525 
rhs
[1][
i
][
j
][
k
] =„hs[1][i][j][k] + 
dy2ty1
 *

1526 (
u
[1][
i
][
j
+1][
k
] - 2.0*u[1][i][j][k] +

1527 
u
[1][
i
][
j
-1][
k
]) +

1528 
yycÚ2
 * (
us
[
i
][
j
+1][
k
] - 2.0*us[i][j][k] +

1529 
us
[
i
][
j
-1][
k
]) -

1530 
ty2
 * (
u
[1][
i
][
j
+1][
k
]*
vp1
 -

1531 
u
[1][
i
][
j
-1][
k
]*
vm1
);

1532 
rhs
[2][
i
][
j
][
k
] =„hs[2][i][j][k] + 
dy3ty1
 *

1533 (
u
[2][
i
][
j
+1][
k
] - 2.0*u[2][i][j][k] +

1534 
u
[2][
i
][
j
-1][
k
]) +

1535 
yycÚ2
*
cÚ43
 * (
vp1
 - 2.0*
vijk
 + 
vm1
) -

1536 
ty2
 * (
u
[2][
i
][
j
+1][
k
]*
vp1
 -

1537 
u
[2][
i
][
j
-1][
k
]*
vm1
 +

1538 (
u
[4][
i
][
j
+1][
k
] - 
squ¬e
[i][j+1][k] -

1539 
u
[4][
i
][
j
-1][
k
] + 
squ¬e
[i][j-1][k])

1540 *
c2
);

1541 
rhs
[3][
i
][
j
][
k
] =„hs[3][i][j][k] + 
dy4ty1
 *

1542 (
u
[3][
i
][
j
+1][
k
] - 2.0*u[3][i][j][k] +

1543 
u
[3][
i
][
j
-1][
k
]) +

1544 
yycÚ2
 * (
ws
[
i
][
j
+1][
k
] - 2.0*ws[i][j][k] +

1545 
ws
[
i
][
j
-1][
k
]) -

1546 
ty2
 * (
u
[3][
i
][
j
+1][
k
]*
vp1
 -

1547 
u
[3][
i
][
j
-1][
k
]*
vm1
);

1548 
rhs
[4][
i
][
j
][
k
] =„hs[4][i][j][k] + 
dy5ty1
 *

1549 (
u
[4][
i
][
j
+1][
k
] - 2.0*u[4][i][j][k] +

1550 
u
[4][
i
][
j
-1][
k
]) +

1551 
yycÚ3
 * (
qs
[
i
][
j
+1][
k
] - 2.0*qs[i][j][k] +

1552 
qs
[
i
][
j
-1][
k
]) +

1553 
yycÚ4
 * (
vp1
*vp1 - 2.0*
vijk
*vijk +

1554 
vm1
*vm1) +

1555 
yycÚ5
 * (
u
[4][
i
][
j
+1][
k
]*
rho_i
[i][j+1][k] -

1556 2.0*
u
[4][
i
][
j
][
k
]*
rho_i
[i][j][k] +

1557 
u
[4][
i
][
j
-1][
k
]*
rho_i
[i][j-1][k]) -

1558 
ty2
 * ((
c1
*
u
[4][
i
][
j
+1][
k
] -

1559 
c2
*
squ¬e
[
i
][
j
+1][
k
]è* 
vp1
 -

1560 (
c1
*
u
[4][
i
][
j
-1][
k
] -

1561 
c2
*
squ¬e
[
i
][
j
-1][
k
]è* 
vm1
);

1570 
j
 = 1;

1571 
m
 = 0; m < 5; m++) {

1572 #´agm¨
omp
 

1573 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1574 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1575 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k]- 
ds¥
 *

1576 Ğ5.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j+1][k] +

1577 
u
[
m
][
i
][
j
+2][
k
]);

1582 
j
 = 2;

1583 
m
 = 0; m < 5; m++) {

1584 #´agm¨
omp
 

1585 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1586 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1587 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1588 (-4.0*
u
[
m
][
i
][
j
-1][
k
] + 6.0*u[m][i][j][k] -

1589 4.0*
u
[
m
][
i
][
j
+1][
k
] + u[m][i][j+2][k]);

1594 
m
 = 0; m < 5; m++) {

1595 #´agm¨
omp
 

1596 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1597 
j
 = 3*1; j <ğ
grid_pošts
[1]-3*1-1; j++) {

1598 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1599 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1600 Ğ
u
[
m
][
i
][
j
-2][
k
] - 4.0*u[m][i][j-1][k] +

1601 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j+1][k] +

1602 
u
[
m
][
i
][
j
+2][
k
] );

1608 
j
 = 
grid_pošts
[1]-3;

1609 
m
 = 0; m < 5; m++) {

1610 #´agm¨
omp
 

1611 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1612 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1613 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1614 Ğ
u
[
m
][
i
][
j
-2][
k
] - 4.0*u[m][i][j-1][k] +

1615 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j+1][k] );

1620 
j
 = 
grid_pošts
[1]-2;

1621 
m
 = 0; m < 5; m++) {

1622 #´agm¨
omp
 

1623 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1624 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1625 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1626 Ğ
u
[
m
][
i
][
j
-2][
k
] - 4.0*u[m][i][j-1][k] +

1627 5.0*
u
[
m
][
i
][
j
][
k
] );

1631 #´agm¨
omp
 
b¬r›r


1636 #´agm¨
omp
 

1637 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1638 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1639 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1640 
wijk
 = 
ws
[
i
][
j
][
k
];

1641 
wp1
 = 
ws
[
i
][
j
][
k
+1];

1642 
wm1
 = 
ws
[
i
][
j
][
k
-1];

1644 
rhs
[0][
i
][
j
][
k
] =„hs[0][i][j][k] + 
dz1tz1
 *

1645 (
u
[0][
i
][
j
][
k
+1] - 2.0*u[0][i][j][k] +

1646 
u
[0][
i
][
j
][
k
-1]) -

1647 
tz2
 * (
u
[3][
i
][
j
][
k
+1] - u[3][i][j][k-1]);

1648 
rhs
[1][
i
][
j
][
k
] =„hs[1][i][j][k] + 
dz2tz1
 *

1649 (
u
[1][
i
][
j
][
k
+1] - 2.0*u[1][i][j][k] +

1650 
u
[1][
i
][
j
][
k
-1]) +

1651 
zzcÚ2
 * (
us
[
i
][
j
][
k
+1] - 2.0*us[i][j][k] +

1652 
us
[
i
][
j
][
k
-1]) -

1653 
tz2
 * (
u
[1][
i
][
j
][
k
+1]*
wp1
 -

1654 
u
[1][
i
][
j
][
k
-1]*
wm1
);

1655 
rhs
[2][
i
][
j
][
k
] =„hs[2][i][j][k] + 
dz3tz1
 *

1656 (
u
[2][
i
][
j
][
k
+1] - 2.0*u[2][i][j][k] +

1657 
u
[2][
i
][
j
][
k
-1]) +

1658 
zzcÚ2
 * (
vs
[
i
][
j
][
k
+1] - 2.0*vs[i][j][k] +

1659 
vs
[
i
][
j
][
k
-1]) -

1660 
tz2
 * (
u
[2][
i
][
j
][
k
+1]*
wp1
 -

1661 
u
[2][
i
][
j
][
k
-1]*
wm1
);

1662 
rhs
[3][
i
][
j
][
k
] =„hs[3][i][j][k] + 
dz4tz1
 *

1663 (
u
[3][
i
][
j
][
k
+1] - 2.0*u[3][i][j][k] +

1664 
u
[3][
i
][
j
][
k
-1]) +

1665 
zzcÚ2
*
cÚ43
 * (
wp1
 - 2.0*
wijk
 + 
wm1
) -

1666 
tz2
 * (
u
[3][
i
][
j
][
k
+1]*
wp1
 -

1667 
u
[3][
i
][
j
][
k
-1]*
wm1
 +

1668 (
u
[4][
i
][
j
][
k
+1] - 
squ¬e
[i][j][k+1] -

1669 
u
[4][
i
][
j
][
k
-1] + 
squ¬e
[i][j][k-1])

1670 *
c2
);

1671 
rhs
[4][
i
][
j
][
k
] =„hs[4][i][j][k] + 
dz5tz1
 *

1672 (
u
[4][
i
][
j
][
k
+1] - 2.0*u[4][i][j][k] +

1673 
u
[4][
i
][
j
][
k
-1]) +

1674 
zzcÚ3
 * (
qs
[
i
][
j
][
k
+1] - 2.0*qs[i][j][k] +

1675 
qs
[
i
][
j
][
k
-1]) +

1676 
zzcÚ4
 * (
wp1
*wp1 - 2.0*
wijk
*wijk +

1677 
wm1
*wm1) +

1678 
zzcÚ5
 * (
u
[4][
i
][
j
][
k
+1]*
rho_i
[i][j][k+1] -

1679 2.0*
u
[4][
i
][
j
][
k
]*
rho_i
[i][j][k] +

1680 
u
[4][
i
][
j
][
k
-1]*
rho_i
[i][j][k-1]) -

1681 
tz2
 * ( (
c1
*
u
[4][
i
][
j
][
k
+1] -

1682 
c2
*
squ¬e
[
i
][
j
][
k
+1])*
wp1
 -

1683 (
c1
*
u
[4][
i
][
j
][
k
-1] -

1684 
c2
*
squ¬e
[
i
][
j
][
k
-1])*
wm1
);

1693 
k
 = 1;

1694 
m
 = 0; m < 5; m++) {

1695 #´agm¨
omp
 

1696 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1697 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1698 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k]- 
ds¥
 *

1699 Ğ5.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j][k+1] +

1700 
u
[
m
][
i
][
j
][
k
+2]);

1705 
k
 = 2;

1706 
m
 = 0; m < 5; m++) {

1707 #´agm¨
omp
 

1708 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1709 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1710 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1711 (-4.0*
u
[
m
][
i
][
j
][
k
-1] + 6.0*u[m][i][j][k] -

1712 4.0*
u
[
m
][
i
][
j
][
k
+1] + u[m][i][j][k+2]);

1717 
m
 = 0; m < 5; m++) {

1718 #´agm¨
omp
 

1719 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1720 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1721 
k
 = 3*1; k <ğ
grid_pošts
[2]-3*1-1; k++) {

1722 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1723 Ğ
u
[
m
][
i
][
j
][
k
-2] - 4.0*u[m][i][j][k-1] +

1724 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j][k+1] +

1725 
u
[
m
][
i
][
j
][
k
+2] );

1731 
k
 = 
grid_pošts
[2]-3;

1732 
m
 = 0; m < 5; m++) {

1733 #´agm¨
omp
 

1734 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1735 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1736 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1737 Ğ
u
[
m
][
i
][
j
][
k
-2] - 4.0*u[m][i][j][k-1] +

1738 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j][k+1] );

1743 
k
 = 
grid_pošts
[2]-2;

1744 
m
 = 0; m < 5; m++) {

1745 #´agm¨
omp
 

1746 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1747 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1748 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1749 Ğ
u
[
m
][
i
][
j
][
k
-2] - 4.0*u[m][i][j][k-1] +

1750 5.0*
u
[
m
][
i
][
j
][
k
] );

1755 
m
 = 0; m < 5; m++) {

1756 #´agm¨
omp
 

1757 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1758 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1759 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1760 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] * 
dt
;

1767 
	}
}

1772 
	$£t_cÚ¡ªts
() {

1777 
û
[0][0] = 2.0;

1778 
û
[1][0] = 0.0;

1779 
û
[2][0] = 0.0;

1780 
û
[3][0] = 4.0;

1781 
û
[4][0] = 5.0;

1782 
û
[5][0] = 3.0;

1783 
û
[6][0] = 0.5;

1784 
û
[7][0] = 0.02;

1785 
û
[8][0] = 0.01;

1786 
û
[9][0] = 0.03;

1787 
û
[10][0] = 0.5;

1788 
û
[11][0] = 0.4;

1789 
û
[12][0] = 0.3;

1791 
û
[0][1] = 1.0;

1792 
û
[1][1] = 0.0;

1793 
û
[2][1] = 0.0;

1794 
û
[3][1] = 0.0;

1795 
û
[4][1] = 1.0;

1796 
û
[5][1] = 2.0;

1797 
û
[6][1] = 3.0;

1798 
û
[7][1] = 0.01;

1799 
û
[8][1] = 0.03;

1800 
û
[9][1] = 0.02;

1801 
û
[10][1] = 0.4;

1802 
û
[11][1] = 0.3;

1803 
û
[12][1] = 0.5;

1805 
û
[0][2] = 2.0;

1806 
û
[1][2] = 2.0;

1807 
û
[2][2] = 0.0;

1808 
û
[3][2] = 0.0;

1809 
û
[4][2] = 0.0;

1810 
û
[5][2] = 2.0;

1811 
û
[6][2] = 3.0;

1812 
û
[7][2] = 0.04;

1813 
û
[8][2] = 0.03;

1814 
û
[9][2] = 0.05;

1815 
û
[10][2] = 0.3;

1816 
û
[11][2] = 0.5;

1817 
û
[12][2] = 0.4;

1819 
û
[0][3] = 2.0;

1820 
û
[1][3] = 2.0;

1821 
û
[2][3] = 0.0;

1822 
û
[3][3] = 0.0;

1823 
û
[4][3] = 0.0;

1824 
û
[5][3] = 2.0;

1825 
û
[6][3] = 3.0;

1826 
û
[7][3] = 0.03;

1827 
û
[8][3] = 0.05;

1828 
û
[9][3] = 0.04;

1829 
û
[10][3] = 0.2;

1830 
û
[11][3] = 0.1;

1831 
û
[12][3] = 0.3;

1833 
û
[0][4] = 5.0;

1834 
û
[1][4] = 4.0;

1835 
û
[2][4] = 3.0;

1836 
û
[3][4] = 2.0;

1837 
û
[4][4] = 0.1;

1838 
û
[5][4] = 0.4;

1839 
û
[6][4] = 0.3;

1840 
û
[7][4] = 0.05;

1841 
û
[8][4] = 0.04;

1842 
û
[9][4] = 0.03;

1843 
û
[10][4] = 0.1;

1844 
û
[11][4] = 0.3;

1845 
û
[12][4] = 0.2;

1847 
c1
 = 1.4;

1848 
c2
 = 0.4;

1849 
c3
 = 0.1;

1850 
c4
 = 1.0;

1851 
c5
 = 1.4;

1853 
bt
 = 
	`sq¹
(0.5);

1855 
dnxm1
 = 1.0 / ()(
grid_pošts
[0]-1);

1856 
dnym1
 = 1.0 / ()(
grid_pošts
[1]-1);

1857 
dnzm1
 = 1.0 / ()(
grid_pošts
[2]-1);

1859 
c1c2
 = 
c1
 * 
c2
;

1860 
c1c5
 = 
c1
 * 
c5
;

1861 
c3c4
 = 
c3
 * 
c4
;

1862 
c1345
 = 
c1c5
 * 
c3c4
;

1864 
cÚz1
 = (1.0-
c1c5
);

1866 
tx1
 = 1.0 / (
dnxm1
 * dnxm1);

1867 
tx2
 = 1.0 / (2.0 * 
dnxm1
);

1868 
tx3
 = 1.0 / 
dnxm1
;

1870 
ty1
 = 1.0 / (
dnym1
 * dnym1);

1871 
ty2
 = 1.0 / (2.0 * 
dnym1
);

1872 
ty3
 = 1.0 / 
dnym1
;

1874 
tz1
 = 1.0 / (
dnzm1
 * dnzm1);

1875 
tz2
 = 1.0 / (2.0 * 
dnzm1
);

1876 
tz3
 = 1.0 / 
dnzm1
;

1878 
dx1
 = 0.75;

1879 
dx2
 = 0.75;

1880 
dx3
 = 0.75;

1881 
dx4
 = 0.75;

1882 
dx5
 = 0.75;

1884 
dy1
 = 0.75;

1885 
dy2
 = 0.75;

1886 
dy3
 = 0.75;

1887 
dy4
 = 0.75;

1888 
dy5
 = 0.75;

1890 
dz1
 = 1.0;

1891 
dz2
 = 1.0;

1892 
dz3
 = 1.0;

1893 
dz4
 = 1.0;

1894 
dz5
 = 1.0;

1896 
dxmax
 = 
	`max
(
dx3
, 
dx4
);

1897 
dymax
 = 
	`max
(
dy2
, 
dy4
);

1898 
dzmax
 = 
	`max
(
dz2
, 
dz3
);

1900 
ds¥
 = 0.25 * 
	`max
(
dx1
, max(
dy1
, 
dz1
) );

1902 
c4ds¥
 = 4.0 * 
ds¥
;

1903 
c5ds¥
 = 5.0 * 
ds¥
;

1905 
d‰x1
 = 
dt
*
tx1
;

1906 
d‰x2
 = 
dt
*
tx2
;

1907 
d‰y1
 = 
dt
*
ty1
;

1908 
d‰y2
 = 
dt
*
ty2
;

1909 
d‰z1
 = 
dt
*
tz1
;

1910 
d‰z2
 = 
dt
*
tz2
;

1912 
c2d‰x1
 = 2.0*
d‰x1
;

1913 
c2d‰y1
 = 2.0*
d‰y1
;

1914 
c2d‰z1
 = 2.0*
d‰z1
;

1916 
dtds¥
 = 
dt
*
ds¥
;

1918 
comz1
 = 
dtds¥
;

1919 
comz4
 = 4.0*
dtds¥
;

1920 
comz5
 = 5.0*
dtds¥
;

1921 
comz6
 = 6.0*
dtds¥
;

1923 
c3c4tx3
 = 
c3c4
*
tx3
;

1924 
c3c4ty3
 = 
c3c4
*
ty3
;

1925 
c3c4tz3
 = 
c3c4
*
tz3
;

1927 
dx1tx1
 = 
dx1
*
tx1
;

1928 
dx2tx1
 = 
dx2
*
tx1
;

1929 
dx3tx1
 = 
dx3
*
tx1
;

1930 
dx4tx1
 = 
dx4
*
tx1
;

1931 
dx5tx1
 = 
dx5
*
tx1
;

1933 
dy1ty1
 = 
dy1
*
ty1
;

1934 
dy2ty1
 = 
dy2
*
ty1
;

1935 
dy3ty1
 = 
dy3
*
ty1
;

1936 
dy4ty1
 = 
dy4
*
ty1
;

1937 
dy5ty1
 = 
dy5
*
ty1
;

1939 
dz1tz1
 = 
dz1
*
tz1
;

1940 
dz2tz1
 = 
dz2
*
tz1
;

1941 
dz3tz1
 = 
dz3
*
tz1
;

1942 
dz4tz1
 = 
dz4
*
tz1
;

1943 
dz5tz1
 = 
dz5
*
tz1
;

1945 
c2iv
 = 2.5;

1946 
cÚ43
 = 4.0/3.0;

1947 
cÚ16
 = 1.0/6.0;

1949 
xxcÚ1
 = 
c3c4tx3
*
cÚ43
*
tx3
;

1950 
xxcÚ2
 = 
c3c4tx3
*
tx3
;

1951 
xxcÚ3
 = 
c3c4tx3
*
cÚz1
*
tx3
;

1952 
xxcÚ4
 = 
c3c4tx3
*
cÚ16
*
tx3
;

1953 
xxcÚ5
 = 
c3c4tx3
*
c1c5
*
tx3
;

1955 
yycÚ1
 = 
c3c4ty3
*
cÚ43
*
ty3
;

1956 
yycÚ2
 = 
c3c4ty3
*
ty3
;

1957 
yycÚ3
 = 
c3c4ty3
*
cÚz1
*
ty3
;

1958 
yycÚ4
 = 
c3c4ty3
*
cÚ16
*
ty3
;

1959 
yycÚ5
 = 
c3c4ty3
*
c1c5
*
ty3
;

1961 
zzcÚ1
 = 
c3c4tz3
*
cÚ43
*
tz3
;

1962 
zzcÚ2
 = 
c3c4tz3
*
tz3
;

1963 
zzcÚ3
 = 
c3c4tz3
*
cÚz1
*
tz3
;

1964 
zzcÚ4
 = 
c3c4tz3
*
cÚ16
*
tz3
;

1965 
zzcÚ5
 = 
c3c4tz3
*
c1c5
*
tz3
;

1966 
	}
}

1971 
	$txšvr
() {

1980 
i
, 
j
, 
k
;

1981 
t1
, 
t2
, 
t3
, 
ac
, 
ru1
, 
uu
, 
vv
, 
ww
, 
r1
, 
r2
, 
r3
,

1982 
r4
, 
r5
, 
ac2šv
;

1984 #´agm¨
omp
 

1985 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1986 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1987 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1989 
ru1
 = 
rho_i
[
i
][
j
][
k
];

1990 
uu
 = 
us
[
i
][
j
][
k
];

1991 
vv
 = 
vs
[
i
][
j
][
k
];

1992 
ww
 = 
ws
[
i
][
j
][
k
];

1993 
ac
 = 
¥“d
[
i
][
j
][
k
];

1994 
ac2šv
 = 
ašv
[
i
][
j
][
k
]*ainv[i][j][k];

1996 
r1
 = 
rhs
[0][
i
][
j
][
k
];

1997 
r2
 = 
rhs
[1][
i
][
j
][
k
];

1998 
r3
 = 
rhs
[2][
i
][
j
][
k
];

1999 
r4
 = 
rhs
[3][
i
][
j
][
k
];

2000 
r5
 = 
rhs
[4][
i
][
j
][
k
];

2002 
t1
 = 
c2
 * 
ac2šv
 * ( 
qs
[
i
][
j
][
k
]*
r1
 - 
uu
*
r2
 -

2003 
vv
*
r3
 - 
ww
*
r4
 + 
r5
 );

2004 
t2
 = 
bt
 * 
ru1
 * ( 
uu
 * 
r1
 - 
r2
 );

2005 
t3
 = ( 
bt
 * 
ru1
 * 
ac
 ) * 
t1
;

2007 
rhs
[0][
i
][
j
][
k
] = 
r1
 - 
t1
;

2008 
rhs
[1][
i
][
j
][
k
] = - 
ru1
 * ( 
ww
*
r1
 - 
r4
 );

2009 
rhs
[2][
i
][
j
][
k
] = 
ru1
 * ( 
vv
*
r1
 - 
r3
 );

2010 
rhs
[3][
i
][
j
][
k
] = - 
t2
 + 
t3
;

2011 
rhs
[4][
i
][
j
][
k
] = 
t2
 + 
t3
;

2015 
	}
}

2020 
	$tz‘¬
() {

2029 
i
, 
j
, 
k
;

2030 
t1
, 
t2
, 
t3
, 
ac
, 
xv–
, 
yv–
, 
zv–
, 
r1
, 
r2
, 
r3
,

2031 
r4
, 
r5
, 
btuz
, 
acšv
, 
ac2u
, 
uzik1
;

2033 #´agm¨
omp
 
	`´iv©e
(
i
,
j
,
k
,
t1
,
t2
,
t3
,
ac
,
xv–
,
yv–
,
zv–
,
r1
,
r2
,
r3
,
r4
,
r5
,
btuz
,
ac2u
,
uzik1
)

2034 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2035 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2036 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2038 
xv–
 = 
us
[
i
][
j
][
k
];

2039 
yv–
 = 
vs
[
i
][
j
][
k
];

2040 
zv–
 = 
ws
[
i
][
j
][
k
];

2041 
ac
 = 
¥“d
[
i
][
j
][
k
];

2042 
acšv
 = 
ašv
[
i
][
j
][
k
];

2044 
ac2u
 = 
ac
*ac;

2046 
r1
 = 
rhs
[0][
i
][
j
][
k
];

2047 
r2
 = 
rhs
[1][
i
][
j
][
k
];

2048 
r3
 = 
rhs
[2][
i
][
j
][
k
];

2049 
r4
 = 
rhs
[3][
i
][
j
][
k
];

2050 
r5
 = 
rhs
[4][
i
][
j
][
k
];

2052 
uzik1
 = 
u
[0][
i
][
j
][
k
];

2053 
btuz
 = 
bt
 * 
uzik1
;

2055 
t1
 = 
btuz
*
acšv
 * (
r4
 + 
r5
);

2056 
t2
 = 
r3
 + 
t1
;

2057 
t3
 = 
btuz
 * (
r4
 - 
r5
);

2059 
rhs
[0][
i
][
j
][
k
] = 
t2
;

2060 
rhs
[1][
i
][
j
][
k
] = -
uzik1
*
r2
 + 
xv–
*
t2
;

2061 
rhs
[2][
i
][
j
][
k
] = 
uzik1
*
r1
 + 
yv–
*
t2
;

2062 
rhs
[3][
i
][
j
][
k
] = 
zv–
*
t2
 + 
t3
;

2063 
rhs
[4][
i
][
j
][
k
] = 
uzik1
*(-
xv–
*
r2
 + 
yv–
*
r1
) +

2064 
qs
[
i
][
j
][
k
]*
t2
 + 
c2iv
*
ac2u
*
t1
 + 
zv–
*
t3
;

2068 
	}
}

2074 
	$v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
) {

2083 
xü»f
[5],
xû»f
[5],
xüdif
[5],
xûdif
[5],

2084 
•sÚ
, 
xû
[5], 
xü
[5], 
dŒef
;

2085 
m
;

2090 
•sÚ
 = 1.0e-08;

2096 
	`”rÜ_nÜm
(
xû
);

2097 
	`compu‹_rhs
();

2099 
	`rhs_nÜm
(
xü
);

2101 
m
 = 0; m < 5; m++) {

2102 
xü
[
m
] = xü[m] / 
dt
;

2105 *
şass
 = 'U';

2106 *
v”if›d
 = 
TRUE
;

2108 
m
 = 0; m < 5; m++) {

2109 
xü»f
[
m
] = 1.0;

2110 
xû»f
[
m
] = 1.0;

2116 iàĞ
grid_pošts
[0] == 12 &&

2117 
grid_pošts
[1] == 12 &&

2118 
grid_pošts
[2] == 12 &&

2119 
no_time_¡•s
 == 100) {

2121 *
şass
 = 'S';

2122 
dŒef
 = 1.5e-2;

2127 
xü»f
[0] = 2.7470315451339479e-02;

2128 
xü»f
[1] = 1.0360746705285417e-02;

2129 
xü»f
[2] = 1.6235745065095532e-02;

2130 
xü»f
[3] = 1.5840557224455615e-02;

2131 
xü»f
[4] = 3.4849040609362460e-02;

2136 
xû»f
[0] = 2.7289258557377227e-05;

2137 
xû»f
[1] = 1.0364446640837285e-05;

2138 
xû»f
[2] = 1.6154798287166471e-05;

2139 
xû»f
[3] = 1.5750704994480102e-05;

2140 
xû»f
[4] = 3.4177666183390531e-05;

2146 } ià(
grid_pošts
[0] == 36 &&

2147 
grid_pošts
[1] == 36 &&

2148 
grid_pošts
[2] == 36 &&

2149 
no_time_¡•s
 == 400) {

2151 *
şass
 = 'W';

2152 
dŒef
 = 1.5e-3;

2157 
xü»f
[0] = 0.1893253733584e-02;

2158 
xü»f
[1] = 0.1717075447775e-03;

2159 
xü»f
[2] = 0.2778153350936e-03;

2160 
xü»f
[3] = 0.2887475409984e-03;

2161 
xü»f
[4] = 0.3143611161242e-02;

2166 
xû»f
[0] = 0.7542088599534e-04;

2167 
xû»f
[1] = 0.6512852253086e-05;

2168 
xû»f
[2] = 0.1049092285688e-04;

2169 
xû»f
[3] = 0.1128838671535e-04;

2170 
xû»f
[4] = 0.1212845639773e-03;

2175 } ià(
grid_pošts
[0] == 64 &&

2176 
grid_pošts
[1] == 64 &&

2177 
grid_pošts
[2] == 64 &&

2178 
no_time_¡•s
 == 400 ) {

2180 *
şass
 = 'A';

2181 
dŒef
 = 1.5e-3;

2186 
xü»f
[0] = 2.4799822399300195;

2187 
xü»f
[1] = 1.1276337964368832;

2188 
xü»f
[2] = 1.5028977888770491;

2189 
xü»f
[3] = 1.4217816211695179;

2190 
xü»f
[4] = 2.1292113035138280;

2195 
xû»f
[0] = 1.0900140297820550e-04;

2196 
xû»f
[1] = 3.7343951769282091e-05;

2197 
xû»f
[2] = 5.0092785406541633e-05;

2198 
xû»f
[3] = 4.7671093939528255e-05;

2199 
xû»f
[4] = 1.3621613399213001e-04;

2205 } ià(
grid_pošts
[0] == 102 &&

2206 
grid_pošts
[1] == 102 &&

2207 
grid_pošts
[2] == 102 &&

2208 
no_time_¡•s
 == 400) {

2210 *
şass
 = 'B';

2211 
dŒef
 = 1.0e-3;

2216 
xü»f
[0] = 0.6903293579998e+02;

2217 
xü»f
[1] = 0.3095134488084e+02;

2218 
xü»f
[2] = 0.4103336647017e+02;

2219 
xü»f
[3] = 0.3864769009604e+02;

2220 
xü»f
[4] = 0.5643482272596e+02;

2225 
xû»f
[0] = 0.9810006190188e-02;

2226 
xû»f
[1] = 0.1022827905670e-02;

2227 
xû»f
[2] = 0.1720597911692e-02;

2228 
xû»f
[3] = 0.1694479428231e-02;

2229 
xû»f
[4] = 0.1847456263981e-01;

2236 } ià(
grid_pošts
[0] == 162 &&

2237 
grid_pošts
[1] == 162 &&

2238 
grid_pošts
[2] == 162 &&

2239 
no_time_¡•s
 == 400) {

2241 *
şass
 = 'C';

2242 
dŒef
 = 0.67e-3;

2247 
xü»f
[0] = 0.5881691581829e+03;

2248 
xü»f
[1] = 0.2454417603569e+03;

2249 
xü»f
[2] = 0.3293829191851e+03;

2250 
xü»f
[3] = 0.3081924971891e+03;

2251 
xü»f
[4] = 0.4597223799176e+03;

2256 
xû»f
[0] = 0.2598120500183e+00;

2257 
xû»f
[1] = 0.2590888922315e-01;

2258 
xû»f
[2] = 0.5132886416320e-01;

2259 
xû»f
[3] = 0.4806073419454e-01;

2260 
xû»f
[4] = 0.5483377491301e+00;

2263 *
v”if›d
 = 
FALSE
;

2274 
m
 = 0; m < 5; m++) {

2276 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]) ;

2277 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

2285 ià(*
şass
 != 'U') {

2286 
	`´štf
(" V”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

2287 
	`´štf
("‡ccu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

2289 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

2290 *
v”if›d
 = 
FALSE
;

2291 *
şass
 = 'U';

2292 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

2295 
	`´štf
(" Unknown class\n");

2298 ià(*
şass
 != 'U') {

2299 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

2301 
	`´štf
(" RMS-norms of„esidual\n");

2304 
m
 = 0; m < 5; m++) {

2305 ià(*
şass
 == 'U') {

2306 
	`´štf
(" %2d%20.13e\n", 
m
, 
xü
[m]);

2307 } ià(
xüdif
[
m
] > 
•sÚ
) {

2308 *
v”if›d
 = 
FALSE
;

2309 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2310 
m
,
xü
[m],
xü»f
[m],
xüdif
[m]);

2312 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2313 
m
,
xü
[m],
xü»f
[m],
xüdif
[m]);

2317 ià(*
şass
 != 'U') {

2318 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

2320 
	`´štf
(" RMS-norms of solutionƒrror\n");

2323 
m
 = 0; m < 5; m++) {

2324 ià(*
şass
 == 'U') {

2325 
	`´štf
(" %2d%20.13e\n", 
m
, 
xû
[m]);

2326 } ià(
xûdif
[
m
] > 
•sÚ
) {

2327 *
v”if›d
 = 
FALSE
;

2328 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2329 
m
,
xû
[m],
xû»f
[m],
xûdif
[m]);

2331 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2332 
m
,
xû
[m],
xû»f
[m],
xûdif
[m]);

2336 ià(*
şass
 == 'U') {

2337 
	`´štf
(" No„eference values…rovided\n");

2338 
	`´štf
(" No verification…erformed\n");

2339 } ià(*
v”if›d
) {

2340 
	`´štf
(" Verification Successful\n");

2342 
	`´štf
(" Verification failed\n");

2344 
	}
}

2349 
	$x_sŞve
() {

2351 #´agm¨
omp
 
·¿Î–


2364 
i
, 
j
, 
k
, 
n
, 
i1
, 
i2
, 
m
;

2365 
çc1
, 
çc2
;

2370 
	`lhsx
();

2375 
n
 = 0;

2376 
i
 = 0; i <ğ
grid_pošts
[0]-3; i++) {

2377 
i1
 = 
i
 + 1;

2378 
i2
 = 
i
 + 2;

2379 #´agm¨
omp
 

2380 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2381 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2382 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2383 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2384 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2385 
m
 = 0; m < 3; m++) {

2386 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2388 
lhs
[
n
+2][
i1
][
j
][
k
] =†hs[n+2][i1][j][k] -

2389 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+3][
i
][j][k];

2390 
lhs
[
n
+3][
i1
][
j
][
k
] =†hs[n+3][i1][j][k] -

2391 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+4][
i
][j][k];

2392 
m
 = 0; m < 3; m++) {

2393 
rhs
[
m
][
i1
][
j
][
k
] =„hs[m][i1][j][k] -

2394 
lhs
[
n
+1][
i1
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2396 
lhs
[
n
+1][
i2
][
j
][
k
] =†hs[n+1][i2][j][k] -

2397 
lhs
[
n
+0][
i2
][
j
][
k
]*lhs[n+3][
i
][j][k];

2398 
lhs
[
n
+2][
i2
][
j
][
k
] =†hs[n+2][i2][j][k] -

2399 
lhs
[
n
+0][
i2
][
j
][
k
]*lhs[n+4][
i
][j][k];

2400 
m
 = 0; m < 3; m++) {

2401 
rhs
[
m
][
i2
][
j
][
k
] =„hs[m][i2][j][k] -

2402 
lhs
[
n
+0][
i2
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2414 
i
 = 
grid_pošts
[0]-2;

2415 
i1
 = 
grid_pošts
[0]-1;

2416 #´agm¨
omp
 

2417 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2418 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2419 
çc1
 = 1.0/
lhs
[
n
+2][
i
][
j
][
k
];

2420 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2421 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2422 
m
 = 0; m < 3; m++) {

2423 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2425 
lhs
[
n
+2][
i1
][
j
][
k
] =†hs[n+2][i1][j][k] -

2426 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+3][
i
][j][k];

2427 
lhs
[
n
+3][
i1
][
j
][
k
] =†hs[n+3][i1][j][k] -

2428 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+4][
i
][j][k];

2429 
m
 = 0; m < 3; m++) {

2430 
rhs
[
m
][
i1
][
j
][
k
] =„hs[m][i1][j][k] -

2431 
lhs
[
n
+1][
i1
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2437 
çc2
 = 1./
lhs
[
n
+2][
i1
][
j
][
k
];

2438 
m
 = 0; m < 3; m++) {

2439 
rhs
[
m
][
i1
][
j
][
k
] = 
çc2
*rhs[m][i1][j][k];

2448 
m
 = 3; m < 5; m++) {

2449 
n
 = (
m
-3+1)*5;

2450 
i
 = 0; i <ğ
grid_pošts
[0]-3; i++) {

2451 
i1
 = 
i
 + 1;

2452 
i2
 = 
i
 + 2;

2453 #´agm¨
omp
 

2454 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2455 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2456 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2457 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2458 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2459 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2460 
lhs
[
n
+2][
i1
][
j
][
k
] =†hs[n+2][i1][j][k] -

2461 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+3][
i
][j][k];

2462 
lhs
[
n
+3][
i1
][
j
][
k
] =†hs[n+3][i1][j][k] -

2463 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+4][
i
][j][k];

2464 
rhs
[
m
][
i1
][
j
][
k
] =„hs[m][i1][j][k] -

2465 
lhs
[
n
+1][
i1
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2466 
lhs
[
n
+1][
i2
][
j
][
k
] =†hs[n+1][i2][j][k] -

2467 
lhs
[
n
+0][
i2
][
j
][
k
]*lhs[n+3][
i
][j][k];

2468 
lhs
[
n
+2][
i2
][
j
][
k
] =†hs[n+2][i2][j][k] -

2469 
lhs
[
n
+0][
i2
][
j
][
k
]*lhs[n+4][
i
][j][k];

2470 
rhs
[
m
][
i2
][
j
][
k
] =„hs[m][i2][j][k] -

2471 
lhs
[
n
+0][
i2
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2479 
i
 = 
grid_pošts
[0]-2;

2480 
i1
 = 
grid_pošts
[0]-1;

2482 #´agm¨
omp
 

2483 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2484 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2485 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2486 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2487 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2488 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2489 
lhs
[
n
+2][
i1
][
j
][
k
] =†hs[n+2][i1][j][k] -

2490 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+3][
i
][j][k];

2491 
lhs
[
n
+3][
i1
][
j
][
k
] =†hs[n+3][i1][j][k] -

2492 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+4][
i
][j][k];

2493 
rhs
[
m
][
i1
][
j
][
k
] =„hs[m][i1][j][k] -

2494 
lhs
[
n
+1][
i1
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2498 
çc2
 = 1./
lhs
[
n
+2][
i1
][
j
][
k
];

2499 
rhs
[
m
][
i1
][
j
][
k
] = 
çc2
*rhs[m][i1][j][k];

2509 
i
 = 
grid_pošts
[0]-2;

2510 
i1
 = 
grid_pošts
[0]-1;

2511 
n
 = 0;

2512 
m
 = 0; m < 3; m++) {

2513 #´agm¨
omp
 

2514 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2515 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2516 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2517 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][
i1
][j][k];

2522 
m
 = 3; m < 5; m++) {

2523 #´agm¨
omp
 

2524 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2525 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2526 
n
 = (
m
-3+1)*5;

2527 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2528 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][
i1
][j][k];

2536 
n
 = 0;

2537 
i
 = 
grid_pošts
[0]-3; i >= 0; i--) {

2538 
i1
 = 
i
 + 1;

2539 
i2
 = 
i
 + 2;

2540 #´agm¨
omp
 

2541 
m
 = 0; m < 3; m++) {

2542 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2543 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2544 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2545 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][
i1
][j][k] -

2546 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][
i2
][j][k];

2555 
m
 = 3; m < 5; m++) {

2556 
n
 = (
m
-3+1)*5;

2557 
i
 = 
grid_pošts
[0]-3; i >= 0; i--) {

2558 
i1
 = 
i
 + 1;

2559 
i2
 = 
i
 + 2;

2560 #´agm¨
omp
 

2561 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2562 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2563 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2564 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][
i1
][j][k] -

2565 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][
i2
][j][k];

2576 
	`nšvr
();

2577 
	}
}

2582 
	$y_sŞve
() {

2584 #´agm¨
omp
 
·¿Î–


2597 
i
, 
j
, 
k
, 
n
, 
j1
, 
j2
, 
m
;

2598 
çc1
, 
çc2
;

2603 
	`lhsy
();

2605 
n
 = 0;

2607 
j
 = 0; j <ğ
grid_pošts
[1]-3; j++) {

2608 
j1
 = 
j
 + 1;

2609 
j2
 = 
j
 + 2;

2610 #´agm¨
omp
 

2611 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2612 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2613 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2614 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2615 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2616 
m
 = 0; m < 3; m++) {

2617 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2619 
lhs
[
n
+2][
i
][
j1
][
k
] =†hs[n+2][i][j1][k] -

2620 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+3][i][
j
][k];

2621 
lhs
[
n
+3][
i
][
j1
][
k
] =†hs[n+3][i][j1][k] -

2622 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+4][i][
j
][k];

2623 
m
 = 0; m < 3; m++) {

2624 
rhs
[
m
][
i
][
j1
][
k
] =„hs[m][i][j1][k] -

2625 
lhs
[
n
+1][
i
][
j1
][
k
]*
rhs
[
m
][i][
j
][k];

2627 
lhs
[
n
+1][
i
][
j2
][
k
] =†hs[n+1][i][j2][k] -

2628 
lhs
[
n
+0][
i
][
j2
][
k
]*lhs[n+3][i][
j
][k];

2629 
lhs
[
n
+2][
i
][
j2
][
k
] =†hs[n+2][i][j2][k] -

2630 
lhs
[
n
+0][
i
][
j2
][
k
]*lhs[n+4][i][
j
][k];

2631 
m
 = 0; m < 3; m++) {

2632 
rhs
[
m
][
i
][
j2
][
k
] =„hs[m][i][j2][k] -

2633 
lhs
[
n
+0][
i
][
j2
][
k
]*
rhs
[
m
][i][
j
][k];

2645 
j
 = 
grid_pošts
[1]-2;

2646 
j1
 = 
grid_pošts
[1]-1;

2647 #´agm¨
omp
 

2648 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2649 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2650 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2651 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2652 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2653 
m
 = 0; m < 3; m++) {

2654 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2656 
lhs
[
n
+2][
i
][
j1
][
k
] =†hs[n+2][i][j1][k] -

2657 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+3][i][
j
][k];

2658 
lhs
[
n
+3][
i
][
j1
][
k
] =†hs[n+3][i][j1][k] -

2659 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+4][i][
j
][k];

2660 
m
 = 0; m < 3; m++) {

2661 
rhs
[
m
][
i
][
j1
][
k
] =„hs[m][i][j1][k] -

2662 
lhs
[
n
+1][
i
][
j1
][
k
]*
rhs
[
m
][i][
j
][k];

2667 
çc2
 = 1./
lhs
[
n
+2][
i
][
j1
][
k
];

2668 
m
 = 0; m < 3; m++) {

2669 
rhs
[
m
][
i
][
j1
][
k
] = 
çc2
*rhs[m][i][j1][k];

2677 
m
 = 3; m < 5; m++) {

2678 
n
 = (
m
-3+1)*5;

2679 
j
 = 0; j <ğ
grid_pošts
[1]-3; j++) {

2680 
j1
 = 
j
 + 1;

2681 
j2
 = 
j
 + 2;

2682 #´agm¨
omp
 

2683 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2684 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2685 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2686 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2687 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2688 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2689 
lhs
[
n
+2][
i
][
j1
][
k
] =†hs[n+2][i][j1][k] -

2690 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+3][i][
j
][k];

2691 
lhs
[
n
+3][
i
][
j1
][
k
] =†hs[n+3][i][j1][k] -

2692 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+4][i][
j
][k];

2693 
rhs
[
m
][
i
][
j1
][
k
] =„hs[m][i][j1][k] -

2694 
lhs
[
n
+1][
i
][
j1
][
k
]*
rhs
[
m
][i][
j
][k];

2695 
lhs
[
n
+1][
i
][
j2
][
k
] =†hs[n+1][i][j2][k] -

2696 
lhs
[
n
+0][
i
][
j2
][
k
]*lhs[n+3][i][
j
][k];

2697 
lhs
[
n
+2][
i
][
j2
][
k
] =†hs[n+2][i][j2][k] -

2698 
lhs
[
n
+0][
i
][
j2
][
k
]*lhs[n+4][i][
j
][k];

2699 
rhs
[
m
][
i
][
j2
][
k
] =„hs[m][i][j2][k] -

2700 
lhs
[
n
+0][
i
][
j2
][
k
]*
rhs
[
m
][i][
j
][k];

2708 
j
 = 
grid_pošts
[1]-2;

2709 
j1
 = 
grid_pošts
[1]-1;

2710 #´agm¨
omp
 

2711 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2712 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2713 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2714 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2715 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2716 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2717 
lhs
[
n
+2][
i
][
j1
][
k
] =†hs[n+2][i][j1][k] -

2718 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+3][i][
j
][k];

2719 
lhs
[
n
+3][
i
][
j1
][
k
] =†hs[n+3][i][j1][k] -

2720 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+4][i][
j
][k];

2721 
rhs
[
m
][
i
][
j1
][
k
] =„hs[m][i][j1][k] -

2722 
lhs
[
n
+1][
i
][
j1
][
k
]*
rhs
[
m
][i][
j
][k];

2726 
çc2
 = 1./
lhs
[
n
+2][
i
][
j1
][
k
];

2727 
rhs
[
m
][
i
][
j1
][
k
] = 
çc2
*rhs[m][i][j1][k];

2736 
j
 = 
grid_pošts
[1]-2;

2737 
j1
 = 
grid_pošts
[1]-1;

2738 
n
 = 0;

2739 
m
 = 0; m < 3; m++) {

2740 #´agm¨
omp
 

2741 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2742 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2743 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2744 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][
j1
][k];

2749 
m
 = 3; m < 5; m++) {

2750 #´agm¨
omp
 

2751 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2752 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2753 
n
 = (
m
-3+1)*5;

2754 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2755 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][
j1
][k];

2763 
n
 = 0;

2764 
m
 = 0; m < 3; m++) {

2765 
j
 = 
grid_pošts
[1]-3; j >= 0; j--) {

2766 
j1
 = 
j
 + 1;

2767 
j2
 = 
j
 + 2;

2768 #´agm¨
omp
 

2769 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2770 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2771 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2772 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][
j1
][k] -

2773 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][i][
j2
][k];

2782 
m
 = 3; m < 5; m++) {

2783 
n
 = (
m
-3+1)*5;

2784 
j
 = 
grid_pošts
[1]-3; j >= 0; j--) {

2785 
j1
 = 
j
 + 1;

2786 
j2
 = 
j1
 + 1;

2787 #´agm¨
omp
 

2788 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2789 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2790 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2791 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][
j1
][k] -

2792 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][i][
j2
][k];

2800 
	`pšvr
();

2801 
	}
}

2806 
	$z_sŞve
() {

2808 #´agm¨
omp
 
·¿Î–


2821 
i
, 
j
, 
k
, 
n
, 
k1
, 
k2
, 
m
;

2822 
çc1
, 
çc2
;

2828 
	`lhsz
();

2830 
n
 = 0;

2832 #´agm¨
omp
 

2833 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2834 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2835 
k
 = 0; k <ğ
grid_pošts
[2]-3; k++) {

2836 
k1
 = 
k
 + 1;

2837 
k2
 = 
k
 + 2;

2838 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2839 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2840 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2841 
m
 = 0; m < 3; m++) {

2842 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2844 
lhs
[
n
+2][
i
][
j
][
k1
] =†hs[n+2][i][j][k1] -

2845 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+3][i][j][
k
];

2846 
lhs
[
n
+3][
i
][
j
][
k1
] =†hs[n+3][i][j][k1] -

2847 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+4][i][j][
k
];

2848 
m
 = 0; m < 3; m++) {

2849 
rhs
[
m
][
i
][
j
][
k1
] =„hs[m][i][j][k1] -

2850 
lhs
[
n
+1][
i
][
j
][
k1
]*
rhs
[
m
][i][j][
k
];

2852 
lhs
[
n
+1][
i
][
j
][
k2
] =†hs[n+1][i][j][k2] -

2853 
lhs
[
n
+0][
i
][
j
][
k2
]*lhs[n+3][i][j][
k
];

2854 
lhs
[
n
+2][
i
][
j
][
k2
] =†hs[n+2][i][j][k2] -

2855 
lhs
[
n
+0][
i
][
j
][
k2
]*lhs[n+4][i][j][
k
];

2856 
m
 = 0; m < 3; m++) {

2857 
rhs
[
m
][
i
][
j
][
k2
] =„hs[m][i][j][k2] -

2858 
lhs
[
n
+0][
i
][
j
][
k2
]*
rhs
[
m
][i][j][
k
];

2869 
k
 = 
grid_pošts
[2]-2;

2870 
k1
 = 
grid_pošts
[2]-1;

2871 #´agm¨
omp
 

2872 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2873 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2874 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2875 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2876 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2877 
m
 = 0; m < 3; m++) {

2878 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2880 
lhs
[
n
+2][
i
][
j
][
k1
] =†hs[n+2][i][j][k1] -

2881 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+3][i][j][
k
];

2882 
lhs
[
n
+3][
i
][
j
][
k1
] =†hs[n+3][i][j][k1] -

2883 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+4][i][j][
k
];

2884 
m
 = 0; m < 3; m++) {

2885 
rhs
[
m
][
i
][
j
][
k1
] =„hs[m][i][j][k1] -

2886 
lhs
[
n
+1][
i
][
j
][
k1
]*
rhs
[
m
][i][j][
k
];

2892 
çc2
 = 1./
lhs
[
n
+2][
i
][
j
][
k1
];

2893 
m
 = 0; m < 3; m++) {

2894 
rhs
[
m
][
i
][
j
][
k1
] = 
çc2
*rhs[m][i][j][k1];

2902 
m
 = 3; m < 5; m++) {

2903 
n
 = (
m
-3+1)*5;

2904 #´agm¨
omp
 

2905 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2906 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2907 
k
 = 0; k <ğ
grid_pošts
[2]-3; k++) {

2908 
k1
 = 
k
 + 1;

2909 
k2
 = 
k
 + 2;

2910 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2911 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2912 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2913 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2914 
lhs
[
n
+2][
i
][
j
][
k1
] =†hs[n+2][i][j][k1] -

2915 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+3][i][j][
k
];

2916 
lhs
[
n
+3][
i
][
j
][
k1
] =†hs[n+3][i][j][k1] -

2917 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+4][i][j][
k
];

2918 
rhs
[
m
][
i
][
j
][
k1
] =„hs[m][i][j][k1] -

2919 
lhs
[
n
+1][
i
][
j
][
k1
]*
rhs
[
m
][i][j][
k
];

2920 
lhs
[
n
+1][
i
][
j
][
k2
] =†hs[n+1][i][j][k2] -

2921 
lhs
[
n
+0][
i
][
j
][
k2
]*lhs[n+3][i][j][
k
];

2922 
lhs
[
n
+2][
i
][
j
][
k2
] =†hs[n+2][i][j][k2] -

2923 
lhs
[
n
+0][
i
][
j
][
k2
]*lhs[n+4][i][j][
k
];

2924 
rhs
[
m
][
i
][
j
][
k2
] =„hs[m][i][j][k2] -

2925 
lhs
[
n
+0][
i
][
j
][
k2
]*
rhs
[
m
][i][j][
k
];

2933 
k
 = 
grid_pošts
[2]-2;

2934 
k1
 = 
grid_pošts
[2]-1;

2935 #´agm¨
omp
 

2936 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2937 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2938 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2939 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2940 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2941 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2942 
lhs
[
n
+2][
i
][
j
][
k1
] =†hs[n+2][i][j][k1] -

2943 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+3][i][j][
k
];

2944 
lhs
[
n
+3][
i
][
j
][
k1
] =†hs[n+3][i][j][k1] -

2945 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+4][i][j][
k
];

2946 
rhs
[
m
][
i
][
j
][
k1
] =„hs[m][i][j][k1] -

2947 
lhs
[
n
+1][
i
][
j
][
k1
]*
rhs
[
m
][i][j][
k
];

2952 
çc2
 = 1./
lhs
[
n
+2][
i
][
j
][
k1
];

2953 
rhs
[
m
][
i
][
j
][
k1
] = 
çc2
*rhs[m][i][j][k1];

2963 
k
 = 
grid_pošts
[2]-2;

2964 
k1
 = 
grid_pošts
[2]-1;

2965 
n
 = 0;

2966 
m
 = 0; m < 3; m++) {

2967 #´agm¨
omp
 

2968 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2969 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2970 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2971 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k1
];

2976 
m
 = 3; m < 5; m++) {

2977 
n
 = (
m
-3+1)*5;

2978 #´agm¨
omp
 

2979 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2980 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2981 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2982 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k1
];

2995 
n
 = 0;

2996 
m
 = 0; m < 3; m++) {

2997 #´agm¨
omp
 

2998 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2999 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

3000 
k
 = 
grid_pošts
[2]-3; k >= 0; k--) {

3001 
k1
 = 
k
 + 1;

3002 
k2
 = 
k
 + 2;

3003 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

3004 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k1
] -

3005 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k2
];

3014 
m
 = 3; m < 5; m++) {

3015 
n
 = (
m
-3+1)*5;

3016 #´agm¨
omp
 

3017 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

3018 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

3019 
k
 = 
grid_pošts
[2]-3; k >= 0; k--) {

3020 
k1
 = 
k
 + 1;

3021 
k2
 = 
k
 + 2;

3022 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

3023 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k1
] -

3024 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k2
];

3032 
	`tz‘¬
();

3033 
	}
}

	@common/c_print_results.c

7 
	~<Çutus/Çutus.h
>

9 
	$c_´št_»suÉs
Ğ*
Çme
,

10 
şass
,

11 
n1
,

12 
n2
,

13 
n3
,

14 
n™”
,

15 
Áh»ads
,

16 
t
,

17 
mİs
,

18 *
İty³
,

19 
·s£d_v”ifiÿtiÚ
,

20 *
Åbv”siÚ
,

21 *
comp‘ime
,

22 *
cc
,

23 *
şšk
,

24 *
c_lib
,

25 *
c_šc
,

26 *
cæags
,

27 *
şškæags
,

28 *
¿nd
)

30 *
ev®ue
="1000";

32 
	`´štf
Ğ"\n\À% B’chm¬k Com¶‘ed\n", 
Çme
 );

34 
	`´štf
Ğ" CÏs  = %c\n", 
şass
 );

36 ifĞ
n2
 =ğ0 && 
n3
 == 0 )

37 
	`´štf
Ğ" Siz = %12d\n", 
n1
 );

39 
	`´štf
Ğ" Siz = %3dx%3dx%3d\n", 
n1
,
n2
,
n3
 );

41 
	`´štf
Ğ" I‹¿tiÚ  = %12d\n", 
n™”
 );

43 
	`´štf
Ğ" Th»ad  = %12d\n", 
Áh»ads
 );

45 
	`´štf
Ğ" Timš secÚd ğ %12.2f\n", 
t
 );

47 
	`´štf
Ğ" Mİ/ tÙ® = %12.2f\n", 
mİs
 );

49 
	`´štf
Ğ" O³¿tiÚy³ = %24s\n", 
İty³
);

51 ifĞ
·s£d_v”ifiÿtiÚ
 )

52 
	`´štf
( " Verification = SUCCESSFUL\n" );

54 
	`´štf
( " Verification = UNSUCCESSFUL\n" );

56 
	`´štf
Ğ" V”siÚ = %12s\n", 
Åbv”siÚ
 );

58 
	`´štf
Ğ" Compd© = %12s\n", 
comp‘ime
 );

60 
	`´štf
( "\n Compile options:\n" );

62 
	`´štf
Ğ" CC = %s\n", 
cc
 );

64 
	`´štf
Ğ" CLINK = %s\n", 
şšk
 );

66 
	`´štf
Ğ" C_LIB = %s\n", 
c_lib
 );

68 
	`´štf
Ğ" C_INC = %s\n", 
c_šc
 );

70 
	`´štf
Ğ" CFLAGS = %s\n", 
cæags
 );

72 
	`´štf
Ğ" CLINKFLAGS = %s\n", 
şškæags
 );

74 
	`´štf
Ğ" RAND = %s\n", 
¿nd
 );

75 #ifdeà
SMP


76 
ev®ue
 = 
	`g‘’v
("MP_SET_NUMTHREADS");

77 
	`´štf
Ğ" MULTICPUS = %s\n", 
ev®ue
 );

89 
	}
}

	@common/c_randdp.c

3 #ià
defšed
(
USE_POW
)

4 
	#r23
 
	`pow
(0.5, 23.0)

	)

5 
	#r46
 (
r23
*r23)

	)

6 
	#t23
 
	`pow
(2.0, 23.0)

	)

7 
	#t46
 (
t23
*t23)

	)

9 
	#r23
 (0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5)

	)

10 
	#r46
 (
r23
*r23)

	)

11 
	#t23
 (2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0)

	)

12 
	#t46
 (
t23
*t23)

	)

18 
	$¿ndlc
 (*
x
, 
a
) {

46 
t1
,
t2
,
t3
,
t4
,
a1
,
a2
,
x1
,
x2
,
z
;

51 
t1
 = 
r23
 * 
a
;

52 
a1
 = ()
t1
;

53 
a2
 = 
a
 - 
t23
 * 
a1
;

60 
t1
 = 
r23
 * (*
x
);

61 
x1
 = ()
t1
;

62 
x2
 = (*
x
è- 
t23
 * 
x1
;

63 
t1
 = 
a1
 * 
x2
 + 
a2
 * 
x1
;

64 
t2
 = ()(
r23
 * 
t1
);

65 
z
 = 
t1
 - 
t23
 * 
t2
;

66 
t3
 = 
t23
 * 
z
 + 
a2
 * 
x2
;

67 
t4
 = ()(
r46
 * 
t3
);

68 (*
x
èğ
t3
 - 
t46
 * 
t4
;

70  (
r46
 * (*
x
));

71 
	}
}

76 
	$v¿Æc
 (
n
, *
x_£ed
, 
a
, 
y
[]) {

104 
i
;

105 
x
,
t1
,
t2
,
t3
,
t4
,
a1
,
a2
,
x1
,
x2
,
z
;

110 
t1
 = 
r23
 * 
a
;

111 
a1
 = ()
t1
;

112 
a2
 = 
a
 - 
t23
 * 
a1
;

113 
x
 = *
x_£ed
;

118 
i
 = 1; i <ğ
n
; i++) {

125 
t1
 = 
r23
 * 
x
;

126 
x1
 = ()
t1
;

127 
x2
 = 
x
 - 
t23
 * 
x1
;

128 
t1
 = 
a1
 * 
x2
 + 
a2
 * 
x1
;

129 
t2
 = ()(
r23
 * 
t1
);

130 
z
 = 
t1
 - 
t23
 * 
t2
;

131 
t3
 = 
t23
 * 
z
 + 
a2
 * 
x2
;

132 
t4
 = ()(
r46
 * 
t3
);

133 
x
 = 
t3
 - 
t46
 * 
t4
;

134 
y
[
i
] = 
r46
 * 
x
;

136 *
x_£ed
 = 
x
;

137 
	}
}

	@common/c_timers.c

1 
	~"wtime.h
"

3 
	~<Çutus/Çutus.h
>

5 
wtime
( * );

11 
	$–­£d_time
( )

13 
t
;

15 
	`wtime
Ğ&
t
 );

16 Ğ
t
 );

17 
	}
}

20 
	g¡¬t
[64], 
	g–­£d
[64];

25 
	$tim”_ş—r
Ğ
n
 )

27 
–­£d
[
n
] = 0.0;

28 
	}
}

34 
	$tim”_¡¬t
Ğ
n
 )

36 
¡¬t
[
n
] = 
	`–­£d_time
();

37 
	}
}

43 
	$tim”_¡İ
Ğ
n
 )

45 
t
, 
now
;

47 
now
 = 
	`–­£d_time
();

48 
t
 = 
now
 - 
¡¬t
[
n
];

49 
–­£d
[
n
] +ğ
t
;

51 
	}
}

57 
	$tim”_»ad
Ğ
n
 )

59 Ğ
–­£d
[
n
] );

60 
	}
}

	@common/common.h

2 #iâdeà
COMMON_H


3 
	#COMMON_H


	)

5 
	~<Çutus/Çutus.h
>

7 
	#´štf
(...è
	`nk_vc_´štf
(
__VA_ARGS__
)

	)

9 
	#©of
(
x
è(()
	`©oi
(x))

	)

11 
	#EXIT_FAILURE
 -1

	)

12 
	#EXIT_SUCCESS
 0

	)

13 
	#ex™
(
x
è
	`·nic
("ex™ from om±e¡\n");

	)

15 
	~<¹/İ’mp/İ’mp.h
>

16 
šlše
 
	$sq¹
(
x
)

18 
»t
;

19 
asm
 volatile(

23 : "ô"(
»t
)

24 : "g"(
x
)

27  
»t
;

28 
	}
}

30 
	#çbs
(
x
è
	`__butš_çbs
(x)

	)

	@common/npb-C.h

4 #iâdeà
_NPB_C_H_


5 
	#_NPB_C_H_


	)

9 
	~<Çutus/Çutus.h
>

18 
	tboŞ—n
;

19 ¡ruù { 
	m»®
; 
	mimag
; } 
	tdcom¶ex
;

21 
	#TRUE
 1

	)

22 
	#FALSE
 0

	)

24 
	#max
(
a
,
b
è((×è> (b)è? (aè: (b))

	)

25 
	#mš
(
a
,
b
è((×è< (b)è? (aè: (b))

	)

26 
	#pow2
(
a
è(×)*×))

	)

28 
	#g‘_»®
(
c
èc.
»®


	)

29 
	#g‘_imag
(
c
èc.
imag


	)

30 
	#ÿdd
(
c
,
a
,
b
è(c.
»®
 =‡.»® + b.»®, c.
imag
 =‡.imag + b.imag)

	)

31 
	#csub
(
c
,
a
,
b
è(c.
»®
 =‡.»® - b.»®, c.
imag
 =‡.imag - b.imag)

	)

32 
	#cmul
(
c
,
a
,
b
è(c.
»®
 =‡.»® * b.»® -‡.
imag
 * b.imag, \

33 
c
.
imag
 = 
a
.
»®
 * 
b
.imag +‡.imag * b.»®)

	)

34 
	#ümul
(
c
,
a
,
b
è(c.
»®
 =‡.»® * b, c.
imag
 =‡.imag * b)

	)

36 
¿ndlc
(*, );

37 
v¿Æc
(, *, , *);

38 
tim”_ş—r
();

39 
tim”_¡¬t
();

40 
tim”_¡İ
();

41 
tim”_»ad
();

43 
c_´št_»suÉs
(*
Çme
, 
şass
, 
n1
, 
n2
,

44 
n3
, 
n™”
, 
Áh»ads
, 
t
,

45 
mİs
, *
İty³
, 
·s£d_v”ifiÿtiÚ
,

46 *
Åbv”siÚ
, *
comp‘ime
, *
cc
,

47 *
şšk
, *
c_lib
, *
c_šc
,

48 *
cæags
, *
şškæags
, *
¿nd
);

	@common/npbparams.h

7 
	#PROBLEM_SIZE
 12

	)

8 
	#NITER_DEFAULT
 60

	)

9 
	#DT_DEFAULT
 0.010

	)

10 
	#CONVERTDOUBLE
 
FALSE


	)

11 
	#COMPILETIME
 "22 Jª 2021"

	)

12 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

13 
	#CS1
 "ÒÚe)"

	)

14 
	#CS2
 "ÒÚe)"

	)

15 
	#CS3
 "ÒÚe)"

	)

16 
	#CS4
 "ÒÚe)"

	)

17 
	#CS5
 "-o3 $(C_IN)"

	)

18 
	#CS6
 "ÒÚe)"

	)

19 
	#CS7
 "ÒÚe)"

	)

	@common/wtime.c

1 
	~"wtime.h
"

4 
	$wtime
(*
t
)

6 
£c
 = -1;

7 
timev®
 
tv
;

8 
	`g‘timeofday
(&
tv
, (*)0);

9 ià(
£c
 < 0è£øğ
tv
.
tv_£c
;

10 *
t
 = (
tv
.
tv_£c
 - 
£c
è+ 1.0e-6*tv.
tv_u£c
;

11 
	}
}

	@common/wtime.h

5 #iâdeà
_WTIME_H_


6 
	#_WTIME_H_


	)

8 #ià
defšed
(
IBM
)

9 
	#wtime
 
wtime


	)

10 #–ià
defšed
(
CRAY
)

11 
	#wtime
 
WTIME


	)

13 
	#wtime
 
wtime_


	)

17 
	~<Çutus/libccom·t.h
>

	@common/wtime_sgi64.c

8 
	~<Çutus/Çutus.h
>

12 
	tiÙim”_t
;

14 
	gcyşev®
;

15 vŞ©
iÙim”_t
 *
	giÙim”_addr
, 
	gba£_couÁ”
;

16 
	g»sŞutiÚ
;

19 
	tadd»ss_t
;

23 
	$tim”_š™
()

26 
fd
;

27 *
vœt_addr
;

28 
add»ss_t
 
phys_addr
, 
·ge_off£t
, 
·gemask
, 
·geba£_addr
;

30 
·gemask
 = 
	`g‘·gesize
() - 1;

31 
”ºo
 = 0;

32 
phys_addr
 = 
	`syssgi
(
SGI_QUERY_CYCLECNTR
, &
cyşev®
);

33 ià(
”ºo
 != 0) {

34 
	`³¼Ü
("SGI_QUERY_CYCLECNTR");

35 
	`ex™
(1);

38 
·ge_off£t
 = 
phys_addr
 & 
·gemask
;

39 
·geba£_addr
 = 
phys_addr
 - 
·ge_off£t
;

40 
fd
 = 
	`İ’
("/dev/mmem", 
O_RDONLY
);

42 
vœt_addr
 = 
	`mm­
(0, 
·gemask
, 
PROT_READ
, 
MAP_PRIVATE
, 
fd
, 
·geba£_addr
);

43 
vœt_addr
 = vœt_add¸+ 
·ge_off£t
;

44 
iÙim”_addr
 = (
iÙim”_t
 *)
vœt_addr
;

46 
»sŞutiÚ
 = 1.0e-12*
cyşev®
;

47 
ba£_couÁ”
 = *
iÙim”_addr
;

48 
	}
}

50 
	$wtime_
(*
time
)

52 
š™Ÿlized
 = 0;

53 vŞ©
iÙim”_t
 
couÁ”_v®ue
;

54 ià(!
š™Ÿlized
) {

55 
	`tim”_š™
();

56 
š™Ÿlized
 = 1;

58 
couÁ”_v®ue
 = *
iÙim”_addr
 - 
ba£_couÁ”
;

59 *
time
 = ()
couÁ”_v®ue
 * 
»sŞutiÚ
;

60 
	}
}

63 
	$wtime
(*
time
)

65 
š™Ÿlized
 = 0;

66 vŞ©
iÙim”_t
 
couÁ”_v®ue
;

67 ià(!
š™Ÿlized
) {

68 
	`tim”_š™
();

69 
š™Ÿlized
 = 1;

71 
couÁ”_v®ue
 = *
iÙim”_addr
 - 
ba£_couÁ”
;

72 *
time
 = ()
couÁ”_v®ue
 * 
»sŞutiÚ
;

73 
	}
}

	@math/common.h

1 
	~<Çutus/Çut_ty³s.h
>

2 
	~<Çutus/š¡rum’t.h
>

	@math/exp/exp.h

76 
	#__HI
(
x
è*(1+(*)&x)

	)

77 
	#__LO
(
x
è*(*)&
	)
x

79 #ifdeà
__STDC__


84 
	gÚe
 = 1.0,

85 
	gh®F
[2] = {0.5,-0.5,},

86 
	ghuge
 = 1.0e+300,

87 
	gtwom1000
= 9.33263618503218878990e-302,

88 
	go_th»shŞd
= 7.09782712893383973096e+02,

89 
	gu_th»shŞd
= -7.45133219101941108420e+02,

90 
	gÊ2HI
[2] ={ 6.93147180369123816490e-01,

92 
	gÊ2LO
[2] ={ 1.90821492927058770002e-10,

94 
	gšvÊ2
 = 1.44269504088896338700e+00,

95 
	gP1
 = 1.66666666666666019037e-01,

96 
	gP2
 = -2.77777777770155933842e-03,

97 
	gP3
 = 6.61375632143793436117e-05,

98 
	gP4
 = -1.65339022054652515390e-06,

99 
	gP5
 = 4.13813679705723846039e-08;

101 
	$exp
(
x
)

103 
y
,
hi
,
lo
,
c
,
t
;

104 
k
,
xsb
;

105 
hx
;

107 
hx
 = 
	`__HI
(
x
);

108 
xsb
 = (
hx
>>31)&1;

109 
hx
 &= 0x7fffffff;

112 if(
hx
 >= 0x40862E42) {

113 if(
hx
>=0x7ff00000) {

114 if(((
hx
&0xfffff)|
	`__LO
(
x
))!=0)

115  
x
+x;

116  (
xsb
==0)? 
x
:0.0;

118 if(
x
 > 
o_th»shŞd
è 
huge
*huge;

119 if(
x
 < 
u_th»shŞd
è 
twom1000
*twom1000;

123 if(
hx
 > 0x3fd62e42) {

124 if(
hx
 < 0x3FF0A2B2) {

125 
hi
 = 
x
-
Ê2HI
[
xsb
]; 
lo
=
Ê2LO
[xsb]; 
k
 = 1-xsb-xsb;

127 
k
 = ()(
švÊ2
*
x
+
h®F
[
xsb
]);

128 
t
 = 
k
;

129 
hi
 = 
x
 - 
t
*
Ê2HI
[0];

130 
lo
 = 
t
*
Ê2LO
[0];

132 
x
 = 
hi
 - 
lo
;

134 if(
hx
 < 0x3e300000) {

135 if(
huge
+
x
>
Úe
)  one+x;

137 
k
 = 0;

140 
t
 = 
x
*x;

141 
c
 = 
x
 - 
t
*(
P1
+t*(
P2
+t*(
P3
+t*(
P4
+t*
P5
))));

142 if(
k
==0è 
Úe
-((
x
*
c
)/(c-2.0)-x);

143 
y
 = 
Úe
-((
lo
-(
x
*
c
)/(2.0-c))-
hi
);

144 if(
k
 >= -1021) {

145 
	`__HI
(
y
è+ğ(
k
<<20);

146  
y
;

148 
	`__HI
(
y
è+ğ((
k
+1000)<<20);

149  
y
*
twom1000
;

151 
	}
}

	@math/exp/linux_test.c

1 
	~<¡dio.h
>

2 
	~"exp.h
"

3 
	$maš
(){

4 
šput1
, 
šput2
;

5 
šput1
 = 22.18070977791824;

6 
šput2
 = 33;

8 
a
 = 
	`exp
(
šput1
);

10 
	`´štf
("%20.20f",
a
);

13 
	}
}

	@math/exp/nas_exp.h

2 #iâdeà
_NAS_EXP_H_


3 
	#_NAS_EXP_H_


	)

5 
	~"../commÚ.h
"

7 
	gÚe
 = 1.0,

8 
	gh®F
[2] = {0.5,-0.5,},

9 
	ghuge
 = 1.0e+300,

10 
	gtwom1000
= 9.33263618503218878990e-302,

11 
	go_th»shŞd
= 7.09782712893383973096e+02,

12 
	gu_th»shŞd
= -7.45133219101941108420e+02,

13 
	gÊ2HI
[2] ={ 6.93147180369123816490e-01,

15 
	gÊ2LO
[2] ={ 1.90821492927058770002e-10,

17 
	gšvÊ2
 = 1.44269504088896338700e+00,

18 
	gP1
 = 1.66666666666666019037e-01,

19 
	gP2
 = -2.77777777770155933842e-03,

20 
	gP3
 = 6.61375632143793436117e-05,

21 
	gP4
 = -1.65339022054652515390e-06,

22 
	gP5
 = 4.13813679705723846039e-08;

25 
	#__HI
(
x
è*(1+(*)&x)

	)

26 
	#__LO
(
x
è*(*)&
	)
x

28 
	$exp
(
x
)

30 
	`NK_PROFILE_ENTRY
();

31 
y
,
hi
,
lo
,
c
,
t
;

32 
k
,
xsb
;

33 
hx
;

34 
hx
 = 
	`__HI
(
x
);

35 
xsb
 = (
hx
>>31)&1;

36 
hx
 &= 0x7fffffff;

38 if(
hx
 >= 0x40862E42) {

39 if(
hx
>=0x7ff00000) {

40 if(((
hx
&0xfffff)|
	`__LO
(
x
))!=0)

41  
x
+x;

42  (
xsb
==0)? 
x
:0.0;

44 if(
x
 > 
o_th»shŞd
è 
huge
*huge;

45 if(
x
 < 
u_th»shŞd
è 
twom1000
*twom1000;

49 if(
hx
 > 0x3fd62e42) {

50 if(
hx
 < 0x3FF0A2B2) {

51 
hi
 = 
x
-
Ê2HI
[
xsb
]; 
lo
=
Ê2LO
[xsb]; 
k
 = 1-xsb-xsb;

53 
k
 = ()(
švÊ2
*
x
+
h®F
[
xsb
]);

54 
t
 = 
k
;

55 
hi
 = 
x
 - 
t
*
Ê2HI
[0];

56 
lo
 = 
t
*
Ê2LO
[0];

58 
x
 = 
hi
 - 
lo
;

60 if(
hx
 < 0x3e300000) {

61 if(
huge
+
x
>
Úe
)  one+x;

63 
k
 = 0;

65 
	`NK_PROFILE_EXIT
();

67 
t
 = 
x
*x;

68 
c
 = 
x
 - 
t
*(
P1
+t*(
P2
+t*(
P3
+t*(
P4
+t*
P5
))));

69 if(
k
==0è 
Úe
-((
x
*
c
)/(c-2.0)-x);

70 
y
 = 
Úe
-((
lo
-(
x
*
c
)/(2.0-c))-
hi
);

72 if(
k
 >= -1021) {

73 
	`__HI
(
y
è+ğ(
k
<<20);

74  
y
;

76 
	`__HI
(
y
è+ğ((
k
+1000)<<20);

77  
y
*
twom1000
;

80 
	}
}

	@math/exp/test.c

1 
	~<¡dio.h
>

2 
	~"Çs_exp.h
"

3 
	$maš
(){

4 
šput1
, 
šput2
;

5 
šput1
 = 22.18070977791824;

6 
šput2
 = 33;

8 
a
 = 
	`exp
(
šput1
);

10 
	`´štf
("%20.20f",
a
);

13 
	}
}

	@math/log/frexp.h

2 
	md
;

3 
	mu
;

4 }
	tudoubË
;

6 
	$äexp
(
x
, * 
e
){

7 
udoubË
 
a
;

8 
a
.
d
 = 
x
;

9 
_a
 = 
a
.
u
;

12 ifĞ! (~(
_a
<<1 >>53)<< 53)){

13 *
e
 = 1023;

16 ià(
x
 == 0.0){

17 *
e
 = 0;

21 
udoubË
 
_mª
;

22 
sign
 = 
_a
 >> 63 << 63, 
mask
 = 0x3FF;

23 
_mª
.
u
 = 
_a
>>63<<63 \

24 | 
mask
 << 52 \

25 | 
_a
 << 12 >> 12;

27 *
e
 = (()(
_a
 << 1 >> 53) -1023 ) + 1;

33  
_mª
.
d
/2;

34 
	}
}

	@math/log/nas_log.h

1 #iâdeà
_NAS_LOG_H_


2 
	#_NAS_LOG_H_


	)

3 
	~"äexp.h
"

4 
	~"../commÚ.h
"

5 
	gLOG2_HI
 = 0x1.62e42ãe00000
p
-1;

6 
	gLOG2_LOW
 = 0x1.a39ef35793c76
p
-33;

7 
	gL1
 = 0x1.5555555555593
p
-1;

8 
	gL2
 = 0x1.999999997ç04
p
-2;

9 
	gL3
 = 0x1.2492494229359
p
-2;

10 
	gL4
 = 0x1.c71c51d8e78af
p
-3;

11 
	gL5
 = 0x1.7466496cb03de
p
-3;

12 
	gL6
 = 0x1.39a09d078c69f
p
-3;

13 
	gL7
 = 0x1.2f112df3e5244
p
-3;

14 
	gSQRT2_HALF
 = 0x1.6a09e667f3bcd
p
-1;

15 
	gæ
, 
	gk
, 
	gf
, 
	gs
, 
	g_s2
,
	g_s4
,
	gR
,
	gt1
,
	gt2
,
	ghfsq
;

17 
	$log
(
x
){

19 
	`NK_PROFILE_ENTRY
();

20 
ki
;

21 
f1
 = 
	`äexp
(
x
,&
ki
);

23 ià(
f1
 < 
SQRT2_HALF
){

24 
f1
 *= 2;

25 
ki
 -= 1;

27 
f
 = 
f1
-1;

28 
k
 = ()
ki
;

30 
s
 = 
f
 / (2 + f);

31 
_s2
 = 
s
 * s;

32 
_s4
 = 
_s2
 * _s2;

34 
t1
 = 
_s2
 * (
L1
 + 
_s4
 * (
L3
 + _s4 * (
L5
 + _s4 * 
L7
)));

36 
t2
 = 
_s4
 * (
L2
 + _s4 * (
L4
 + _s4 * 
L6
));

37 
R
 = 
t1
 + 
t2
;

38 
hfsq
 = 0.5 * 
f
 * f;

40 
	`NK_PROFILE_EXIT
();

41  
k
 * 
LOG2_HI
 - ((
hfsq
 - (
s
 * (hfsq + 
R
è+ k * 
LOG2_LOW
)è- 
f
);

42 
	}
}

45 
	gšput
; \

46 
sÿnf
("%lf", &
šput
); \

47 
	glo
 = 
log
(
šput
); \

48 
´štf
("lØ%à\n",
lo
); \

	@math/log/test.c

1 
	~<¡dio.h
>

3 
	~"Çs_log.h
"

5 
	$maš
(){

6 
šput
 = 5;

7 
	`´štf
("%20.20f",
	`log
(0.4));

8 
	}
}

	@math/nas_math.h

2 #iâdeà
_NAS_MATH_H_


3 
	#_NAS_MATH_H_


	)

5 
	~<Çutus/Çutus.h
>

6 
	~"log/Çs_log.h
"

7 
	~"pow/Çs_pow.h
"

8 
	~"exp/Çs_exp.h
"

9 
	~"sšcos/Çs_sšcos.h
"

13 
šlše
 
	$sq¹
(
x
)

15 
»t
;

16 
asm
 volatile(

20 : "ô"(
»t
)

21 : "g"(
x
)

24  
»t
;

25 
	}
}

27 
	#çbs
(
x
è
	`__butš_çbs
(x)

	)

	@math/pow/nas_pow.h

1 
	~"../log/Çs_log.h
"

2 
	~"../exp/Çs_exp.h
"

3 
	~"../commÚ.h
"

5 
	$pow
(
a
, 
b
){

7  
	`exp
(
b
*
	`log
(
a
));

9 
	}
}

	@math/pow/test.c

1 
	~<¡dio.h
>

2 
	~"Çs_pow.h
"

3 
	$maš
(){

4 
šput1
, 
šput2
;

5 
šput1
 = 2.0;

6 
šput2
 = 33;

8 
a
 = 
	`pow
(
šput1
,
šput2
);

10 
	`´štf
("%20.20f",
a
);

13 
	}
}

	@math/sincos/__sincostab.h

20 
	~"Çs_mydefs.h
"

21 
	~"Çs_’dŸn.h
"

27 #ifdeà
BIG_ENDI


28 cÚ¡ uniÚ {
št4
 
	mi
[880]; 
	mx
[440];}
	g__sšco¡ab
 = { .
i
 = {

470 #ifdeà
LITTLE_ENDI


471 cÚ¡ uniÚ {
št4
 
	mi
[880]; 
	mx
[440];} 
	g__sšco¡ab
 = { .
i
 = {

	@math/sincos/nas_branred.c

34 
	~"Çs_mydefs.h
"

35 
	~"Çs_b¿Äed_ty³.h
"

36 
	~"Çs_b¿Äed.h
"

38 #iâdeà
SECTION


39 
	#SECTION


	)

50 
SECTION


51 
	$__b¿Äed
(
x
, *
a
, *
¯
)

53 
i
=0,
k
=0;

54 
mynumb”
 
u
,
gÜ
;

55 
r
[6],
s
=0,
t
=0,
sum
=0,
b
=0,
bb
=0,
sum1
=0,
sum2
=0,
b1
=0,
bb1
=0,
b2
=0,
bb2
=0,
x1
=0,
x2
=0,
t1
=0,
t2
=0;

57 
x
*=
tm600
.x;

58 
t
=
x
*
¥l™
;

59 
x1
=
t
-Ñ-
x
);

60 
x2
=
x
-
x1
;

61 
sum
=0;

62 
u
.
x
 = 
x1
;

63 
k
 = (
u
.
i
[
HIGH_HALF
]>>20)&2047;

64 
k
 = (k-450)/24;

65 ià(
k
<0)

66 
k
=0;

67 
gÜ
.
x
 = 
t576
.x;

68 
gÜ
.
i
[
HIGH_HALF
] -ğ((
k
*24)<<20);

69 
i
=0;i<6;i++)

70 { 
r
[
i
] = 
x1
*
tov”p
[
k
+i]*
gÜ
.
x
; gÜ.x *ğ
tm24
.x; }

71 
i
=0;i<3;i++) {

72 
s
=(
r
[
i
]+
big
.
x
)-big.x;

73 
sum
+=
s
;

74 
r
[
i
]-=
s
;

76 
t
=0;

77 
i
=0;i<6;i++)

78 
t
+=
r
[5-
i
];

79 
bb
=(((((
r
[0]-
t
)+r[1])+r[2])+r[3])+r[4])+r[5];

80 
s
=(
t
+
big
.
x
)-big.x;

81 
sum
+=
s
;

82 
t
-=
s
;

83 
b
=
t
+
bb
;

84 
bb
=(
t
-
b
)+bb;

85 
s
=(
sum
+
big1
.
x
)-big1.x;

86 
sum
-=
s
;

87 
b1
=
b
;

88 
bb1
=
bb
;

89 
sum1
=
sum
;

90 
sum
=0;

92 
u
.
x
 = 
x2
;

93 
k
 = (
u
.
i
[
HIGH_HALF
]>>20)&2047;

94 
k
 = (k-450)/24;

95 ià(
k
<0)

96 
k
=0;

97 
gÜ
.
x
 = 
t576
.x;

98 
gÜ
.
i
[
HIGH_HALF
] -ğ((
k
*24)<<20);

99 
i
=0;i<6;i++)

100 { 
r
[
i
] = 
x2
*
tov”p
[
k
+i]*
gÜ
.
x
; gÜ.x *ğ
tm24
.x; }

101 
i
=0;i<3;i++) {

102 
s
=(
r
[
i
]+
big
.
x
)-big.x;

103 
sum
+=
s
;

104 
r
[
i
]-=
s
;

106 
t
=0;

107 
i
=0;i<6;i++)

108 
t
+=
r
[5-
i
];

109 
bb
=(((((
r
[0]-
t
)+r[1])+r[2])+r[3])+r[4])+r[5];

110 
s
=(
t
+
big
.
x
)-big.x;

111 
sum
+=
s
;

112 
t
-=
s
;

113 
b
=
t
+
bb
;

114 
bb
=(
t
-
b
)+bb;

115 
s
=(
sum
+
big1
.
x
)-big1.x;

116 
sum
-=
s
;

118 
b2
=
b
;

119 
bb2
=
bb
;

120 
sum2
=
sum
;

122 
sum
=
sum1
+
sum2
;

123 
b
=
b1
+
b2
;

124 
bb
 = (
	`çbs
(
b1
)>çbs(
b2
))? (b1-
b
)+b2 : (b2-b)+b1;

125 ià(
b
 > 0.5)

126 {
b
-=1.0; 
sum
+=1.0;}

127 ià(
b
 < -0.5)

128 {
b
+=1.0; 
sum
-=1.0;}

129 
s
=
b
+(
bb
+
bb1
+
bb2
);

130 
t
=((
b
-
s
)+
bb
)+(
bb1
+
bb2
);

131 
b
=
s
*
¥l™
;

132 
t1
=
b
-(b-
s
);

133 
t2
=
s
-
t1
;

134 
b
=
s
*
hp0
.
x
;

135 
bb
=(((
t1
*
mp1
.
x
-
b
)+t1*
mp2
.x)+
t2
*mp1.x)+Ñ2*mp2.x+
s
*
hp1
.x+
t
*
hp0
.x);

136 
s
=
b
+
bb
;

137 
t
=(
b
-
s
)+
bb
;

138 *
a
=
s
;

139 *
¯
=
t
;

140  ((è
sum
)&3;

141 
	}
}

	@math/sincos/nas_branred.h

2 #iâdeà
_BRANRED_H_


3 
	#_BRANRED_H_


	)

5 
__b¿Äed
(
x
, *
a
, *
¯
);

	@math/sincos/nas_branred_type.h

26 #iâdeà
_BRANRED_TYPE_H


27 
	#_BRANRED_TYPE_H


	)

28 
	#çbs
(
x
è
	`__butš_çbs
(x)

	)

31 
	#CN
 134217729.0

	)

32 
	#HIGH_HALF
 1

	)

33 
	#LOW_HALF
 0

	)

36 #iâdeà
LITTLE_ENDI


37 
	#LITTLE_ENDI


	)

39 #ifdeà
BIG_ENDI


40 cÚ¡ 
mynumb”


42  
	gt576
 = {{0x63f00000, 0x00000000}},

43  
	gtm600
 = {{0x1a700000, 0x00000000}},

44  
	gtm24
 = {{0x3e700000, 0x00000000}},

45  
	gbig
 = {{0x43380000, 0x00000000}},

46  
	gbig1
 = {{0x43580000, 0x00000000}},

47  
	ghp0
 = {{0x3FF921FB, 0x54442D18}} ,

48  
	ghp1
 = {{0x3C91A626, 0x33145C07}} ,

49  
	gmp1
 = {{0x3FF921FB, 0x58000000}},

50  
	gmp2
 = {{0xBE4DDE97, 0x40000000}};

53 #ifdeà
LITTLE_ENDI


54 cÚ¡ 
mynumb”


56  
	gt576
 = {{0x00000000, 0x63f00000}},

57  
	gtm600
 = {{0x00000000, 0x1a700000}},

58  
	gtm24
 = {{0x00000000, 0x3e700000}},

59  
	gbig
 = {{0x00000000, 0x43380000}},

60  
	gbig1
 = {{0x00000000, 0x43580000}},

61  
	ghp0
 = {{0x54442D18, 0x3FF921FB}},

62  
	ghp1
 = {{0x33145C07, 0x3C91A626}},

63  
	gmp1
 = {{0x58000000, 0x3FF921FB}},

64  
	gmp2
 = {{0x40000000, 0xBE4DDE97}};

69 cÚ¡ 
	gtov”p
[75] = {

86 cÚ¡ 
	g¥l™
 = 
CN
;

	@math/sincos/nas_endian.h

1 #iâdeà
_NAS_ENDIAN_H_


2 
	#_NAS_ENDIAN_H_


	)

4 #iâdeà
LITTLE_ENDI


5 
	#LITTLE_ENDI


	)

	@math/sincos/nas_mydefs.h

27 #iâdeà
MY_H


28 
	#MY_H


	)

30 
	tšt4
;

31 uniÚ { 
št4
 
	mi
[2]; 
	mx
; } 
	tmynumb”
;

33 
	#max
(
x
, 
y
è(((yè> (x)è? (yè: (x))

	)

34 
	#mš
(
x
, 
y
è(((yè< (x)è? (yè: (x))

	)

	@math/sincos/nas_sincos.c

2 
	~"Çs_ty³.h
"

3 
	~"Çs_b¿Äed.h
"

4 
	~"__sšco¡ab.h
"

5 
	~"Çs_sšcos.h
"

6 
	#ERROR
(
fmt
, 
¬gs
...)

	)

9 
	#çbs
(
x
è
	`__butš_çbs
(x)

	)

13 
št4
 
	gi
[880]; \

14 
	gx
[440]; \

15 } 
	g__sšco¡ab
;

21 
	#POLYNOMIAL2
(
xx
è((((
s5
 * (xxè+ 
s4
è* (xxè+ 
s3
è* (xxè+ 
s2
è* (xx))

	)

23 
	#POLYNOMIAL
(
xx
è(
	`POLYNOMIAL2
 (xxè+ 
s1
)

	)

32 
	$TAYLOR_SIN
(
xx
, 
a
,
da
) { \

33 
t
 = ((
	`POLYNOMIAL
 (
xx
è* (
a
è- 0.5 * (
da
)) * (xx) + (da)); \

34 
»s
 = (
a
è+ 
t
; \

35  
»s
; \

36 
	}
}

38 
	$SINCOS_TABLE_LOOKUP
(
mynumb”
 
u
, * 
¢
,* 
s¢
,* 
cs
, *
ccs
){

40 
št4
 
k
 = 
u
.
i
[
LOW_HALF
] << 2;

41 *
¢
 = 
__sšco¡ab
.
x
[
k
]; \

42 *
s¢
 = 
__sšco¡ab
.
x
[
k
 + 1]; \

43 *
cs
 = 
__sšco¡ab
.
x
[
k
 + 2]; \

44 *
ccs
 = 
__sšco¡ab
.
x
[
k
 + 3]; \

45 
	}
}

49 
	g¢3
 = -1.66666666666664880952546298448555E-01,

50 
	g¢5
 = 8.33333214285722277379541354343671E-03,

51 
	gcs2
 = 4.99999999999999999999950396842453E-01,

52 
	gcs4
 = -4.16666666666664434524222570944589E-02,

53 
	gcs6
 = 1.38888874007937613028114285595617E-03;

59 
šlše
 

61 
	$do_cos
 (
x
, 
dx
)

63 
mynumb”
 
u
;

65 ià(
x
 < 0)

66 
dx
 = -dx;

68 
u
.
x
 = 
big
 + 
	`çbs
 (x);

69 
x
 = 
	`çbs
 (xè- (
u
.x - 
big
è+ 
dx
;

71 
xx
=0, 
s
=0, 
¢
=0, 
s¢
=0, 
c
=0, 
cs
=0, 
ccs
=0, 
cÜ
=0;

72 
xx
 = 
x
 * x;

73 
s
 = 
x
 + x * 
xx
 * (
¢3
 + xx * 
¢5
);

74 
c
 = 
xx
 * (
cs2
 + xx * (
cs4
 + xx * 
cs6
));

75 
	`SINCOS_TABLE_LOOKUP
 (
u
, &
¢
, &
s¢
, &
cs
, &
ccs
);

76 
cÜ
 = (
ccs
 - 
s
 * 
s¢
 - 
cs
 * 
c
è- 
¢
 * s;

77  
cs
 + 
cÜ
;

78 
	}
}

84 
šlše
 

86 
	$do_sš
 (
x
, 
dx
)

88 
xŞd
 = 
x
;

90 ià(
	`çbs
 (
x
) < 0.126)

91  
	`TAYLOR_SIN
 (
x
 * x, x, 
dx
);

93 
mynumb”
 
u
;

95 ià(
x
 <= 0)

96 
dx
 = -dx;

97 
u
.
x
 = 
big
 + 
	`çbs
 (x);

98 
x
 = 
	`çbs
 (xè- (
u
.x - 
big
);

100 
xx
=0, 
s
=0, 
¢
=0, 
s¢
=0, 
c
=0, 
cs
=0, 
ccs
=0, 
cÜ
=0;

101 
xx
 = 
x
 * x;

102 
s
 = 
x
 + (
dx
 + x * 
xx
 * (
¢3
 + xx * 
¢5
));

103 
c
 = 
x
 * 
dx
 + 
xx
 * (
cs2
 + xx * (
cs4
 + xx * 
cs6
));

104 
	`SINCOS_TABLE_LOOKUP
 (
u
, &
¢
, &
s¢
,& 
cs
, &
ccs
);

105 
cÜ
 = (
s¢
 + 
s
 * 
ccs
 - 
¢
 * 
c
è+ 
cs
 * s;

106  
	`__cİysign
 (
¢
 + 
cÜ
, 
xŞd
);

107 
	}
}

113 
šlše
 
št4


115 
	$»duû_sšcos
 (
x
, *
a
, *
da
)

117 
mynumb”
 
v
;

119 
t
 = (
x
 * 
hpšv
 + 
tošt
);

121 
xn
 = 
t
 - 
tošt
;

124 
v
.
x
 = 
t
;

125 
y
 = (
x
 - 
xn
 * 
mp1
è- xÀ* 
mp2
;

126 
št4
 
n
 = 
v
.
i
[
LOW_HALF
] & 3;

128 
b
=0, 
db
=0, 
t1
=0, 
t2
=0;

129 
t1
 = 
xn
 * 
µ3
;

130 
t2
 = 
y
 - 
t1
;

133 
db
 = (
y
 - 
t2
è- 
t1
;

136 
t1
 = 
xn
 * 
µ4
;

137 
b
 = 
t2
 - 
t1
;

139 
db
 +ğ(
t2
 - 
b
è- 
t1
;

142 *
a
 = 
b
;

143 *
da
 = 
db
;

146  
n
;

147 
	}
}

150 
šlše
 

152 
	$do_sšcos
 (
a
, 
da
, 
št4
 
n
)

154 
»tv®
;

156 ià(
n
 & 1)

158 
»tv®
 = 
	`do_cos
 (
a
, 
da
);

161 
»tv®
 = 
	`do_sš
 (
a
, 
da
);

163  (
n
 & 2è? -
»tv®
 :„etval;

164 
	}
}

172 
	$__sš
 (
x
)

174 
	`NK_PROFILE_ENTRY
();

175 
t
=0, 
a
=0, 
da
=0;

176 
mynumb”
 
u
;

177 
št4
 
k
=0, 
m
=0, 
n
=0;

178 
»tv®
 = 0;

182 
u
.
x
 = x;

183 
m
 = 
u
.
i
[
HIGH_HALF
];

184 
k
 = 0x7ffffffà& 
m
;

187 ià(
k
 < 0x3e500000)

189 
	`ERROR
("underflow !");

191 
»tv®
 = 
x
;

194 ià(
k
 < 0x3feb6000)

197 
»tv®
 = 
	`do_sš
 (
x
, 0);

201 ià(
k
 < 0x400368fd)

203 
t
 = 
hp0
 - 
	`çbs
 (
x
);

205 
»tv®
 = 
	`__cİysign
 (
	`do_cos
 (
t
, 
hp1
), 
x
);

209 ià(
k
 < 0x419921FB)

211 
n
 = 
	`»duû_sšcos
 (
x
, &
a
, &
da
);

213 
»tv®
 = 
	`do_sšcos
 (
a
, 
da
, 
n
);

217 ià(
k
 < 0x7ff00000)

219 
n
 = 
	`__b¿Äed
 (
x
, &
a
, &
da
);

220 
»tv®
 = 
	`do_sšcos
 (
a
, 
da
, 
n
);

225 ià(
k
 =ğ0x7ff00000 && 
u
.
i
[
LOW_HALF
] == 0)

227 
»tv®
 = 
x
 / x;

229 
	`NK_PROFILE_EXIT
();

230  
»tv®
;

231 
	}
}

240 
	$__cos
 (
x
)

242 
	`NK_PROFILE_ENTRY
();

243 
y
=0, 
a
=0, 
da
=0;

244 
mynumb”
 
u
;

245 
št4
 
k
=0, 
m
=0, 
n
=0;

247 
»tv®
 = 0;

251 
u
.
x
 = x;

252 
m
 = 
u
.
i
[
HIGH_HALF
];

253 
k
 = 0x7ffffffà& 
m
;

256 ià(
k
 < 0x3e400000)

257 
»tv®
 = 1.0;

259 ià(
k
 < 0x3feb6000)

262 
»tv®
 = 
	`do_cos
 (
x
, 0);

265 ià(
k
 < 0x400368fd)

267 
y
 = 
hp0
 - 
	`çbs
 (
x
);

268 
a
 = 
y
 + 
hp1
;

269 
da
 = (
y
 - 
a
è+ 
hp1
;

272 
»tv®
 = 
	`do_sš
 (
a
, 
da
);

275 ià(
k
 < 0x419921FB)

277 
n
 = 
	`»duû_sšcos
 (
x
, &
a
, &
da
);

278 
»tv®
 = 
	`do_sšcos
 (
a
, 
da
, 
n
 + 1);

282 ià(
k
 < 0x7ff00000)

284 
n
 = 
	`__b¿Äed
 (
x
, &
a
, &
da
);

285 
»tv®
 = 
	`do_sšcos
 (
a
, 
da
, 
n
 + 1);

290 ià(
k
 =ğ0x7ff00000 && 
u
.
i
[
LOW_HALF
] == 0)

292 
»tv®
 = 
x
 / x;

294 
	`NK_PROFILE_EXIT
();

295  
»tv®
;

296 
	}
}

299 
	$sš
(
x
è{ 
	`__sš
(x);
	}
}

300 
	$cos
(
x
è{ 
	`__cos
(x);
	}
}

	@math/sincos/nas_sincos.h

1 #iâdeà
_NAS_SINCOS_H_


2 
	#_NAS_SINCOS_H_


	)

4 
	~"../commÚ.h
"

5 
sš
(
x
);

6 
cos
(
x
);

	@math/sincos/nas_type.h

1 #iâdeà
_SINCOS_TYPE_H_


2 
	#_SINCOS_TYPE_H_


	)

3 
	~"Çs_mydefs.h
"

7 cÚ¡ 
	gs1
 = -0x1.5555555555555
p
-3;

8 cÚ¡ 
	gs2
 = 0x1.1111111110ECE
p
-7;

9 cÚ¡ 
	gs3
 = -0x1.A01A019DB08B8
p
-13;

10 cÚ¡ 
	gs4
 = 0x1.71DE27B9A7ED9
p
-19;

11 cÚ¡ 
	gs5
 = -0x1.ADDFFC2FCDF59
p
-26;

12 cÚ¡ 
	g¯
 = -0x1.5558000000000
p
-3;

13 cÚ¡ 
	gbb
 = 0x1.5555555556E24
p
-18;

14 cÚ¡ 
	gbig
 = 0x1.8000000000000
p45
;

15 cÚ¡ 
	ghp0
 = 0x1.921FB54442D18
p0
;

16 cÚ¡ 
	ghp1
 = 0x1.1A62633145C07
p
-54;

17 cÚ¡ 
	gmp1
 = 0x1.921FB58000000
p0
;

18 cÚ¡ 
	gmp2
 = -0x1.DDE973C000000
p
-27;

19 cÚ¡ 
	gmp3
 = -0x1.CB3B399D747F2
p
-55;

20 cÚ¡ 
	gµ3
 = -0x1.CB3B398000000
p
-55;

21 cÚ¡ 
	gµ4
 = -0x1.d747f23e32ed7
p
-83;

22 cÚ¡ 
	ghpšv
 = 0x1.45F306DC9C883
p
-1;

23 cÚ¡ 
	gtošt
 = 0x1.8000000000000
p52
;

27 
	$__cİysign
 (
x
, 
y
)

29 uniÚ {
x
; 
u
;} 
_x
, 
_y
, 
_r
;

30 
_x
.
x
 = x;

31 
_y
.
x
 = 
y
;

32 
_r
.
u
 = 
_x
.u <<1 >>1 | 
_y
.u >>63 <<63;

33  
_r
.
x
;

36 
	}
}

39 
	#LITTLE_ENDI
 1

	)

40 
	#HIGH_HALF
 1

	)

41 
	#LOW_HALF
 0

	)

	@math/sincos/sincos_test.c

1 
	~<Çutus/Çutus.h
>

2 
	~<Çutus/sh–l.h
>

3 
	~"Çs_sšcos.h
"

5 
sšcos
(*
__buf
, * 
__´iv
);

7 
sh–l_cmd_im¶
 
	gÇs_sšcos_im¶
 = {

8 .
cmd
 = "sc",

9 .
	gh–p_¡r
 = "sincosest",

10 .
	ghªdËr
 = 
sšcos
,

12 
nk_»gi¡”_sh–l_cmd
(
Çs_sšcos_im¶
);

16 
	$sšcos
(*
__buf
, * 
__´iv
) {

18 
	`´štf
("sš : %lf, co : %là\n", 
	`sš
(0.567),
	`cos
(9.087));

20 
	}
}

	@math/sincos/test.c

1 
	~"Çs_sšcos.h
"

2 
	~<¡dio.h
>

3 
	$maš
(){

5 
a
 = 4.5;

6 
	`´štf
("%20.20à%20.20à%20.20f\À%20.20à%20.20à%20.20f\À%20.20à%20.20à%20.20f\n", 
	`cos
(6.78), 
	`sš
(0.045664),cos(0.0678), sin(90),sin(0.987),sin(33.8),cos(90),cos(7.9));

7 
	}
}

	@npbparams.h

7 
	#PROBLEM_SIZE
 12

	)

8 
	#NITER_DEFAULT
 60

	)

9 
	#DT_DEFAULT
 0.010

	)

10 
	#CONVERTDOUBLE
 
FALSE


	)

11 
	#COMPILETIME
 "21 S• 2020"

	)

12 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

13 
	#CS1
 "cc"

	)

14 
	#CS2
 "cc"

	)

15 
	#CS3
 "ÒÚe)"

	)

16 
	#CS4
 "-I../commÚ"

	)

17 
	#CS5
 "-O3 "

	)

18 
	#CS6
 "ÒÚe)"

	)

19 
	#CS7
 "¿nddp"

	)

	@rand/c_randdp.c

3 #ià
defšed
(
USE_POW
)

4 
	#r23
 
	`pow
(0.5, 23.0)

	)

5 
	#r46
 (
r23
*r23)

	)

6 
	#t23
 
	`pow
(2.0, 23.0)

	)

7 
	#t46
 (
t23
*t23)

	)

9 
	#r23
 (0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5)

	)

10 
	#r46
 (
r23
*r23)

	)

11 
	#t23
 (2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0)

	)

12 
	#t46
 (
t23
*t23)

	)

18 
	$¿ndlc
 (*
x
, 
a
) {

46 
t1
,
t2
,
t3
,
t4
,
a1
,
a2
,
x1
,
x2
,
z
;

51 
t1
 = 
r23
 * 
a
;

52 
a1
 = ()
t1
;

53 
a2
 = 
a
 - 
t23
 * 
a1
;

60 
t1
 = 
r23
 * (*
x
);

61 
x1
 = ()
t1
;

62 
x2
 = (*
x
è- 
t23
 * 
x1
;

63 
t1
 = 
a1
 * 
x2
 + 
a2
 * 
x1
;

64 
t2
 = ()(
r23
 * 
t1
);

65 
z
 = 
t1
 - 
t23
 * 
t2
;

66 
t3
 = 
t23
 * 
z
 + 
a2
 * 
x2
;

67 
t4
 = ()(
r46
 * 
t3
);

68 (*
x
èğ
t3
 - 
t46
 * 
t4
;

70  (
r46
 * (*
x
));

71 
	}
}

76 
	$v¿Æc
 (
n
, *
x_£ed
, 
a
, * 
y
) {

103 
i
;

104 
x
,
t1
,
t2
,
t3
,
t4
,
a1
,
a2
,
x1
,
x2
,
z
;

105 
__a
;

109 
t1
 = 
r23
 * 
a
;

110 
a1
 = ()
t1
;

111 
a2
 = 
a
 - 
t23
 * 
a1
;

112 
x
 = *
x_£ed
;

117 
i
 = 1; i <ğ
n
; i++) {

124 
t1
 = 
r23
 * 
x
;

125 
x1
 = ()
t1
;

126 
x2
 = 
x
 - 
t23
 * 
x1
;

127 
t1
 = 
a1
 * 
x2
 + 
a2
 * 
x1
;

128 
t2
 = ()(
r23
 * 
t1
);

129 
z
 = 
t1
 - 
t23
 * 
t2
;

130 
t3
 = 
t23
 * 
z
 + 
a2
 * 
x2
;

131 
t4
 = ()(
r46
 * 
t3
);

132 
x
 = 
t3
 - 
t46
 * 
t4
;

133 
y
[
i
] = 
r46
 * 
x
;

135 *
x_£ed
 = 
x
;

136 
	}
}

	@sys/setparams.c

41 
	~<Çutus/Çutus.h
>

42 
	~<Çutus/sh–l.h
>

43 
	~<Çutus/Çut_¡ršg.h
>

52 
	#VERSION
 "3.0 sŒuùu»d"

	)

57 
	#FILENAME
 "Åb·¿ms.h"

	)

58 
	#DESC_LINE
 "/* CLASS = %ø*/\n"

	)

59 
	#DEF_CLASS_LINE
 "#defšCLASS '%c'\n"

	)

60 
	#FINDENT
 " "

	)

61 
	#CONTINUE
 " > "

	)

63 
g‘_šfo
(*
¬gv
[], *
ty³p
, *
şas¥
);

64 
check_šfo
(
ty³
, 
şass
);

65 
»ad_šfo
(
ty³
, *
şas¥
);

66 
wr™e_šfo
(
ty³
, 
şass
);

67 
wr™e_¥_šfo
(
FILE
 *
å
, 
şass
);

68 
wr™e_bt_šfo
(
FILE
 *
å
, 
şass
);

69 
wr™e_lu_šfo
(
FILE
 *
å
, 
şass
);

70 
wr™e_mg_šfo
(
FILE
 *
å
, 
şass
);

71 
wr™e_cg_šfo
(
FILE
 *
å
, 
şass
);

72 
wr™e_á_šfo
(
FILE
 *
å
, 
şass
);

73 
wr™e_•_šfo
(
FILE
 *
å
, 
şass
);

74 
wr™e_is_šfo
(
FILE
 *
å
, 
şass
);

75 
wr™e_comp”_šfo
(
ty³
, 
FILE
 *
å
);

76 
wr™e_cÚv”tdoubË_šfo
(
ty³
, 
FILE
 *
å
);

77 
check_lše
(*
lše
, *
Ïb–
, *
v®
);

78 
check_šşude_lše
(*
lše
, *
f’ame
);

79 
put_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
);

80 
put_def_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
);

81 
put_def_v¬ŸbË
(
FILE
 *
å
, *
Çme
, *
v®
);

82 
og2
(
i
);

84 
	eb’chm¬k_ty³s
 {
	mSP
, 
	mBT
, 
	mLU
, 
	mMG
, 
	mFT
, 
	mIS
, 
	mEP
, 
	mCG
};

86 
	$NAS_’Œy
(
¬gc
, *
¬gv
[])

88 
ty³
;

89 
şass
, 
şass_Şd
;

91 ià(
¬gc
 != 3) {

92 
	`´štf
("U§ge: % b’chm¬k-Çmşass\n", 
¬gv
[0]);

93 
	`ex™
(1);

97 
	`g‘_šfo
(
¬gv
, &
ty³
, &
şass
);

98 ià(
şass
 != 'U') {

99 #ifdeà
VERBOSE


100 
	`´štf
("setparams: For benchmark %s: class = %c\n",

101 
¬gv
[1], 
şass
);

103 
	`check_šfo
(
ty³
, 
şass
);

107 
	`»ad_šfo
(
ty³
, &
şass_Şd
);

108 ià(
şass
 != 'U') {

109 ià(
şass_Şd
 != 'X') {

110 #ifdeà
VERBOSE


111 
	`´štf
("setparams: old settings: class = %c\n",

112 
şass_Şd
);

116 
	`´štf
("setparams:\n\
*********************************************************************\n\
* You must specify CLASSo buildhis benchmark *\n\
* Forƒxample,o build‡ class A benchmark,ype *\n\
* make {benchmark-name} CLASS=A *\n\
*********************************************************************\n\n");

123 ià(
şass_Şd
 != 'X') {

124 #ifdeà
VERBOSE


125 
	`´štf
("£¬ams: P»viou £‰šg w”CLASS=%ø\n", 
şass_Şd
);

128 
	`ex™
(1);

132 ià(
şass
 !ğ
şass_Şd
) {

133 #ifdeà
VERBOSE


134 
	`´štf
("£¬ams: Wr™šg %s\n", 
FILENAME
);

136 
	`wr™e_šfo
(
ty³
, 
şass
);

138 #ifdeà
VERBOSE


139 
	`´štf
("£¬ams: S‘tšg unchªged. % unmodif›d\n", 
FILENAME
);

143 
	`ex™
(0);

144 
	}
}

151 
	$g‘_šfo
(*
¬gv
[], *
ty³p
, *
şas¥
)

154 *
şas¥
 = *
¬gv
[2];

156 ià(!
	`¡rcmp
(
¬gv
[1], "¥"è|| !¡rcmp×rgv[1], "SP")è*
ty³p
 = 
SP
;

157 ià(!
	`¡rcmp
(
¬gv
[1], "bt"è|| !¡rcmp×rgv[1], "BT")è*
ty³p
 = 
BT
;

158 ià(!
	`¡rcmp
(
¬gv
[1], "á"è|| !¡rcmp×rgv[1], "FT")è*
ty³p
 = 
FT
;

159 ià(!
	`¡rcmp
(
¬gv
[1], "lu"è|| !¡rcmp×rgv[1], "LU")è*
ty³p
 = 
LU
;

160 ià(!
	`¡rcmp
(
¬gv
[1], "mg"è|| !¡rcmp×rgv[1], "MG")è*
ty³p
 = 
MG
;

161 ià(!
	`¡rcmp
(
¬gv
[1], "is"è|| !¡rcmp×rgv[1], "IS")è*
ty³p
 = 
IS
;

162 ià(!
	`¡rcmp
(
¬gv
[1], "•"è|| !¡rcmp×rgv[1], "EP")è*
ty³p
 = 
EP
;

163 ià(!
	`¡rcmp
(
¬gv
[1], "cg"è|| !¡rcmp×rgv[1], "CG")è*
ty³p
 = 
CG
;

165 
	`´štf
("£¬ams: E¼Ü: unknowÀb’chm¬ky³ %s\n", 
¬gv
[1]);

166 
	`ex™
(1);

168 
	}
}

174 
	$check_šfo
(
ty³
, 
şass
)

176 
tm¶og
;

179 ià(
şass
 != 'S' &&

180 
şass
 != 'A' &&

181 
şass
 != 'B' &&

182 
şass
 != 'R' &&

183 
şass
 != 'W' &&

184 
şass
 != 'C') {

185 
	`´štf
("£¬ams: UnknowÀb’chm¬k cÏs %c\n", 
şass
);

186 
	`´štf
("setparams: Allowed classes‡re \"S\", \"A\", \"B\"‡nd \"C\"\n");

187 
	`ex™
(1);

190 
	}
}

201 
	$»ad_šfo
(
ty³
, *
şas¥
)

203 
Ä—d
, 
gÙem
 = 0;

204 
lše
[200];

243 
nÜm®_»tuº
:

244 *
şas¥
 = *classp;

245 
	`fşo£
(
å
);

250 
abÜt
:

251 *
şas¥
 = 'X';

253 
	}
}

263 
	$wr™e_šfo
(
ty³
, 
şass
)

340 
	}
}

347 
	$wr™e_¥_šfo
(
FILE
 *
å
, 
şass
)

349 
´obËm_size
, 
n™”
;

350 *
dt
;

351 ià(
şass
 =ğ'S'è{ 
´obËm_size
 = 12; 
dt
 = "0.015"; 
n™”
 = 100; }

352 ià(
şass
 =ğ'W'è{ 
´obËm_size
 = 36; 
dt
 = "0.0015"; 
n™”
 = 400; }

353 ià(
şass
 =ğ'A'è{ 
´obËm_size
 = 64; 
dt
 = "0.0015"; 
n™”
 = 400; }

354 ià(
şass
 =ğ'B'è{ 
´obËm_size
 = 102; 
dt
 = "0.001"; 
n™”
 = 400; }

355 ià(
şass
 =ğ'C'è{ 
´obËm_size
 = 162; 
dt
 = "0.00067"; 
n™”
 = 400; }

357 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs %c\n", 
şass
);

358 
	`ex™
(1);

360 
	`årštf
(
å
, "#defše\tPROBLEM_SIZE\t%d\n", 
´obËm_size
);

361 
	`årštf
(
å
, "#defše\tNITER_DEFAULT\t%d\n", 
n™”
);

362 
	`årštf
(
å
, "#defše\tDT_DEFAULT\t%s\n", 
dt
);

363 
	}
}

369 
	$wr™e_bt_šfo
(
FILE
 *
å
, 
şass
)

371 
´obËm_size
, 
n™”
;

372 *
dt
;

373 ià(
şass
 =ğ'S'è{ 
´obËm_size
 = 12; 
dt
 = "0.010"; 
n™”
 = 60; }

374 ià(
şass
 =ğ'W'è{ 
´obËm_size
 = 24; 
dt
 = "0.0008"; 
n™”
 = 200; }

375 ià(
şass
 =ğ'A'è{ 
´obËm_size
 = 64; 
dt
 = "0.0008"; 
n™”
 = 200; }

376 ià(
şass
 =ğ'B'è{ 
´obËm_size
 = 102; 
dt
 = "0.0003"; 
n™”
 = 200; }

377 ià(
şass
 =ğ'C'è{ 
´obËm_size
 = 162; 
dt
 = "0.0001"; 
n™”
 = 200; }

379 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs %c\n", 
şass
);

380 
	`ex™
(1);

382 
	`årštf
(
å
, "#defše\tPROBLEM_SIZE\t%d\n", 
´obËm_size
);

383 
	`årštf
(
å
, "#defše\tNITER_DEFAULT\t%d\n", 
n™”
);

384 
	`årštf
(
å
, "#defše\tDT_DEFAULT\t%s\n", 
dt
);

385 
	}
}

393 
	$wr™e_lu_šfo
(
FILE
 *
å
, 
şass
)

395 
isiz1
, 
isiz2
, 
™max
, 
šÜm
, 
´obËm_size
;

396 
xdiv
, 
ydiv
;

397 *
dt_deçuÉ
;

399 ià(
şass
 =ğ'S'è{ 
´obËm_size
 = 12; 
dt_deçuÉ
 = "0.5"; 
™max
 = 50; }

400 ià(
şass
 =ğ'W'è{ 
´obËm_size
 = 33; 
dt_deçuÉ
 = "1.5e-3"; 
™max
 = 300; }

401 ià(
şass
 =ğ'A'è{ 
´obËm_size
 = 64; 
dt_deçuÉ
 = "2.0"; 
™max
 = 250; }

402 ià(
şass
 =ğ'B'è{ 
´obËm_size
 = 102; 
dt_deçuÉ
 = "2.0"; 
™max
 = 250; }

403 ià(
şass
 =ğ'C'è{ 
´obËm_size
 = 162; 
dt_deçuÉ
 = "2.0"; 
™max
 = 250; }

405 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs %c\n", 
şass
);

406 
	`ex™
(1);

408 
šÜm
 = 
™max
;

409 
isiz1
 = 
´obËm_size
;

410 
isiz2
 = 
´obËm_size
;

412 
	`årštf
(
å
, "\n/* full…roblem size */\n");

413 
	`årštf
(
å
, "#defše\tISIZ1\t%d\n", 
´obËm_size
);

414 
	`årštf
(
å
, "#defše\tISIZ2\t%d\n", 
´obËm_size
);

415 
	`årštf
(
å
, "#defše\tISIZ3\t%d\n", 
´obËm_size
);

417 
	`årštf
(
å
, "/*‚umber of iterations‡nd how ofteno…rinthe‚orm */\n");

418 
	`årštf
(
å
, "#defše\tITMAX_DEFAULT\t%d\n", 
™max
);

419 
	`årštf
(
å
, "#defše\tINORM_DEFAULT\t%d\n", 
šÜm
);

421 
	`årštf
(
å
, "#defše\tDT_DEFAULT\t%s\n", 
dt_deçuÉ
);

422 
	}
}

428 
	$wr™e_mg_šfo
(
FILE
 *
å
, 
şass
)

430 
´obËm_size
, 
n™
, 
log2_size
, 
É_deçuÉ
, 
lm
;

431 
ndim1
, 
ndim2
, 
ndim3
;

432 ià(
şass
 =ğ'S'è{ 
´obËm_size
 = 32; 
n™
 = 4; }

433 ià(
şass
 =ğ'W'è{ 
´obËm_size
 = 64; 
n™
 = 40; }

434 ià(
şass
 =ğ'A'è{ 
´obËm_size
 = 256; 
n™
 = 4; }

435 ià(
şass
 =ğ'B'è{ 
´obËm_size
 = 256; 
n™
 = 20; }

436 ià(
şass
 =ğ'C'è{ 
´obËm_size
 = 512; 
n™
 = 20; }

438 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

439 
	`ex™
(1);

441 
log2_size
 = 
	`og2
(
´obËm_size
);

443 
É_deçuÉ
 = 
log2_size
;

445 
lm
 = 
log2_size
;

446 
ndim1
 = 
lm
;

447 
ndim3
 = 
log2_size
;

448 
ndim2
 = 
log2_size
;

450 
	`årštf
(
å
, "#defše\tNX_DEFAULT\t%d\n", 
´obËm_size
);

451 
	`årštf
(
å
, "#defše\tNY_DEFAULT\t%d\n", 
´obËm_size
);

452 
	`årštf
(
å
, "#defše\tNZ_DEFAULT\t%d\n", 
´obËm_size
);

453 
	`årštf
(
å
, "#defše\tNIT_DEFAULT\t%d\n", 
n™
);

454 
	`årštf
(
å
, "#defše\tLM\t%d\n", 
lm
);

455 
	`årštf
(
å
, "#defše\tLT_DEFAULT\t%d\n", 
É_deçuÉ
);

456 
	`årštf
(
å
, "#define\tDEBUG_DEFAULT\t%d\n", 0);

457 
	`årštf
(
å
, "#defše\tNDIM1\t%d\n", 
ndim1
);

458 
	`årštf
(
å
, "#defše\tNDIM2\t%d\n", 
ndim2
);

459 
	`årštf
(
å
, "#defše\tNDIM3\t%d\n", 
ndim3
);

460 
	}
}

467 
	$wr™e_is_šfo
(
FILE
 *
å
, 
şass
)

469 
m1
, 
m2
, 
m3
 ;

470 ifĞ
şass
 != 'S' &&

471 
şass
 != 'W' &&

472 
şass
 != 'A' &&

473 
şass
 != 'B' &&

474 
şass
 != 'C')

476 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

477 
	`ex™
(1);

479 
	}
}

486 
	$wr™e_cg_šfo
(
FILE
 *
å
, 
şass
)

488 
Ç
,
nÚz”
,
n™”
;

489 *
shiá
,*
rcÚd
="1.0e-1";

490 *
shiáS
="10.0",

491 *
shiáW
="12.0",

492 *
shiáA
="20.0",

493 *
shiáB
="60.0",

494 *
shiáC
="110.0";

497 ifĞ
şass
 == 'S' )

498 { 
Ç
=1400; 
nÚz”
=7; 
n™”
=15; 
shiá
=
shiáS
; }

499 ifĞ
şass
 == 'W' )

500 { 
Ç
=7000; 
nÚz”
=8; 
n™”
=15; 
shiá
=
shiáW
; }

501 ifĞ
şass
 == 'A' )

502 { 
Ç
=14000; 
nÚz”
=11; 
n™”
=15; 
shiá
=
shiáA
; }

503 ifĞ
şass
 == 'B' )

504 { 
Ç
=75000; 
nÚz”
=13; 
n™”
=75; 
shiá
=
shiáB
; }

505 ifĞ
şass
 == 'C' )

506 { 
Ç
=150000; 
nÚz”
=15; 
n™”
=75; 
shiá
=
shiáC
; }

509 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

510 
	`ex™
(1);

512 
	`årštf
Ğ
å
, "#defše\tNA\t%d\n", 
Ç
);

513 
	`årštf
Ğ
å
, "#defše\tNONZER\t%d\n", 
nÚz”
);

514 
	`årštf
Ğ
å
, "#defše\tNITER\t%d\n", 
n™”
);

515 
	`årštf
Ğ
å
, "#defše\tSHIFT\t%s\n", 
shiá
);

516 
	`årštf
Ğ
å
, "#defše\tRCOND\t%s\n", 
rcÚd
);

517 
	}
}

524 
	$wr™e_á_šfo
(
FILE
 *
å
, 
şass
)

530 
nx
, 
ny
, 
nz
, 
maxdim
, 
n™”
, 
Å_mš
;

531 ià(
şass
 =ğ'S'è{ 
nx
 = 64; 
ny
 = 64; 
nz
 = 64; 
n™”
 = 6;}

532 ià(
şass
 =ğ'W'è{ 
nx
 = 128; 
ny
 = 128; 
nz
 = 32; 
n™”
 = 6;}

533 ià(
şass
 =ğ'A'è{ 
nx
 = 256; 
ny
 = 256; 
nz
 = 128; 
n™”
 = 6;}

534 ià(
şass
 =ğ'B'è{ 
nx
 = 512; 
ny
 = 256; 
nz
 = 256; 
n™”
 =20;}

535 ià(
şass
 =ğ'C'è{ 
nx
 = 512; 
ny
 = 512; 
nz
 = 512; 
n™”
 =20;}

537 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

538 
	`ex™
(1);

540 
maxdim
 = 
nx
;

541 ià(
ny
 > 
maxdim
) maxdim =‚y;

542 ià(
nz
 > 
maxdim
) maxdim =‚z;

543 
	`årštf
(
å
, "#defše\tNX\t%d\n", 
nx
);

544 
	`årštf
(
å
, "#defše\tNY\t%d\n", 
ny
);

545 
	`årštf
(
å
, "#defše\tNZ\t%d\n", 
nz
);

546 
	`årštf
(
å
, "#defše\tMAXDIM\t%d\n", 
maxdim
);

547 
	`årštf
(
å
, "#defše\tNITER_DEFAULT\t%d\n", 
n™”
);

548 
	`årštf
(
å
, "#defše\tNTOTAL\t%d\n", 
nx
*
ny
*
nz
);

549 
	}
}

555 
	$wr™e_•_šfo
(
FILE
 *
å
, 
şass
)

561 
m
;

562 ià(
şass
 =ğ'S'è{ 
m
 = 24; }

563 ià(
şass
 =ğ'W'è{ 
m
 = 25; }

564 ià(
şass
 =ğ'A'è{ 
m
 = 28; }

565 ià(
şass
 =ğ'B'è{ 
m
 = 30; }

566 ià(
şass
 =ğ'C'è{ 
m
 = 32; }

568 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

569 
	`ex™
(1);

572 
	`årštf
(
å
, "#defše\tCLASS\ˆ\'%c\'\n", 
şass
);

573 
	`årštf
(
å
, "#defše\tM\t%d\n", 
m
);

574 
	}
}

589 
	#VERBOSE


	)

590 
	#LL
 400

	)

591 
	~<¡dio.h
>

592 
	#DEFFILE
 "../cÚfig/make.def"

	)

593 
	#DEFAULT_MESSAGE
 "ÒÚe)"

	)

594 
	$wr™e_comp”_šfo
(
ty³
, 
FILE
 *
å
)

596 
FILE
 *
deffe
;

597 
lše
[
LL
];

598 
f77
[
LL
], 
æšk
[LL], 
f_lib
[LL], 
f_šc
[LL], 
fæags
[LL], 
æškæags
[LL];

599 
comp‘ime
[
LL
], 
¿ndfe
[LL];

600 
cc
[
LL
], 
cæags
[LL], 
şšk
[LL], 
şškæags
[LL],

601 
c_lib
[
LL
], 
c_šc
[LL];

602 
tm
 *
tmp
;

603 
time_t
 
t
;

604 
deffe
 = 
	`fİ’
(
DEFFILE
, "r");

605 ià(
deffe
 =ğ
NULL
) {

606 
	`´štf
("\n\
: F% dÛ¢'ˆexi¡. TØbudhNAS b’chm¬ks\n\
‚“dØü—‹ i accÜdšgØthš¡ruùiÚs\n\
hREADME iÀthmaš dœeùÜy‡nd comm’t š \n\
 fcÚfig/make.def.‹m¶©e\n", 
DEFFILE
);

611 
	`ex™
(1);

613 
	`¡rıy
(
f77
, 
DEFAULT_MESSAGE
);

614 
	`¡rıy
(
æšk
, 
DEFAULT_MESSAGE
);

615 
	`¡rıy
(
f_lib
, 
DEFAULT_MESSAGE
);

616 
	`¡rıy
(
f_šc
, 
DEFAULT_MESSAGE
);

617 
	`¡rıy
(
fæags
, 
DEFAULT_MESSAGE
);

618 
	`¡rıy
(
æškæags
, 
DEFAULT_MESSAGE
);

619 
	`¡rıy
(
¿ndfe
, 
DEFAULT_MESSAGE
);

620 
	`¡rıy
(
cc
, 
DEFAULT_MESSAGE
);

621 
	`¡rıy
(
cæags
, 
DEFAULT_MESSAGE
);

622 
	`¡rıy
(
şšk
, 
DEFAULT_MESSAGE
);

623 
	`¡rıy
(
şškæags
, 
DEFAULT_MESSAGE
);

624 
	`¡rıy
(
c_lib
, 
DEFAULT_MESSAGE
);

625 
	`¡rıy
(
c_šc
, 
DEFAULT_MESSAGE
);

627 
	`fg‘s
(
lše
, 
LL
, 
deffe
è!ğ
NULL
) {

628 ià(*
lše
 == '#') ;

630 
	`check_lše
(
lše
, "F77", 
f77
);

631 
	`check_lše
(
lše
, "FLINK", 
æšk
);

632 
	`check_lše
(
lše
, "F_LIB", 
f_lib
);

633 
	`check_lše
(
lše
, "F_INC", 
f_šc
);

634 
	`check_lše
(
lše
, "FFLAGS", 
fæags
);

635 
	`check_lše
(
lše
, "FLINKFLAGS", 
æškæags
);

636 
	`check_lše
(
lše
, "RAND", 
¿ndfe
);

637 
	`check_lše
(
lše
, "CC", 
cc
);

638 
	`check_lše
(
lše
, "CFLAGS", 
cæags
);

639 
	`check_lše
(
lše
, "CLINK", 
şšk
);

640 
	`check_lše
(
lše
, "CLINKFLAGS", 
şškæags
);

641 
	`check_lše
(
lše
, "C_LIB", 
c_lib
);

642 
	`check_lše
(
lše
, "C_INC", 
c_šc
);

646 (è
	`time
(&
t
);

647 
tmp
 = 
	`loÿÉime
(&
t
);

648 (è
	`¡ráime
(
comp‘ime
, (
size_t
)
LL
, "%d %b %Y", 
tmp
);

651 
ty³
) {

652 
FT
:

653 
SP
:

654 
BT
:

655 
MG
:

656 
LU
:

657 
EP
:

658 
CG
:

659 
	`put_def_¡ršg
(
å
, "COMPILETIME", 
comp‘ime
);

660 
	`put_def_¡ršg
(
å
, "NPBVERSION", 
VERSION
);

661 
	`put_def_¡ršg
(
å
, "CS1", 
cc
);

662 
	`put_def_¡ršg
(
å
, "CS2", 
şšk
);

663 
	`put_def_¡ršg
(
å
, "CS3", 
c_lib
);

664 
	`put_def_¡ršg
(
å
, "CS4", 
c_šc
);

665 
	`put_def_¡ršg
(
å
, "CS5", 
cæags
);

666 
	`put_def_¡ršg
(
å
, "CS6", 
şškæags
);

667 
	`put_def_¡ršg
(
å
, "CS7", 
¿ndfe
);

669 
IS
:

670 
	`put_def_¡ršg
(
å
, "COMPILETIME", 
comp‘ime
);

671 
	`put_def_¡ršg
(
å
, "NPBVERSION", 
VERSION
);

672 
	`put_def_¡ršg
(
å
, "CC", 
cc
);

673 
	`put_def_¡ršg
(
å
, "CFLAGS", 
cæags
);

674 
	`put_def_¡ršg
(
å
, "CLINK", 
şšk
);

675 
	`put_def_¡ršg
(
å
, "CLINKFLAGS", 
şškæags
);

676 
	`put_def_¡ršg
(
å
, "C_LIB", 
c_lib
);

677 
	`put_def_¡ršg
(
å
, "C_INC", 
c_šc
);

680 
	`´štf
("setparams: (Internalƒrror): Unknown benchmarkype %d\n",

681 
ty³
);

682 
	`ex™
(1);

685 
	}
}

687 
	$check_lše
(*
lše
, *
Ïb–
, *
v®
)

689 *
Üigš®_lše
;

690 
Üigš®_lše
 = 
lše
;

692 *
Ïb–
 !ğ'\0' && *
lše
 == *label) {

693 
lše
++; 
Ïb–
++;

696 ià(*
Ïb–
 != '\0') ;

698 ià(!
	`is¥aû
(*
lše
) && *line != '=')  ;

700 
	`is¥aû
(*
lše
))†ine++;

702 ià(*
lše
 != '=') ;

704 
	`is¥aû
(*++
lše
));

706 ià(*
lše
 == '\0') ;

708 
	`¡rıy
(
v®
, 
lše
);

710 
v®
[
	`¡¾’
(val)-1] = '\0';

711 ià(
v®
[
	`¡¾’
(val) - 1] == '\\') {

712 
	`´štf
("\n\
: E¼Ü iÀfmake.def. Beÿu£ oàthway iÀwhich\n\
†š¬gum’t ¬šcÜpÜ©ed iÁØthe\n\
 b’chm¬k, you cª'ˆhavªy cÚtšued\n\
 iÀthfmake.def,h© is,†še ’dšg\n\
hch¬aù” \"\\\". AÉhough iˆmay bugly, \n\
 should babËØ»fÜm© w™houˆcÚtšu©iÚ\n\
. Thofãndšg†šis\n\
%s\n", 
Üigš®_lše
);

721 
	`ex™
(1);

723 
	}
}

725 
	$check_šşude_lše
(*
lše
, *
f’ame
)

727 *
šşude_¡ršg
 = "include";

729 *
šşude_¡ršg
 !ğ'\0' && *
lše
 == *include_string) {

730 
lše
++; 
šşude_¡ršg
++;

733 ià(*
šşude_¡ršg
 != '\0') (0);

735 ià(!
	`is¥aû
(*
lše
)) (0);

737 
	`is¥aû
(*++
lše
));

739 ià(*
lše
 == '\0') (0);

741 *
f’ame
 !ğ'\0' && *
lše
 == *filename) {

742 
lše
++; 
f’ame
++;

744 ià(*
f’ame
 != '\0' ||

745 (*
lše
 != ' ' && *line != '\0' && *line !='\n')) (0);

747 
	}
}

750 
	#MAXL
 46

	)

751 
	$put_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
)

753 
Ën
;

754 
Ën
 = 
	`¡¾’
(
v®
);

755 ià(
Ën
 > 
MAXL
) {

756 
v®
[
MAXL
] = '\0';

757 
v®
[
MAXL
-1] = '.';

758 
v®
[
MAXL
-2] = '.';

759 
v®
[
MAXL
-3] = '.';

760 
Ën
 = 
MAXL
;

762 
	`årštf
(
å
, "%sch¬aù”*%d %s\n", 
FINDENT
, 
Ën
, 
Çme
);

763 
	`årštf
(
å
, "%¥¬am‘” (%s=\'%s\')\n", 
FINDENT
, 
Çme
, 
v®
);

764 
	}
}

767 
	$put_def_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
)

769 
Ën
;

770 
Ën
 = 
	`¡¾’
(
v®
);

771 ià(
Ën
 > 
MAXL
) {

772 
v®
[
MAXL
] = '\0';

773 
v®
[
MAXL
-1] = '.';

774 
v®
[
MAXL
-2] = '.';

775 
v®
[
MAXL
-3] = '.';

776 
Ën
 = 
MAXL
;

778 
	`årštf
(
å
, "#defš% \"%s\"\n", 
Çme
, 
v®
);

779 
	}
}

781 
	$put_def_v¬ŸbË
(
FILE
 *
å
, *
Çme
, *
v®
)

783 
Ën
;

784 
Ën
 = 
	`¡¾’
(
v®
);

785 ià(
Ën
 > 
MAXL
) {

786 
v®
[
MAXL
] = '\0';

787 
v®
[
MAXL
-1] = '.';

788 
v®
[
MAXL
-2] = '.';

789 
v®
[
MAXL
-3] = '.';

790 
Ën
 = 
MAXL
;

792 
	`årštf
(
å
, "#defš% %s\n", 
Çme
, 
v®
);

793 
	}
}

804 
	#LINELEN
 65

	)

805 
	$put_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
)

807 
Ën
, 
Æšes
, 
pos
, 
i
;

808 
lše
[100];

809 
Ën
 = 
	`¡¾’
(
v®
);

810 
Æšes
 = 
Ën
/
LINELEN
;

811 ià(
Æšes
*
LINELEN
 < 
Ën
)‚lines++;

812 
	`årštf
(
å
, "%sch¬aù”*%d %s\n", 
FINDENT
, 
Æšes
*
LINELEN
, 
Çme
);

813 
	`årštf
(
å
, "%¥¬am‘” (% ğ\n", 
FINDENT
, 
Çme
);

814 
i
 = 0; i < 
Æšes
; i++) {

815 
pos
 = 
i
*
LINELEN
;

816 ià(
i
 =ğ0è
	`årštf
(
å
, "%s\'", 
CONTINUE
);

817 
	`årštf
(
å
, "%s", 
CONTINUE
);

819 
	`årštf
(
å
, "%.65s", 
v®
+
pos
);

820 ià(
i
 =ğ
Æšes
-1è
	`årštf
(
å
, "\')\n");

821 
	`årštf
(
å
, "\n");

823 
	}
}

832 
	$og2
(
i
)

834 
log2
;

835 
exp2
 = 1;

836 ià(
i
 <= 0) (-1);

838 
log2
 = 0;†og2 < 20;†og2++) {

839 ià(
exp2
 =ğ
i
è(
log2
);

840 
exp2
 *= 2;

843 
	}
}

847 
	$wr™e_cÚv”tdoubË_šfo
(
ty³
, 
FILE
 *
å
)

849 
ty³
) {

850 
SP
:

851 
BT
:

852 
LU
:

853 
FT
:

854 
MG
:

855 
EP
:

856 
CG
:

857 #ifdeà
CONVERTDOUBLE


858 
	`årštf
(
å
, "#define\tCONVERTDOUBLE\tTRUE\n");

860 
	`årštf
(
å
, "#define\tCONVERTDOUBLE\tFALSE\n");

864 
	}
}

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	~<b™s/ty³s/__FILE.h
>

37 
	~<b™s/ty³s/FILE.h
>

39 
	#_STDIO_USES_IOSTREAM


	)

41 
	~<b™s/libio.h
>

43 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


44 #ifdeà
__GNUC__


45 #iâdeà
_VA_LIST_DEFINED


46 
_G_va_li¡
 
	tva_li¡
;

47 
	#_VA_LIST_DEFINED


	)

50 
	~<¡d¬g.h
>

54 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


55 #iâdeà
__off_t_defšed


56 #iâdeà
__USE_FILE_OFFSET64


57 
__off_t
 
	toff_t
;

59 
__off64_t
 
	toff_t
;

61 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

69 #ifdeà
__USE_XOPEN2K8


70 #iâdeà
__ssize_t_defšed


71 
__ssize_t
 
	tssize_t
;

72 
	#__ssize_t_defšed


	)

77 #iâdeà
__USE_FILE_OFFSET64


78 
_G_åos_t
 
	tåos_t
;

80 
_G_åos64_t
 
	tåos_t
;

82 #ifdeà
__USE_LARGEFILE64


83 
_G_åos64_t
 
	tåos64_t
;

87 
	#_IOFBF
 0

	)

88 
	#_IOLBF
 1

	)

89 
	#_IONBF
 2

	)

93 #iâdeà
BUFSIZ


94 
	#BUFSIZ
 
_IO_BUFSIZ


	)

100 #iâdeà
EOF


101 
	#EOF
 (-1)

	)

107 
	#SEEK_SET
 0

	)

108 
	#SEEK_CUR
 1

	)

109 
	#SEEK_END
 2

	)

110 #ifdeà
__USE_GNU


111 
	#SEEK_DATA
 3

	)

112 
	#SEEK_HOLE
 4

	)

116 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


118 
	#P_tmpdœ
 "/tmp"

	)

131 
	~<b™s/¡dio_lim.h
>

135 
_IO_FILE
 *
¡dš
;

136 
_IO_FILE
 *
¡dout
;

137 
_IO_FILE
 *
¡d”r
;

139 
	#¡dš
 
¡dš


	)

140 
	#¡dout
 
¡dout


	)

141 
	#¡d”r
 
¡d”r


	)

144 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

146 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

148 #ifdeà
__USE_ATFILE


150 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

151 cÚ¡ *
__Ãw
è
__THROW
;

158 #iâdeà
__USE_FILE_OFFSET64


159 
FILE
 *
	$tmpfe
 (è
__wur
;

161 #ifdeà
__REDIRECT


162 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

164 
	#tmpfe
 
tmpfe64


	)

168 #ifdeà
__USE_LARGEFILE64


169 
FILE
 *
	$tmpfe64
 (è
__wur
;

173 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

175 #ifdeà
__USE_MISC


178 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

182 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


190 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

191 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

199 
	`fşo£
 (
FILE
 *
__¡»am
);

204 
	`fæush
 (
FILE
 *
__¡»am
);

206 #ifdeà
__USE_MISC


213 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

216 #ifdeà
__USE_GNU


223 
	`fşo£®l
 ();

227 #iâdeà
__USE_FILE_OFFSET64


232 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

233 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

238 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

239 cÚ¡ *
__»¡riù
 
__modes
,

240 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

242 #ifdeà
__REDIRECT


243 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

244 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

245 
__wur
;

246 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

247 cÚ¡ *
__»¡riù
 
__modes
,

248 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

249 
__wur
;

251 
	#fİ’
 
fİ’64


	)

252 
	#äeİ’
 
äeİ’64


	)

255 #ifdeà
__USE_LARGEFILE64


256 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

257 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

258 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

259 cÚ¡ *
__»¡riù
 
__modes
,

260 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

263 #ifdef 
__USE_POSIX


265 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

268 #ifdef 
__USE_GNU


271 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

272 cÚ¡ *
__»¡riù
 
__modes
,

273 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

276 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

278 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

279 
__THROW
 
__wur
;

284 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

290 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

294 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

295 
__modes
, 
size_t
 
__n
è
__THROW
;

297 #ifdef 
__USE_MISC


300 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

301 
size_t
 
__size
è
__THROW
;

304 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

312 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

313 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

318 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

320 
	$¥rštf
 (*
__»¡riù
 
__s
,

321 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

327 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

328 
_G_va_li¡
 
__¬g
);

333 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

335 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

336 
_G_va_li¡
 
__¬g
è
__THROWNL
;

338 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


340 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

341 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

342 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

344 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

345 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

346 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

349 #ià
	`__GLIBC_USE
 (
LIB_EXT2
)

352 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

353 
_G_va_li¡
 
__¬g
)

354 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

355 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

356 cÚ¡ *
__»¡riù
 
__fmt
, ...)

357 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

358 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

359 cÚ¡ *
__»¡riù
 
__fmt
, ...)

360 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

363 #ifdeà
__USE_XOPEN2K8


365 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

366 
_G_va_li¡
 
__¬g
)

367 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

368 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

369 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

377 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

378 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

383 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

385 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

386 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

388 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

389 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

390 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

391 #ifdeà
__REDIRECT


395 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

396 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

397 
__isoc99_fsÿnf
è
__wur
;

398 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

399 
__isoc99_sÿnf
è
__wur
;

400 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

401 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

402 
__isoc99_ssÿnf
);

404 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

405 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

406 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

407 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

408 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

409 
	#fsÿnf
 
__isoc99_fsÿnf


	)

410 
	#sÿnf
 
__isoc99_sÿnf


	)

411 
	#ssÿnf
 
__isoc99_ssÿnf


	)

415 #ifdef 
__USE_ISOC99


420 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

421 
_G_va_li¡
 
__¬g
)

422 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

428 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

429 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

432 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

433 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

434 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

436 #ià!
defšed
 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
vfsÿnf
,

444 (
FILE
 *
__»¡riù
 
__s
,

445 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

446 
__isoc99_vfsÿnf
)

447 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

448 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

449 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

450 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

451 
	`__REDIRECT_NTH
 (
vssÿnf
,

452 (cÚ¡ *
__»¡riù
 
__s
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
,

454 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

455 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

457 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

458 cÚ¡ *
__»¡riù
 
__fÜm©
,

459 
_G_va_li¡
 
__¬g
è
__wur
;

460 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

461 
_G_va_li¡
 
__¬g
è
__wur
;

462 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

463 cÚ¡ *
__»¡riù
 
__fÜm©
,

464 
_G_va_li¡
 
__¬g
è
__THROW
;

465 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

466 
	#vsÿnf
 
__isoc99_vsÿnf


	)

467 
	#vssÿnf
 
__isoc99_vssÿnf


	)

477 
	`fg‘c
 (
FILE
 *
__¡»am
);

478 
	`g‘c
 (
FILE
 *
__¡»am
);

484 
	`g‘ch¬
 ();

488 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

490 #ifdeà
__USE_POSIX199506


495 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

496 
	`g‘ch¬_uÆocked
 ();

499 #ifdeà
__USE_MISC


506 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

517 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

518 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

524 
	`putch¬
 (
__c
);

528 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

530 #ifdeà
__USE_MISC


537 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

540 #ifdeà
__USE_POSIX199506


545 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

546 
	`putch¬_uÆocked
 (
__c
);

550 #ià
defšed
 
__USE_MISC
 \

551 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

553 
	`g‘w
 (
FILE
 *
__¡»am
);

556 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

564 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

565 
__wur
;

567 #ià
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

577 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

580 #ifdeà
__USE_GNU


587 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

588 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

592 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

603 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

604 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

605 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

606 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

607 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

608 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

616 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

617 
size_t
 *
__»¡riù
 
__n
,

618 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

626 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

632 
	`puts
 (cÚ¡ *
__s
);

639 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

646 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

647 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

652 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

653 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

655 #ifdeà
__USE_GNU


662 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

663 
FILE
 *
__»¡riù
 
__¡»am
);

666 #ifdeà
__USE_MISC


673 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

674 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

675 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

676 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

684 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

689 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

694 
	`»wšd
 (
FILE
 *
__¡»am
);

701 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


702 #iâdeà
__USE_FILE_OFFSET64


707 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

712 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

714 #ifdeà
__REDIRECT


715 
	`__REDIRECT
 (
f£eko
,

716 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

717 
f£eko64
);

718 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

720 
	#f£eko
 
f£eko64


	)

721 
	#á–lo
 
á–lo64


	)

726 #iâdeà
__USE_FILE_OFFSET64


731 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

736 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

738 #ifdeà
__REDIRECT


739 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

740 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

741 
	`__REDIRECT
 (
f£os
,

742 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

744 
	#fg‘pos
 
fg‘pos64


	)

745 
	#f£os
 
f£os64


	)

749 #ifdeà
__USE_LARGEFILE64


750 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

751 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

752 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

753 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

757 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

759 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

761 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

763 #ifdeà
__USE_MISC


765 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

766 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

767 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

775 
	`³¼Ü
 (cÚ¡ *
__s
);

781 
	~<b™s/sys_”¾i¡.h
>

784 #ifdef 
__USE_POSIX


786 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

789 #ifdeà
__USE_MISC


791 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

795 #ifdeà
__USE_POSIX2


800 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

806 
	`pşo£
 (
FILE
 *
__¡»am
);

810 #ifdef 
__USE_POSIX


812 *
	$ù”mid
 (*
__s
è
__THROW
;

816 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
è|| defšed 
__USE_GNU


818 *
	`cu£rid
 (*
__s
);

822 #ifdef 
__USE_GNU


823 
ob¡ack
;

826 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

827 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

828 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

829 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

830 cÚ¡ *
__»¡riù
 
__fÜm©
,

831 
_G_va_li¡
 
__¬gs
)

832 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

836 #ifdeà
__USE_POSIX199506


840 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

844 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

847 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

850 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


853 
	~<b™s/g‘İt_posix.h
>

858 #ifdeà
__USE_EXTERN_INLINES


859 
	~<b™s/¡dio.h
>

861 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


862 
	~<b™s/¡dio2.h
>

864 #ifdeà
__LDBL_COMPAT


865 
	~<b™s/¡dio-ldbl.h
>

868 
__END_DECLS


	@
1
.
1
/usr/include
56
937
BT/bt.c
BT/header.h
BT/npbparams.h
CG/cg.c
CG/npbparams.h
EP/ep.c
EP/npbparams.h
FT/ft.c
FT/global.h
FT/npbparams.h
IS/is.c
IS/npbparams.h
LU/applu.h
LU/lu.c
LU/npbparams.h
MG/globals.h
MG/mg.c
MG/npbparams.h
SP/header.h
SP/npbparams.h
SP/sp.c
common/c_print_results.c
common/c_randdp.c
common/c_timers.c
common/common.h
common/npb-C.h
common/npbparams.h
common/wtime.c
common/wtime.h
common/wtime_sgi64.c
math/common.h
math/exp/exp.h
math/exp/linux_test.c
math/exp/nas_exp.h
math/exp/test.c
math/log/frexp.h
math/log/nas_log.h
math/log/test.c
math/nas_math.h
math/pow/nas_pow.h
math/pow/test.c
math/sincos/__sincostab.h
math/sincos/nas_branred.c
math/sincos/nas_branred.h
math/sincos/nas_branred_type.h
math/sincos/nas_endian.h
math/sincos/nas_mydefs.h
math/sincos/nas_sincos.c
math/sincos/nas_sincos.h
math/sincos/nas_type.h
math/sincos/sincos_test.c
math/sincos/test.c
npbparams.h
rand/c_randdp.c
sys/setparams.c
/usr/include/stdio.h
